<h3>12.5 Variable context <code>sys</code></h3>

<p><br>

   <p>System variables are derived from CFEngine's automated discovery of system values. They are provided as variables in order to make automatically adaptive rules for configuration. For example:

<pre>
files:

 any::

  "$(sys.resolv)"

      create        => "true",
      edit_line     => doresolv("@(this.list1)","@(this.list2)"),
      edit_defaults => reconstruct;

</pre>

<p>The above rule requires no class specification because the variable itself is class-specific.

<ul>
<li><a>Variable sys.arch</a>
<li><a>Variable sys.cdate</a>
<li><a>Variable sys.cf_promises</a>
<li><a>Variable sys.cf_version</a>
<li><a>Variable sys.class</a>
<li><a>Variable sys.cpus</a>
<li><a>Variable sys.crontab</a>
<li><a>Variable sys.date</a>
<li><a>Variable sys.doc_root</a>
<li><a>Variable sys.domain</a>
<li><a>Variable sys.enterprise_version</a>
<li><a>Variable sys.expires</a>
<li><a>Variable sys.exports</a>
<li><a>Variable sys.flavor</a>
<li><a>Variable sys.flavour</a>
<li><a>Variable sys.fqhost</a>
<li><a>Variable sys.fstab</a>
<li><a>Variable sys.hardware_addresses</a>
<li><a>Variable sys.hardware_mac[interface_name]</a>
<li><a>Variable sys.host</a>
<li><a>Variable sys.interface</a>
<li><a>Variable sys.interfaces</a>
<li><a>Variable sys.ip_addresses</a>
<li><a>Variable sys.ipv4</a>
<li><a>Variable sys.ipv4[interface_name]</a>
<li><a>Variable sys.ipv4_1[interface_name]</a>
<li><a>Variable sys.ipv4_2[interface_name]</a>
<li><a>Variable sys.ipv4_3[interface_name]</a>
<li><a>Variable sys.license_owner</a>
<li><a>Variable sys.licenses_granted</a>
<li><a>Variable sys.long_arch</a>
<li><a>Variable sys.maildir</a>
<li><a>Variable sys.nova_version</a>
<li><a>Variable sys.os</a>
<li><a>Variable sys.ostype</a>
<li><a>Variable sys.policy_hub</a>
<li><a>Variable sys.release</a>
<li><a>Variable sys.resolv</a>
<li><a>Variable sys.uqhost</a>
<li><a>Variable sys.version</a>
<li><a>Variable sys.windir</a>
<li><a>Variable sys.winprogdir</a>
<li><a>Variable sys.winprogdir86</a>
<li><a>Variable sys.winsysdir</a>
<li><a>Variable sys.workdir</a>
</ul>
<div>
<a></a>
<a></a>

</div>

<h4>12.5.1 Variable sys.arch</h4>

<p><br>

   <p>The variable gives the kernel's short architecture description.

<pre>
# arch = x86_64

</pre>

<div>
<a></a>
<a></a>

</div>

<h4>12.5.2 Variable sys.cdate</h4>

<p><br>

   <p>The date of the system in canonical form, i.e. in the form of a class.

<pre>
# cdate = Sun_Dec__7_10_39_53_2008_

</pre>

<div>
<a></a>
<a></a>

</div>

<h4>12.5.3 Variable sys.cf_promises</h4>

<p><br>

   <p>A variable containing the path to the CFEngine syntax analyxer <code>cf-promises</code> on the platform you are using.

<pre>
classes:

  "syntax_ok" expression => returnszero("$(sys.cf_promises)");

</pre>

<div>
<a></a>
<a></a>

</div>

<h4>12.5.4 Variable sys.cf_version</h4>

<p><br>

   <p>The variable gives the version of the running CFEngine Community Edition.

<pre>
# cf_version = 3.0.5 

</pre>

<div>
<a></a>
<a></a>

</div>

<h4>12.5.5 Variable sys.class</h4>

<p><br>

   <p>This variable contains the name of the hard-class category for this host (i.e. its top level operating system type classification).

<pre>
# class = linux

</pre>

<div>
<a></a>
<a></a>

</div>

<h4>12.5.6 Variable sys.cpus</h4>

<p><br>

   <p><i>History</i>: Was introduced in 3.3.0, Nova 2.2.0 (2012)

   <p>A variable containing the number of CPU cores detected. On systems which provide virtual cores, it is set to the total number of virtual, not physical, cores. In addition, on a single-core system the class "1_cpu" is set, and on multi-core systems the class "<em>n</em>_cpus" is set, where "<em>n</em>" is the number of cores identified.

<pre>reports:

 cfengine_3::

   "Number of CPUS = $(sys.cpus)";

 8_cpus::
   "This system has 8 processors.";

</pre>

<div>
<a></a>
<a></a>

</div>

<h4>12.5.7 Variable sys.crontab</h4>

<p><br>

   <p>The variable gives the location of the current users's master crontab directory.

<pre>
# crontab = /var/spool/crontas/root 

</pre>

<div>
<a></a>
<a></a>

</div>

<h4>12.5.8 Variable sys.date</h4>

<p><br>

   <p>The date of the system as a text string.

<pre>
# date = Sun Dec  7 10:39:53 2008

</pre>

<div>
<a></a>
<a></a>

</div>

<h4>12.5.9 Variable sys.doc_root</h4>

<p><br>

   <p><i>History</i>: Was introduced in 3.1.0, Nova 2.0.

   <p>A scalar variable containing the default path for the document root of the standard web server package.

<div>
<a></a>
<a></a>

</div>

<h4>12.5.10 Variable sys.domain</h4>

<p><br>

   <p>The domain name as divined by CFEngine. If the DNS is in use, it could be possible to derive the domain name from its DNS regisration, but in general there is no way to discover this value automatically. The <code>common control</code> body permits the ultimate specification of this value.

<pre>
# domain = example.org
 
</pre>

<div>
<a></a>
<a></a>

</div>

<h4>12.5.11 Variable sys.enterprise_version</h4>

<p><br>

   <p><i>History</i>: Was introduced in 3.5.0, Enterprise 3.0.0

   <p>The variable gives the version of the running CFEngine Enterprise Edition.

<pre>
# enterprise_version = 3.0.0

</pre>

<div>
<a></a>
<a></a>

</div>

<h4>12.5.12 Variable sys.expires</h4>

<p><br>

<pre>reports:

 nova::

  "License expires $(sys.expires)";
</pre>

<div>
<a></a>
<a></a>

</div>

<h4>12.5.13 Variable sys.exports</h4>

<p><br>

   <p>The location of the system NFS exports file.

<pre>
# exports = /etc/exports
# exports = /etc/dfs/dfstab

</pre>

<div>
<a></a>
<a></a>

</div>

<h4>12.5.14 Variable sys.flavor</h4>

<p><br>

   <p><i>History</i>: Was introduced in 3.2.0, Nova 2.0

   <p>A variable containing an operating system identification string that is used to determine the current release of the operating system in a form that can be used as a label in naming. This is used, for instance, to detect which package name to choose when updating software binaries for CFEngine.

   <p>This is a synonym for <code>$(sys.flavour)</code>.

<div>
<a></a>
<a></a>

</div>

<h4>12.5.15 Variable sys.flavour</h4>

<p><br>

   <p><i>History</i>: Was introduced in 3.2.0, Nova 2.0

   <p>A variable containing an operating system identification string that is used to determine the current release of the operating system in a form that can be used as a label in naming. This is used, for instance, to detect which package name to choose when updating software binaries for CFEngine.

   <p>This is a synonym for <code>$(sys.flavor)</code>.

<div>
<a></a>
<a></a>

</div>

<h4>12.5.16 Variable sys.fqhost</h4>

<p><br>

   <p>The fully qualified name of the host. In order to compute this value properly, the domain name must be defined.

<pre>
# fqhost = host.example.org

</pre>

<div>
<a></a>
<a></a>

</div>

<h4>12.5.17 Variable sys.fstab</h4>

<p><br>

   <p>The location of the system filesystem (mount) table.

<pre>
# fstab = /etc/fstab

</pre>

<div>
<a></a>
<a></a>

</div>

<h4>12.5.18 Variable sys.hardware_addresses</h4>

<p><br>

   <p><i>History</i>: Was introduced in 3.3.0, Nova 2.2.0 (2011)

   <p>This is a list variable containing a list of all known MAC addresses for system interfaces.

<div>
<a></a>
<a></a>

</div>

<h4>12.5.19 Variable sys.hardware_mac[interface_name]</h4>

<p><br>

   <p><i>History</i>: Was introduced in 3.3.0, Nova 2.2.0 (2011)

   <p>This contains the MAC address of the named interface. For example:

<pre>
reports:

  linux::

    "Tell me $(harware_mac[eth0])";
</pre>

<div>
<a></a>
<a></a>

</div>

<h4>12.5.20 Variable sys.host</h4>

<p><br>

   <p>The name of the current host, according to the kernel. It is undefined whether this is qualified or unqualified with a domain name.

<pre>
# host = myhost

</pre>

<div>
<a></a>
<a></a>

</div>

<h4>12.5.21 Variable sys.interface</h4>

<p><br>

   <p>The assumed (default) name of the main system interface on this host.

<pre>
# interface = eth0

</pre>

<div>
<a></a>
<a></a>

</div>

<h4>12.5.22 Variable sys.interfaces</h4>

<p><br>

   <p><i>History</i>: Was introduced in 3.3.0, Nova 2.2.0 (2011)

   <p>Displays a system list of configured interfaces currently active in use by the system. This list is detected at runtime and it passed in the variables report to a Mission Portal in commercial editions of CFEngine.

   <p>To use this list in a policy, you will need a local copy since only local variables can be iterated.

<pre>
bundle agent test
{
vars:

 # To iterate, we need a local copy

 "i1" slist => { @(sys.ip_addresses)} ;
 "i2" slist => { @(sys.interfaces)} ;

reports:

  cfengine::

    "Addresses: $(i1)";
    "Interfaces: $(i2)";
    "Addresses of the interfaces: $(sys.ipv4[$(i2)])";

}

</pre>

<div>
<a></a>
<a></a>

</div>

<h4>12.5.23 Variable sys.ip_addresses</h4>

<p><br>

   <p><i>History</i>: Was introduced in 3.3.0, Nova 2.2.0 (2011)

   <p>Displays a system list of IP addresses currently in use by the system. This list is detected at runtime and passed in the variables report to a Mission Portal in commercial editions of CFEngine.

   <p>To use this list in a policy, you will need a local copy since only local variables can be iterated.

<pre>
bundle agent test
{
vars:

 # To iterate, we need a local copy

 "i1" slist => { @(sys.ip_addresses)} ;
 "i2" slist => { @(sys.interfaces)} ;

reports:

  cfengine::

    "Addresses: $(i1)";
    "Interfaces: $(i2)";
    "Addresses of the interfaces: $(sys.ipv4[$(i2)])";

}

</pre>

<div>
<a></a>
<a></a>

</div>

<h4>12.5.24 Variable sys.ipv4</h4>

<p><br>

   <p>All four octets of the IPv4 address of the first system interface.

<p><b>Note</b>:<br>

   <p>If your system has a single ethernet interface, <samp><span>$(sys.ipv4)</span></samp> will contain your IPv4 address. However, if your system has multiple interfaces, then <samp><span>$(sys.ipv4)</span></samp> will simply be the IPv4 address of the first interface in the list that has an assigned address, See <a>Variable sys.ipv4[interface_name]</a>, for details on obtaining the IPv4 addresses of all interfaces on a system.

<div>
<a></a>
<a></a>

</div>

<h4>12.5.25 Variable sys.ipv4[interface_name]</h4>

<p><br>

   <p>The full IPv4 address of the system interface named
as the associative array index, e.g. 
<samp><span>$(ipv4[le0])</span></samp> or <samp><span>$(ipv4[xr1])</span></samp>.

<pre>
# If the IPv4 address on the interfaces are
#        le0 = 192.168.1.101
#	 xr1 = 10.12.7.254
#
# Then the octets of all interfaces are accessible as an associative array
# ipv4_1[le0] = 192
# ipv4_2[le0] = 192.168
# ipv4_3[le0] = 192.168.1
#   ipv4[le0] = 192.168.1.101
# ipv4_1[xr1] = 10
# ipv4_2[xr1] = 10.12
# ipv4_3[xr1] = 10.12.7
#   ipv4[xr1] = 10.12.7.254

</pre>

<p><b>Note</b>:<br>

   <p>The list of interfaces may be acquired with <samp><span>getindices("sys.ipv4")</span></samp> (or from any of the other associative arrays). Only those interfaces which are marked as "up" and have an IP address will be listed.

<div>
<a></a>
<a></a>

</div>

<h4>12.5.26 Variable sys.ipv4_1[interface_name]</h4>

<p><br>

   <p>The first octet of the IPv4 address of the system interface named as the associative array index, e.g. <samp><span>$(ipv4_1[le0])</span></samp> or <samp><span>$(ipv4_1[xr1])</span></samp> (See <a>Variable sys.ipv4[interface_name]</a>).

<div>
<a></a>
<a></a>

</div>

<h4>12.5.27 Variable sys.ipv4_2[interface_name]</h4>

<p><br>

   <p>The first two octets of the IPv4 address of the system interface named as the associative array index, e.g. <samp><span>$(ipv4_2[le0])</span></samp> or <samp><span>$(ipv4_2[xr1])</span></samp> (See <a>Variable sys.ipv4[interface_name]</a>).

<div>
<a></a>
<a></a>

</div>

<h4>12.5.28 Variable sys.ipv4_3[interface_name]</h4>

<p><br>

   <p>The first three octets of the IPv4 address of the system interface named as the associative array index, e.g. <samp><span>$(ipv4_3[le0])</span></samp> or <samp><span>$(ipv4_3[xr1])</span></samp> (See <a>Variable sys.ipv4[interface_name]</a>).

<div>
<a></a>
<a></a>


</div>

<h4>12.5.29 Variable sys.license_owner</h4>

<p><br>

   <p><i>History</i>: Was introduced in version 3.1.4,Nova 2.0.2 (2011)

<pre>
reports:

 nova::

  "This version of CFEngine is licensed to $(sys.license_owner)";

</pre>

<div>
<a></a>
<a></a>


</div>

<h4>12.5.30 Variable sys.licenses_granted</h4>

<p><br>

   <p><i>History</i>: Was introduced in version 3.1.4,Nova 2.0.2 (2011)

<pre>
reports:

 nova::

  "There are $(sys.licenses_granted) licenses granted for use";

</pre>

<div>
<a></a>
<a></a>

</div>

<h4>12.5.31 Variable sys.long_arch</h4>

<p><br>

   <p>The long architecture name for this system kernel. This name is sometimes quite unwieldy but can be useful for logging purposes.

<pre>
# long_arch = linux_x86_64_2_6_22_19_0_1_default__1_SMP_2008_10_14_22_17_43__0200

</pre>

<div>
<a></a>
<a></a>


</div>

<h4>12.5.32 Variable sys.maildir</h4>

<p><br>

   <p>The name of the system email spool directory.

<pre>
# maildir = /var/spool/mail

</pre>

<div>
<a></a>
<a></a>


</div>

<h4>12.5.33 Variable sys.nova_version</h4>

<p><br>

   <p>The variable gives the version of the running CFEngine Nova Edition.

<pre>
# nova_version = 1.1.3

</pre>

<div>
<a></a>
<a></a>


</div>

<h4>12.5.34 Variable sys.os</h4>

<p><br>

   <p>The name of the operating system according to the kernel.

<pre>
# os = linux

</pre>

<div>
<a></a>
<a></a>

</div>

<h4>12.5.35 Variable sys.ostype</h4>

<p><br>

   <p>Another name for the operating system.

<pre>
# ostype = linux_x86_64

</pre>

<div>
<a></a>
<a></a>


</div>

<h4>12.5.36 Variable sys.policy_hub</h4>

<p><br>
Hostname of the machine acting as a policy hub. This value is set during bootstrap. In case bootstrap was not performed, it is set to undefined.

   <p><b>History</b>: Was introduced in version 3.1.0b1,Nova 2.0.0b1 (2010). Available in Community since 3.2.0

<pre>
reports:

 "Policy hub is $(sys.policy_hub)";

</pre>

<div>
<a></a>
<a></a>


</div>

<h4>12.5.37 Variable sys.release</h4>

<p><br>

   <p>The kernel release of the operating system.

<pre>
# release = 2.6.22.19-0.1-default

</pre>

<div>
<a></a>
<a></a>


</div>

<h4>12.5.38 Variable sys.resolv</h4>

<p><br>

   <p>The location of the system resolver file.

<pre>
# resolv = /etc/resolv.conf

</pre>

<div>
<a></a>
<a></a>


</div>

<h4>12.5.39 Variable sys.uqhost</h4>

<p><br>

   <p>The unqualified name of the current host. See also <code>sys.fqhost</code>.

<pre>
# uqhost = myhost

</pre>

<div>
<a></a>
<a></a>


</div>

<h4>12.5.40 Variable sys.version</h4>

<p><br>

   <p>The version of the running kernel. On Linux, this corresponds
to the ouput of <code>uname -v</code>.

<pre>
# version = #55-Ubuntu SMP Mon Jan 10 23:42:43 UTC 2011

</pre>

   <p><i>History</i>: Was introduced in version 3.1.4,Nova 2.0.2 (2011)

<div>
<a></a>
<a></a>


</div>

<h4>12.5.41 Variable sys.windir</h4>

<p><br>

   <p>On the Windows version of CFEngine Nova, this is the path to the Windows directory of this system.

<pre>
# windir = C:\WINDOWS

</pre>

<div>
<a></a>
<a></a>

</div>

<h4>12.5.42 Variable sys.winprogdir</h4>

<p><br>

   <p>On the Windows version of CFEngine Nova, this is the path to the program files directory of the system.

<pre>
# winprogdir = C:\Program Files

</pre>

<div>
<a></a>
<a></a>


</div>

<h4>12.5.43 Variable sys.winprogdir86</h4>

<p><br>

   <p>On 64 bit Windows versions of CFEngine Nova, this is the path to the 32 bit (x86) program files directory of the system.

<pre>
# winprogdir86 = C:\Program Files (x86)

</pre>

<div>
<a></a>
<a></a>


</div>

<h4>12.5.44 Variable sys.winsysdir</h4>

<p><br>

   <p>On the Windows version of CFEngine Nova, this is the path to the Windows system directory.

<pre>
# winsysdir = C:\WINDOWS\system32

</pre>

<div>
<a></a>
<a></a>


</div>

<h4>12.5.45 Variable sys.workdir</h4>

<p><br>

   <p>The location of the CFEngine work directory and cache. For the system privileged user this is normally:

<pre>
# workdir = /var/cfengine

</pre>

   <p>For non-privileged users it is in the user's home directory:

<pre>
# workdir = /home/user/.cfagent

</pre>

   <p>On the Windows version of CFEngine Nova, it is normally under program files (the directory name may change with the language of Windows):

<pre>
# workdir = C:\Program Files\CFEngine

</pre>

<div>
<a></a>

</div>


