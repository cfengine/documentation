<h3>11.84 Function regldap</h3>

<p><b>Synopsis</b>: regldap(arg1,arg2,arg3,arg4,arg5,arg6,arg7) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : URI, <i>in the range</i> .*
<br>
   <i>arg2</i> : Distinguished name, <i>in the range</i> .*
<br>
   <i>arg3</i> : Filter, <i>in the range</i> .*
<br>
   <i>arg4</i> : Record name, <i>in the range</i> .*
<br>
   <i>arg5</i> : Search scope policy, <i>in the range</i> subtree,onelevel,base
<br>
   <i>arg6</i> : Regex to match results, <i>in the range</i> .*
<br>
   <i>arg7</i> : Security level, <i>in the range</i> none,ssl,sasl
<br>

<p>True if the regular expression in arg6 matches a value item in an LDAP search.

<p><b>Example</b>:<br>
<br>

<pre>
classes:

   "found" expression => regldap(
                                "ldap://ldap.example.org",
                                "dc=cfengine,dc=com",
                                "(sn=User)",
                                "uid",
                                "subtree",
                                "jon.*",
                                "none"
                                );

</pre>

<p><b>Notes</b>:<br>
<br>

   <p><table><tr><td>
<pre>     
     (class) regldap(<var>uri</var>,<var>dn</var>,<var>filter</var>,<var>name</var>,<var>scope</var>,<var>regex</var>,<var>security</var>)
     
</pre>
   </td></tr></table>

   <p>This function retrieves a single field from all matching LDAP records identified by the search parameters and compares it to a regular expression. If there is a match, true is returned else false.

<p><b>ARGUMENTS</b>:

     <dl>
<dt><samp><span>uri</span></samp><dd>String value of the ldap server. e.g. <code>"ldap://ldap.cfengine.com.no"</code>
<br><dt><samp><span>dn</span></samp><dd>Distinguished name, an ldap formatted name built from components, e.g. "dc=cfengine,dc=com". 
<br><dt><samp><span>filter</span></samp><dd>String filter criterion, in ldap search, e.g. "(sn=User)". 
<br><dt><samp><span>name</span></samp><dd>String value, the name of a single record to be retrieved, e.g. <code>uid</code>. 
<br><dt><samp><span>scope</span></samp><dd>Menu option, the type of ldap search, from the specified root. May take values:
     <pre>              subtree
              onelevel
              base
</pre>
     <br><dt><samp><span>regex</span></samp><dd>A regular expression string to match to the results of an LDAP search. The regular expression is anchored, meaning it must match the entire named field (See <a>Anchored vs. unanchored regular expressions</a>). If any item matches the regex, the result will be true.

     <br><dt><samp><span>security</span></samp><dd>Menu option indicating the encryption and authentication settings for communication with the LDAP server. These features might be subject to machine and server capabilities.
     <pre>               none
               ssl
               sasl
</pre>
     </dl>

<div>
<a></a>

</div>


