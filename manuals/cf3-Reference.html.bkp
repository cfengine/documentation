<html lang="en">
<head>
<title>CFEngine reference manual</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="CFEngine reference manual">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="top" href="#Top">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
@font-face {
    font-family: 'CFE_FONT';
    src: url('fonts/eot/opensans-regular-webfont.eot');
    src: local('â˜º'),  url('fonts/ttf/opensans-regular-webfont.ttf') format('truetype'), url('fonts/svg/opensans-regular-webfont.svg') format('svg');
    font-weight: normal;
    font-style: normal;
}    
pre {
    background-color: #EEFFDD;
    border: 1px solid #CCCCCC;
    font-family: courier;
    margin-bottom: 10px;
    margin-top: 10px;
    padding: 5px;
    font-size: 90%;
    }
pre.display { font-family:inherit }
pre.format  { font-family:inherit }
pre.smallexample
pre.smalllisp,
pre.smallformat,
pre.smalldisplay {
  font-size: 90%;
} 

span.sc    { font-variant:small-caps }
span.roman { font-family:serif; font-weight:normal; } 
span.sansserif { font-family:sans-serif; font-weight:normal; } 

body {
    font:  90%  'CFE_FONT', arial, Helvetica,sans-serif; 
    color: #646464;
    padding: 10px 20px;
    width: 960px;
    margin: 0 auto;
}
.node
{
    text-align: right;
    padding: 2px;
    font-size: smaller;
}
.node hr {
    border: 0;
    width: 100%;
    color: #CCC;
    background-color: #CCC;
    height: 5px;
}
.section {
    padding-right: 0px;
    padding-bottom: 0px;
    padding-left: 0px;
}

h1 {
    font-size: 26px;
    font-weight: normal;
    line-height: 32px;
    margin: 32px 0 16px;
    text-align: left;
    text-transform: uppercase;
}

h2 {
    color: #9E9981 !important;
    font-size: 16px;
    line-height: 18px;
    font-weight: normal;
    margin: 16px 0 26px;
    text-align: left;
}
h3 {
    margin-top: 3px;
    margin-right: 0px;
    margin-bottom: 10px;
    margin-left: 0px;
    line-height: 20px;
    font-size: 16px;
    font-weight: normal;
}

.contents
{
    background-color: #CCC;
    padding-top: 2px;
    padding-right: 2px;
    padding-bottom: 2px;
    padding-left: 10px;
}

.index-cp
{  
background: #fff url(index-cp.png) right repeat-y;
}

.index-vr
{  
background: #fff url(index-vr.png) right repeat-y;
}

.index-mb
{  
background: #eee url(index-faq.png) right repeat-y;
}

table.border
{
	border-color: #666;
	border-width: 0px;
}

FONT.liten {font-size: 80%; }
 
.tynn {
    font-family: Arial, Helvetica, sans-serif;
    font-size: smaller;
    font-style: normal;
    font-weight: lighter;
    margin-bottom: 0em;
    font-size: 11pt;
}
.verbatim {
    color: #000;
    margin-top: 0px;
    margin-right: 0px;
    margin-bottom: 20px;
    margin-left: 0px;
}
.example {
    color: #000;
    width: 100%;
    margin-top: 0px;
    margin-right: 0px;
    margin-bottom: 20px;
    margin-left: 0px;
}
.smallexample {
    color: #000;
    padding-top: 10px;
    padding-right: 30px;
    padding-bottom: 5px;
    padding-left: 30px;
    margin-top: 0px;
    margin-right: 0px;
    margin-bottom: 0px;
    margin-left: 0px;
}
.cartouche {
    padding: 5px;
    font-style: italic;
    font-size: 85%;
}

table.cartouche {
    border: none !important;
}

 .cartouche td  {
    background: none !important;
    border: none !important;
    padding: 5px; 

/*    background-color: #ddd;
    border: 1px solid #ccc;
    padding: 5px;*/
}

A:link { color: #2c2e70 }
A:visited { color: black }
A:active { color: #600041 }
dt em {font-weight: bold}
/* don't change this rule */    
pre.sp {
    background: none !important;   
    border:none !important
}
/* --- */
/*code hightlight*/
.red { color: #b80047; font-weight: bold; }

.blue { color: blue;  /*font-weight: bold;*/ }

.green { color: darkgreen; }

.comment { font-style: italic; }
--></style>
</head>
<body>
<h1 class="settitle">CFEngine reference manual</h1>
<div class="node">
<a name="Top"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Getting-started">Getting started</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#dir">(dir)</a>

</div>

<h2 class="unnumbered">CFEngine-AutoReference</h2>

<ul class="menu">
<li><a accesskey="1" href="#Getting-started">Getting started</a>
<li><a accesskey="2" href="#A-simple-crash-course">A simple crash course</a>
<li><a accesskey="3" href="#How-to-run-CFEngine-3-examples">How to run CFEngine 3 examples</a>
<li><a accesskey="4" href="#A-complete-configuration">A complete configuration</a>
<li><a accesskey="5" href="#Control-Promises">Control Promises</a>
<li><a accesskey="6" href="#Bundles-for-common">Bundles for common</a>
<li><a accesskey="7" href="#Bundles-for-agent">Bundles for agent</a>
<li><a accesskey="8" href="#Bundles-for-server">Bundles for server</a>
<li><a accesskey="9" href="#Bundles-for-knowledge">Bundles for knowledge</a>
<li><a href="#Bundles-for-monitor">Bundles for monitor</a>
<li><a href="#Special-functions">Special functions</a>
<li><a href="#Special-Variables">Special Variables</a>
<li><a href="#Logs-and-records">Logs and records</a>
</ul>
<a href="#Contents"><h1>COMPLETE TABLE OF CONTENTS</h1></a>
<h2>Summary of contents</h2><!-- ***************************************************** -->
<!-- * CHAPTER -->
<!-- ***************************************************** -->
<div class="node">
<a name="Getting-started"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#A-simple-crash-course">A simple crash course</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Top">Top</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">1 CFEngine 3.5.0a1.cd6175a &ndash; Getting started</h2>

<p><br>

   <p>CFEngine is a suite of programs for integrated autonomic management of
either individual or networked computers. It has existed as as
software suite since 1993 and this version published under the GNU
Public License (GPL v3) and a Commercial Open Source License (COSL). 
CFEngine is Copyright by <b>CFEngine AS</b>, a company founded by CFEngine
author Mark Burgess.

   <p>This document describes major version 3 of CFEngine, which is a
significant departure from earlier versions, and represents the newest
and most carefully researched technology available for configuration
management. It is both simpler and more powerful.  CFEngine 3 will
exist as both free open source and commercial enterprise versions:

     <ul>
<li><b>Community Edition</b> - a free and gratis core of the software (available now). 
<li><b>Enterprise</b> - a commercial enhanced version for basic enterprise needs (available now; previously known as Nova). 
</ul>

   <p>This document is valid for <b>all versions</b> of CFEngine.  Whenever a feature is only
available in a specific version, that fact will be noted in the documentation for that
feature (if there is no note, then that feature is available in all versions).

   <p>CFEngine 3 has been changed to be both a more powerful tool and a much
simpler tool. CFEngine 3's language interface is not backwards
compatible with the CFEngine 2 configuration language, but it
interoperates with CFEngine 2 so that it is "run-time compatible". 
This means that you can change over to version 3 slowly, with low risk
and at your own speed.

   <p>With CFEngine 3 you can install, configure and maintain computers
using powerful hands-free tools. You can also integrate knowledge
management and diagnosis into the processes.

   <p>CFEngine differs from most management systems in being

     <ul>
<li>Open software (GPL or COSL). 
<li>Lightweight and generic. 
<li>Non-reliant on a working network to function correctly. 
<li>Capable of making each and every host autonomous
</ul>

<ul class="menu">
<li><a accesskey="1" href="#Software-components">Software components</a>
<li><a accesskey="2" href="#Core-concepts">Core concepts</a>
<li><a accesskey="3" href="#A-renewed-CFEngine">A renewed CFEngine</a>
<li><a accesskey="4" href="#Installation">Installation</a>
<li><a accesskey="5" href="#Syntax">Syntax</a>
<li><a accesskey="6" href="#Work-directory">Work directory</a>
<li><a accesskey="7" href="#Decisions">Decisions</a>
<li><a accesskey="8" href="#Filenames-and-paths">Filenames and paths</a>
<li><a accesskey="9" href="#Upgrading-from-CFEngine-2">Upgrading from CFEngine 2</a>
<li><a href="#Testing-as-a-non_002dprivilieged-user">Testing as a non-privilieged user</a>
<li><a href="#The-bare-necessities-of-a-CFEngine-3">The bare necessities of a CFEngine 3</a>
<li><a href="#Familiiarizing-yourself">Familiiarizing yourself</a>
<li><a href="#Remote-access-troubleshooting">Remote access troubleshooting</a>
</ul>

<div class="node">
<a name="Software-components"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Core-concepts">Core concepts</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Getting-started">Getting started</a>

</div>

<h3 class="section">1.1 Software components</h3>

<p>CFEngine 3 consists of a number of components.  The names of the programs are
intentionally different from those in CFEngine 2 to help disambiguate them (and
some CFEngine 2 components have been merged and/or eliminated).  The
starred components are new to CFEngine 3:

<ul class="menu">
<li><a accesskey="1" href="#cf_002dagent">cf-agent</a>
<li><a accesskey="2" href="#cf_002dexecd">cf-execd</a>
<li><a accesskey="3" href="#cf_002dknow">cf-know</a>
<li><a accesskey="4" href="#cf_002dmonitord">cf-monitord</a>
<li><a accesskey="5" href="#cf_002dpromises">cf-promises</a>
<li><a accesskey="6" href="#cf_002drunagent">cf-runagent</a>
<li><a accesskey="7" href="#cf_002dserverd">cf-serverd</a>
<li><a accesskey="8" href="#cf_002dreport">cf-report</a>
<li><a accesskey="9" href="#cf_002dkey">cf-key</a>
<li><a href="#cf_002dhub">cf-hub</a>
</ul>

<div class="node">
<a name="cf-agent"></a>
<a name="cf_002dagent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#cf_002dexecd">cf-execd</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Software-components">Software components</a>

</div>

<h4 class="subsection">1.1.1 cf-agent</h4>

<p>Active agent &ndash; responsible for maintaining promises about the state of
    your system (in CFEngine 2 the agent was called <code>cfagent</code>). 
    You can run <code>cf-agent</code> manually, but if you want to have it
    run on a regular basis, you should use <a href="#cf_002dexecd">cf-execd</a>
    (instead of using <code>cron</code>).

   <p><code>cf-agent</code> keeps the promises made in <a href="#Bundles-for-common">common</a>
and <a href="#Bundles-for-agent">agent</a> bundles, and is affected by
<a href="#control-common">common</a> and <a href="#control-agent">agent</a>
control bodies.

<div class="node">
<a name="cf-execd"></a>
<a name="cf_002dexecd"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#cf_002dknow">cf-know</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#cf_002dagent">cf-agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Software-components">Software components</a>

</div>

<h4 class="subsection">1.1.2 cf-execd</h4>

<p>Scheduler &ndash; responsible for running cf-agent on a regular (and
    user-configurable) basis (in CFEngine 2 the scheduler was called
    <code>cfexecd</code>).

   <p>EXECUTOR
<code>cf-execd</code> keeps the promises made in <a href="#Bundles-for-common">common</a>
bundles, and is affected by
<a href="#control-common">common</a> and <a href="#control-executor">executor</a>
control bodies.

<div class="node">
<a name="cf-know"></a>
<a name="cf_002dknow"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#cf_002dmonitord">cf-monitord</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#cf_002dexecd">cf-execd</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Software-components">Software components</a>

</div>

<h4 class="subsection">1.1.3 cf-know*</h4>

<p>Knowledge modelling agent &ndash; responsible for building and analysing a
       semantic knowledge network.

   <p><code>cf-know</code> keeps the promises made in <a href="#Bundles-for-common">common</a>
and <a href="#Bundles-for-knowledge">knowledge</a> bundles, and is affected by
<a href="#control-common">common</a> and <a href="#control-knowledge">knowledge</a>
control bodies.

<div class="node">
<a name="cf-monitord"></a>
<a name="cf_002dmonitord"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#cf_002dpromises">cf-promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#cf_002dknow">cf-know</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Software-components">Software components</a>

</div>

<h4 class="subsection">1.1.4 cf-monitord</h4>

<p>Passive monitoring agent &ndash; responsible for collecting information about
    the status of your system (which can be reported upon or used to
    enforce promises or influence when promises are enforced).  In CFEngine 2
    the passive monitoring agent was known as <code>cfenvd</code>.

   <p><code>cf-monitord</code> keeps the promises made in <a href="#Bundles-for-common">common</a>
and <a href="#Bundles-for-monitor">monitor</a> bundles, and is affected by
<a href="#control-common">common</a> and <a href="#control-monitor">monitor</a>
control bodies.

<div class="node">
<a name="cf-promises"></a>
<a name="cf_002dpromises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#cf_002drunagent">cf-runagent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#cf_002dmonitord">cf-monitord</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Software-components">Software components</a>

</div>

<h4 class="subsection">1.1.5 cf-promises</h4>

<p>Promise validator &ndash; used to verify that the promises used by the other
    components of CFEngine are syntactically valid. 
<code>cf-promises</code> does not execute any promises, but can syntax-check
all of them.

<div class="node">
<a name="cf-runagent"></a>
<a name="cf_002drunagent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#cf_002dserverd">cf-serverd</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#cf_002dpromises">cf-promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Software-components">Software components</a>

</div>

<h4 class="subsection">1.1.6 cf-runagent</h4>

<p>Remote run agent &ndash; used to execute <code>cf-agent</code> on a remote machine (in
    CFEngine 2 the remote run agent was called <code>cfrun</code>). 
<code>cf-runagent</code> does not keep any promises, but instead is used to ask
another machine to do so.

<div class="node">
<a name="cf-serverd"></a>
<a name="cf_002dserverd"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#cf_002dreport">cf-report</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#cf_002drunagent">cf-runagent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Software-components">Software components</a>

</div>

<h4 class="subsection">1.1.7 cf-serverd</h4>

<p>Server &ndash; used to distribute policy and/or data files to clients requesting
    them and used to respond to requests from <code>cf-runagent</code> (in
    CFEngine 2 the remote run agent was called <code>cfservd</code>).

   <p><code>cf-serverd</code> keeps the promises made in <a href="#Bundles-for-common">common</a>
and <a href="#Bundles-for-server">server</a> bundles, and is affected by
<a href="#control-common">common</a> and <a href="#control-server">server</a>
control bodies.

<div class="node">
<a name="cf-report"></a>
<a name="cf_002dreport"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#cf_002dkey">cf-key</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#cf_002dserverd">cf-serverd</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Software-components">Software components</a>

</div>

<h4 class="subsection">1.1.8 cf-report</h4>

<p>Self-knowledge extractor &ndash; takes data stored in CFEngine's embedded
    databases and converts them to human readable form

   <p><code>cf-report</code> keeps the promises made in <a href="#Bundles-for-common">common</a>
bundles, and is affected by
<a href="#control-common">common</a> and <a href="#control-reporter">reporter</a>
control bodies.

<div class="node">
<a name="cf-key"></a>
<a name="cf_002dkey"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#cf_002dhub">cf-hub</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#cf_002dreport">cf-report</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Software-components">Software components</a>

</div>

<h4 class="subsection">1.1.9 cf-key</h4>

<p>Key generation tool &ndash; run once on every host to create public/private key
    pairs for secure communication (in CFEngine 2 the key generation tool
    was called <code>cfkey</code>).  <code>cf-key</code> does not keep any promises.

<div class="node">
<a name="cf-hub"></a>
<a name="cf_002dhub"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#cf_002dkey">cf-key</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Software-components">Software components</a>

</div>

<h4 class="subsection">1.1.10 cf-hub</h4>

<p>A data aggregator used as part of the commercial product. This stub is not
used in the community edition of CFEngine.

<div class="node">
<a name="Core-concepts"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#A-renewed-CFEngine">A renewed CFEngine</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Software-components">Software components</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Getting-started">Getting started</a>

</div>

<h3 class="section">1.2 Core concepts</h3>

<p>Unlike previous versions of CFEngine, which had no consistent model
for its features, you can recognize <i>everything</i> in CFEngine 3
from just a few concepts.

     <dl>
<dt><i>Promise</i><dd>A declaration about the <i>state</i> we desire to maintain (<i>e.g.,</i> the permissions
or contents of a file, the availability or absence of a service, the
(de)installation of a package). 
<br><dt><i>Promise bundles</i><dd>A collection of promises. 
<br><dt><i>Promise bodies</i><dd>A part of a promise which details and constrains its nature. 
<br><dt><i>Data types</i><dd>An interpretation of a scalar value: string, integer or real number. 
<br><dt><i>Variables</i><dd>An association of the form "LVALUE <i>represents</i> RVALUE", where rval may be a scalar value or a list of scalar values. 
<br><dt><i>Functions</i><dd>Built-in parameterized rvalues. 
<br><dt><i>Classes</i><dd>CFEngine's boolean classifiers that describe context. 
</dl>

   <p>If you have used CFEngine before then the most visible part of
CFEngine 3 will be its new language interface.  Although it has been
clear for a long time that the organically grown language used in
CFEngine 1 and 2 developed many problems, it was not immediately
clear exactly what would be better. It has taken years of research to
simplify the successful features of CFEngine to a single overarching
model. To understand the new CFEngine, it is best to set aside any
preconceptions about what CFEngine is today. CFEngine 3 is a genuine
"next generation" effort, which will be a springboard into the
future of system management.

<div class="node">
<a name="A-renewed-CFEngine"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Installation">Installation</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Core-concepts">Core concepts</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Getting-started">Getting started</a>

</div>

<h3 class="section">1.3 A renewed CFEngine</h3>

<p>CFEngine 3 is a significant rewrite of underlying CFEngine technology
which preserves the core principles and methodology of CFEngine's
tried and tested approach.  It comes with a new, improved language,
with a consistent syntax and powerful pattern expression features that
display the intent behind CFEngine code more clearly. The main goal in
changing the language is to simplify and improve the robustness and
functionality without sacrificing the basic freedoms and self-repairing
concepts.

   <p>CFEngine 3's new language is a direct implementation of a model
developed at Oslo University College over the past four years, known
colloquially as "Promise Theory".  Promises were originally introduced
by Mark Burgess as a way to talk about CFEngine's model of autonomy
and have since become a powerful way of modelling cooperative systems
&ndash; not just computers, but humans too.

   <blockquote>

   <p><i>   &ldquo;The biggest challenge of implementing CFEngine in our organization<br>
     was not technical but political &ndash; getting everyone to agree.<br>
     Promise theory was a big help in understand this.&rdquo;</i>

   </blockquote>

   <p>CFEngine 3 is a generic implementation of the language of promises
that allows all of the aspects of configuration and change management to be
unified under a single umbrella.

   <p>Why talk about promises instead of simply talking about changes? After
all, the trend in business and IT management today is to talk about
Change Management (with capital letters), e.g. in the IT
Infrastructure Library (ITIL) terminology.  This comes from a long
history of process management thinking. But we are not really
interested in change &ndash; we are interested in avoiding it, i.e. being
in a state where we don't need to make any changes. In other words we
want to be able to promise that the system is correct, verify this and
only make changes if our promises are not kept. If you want
to think ITIL, think of this as a service that CFEngine provides.

   <p>To put it another way, CFEngine is not really a <i>change
management</i> system, it is a <i>maintenance system</i>. Maintenance
is the process of making small changes or corrections to a model. A
`model' is just another word for a template or a specification of how
we want the system to work. CFEngine's model is based on the idea of
promises, which means that it focuses on what is stable and lasting
about a system &ndash; not about what is changing.

   <p>This is an important philosophical shift. It means we are focused
mainly on what is right and not on what is wrong. By saying what
"right" is (the ideal state of our system) we are focused on the
actual behaviour. If we focus too much on the changes, i.e. the
differences between now and the future, we might forget to verify that what
we assume is working now in fact works.

   <p>Models that talk about change management tend to forget that after
every change there is a litany of <i>incidents</i> during which it is
necessary to repair the system or return it to its intended state. 
But if we know what we have promised, it is easy to verify whether the
promise is kept. 
This means that it is the <i>promises</i> about how the system should
be that are most important, not the actual changes that are made in
order to keep them.

<div class="node">
<a name="Installation"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Syntax">Syntax</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#A-renewed-CFEngine">A renewed CFEngine</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Getting-started">Getting started</a>

</div>

<h3 class="section">1.4 Installation</h3>

<p>In order to install CFEngine, you should first ensure that the following
packages are installed.

     <dl>
<dt><b>OpenSSL</b><dd>Open source Secure Sockets Layer for encryption.<br>URL: <a href="http://www.openssl.org">http://www.openssl.org</a>
<br><dt><b>Tokyo Cabinet</b><span class="roman"> (version 1.4.42 or later)</span><dd>Lightweight flat-file database system.<br>URL: <a href="http://fallabs.com/tokyocabinet/">http://fallabs.com/tokyocabinet/</a>
<br><dt><b>PCRE</b><dd>Perl Compatible Regular Expression library.<br>URL: <a href="http://www.pcre.org/">http://www.pcre.org/</a>

     <br><dt><dd>On Windows machines, you need to install the basic Cygwin DLL from <a href="http://www.cygwin.com">http://www.cygwin.com</a>
in order to run CFEngine. 
</dl>

   <p>Additional functionality becomes available if other libraries are present, e.g. 
OpenLDAP, client libraries for MySQL and PostgreSQL, etc. It is possible to run
CFEngine without these, but related functionality will be missing.

   <p>Unless you have purchased ready-to-run binaries, or are using a
package distribution, you will need to compile CFEngine. For this you
will also need a build environment tools: <code>gcc</code>, <code>flex</code>, <code>bison</code>.

<p class="noindent">The preferred method of installation is then

<pre class="smallexample">     tar zxf cfengine-x.x.x.tar.gz
     cd cfengine-x.x.x
     ./configure
     make
     make install
</pre>
   <p class="noindent">This results in binaries being installed in <samp><span class="file">/var/cfengine/bin</span></samp>.

<div class="node">
<a name="Syntax"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Work-directory">Work directory</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Installation">Installation</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Getting-started">Getting started</a>

</div>

<h3 class="section">1.5 Syntax, identifiers and names</h3>

<p>The CFEngine 3 language has a few simple rules:

     <ul>
<li>CFEngine built-in words, and identifiers of your choosing (the names
of variables, bundles, body templates and classes) may only contain
the usual alphanumeric and underscore characters (&lsquo;<samp><span class="samp">a-zA-Z0-9_</span></samp>&rsquo;).

     <li>All other `literal' data must be quoted.

     <li>Declarations of promise bundles
in the form:
     <pre class="example">          bundle <var>agent-type</var> identifier
          {
          ...
          }
</pre>
     <li>Declarations of promise body-parts in the form:
     <pre class="example">          body constraint_type template_identifier
          {
          ...
          }
</pre>
     <p>matching and expanding on a reference inside a promise
of the form
&lsquo;<samp><span class="samp">constraint_type =&gt; template_identifier</span></samp>&rsquo;.

     <li>CFEngine uses many `constraint expressions'
as part of the body of a promise. These take the form: left-hand-side (CFEngine word)
&lsquo;<samp><span class="samp">=&gt;</span></samp>&rsquo; right-hand-side (user defined data). This can take several forms:

     <pre class="verbatim">     cfengine_word => user_defined_template(parameters)
                      user_defined_template
                      builtin_function()
                      "quoted literal scalar"
                      { list }
</pre>
In each of these cases, the right hand side is a user choice. 
</ul>

<div class="node">
<a name="Work-directory"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Decisions">Decisions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Syntax">Syntax</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Getting-started">Getting started</a>

</div>

<h3 class="section">1.6 The work directory</h3>

<p>In order to achieve the desired simplifications, it was decided to
reserve a private work area for the CFEngine tool-set. 
<!-- chew begin Work directory -->

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
In CFEngine 1.x, the administrator could choose the locations of
configuration files, locks, and logging data independently. In
CFEngine 2.x, this diversity has been simplified to a single directory
which defaults to <samp><span class="file">/var/cfengine</span></samp> (similar to <samp><span class="file">/var/cron</span></samp>), and in
CFEngine 3.x this is preserved. 
</td></tr></table>

<!-- /@w --><pre class="smallexample">     /var/cfengine
     /var/cfengine/bin
     /var/cfengine/inputs
     /var/cfengine/outputs
</pre>
   <!-- chew end Work directory -->
   <p>A trusted cache of the input files must now be maintained
in the <samp><span class="file">inputs</span></samp> subdirectory. When CFEngine is invoked by the
scheduler, it reads only from this directory. It is up to the user to
keep this cache updated, on each host. This simplifies and
consolidates the CFEngine resources in a single place.

   <p>Unlike CFEngine 2, CFEngine 3 does not recognize the
<code>CFINPUTS</code> environment variable.

   <p>The <samp><span class="file">outputs</span></samp> directory is now a record of spooled run-reports. These
are often mailed to the administrator by <code>cf-execd</code>, or can be copied
to another central location and viewed in an alternative browser.

<!--  -->
<!-- SECTION -->
<!--  -->
<div class="node">
<a name="Decisions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Filenames-and-paths">Filenames and paths</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Work-directory">Work directory</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Getting-started">Getting started</a>

</div>

<h3 class="section">1.7 Decisions</h3>

<p>CFEngine decisions are made behind the scenes and the results of
certain true/false propositions are cached in Booleans referred to as
`classes'. There are no if-then-else statements in CFEngine; all
decisions are made with classes.

   <p>Classes fall into hard (discovered) and soft (user-defined) types.  A
single hard class can be one of several things:

<ul class="menu">
<li><a accesskey="1" href="#Hard-classes">Hard classes</a>
<li><a accesskey="2" href="#Class-combination-operators-and-precedence">Class combination operators and precedence</a>
<li><a accesskey="3" href="#Global-and-local-classes">Global and local classes</a>
</ul>

<div class="node">
<a name="Hard-classes"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Class-combination-operators-and-precedence">Class combination operators and precedence</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Decisions">Decisions</a>

</div>

<h4 class="subsection">1.7.1 CFEngine hard classes</h4>

<p>CFEngine runs on every computer individually and each time it wakes up
the underlying generic agent platform discovers and classifies
properties of the environment or context in which it runs.  This information
is cached and may be used to make decisions about configuration<a rel="footnote" href="#fn-1" name="fnd-1"><sup>1</sup></a>.

   <p>Classes fall into hard (discovered) and soft (defined) types.  A
single class can be one of several things:

<!-- chew start Hard classes -->
     <ul>
<li>The name of an operating system architecture e.g.  <code>ultrix</code>, <code>sun4</code>, etc.

     <li>The unqualified name of a particular host (e.g., <code>www</code>). If your
system returns a fully qualified domain name for your host (e.g.,
<code>www.iu.hio.no</code>), CFEngine will also define a hard class for the fully
qualified name, as well as the partially-qualified component names
<code>iu.hio.no</code>, <code>hio.no</code>, and <code>no</code>.

     <li>The name of a user-defined group of hosts.

     <li>A day of the week (in the form <code>Monday, Tuesday, Wednesday, ..</code>).

     <li>An hour of the day, in the current time zone (in the form <code>Hr00,
Hr01 ... Hr23</code>).

     <li>An hour of the day GMT (in the form <code>GMT_Hr00, GMT_Hr01 ... GMT_Hr23</code>). 
This is consistent the world over, in case you need virtual simulteneity of change
coordination.

     <li>Minutes in the hour (in the form <code>Min00, Min17 ... Min45</code>).

     <li>A five minute interval in the hour (in the form <code>Min00_05, Min05_10 ... Min55_00</code>).

     <li>A fifteen minute (quarter-hour) interval (in the form <code>Q1, Q2,
Q3, Q4</code>).

     <li>An expression of the current quarter hour (in the form <code>Hr12_Q3</code>).

     <li>A day of the month (in the form <code>Day1, Day2, ... Day31</code>).

     <li>A month (in the form <code>January, February, ... December</code>).

     <li>A year (in the form <code>Yr1997, Yr2004</code>).

     <li>A shift in <code>Night,Morning,Afternoon,Evening</code>, which fall into six hour blocks
starting at 00:00 hours.

     <li>A `lifecycle index', which is the year number modulo 3 (in the form
<code>Lcycle_0, Lcycle_1, Lcycle_2</code>, used in long term resource memory).

     <li>An arbitrary user-defined string (as specified in the <code>-D</code> command
line option, or defined in a <code>classes</code> promise or body,
<code>restart_class</code> in a <code>processes</code> promise, etc).

     <li>The IP address octets of any active interface (in the form <code>ipv4_192_0_0_1<!-- /@w --></code>,
<code>ipv4_192_0_0<!-- /@w --></code>, <code>ipv4_192_0<!-- /@w --></code>, <code>ipv4_192<!-- /@w --></code>),
provided they are not excluded by a regular expression in the file <samp><span class="file">WORKDIR/inputs/ignore_interfaces.rx</span></samp>.

     <li>The names of the active interfaces (in the form <code>net_iface_xl0</code>,
<code>net_iface_vr0</code>).

     <li>System status and entropy information reported by <code>cf-monitord</code>.

     <li>On Solaris-10 systems, the zone name (in the form <code>zone_global,
zone_foo, zone_baz</code>).

   </ul>

<!-- chew end Hard classes -->
   <p>To see all of the classes defined on a particular host, run

<pre class="smallexample">     host# cf-promises -v
</pre>
   <p>as a privileged user. Note that some of the classes are set only
if a trusted link can be established with cf-monitord, i.e. if both
are running with privilege, and the <samp><span class="file">/var/cfengine/state/env_data</span></samp>
file is secure. More information about classes can be found in connection with
<code>allclasses</code>.

<!--  -->
<!-- SECTION -->
<!--  -->
<div class="node">
<a name="Class-combination-operators-and-precedence"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Global-and-local-classes">Global and local classes</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Hard-classes">Hard classes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Decisions">Decisions</a>

</div>

<h4 class="subsection">1.7.2 Class combination operators and precedence</h4>

<p>Classes may be combined with the usual boolean operators, in the usual precedence (AND binds
stronger than OR). On addition the dot may be used for AND to improve readability, or
imply the interpretation `subset' or `subclass'. In order of precedence:

     <dl>
<dt>&lsquo;<samp><span class="samp">()</span></samp>&rsquo;<dd>The parenthesis group operator. 
<br><dt>&lsquo;<samp><span class="samp">!</span></samp>&rsquo;<dd>The NOT operator. 
<br><dt>&lsquo;<samp><span class="samp">.</span></samp>&rsquo;<dd>The AND operator. 
<br><dt>&lsquo;<samp><span class="samp">&amp;</span></samp>&rsquo;<dd>The AND operator (alternative). 
<br><dt>&lsquo;<samp><span class="samp">|</span></samp>&rsquo;<dd>The OR operator. 
<br><dt>&lsquo;<samp><span class="samp">||</span></samp>&rsquo;<dd>The OR operator (alternative). 
</dl>

<p class="noindent">So the following expression would be only true on Mondays or Wednesdays
from 2:00pm to 2:59pm on Windows XP systems:

<pre class="example">     
     (Monday|Wednesday).Hr14.WinXP::
     
</pre>
   <!--  -->
<!-- SECTION -->
<!--  -->
<div class="node">
<a name="Global-and-local-classes"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Class-combination-operators-and-precedence">Class combination operators and precedence</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Decisions">Decisions</a>

</div>

<h4 class="subsection">1.7.3 Global and local classes</h4>

<p>User defined classes are mostly defined in bundles, but they are used as a
signalling mechanism between promises. We'll return to those in a moment.

   <p>Classes promises define new classes based on combinations of old ones. 
This is how to make complex decisions in CFEngine, with readable results. 
It is like defining aliases for class combinations. 
Such class `aliases' may be specified in any kind of bundle. 
Bundles of type <code>common</code> yield classes that are global in scope,
whereas in all other bundle types classes are local.  Classes are
evaluated when the bundle is evaluated (and the bundles are evaluated
in the order specified in the <code>bundlesequence</code>).  Consider the
following example.

<pre class="verbatim">
body common control
{
bundlesequence => { "g","tryclasses_1", "tryclasses_2" };
}

#################################

bundle common g
{
classes:

  "one" expression => "any";

}

#################################

bundle agent tryclasses_1
{
classes:

  "two" expression => "any";
}

#################################

bundle agent tryclasses_2
{
classes:

  "three" expression => "any";

reports:

  one.three.!two::

    "Success";
}

</pre>

   <p>Here we see that class &lsquo;<samp><span class="samp">one</span></samp>&rsquo; is global (because it is defined inside the
<code>common</code> bundle), while classes &lsquo;<samp><span class="samp">two</span></samp>&rsquo; and &lsquo;<samp><span class="samp">three</span></samp>&rsquo; are local (to
their respective bundles). 
The report result `Success' is therefore true because only &lsquo;<samp><span class="samp">one</span></samp>&rsquo; and
&lsquo;<samp><span class="samp">three</span></samp>&rsquo; are in scope (and &lsquo;<samp><span class="samp">two</span></samp>&rsquo; is <i>not</i> in scope) inside of the
third bundle.

   <p>Note that any class promise must have one - and only one - value
constraint. That is, you might not leave &lsquo;<samp><span class="samp">expression</span></samp>&rsquo; in the
example above or add both &lsquo;<samp><span class="samp">and</span></samp>&rsquo; and &lsquo;<samp><span class="samp">xor</span></samp>&rsquo; constraints to the
single promise.

   <p>Another type of class definition happens when you define classes based on the
outcome of a promise, e.g. to set a class if a promise is repaired, one might write:

<pre class="verbatim"> "promiser..."

    ...

    classes => if_repaired("signal_class");
</pre>

   <p>These classes are global in scope. Finally <code>restart_class</code> classes in <code>processes</code>
are global.

<!--  -->
<!-- SECTION -->
<!--  -->
<div class="node">
<a name="Filenames-and-paths"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Upgrading-from-CFEngine-2">Upgrading from CFEngine 2</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Decisions">Decisions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Getting-started">Getting started</a>

</div>

<h3 class="section">1.8 Filenames and paths</h3>

<!-- chew start Unix filenames -->
<p>Filenames in Unix-like operating systems use the forward slash
&lsquo;<samp><span class="samp">/</span></samp>&rsquo; character for their directory separator . All references to
file locations must be absolute pathnames in CFEngine, i.e. they must
begin with a complete specification of which directory they are
in. For example:

<pre class="smallexample">     /etc/passwd
     /var/cfengine/masterfiles/distfile
</pre>
   <p class="noindent">The only place where it makes sense to refer to a file without a complete
directory specification is when searching through directories for different
kinds of file, e.g. in pattern matching

<pre class="verbatim">
leaf_name => { "tmp_.*", "output_file", "core" };

</pre>

<p class="noindent">Here, one can write <samp><span class="file">core</span></samp> without a path, because one is looking for any
file of that name in a number of directories. 
<!-- chew end Unix filenames -->

<!-- chew start Windows filenames -->
   <p>The Windows operating systems traditionally use a different filename
convention.  The following are all valid absolute file names under
Windows:

<pre class="smallexample">      c:\winnt
      "c:\spaced name"
      c:/winnt
      /var/cfengine/inputs
      //<var>fileserver</var>/share2/dir
</pre>
   <p>The `drive' name &ldquo;C:&rdquo; in Windows refers to a partition or device. Unlike Unix,
Windows does not integrate these seamlessly into a single file-tree. 
This is not a valid absolute filename:

<pre class="smallexample">     \var\cfengine\inputs
</pre>
   <p>Paths beginning with a backslash are assumed to be win32 paths.  They
must begin with a drive letter or double-slash server name. 
<!-- chew end Windows filenames -->

   <p>Note in recent versions of Cygwin you can decide to use the
<code>/cygdrive</code> to specify a path to windows file E.g
<samp><span class="file">/cygdrive/c/myfile</span></samp> means <samp><span class="file">c:\myfile</span></samp> or you can do it straight away in
CFEngine as <code>c:\myfile</code>.

<!--  -->
<div class="node">
<a name="Upgrading-from-CFEngine-2"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Testing-as-a-non_002dprivilieged-user">Testing as a non-privilieged user</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Filenames-and-paths">Filenames and paths</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Getting-started">Getting started</a>

</div>

<h3 class="section">1.9 Upgrading from CFEngine 2</h3>

<p>CFEngine 3 has a completely new syntax, designed to solve the issues
brought up from 15 years of experience with configuration
management. Rather than clutter CFEngine 3 with buggy
backward-compatability issues, it was decided to make no compromises
with CFEngine 3 and instead allow CFEngine 2 and CFEngine 3 to
coincide in a cooperative fashion for the foreseeable future.  This
means that users can upgrade at their own pace, in the classic
CFEngine incremental fashion. We expect that CFEngine 2 installations
will be around for years to come so this upgrade path seems the most
defensible.

   <p>The daemons and support services are fully interoperable between
CFEngine 2 and CFEngine 3, so it does not matter whether you run
<code>cfservd</code> (cf2) together with <code>cf-agent</code> (cf3) or
<code>cf-serverd</code> (cf3) together with <code>cfagent</code> (cf2). You can
change the servers at your own pace.

   <p>CFEngine 3's <code>cf-execd</code> replaces CFEngine 2's <code>cfexecd</code> and
it is designed to work optimally with <code>cf-agent</code> (cf3). Running
this daemon has no consequences for access control, only for
scheduling <code>cf-agent</code>. You can (indeed should) replace
<code>cfexecd</code> with <code>cf-execd</code> immediately. You will want to
alter your <samp><span class="file">crontab</span></samp> file to run the new component instead of the
old. The sample CFEngine 3 input files asks <code>cf-agent</code> to do
this automatically, simply replacing the string.

   <p>The sample <samp><span class="file">inputs</span></samp> files supplied with CFEngine 3 contain
promises to integrate CFEngine 2 as described. What can you do to
upgrade? Here is a simple recipe that assumes you have a standardized
CFEngine 2 setup, running <code>cfexecd</code> in <samp><span class="file">crontabs</span></samp> and possibly
running <code>cfservd</code> and <code>cfenvd</code> as daemons.

     <ol type=1 start=1>

     <li>Install the CFEngine 3 software on a host.

     <li>Go to the <samp><span class="file">inputs/</span></samp> directory in the source and copy these
files to your master update repository, i.e.  where you will publish
policies for distribution.

     <li>Remove any self-healing rules to reinstall CFEngine 2, especially
rules to add <code>cfexecd</code> or <code>cfagent</code> to <samp><span class="file">crontabs</span></samp> etc. CFEngine 3
will handle this from now on and encapsulate old CFEngine 2 scripts.

     <li>Move to this inputs directory: <code>cd </code><var>your-path</var><code>/inputs</code>.

     <li>Set the location of this master update directory in the <samp><span class="file">update.cf</span></samp>
file to the location of the master directory.

     <li>Set the email options for the executor in <samp><span class="file">promises.cf</span></samp>.

     <li>Run <code>cf-agent --bootstrap</code> as the root or privileged user. This will install
CFEngine 3 in place of CFEngine 2, integrate your old CFEngine 2
configuration, and warn you about any rules that need to be removed
from your old CFEngine configuration.

     <li>You should now be running CFEngine 3. You can now add new rules to the files
in your own time, or convert the old CFEngine 2 rules and gradually comment them
out of the CFEngine 2 files.

     <li>Make sure there are no rules in your old CFEngine 2 configuration to activate
CFEngine 2 components, i.e. rules that will fight against CFEngine 3. 
Then, when you are ready, convert <samp><span class="file">cfservd.conf</span></samp> into a server bundle e.g. in <samp><span class="file">promises.cf</span></samp>
and remove all rules to run <code>cfservd</code> and replace them with rules to run
<code>cf-serverd</code> at your own pace.

        </ol>

<!--  -->
<div class="node">
<a name="Testing-as-a-non-privilieged-user"></a>
<a name="Testing-as-a-non_002dprivilieged-user"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#The-bare-necessities-of-a-CFEngine-3">The bare necessities of a CFEngine 3</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Upgrading-from-CFEngine-2">Upgrading from CFEngine 2</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Getting-started">Getting started</a>

</div>

<h3 class="section">1.10 Testing as a non-privilieged user</h3>

<p>One of the practical advantages of CFEngine is that you can test it
without the need for root or administrator privileges. This is
recommended for all new users of CFEngine 3.

   <p>CFEngine operates with the notion of a work-directory. The default
work directory for the <code>root</code> user is <samp><span class="file">/var/cfengine</span></samp>
(except on Debian Linux and various derivatives which prefer
<samp><span class="file">/var/lib/cfengine</span></samp>).  For any other user, the work directory
lies in the user's home directory, named <samp><span class="file">~/.cfagent</span></samp>. CFEngine
prefers you to keep certain files here.  You should not resist this
too strongly or you will make unnecessary trouble for yourself.  The
decision to have this `known directory' was made to simplify a lot of
configuration.

   <p>To test CFEngine as an ordinary user, do the following:

     <ul>
<li>Compile and make the software. 
<li>Copy the binaries into the work directory:
     <pre class="smallexample">          host$ mkdir -p ~/.cfagent/inputs
          host$ mkdir -p ~/.cfagent/bin
          host$ cd src
          host$ cp cf-* ~/.cfagent/bin
          host$ cd ../inputs
          host$ cp *.cf ~/.cfagent/inputs
</pre>
     </ul>

   <p>You can test the software and play with configuration files by editing the basic get-started files
directly in the <samp><span class="file">~/.cfagent/inputs</span></samp> directory. For example, try the following:

<pre class="smallexample">     host$ ~/.cfagent/bin/cf-promises
     host$ ~/.cfagent/bin/cf-promises --verbose
</pre>
   <p>This is always the way to start checking a configuration in CFEngine
3. If a configuration does not pass this check/test, you will not be
allowed to use it, and <samp><span class="file">cf-agent</span></samp> will look for the file
<samp><span class="file">failsafe.cf</span></samp>.

   <p>Notice that the CFEngine 3 binaries have slightly different names than the CFEngine
2 binaries. They all start with the <samp><span class="file">cf-</span></samp> prefix.
<pre class="smallexample">     host$ ~/.cfagent/bin/cf-agent
</pre>
   <!--  -->
<div class="node">
<a name="The-bare-necessities-of-a-CFEngine-3"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Familiiarizing-yourself">Familiiarizing yourself</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Testing-as-a-non_002dprivilieged-user">Testing as a non-privilieged user</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Getting-started">Getting started</a>

</div>

<h3 class="section">1.11 The `bare necessities' of a CFEngine 3</h3>

<p>Here is the simplest `Hello world' program in CFEngine 3:

<pre class="verbatim">
body common control
{
bundlesequence  => { "test" };
}

bundle agent test
{
reports:

 Yr2009::
    "Hello world";
}

</pre>

<p class="noindent">If you try to process this using the <code>cf-promises</code> command, you will
see something like this:

<pre class="smallexample">     atlas$ ~/LapTop/CFEngine3/trunk/src/cf-promises -r -f ./unit_null_config.cf
     Summarizing promises as text to ./unit_null_config.cf.txt
     Summarizing promises as html to ./unit_null_config.cf.html
</pre>
   <p class="noindent">The &lsquo;<samp><span class="samp">-r</span></samp>&rsquo; option produces a report. Examine the files produced:

<pre class="smallexample">     cat ./unit_null_config.cf.txt
     firefox ./unit_null_config.cf.html
</pre>
   <p>You will see a summary of how CFEngine interprets the files, either in
HTML or text. By default, the CFEngine components also dump a debugging
file, e.g. <samp><span class="file">promise_output_agent.html</span></samp>, <samp><span class="file">promise_output_agent.txt</span></samp>
with an expanded view.

<!--  -->
<div class="node">
<a name="Familiiarizing-yourself"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Remote-access-troubleshooting">Remote access troubleshooting</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-bare-necessities-of-a-CFEngine-3">The bare necessities of a CFEngine 3</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Getting-started">Getting started</a>

</div>

<h3 class="section">1.12 Familiarizing yourself</h3>

<p>To familiarize yourself with CFEngine 3, type or paste in the following example text:

<pre class="verbatim">########################################################
#
# Simple test execution
#
########################################################

body common control

{
bundlesequence  => { "testbundle"  };
}

########################################################

bundle agent testbundle

{
vars:

  "size" int => "46k";
  "rand" int => randomint("33","$(size)");

commands:

  "/bin/echo"
     args => "Hello world - $(size)/$(rand)",
     contain => standard,
     classes => cdefine("followup","alert");

  followup::

     "/bin/ls"
       contain => standard;

reports:

  alert::

     "What happened?";

}

######################################################################

body contain standard

{
exec_owner => "mark";
useshell => "true";
}

######################################################################

body classes cdefine(class,alert)

{
promise_repaired => { "$(class)" };
repair_failed => { "$(alert)" };
}
</pre>

   <p>This example shows all of the main features of CFEngine: bundles,
bodies, control, variables, and promises.  To the casual eye it might
look complex, but that is because it is explicit about all of the
details. Fortunately it is easy to hide many of these details to
make the example simpler without sacrificing any functionality.

   <p>The first thing to try with this example is to verify it &ndash; did we
make any mistakes? Are there any inconsistencies? To do this we use
the new CFEngine program <code>cf-promises</code>. Let's assume that you
typed this into a file called <samp><span class="file">test.cf</span></samp> in the current directory.

<pre class="smallexample">     cf-promises -f ./test.cf
</pre>
   <p>If all is well, typing this command shows no output. Try now running the
command with verbose output.

<pre class="smallexample">     cf-promises -f ./test.cf -v
</pre>
   <p>Now you see a lot of information

<pre class="smallexample">     Reference time set to Sat Aug  2 11:26:06 2008
     
     cf3 CFEngine - 3.0.0
     Free Software Foundation 1994-
     Donated by Mark Burgess, Oslo University College, Norway
     cf3 ------------------------------------------------------------------------
     cf3 Host name is: atlas
     cf3 Operating System Type is linux
     cf3 Operating System Release is 2.6.22.18-0.2-default
     cf3 Architecture = x86_64
     cf3 Using internal soft-class linux for host linux
     cf3 The time is now Sat Aug  2 11:26:06 2008
     cf3 ------------------------------------------------------------------------
     cf3 Additional hard class defined as: 64_bit
     cf3 Additional hard class defined as: linux_2_6_22_18_0_2_default
     cf3 Additional hard class defined as: linux_x86_64
     cf3 Additional hard class defined as: linux_x86_64_2_6_22_18_0_2_default
     cf3 GNU autoconf class from compile time: compiled_on_linux_gnu
     cf3 Interface 1: lo
     cf3 Trying to locate my IPv6 address
     cf3 Looking for environment from cf-monitord...
     cf3 Unable to detect environment from cf-monitord
     ---------------------------------------------------------------------
     Loading persistent classes
     ---------------------------------------------------------------------
     
     ---------------------------------------------------------------------
     Loaded persistent memory
     ---------------------------------------------------------------------
     cf3   &gt; Parsing file ./test.cf
     ---------------------------------------------------------------------
     Agent's basic classified context
     ---------------------------------------------------------------------
     
     
     Defined Classes = ( any Saturday Hr11 Min26 Min25_30 Q2 Hr11_Q2 Day2
     August Yr2008 linux atlas 64_bit linux_2_6_22_18_0_2_default x86_64
     linux_x86_64 linux_x86_64_2_6_22_18_0_2_default
     linux_x86_64_2_6_22_18_0_2_default__1_SMP_2008_06_09_13_53_20__0200
     compiled_on_linux_gnu net_iface_lo )
     
     Negated Classes = ( )
     
     Installable classes = ( )
     cf3 Wrote expansion summary to promise_output_common.html
     cf3 Inputs are valid
</pre>
   <p>The last two lines of this are of interest. Each time a component of
CFEngine 3 parses a number of promises, it summarizes the information
in an HTML file called generically <code>promise_output_</code><i>component-type</i><code>.html</code>. 
In this case the <code>cf-promises</code> command represents all possible promises,
by the type "common". You can view this output file in a suitable web browser
to see exactly what CFEngine has understood by the configuration.

   <p>Now that you have verified it, you can execute it. To run this example you need
to change the username `mark' to your own, or obtain root privileges to change
to another user. 
The non-verbose output of the script when run in the CFEngine 3
directory looks something like this:

<pre class="verbatim">host$ ./cf-agent -f ../tests/units/unit_exec_in_sequence.cf
Q ".../bin/echo Hello": Hello world - 46k/219
 -> Last 1 QUOTEed lines were generated by "/bin/echo Hello world - 46k/219"
Q ".../bin/ls": agent.c
Q ".../bin/ls": agentdiagnostic.c
Q ".../bin/ls": agentdiagnostic.o
Q ".../bin/ls": agent.o
Q ".../bin/ls": args.c
Q ".../bin/ls": args.lo
Q ".../bin/ls": args.o
...
Q ".../bin/ls": verify_reports.o
Q ".../bin/ls": verify_storage.c
Q ".../bin/ls": verify_storage.o
 -> Last 288 QUOTEed lines were generated by "/bin/ls"
atlas$
</pre>

<!--  -->
<div class="node">
<a name="Remote-access-troubleshooting"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Familiiarizing-yourself">Familiiarizing yourself</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Getting-started">Getting started</a>

</div>

<h3 class="section">1.13 Remote access troubleshooting</h3>

<ul class="menu">
<li><a accesskey="1" href="#Server-connection">Server connection</a>
<li><a accesskey="2" href="#Key-exchange">Key exchange</a>
<li><a accesskey="3" href="#Time-windows">Time windows</a>
<li><a accesskey="4" href="#Other-users-than-root">Other users than root</a>
<li><a accesskey="5" href="#Encryption">Encryption</a>
</ul>

<div class="node">
<a name="Server-connection"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Key-exchange">Key exchange</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Remote-access-troubleshooting">Remote access troubleshooting</a>

</div>

<h4 class="subsection">1.13.1 Server connection</h4>

<p>When setting up <code>cf-serverd</code>, you might see the error message

<pre class="verbatim">  Unspecified server refusal
</pre>

   <p>This means that <code>cf-serverd</code> is unable or is unwilling to
authenticate the connection from your client machine. The message is
generic: it is deliberately non-specific so that anyone attempting to
attack or exploit the service will not be given information which
might be useful to them. There is a simple checklist for curing this
problem:

     <ol type=1 start=1>
<li>Make sure that the domain variable is set in the configuration files read by both client
and server; alternatively use <code>skipidentify</code> and <code>skipverify</code> to decouple DNS from the
the authentication.

     <li>Make sure that you have granted access to your client in the server body

     <pre class="smallexample">          
          body server control
          {
          allowconnects         =&gt; { "127.0.0.1" , "::1" <var>...etc</var> };
          allowallconnects      =&gt; { "127.0.0.1" , "::1" <var>...etc</var> };
          trustkeysfrom         =&gt; { "127.0.0.1" , "::1" <var>...etc</var> };
          }
          
</pre>
     <li>Make sure you have created valid keys for the hosts using <code>cf-key</code>. 
<li>If you are using secure copy, make sure that you have created a key
file and that you have distributed and installed it to all
participating hosts in your cluster.
        </ol>

<p class="noindent">Always remember that you can run CFEngine in verbose or
debugging modes to see how the authentication takes place:

<pre class="verbatim">cf-agent -v
cf-serverd -v
</pre>

   <p><code>cf-agent</code> reports that access is denied regardless of the nature
of the error, to avoid giving away information which might be used by
an attacker. To find out the real reason for a denial, use verbose &lsquo;<samp><span class="samp">-v</span></samp>&rsquo; or
even debugging mode &lsquo;<samp><span class="samp">-d2</span></samp>&rsquo;.

<div class="node">
<a name="Key-exchange"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Time-windows">Time windows</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Server-connection">Server connection</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Remote-access-troubleshooting">Remote access troubleshooting</a>

</div>

<h4 class="subsection">1.13.2 Key exchange</h4>

<p>The key exchange model used by CFEngine is based on that used by
OpenSSH. It is a peer to peer exchange model, not a central
certificate authority model. This means that there are no scalability
bottlenecks (at least by design, though you might introduce your own
if you go for an overly centralized architecture).

   <p>The problem of key distribution is the conundrum of every public key
infrastructure. Key exchange is handled automatically by CFEngine and all you
need to do is to decide which keys to trust.

   <p>When public keys are offered to a server, they could be accepted
automatically on trust because no one is available to make a decision
about them. This would lead to a race to be the first to submit a key
claiming identity.

   <p>Even with DNS checks for correct name/IP address correlation (turned
off with <code>skipverify</code>), it might be possible to submit a false
key to a server.

   <p>The server <code>cf-serverd</code> blocks the acceptance of unknown keys by
default. In order to accept such a new key, the IP address of the
presumed client must be listed in the <code>trustkeysfrom</code> stanza of a
<code>server</code> bundle (these bundles can be placed in any file). Once a
key has been accepted, it will never be replaced with a new key, thus
no more trust is offered or required.

   <p>Once you have arranged for the right to connect to the server, you
must decide which hosts will have access to which files. This is done
with <code>access</code> rules.

<pre class="verbatim">
bundle server access_rules()

{
access:

  "/path/file"

    admit   => { "127.0.0.1", "127.0.0.2", "127.0.0.3" },
    deny    => { "192\..*" };
}

</pre>

   <p>On the client side, i.e. <code>cf-runagent</code> and <code>cf-agent</code>, there are three issues:

     <ol type=1 start=1>
<li>Choosing which server to connect to. 
<li>Trusting the identity of any previously unknown servers, i.e. trusting
the server's public key to be its and no one else's. (The issues here are
the same as for the server.) 
<li>Choosing whether data transfers should be encrypted (with <code>encrypt</code>).
        </ol>

   <p>Because there are two clients for connecting to <code>cf-serverd</code>
(<code>cf-agent</code> and <code>cf-runagent</code>), there are also two ways of
managing trust of server keys by a client. One is an automated option, setting the option
<code>trustkey</code> in a <code>copy_from</code> stanza, e.g.

<pre class="verbatim">
body copy_from example
     {
     # .. other settings ..
     trustkey => "true";
     }

</pre>

   <p>Another way is to run <code>cf-runagent</code> in interactive mode. When you run <code>cf-runagent</code>, unknown
server keys are offered to you interactively (as with <code>ssh</code>) for you to
accept or deny manually:

<pre class="smallexample">     
     WARNING - You do not have a public key from host ubik.iu.hio.no = 128.39.74.25
               Do you want to accept one on trust? (yes/no)
     --&gt;
     
</pre>
   <div class="node">
<a name="Time-windows"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Other-users-than-root">Other users than root</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Key-exchange">Key exchange</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Remote-access-troubleshooting">Remote access troubleshooting</a>

</div>

<h4 class="subsection">1.13.3 Time windows (races)</h4>

<p>Once public keys have been exchanged from client to server and from
server to client, the issue of trust is solved according to public key
authentication schemes. You only need to worry about trust when one side
of a connection has never seen the other side before.

   <p>Often you will have a central server and many client satellites. Then
the best way to transfer all the keys is to set the <code>trustkey</code>
flags on server and clients sides to coincide with a time at which you
know that <code>cf-agent</code> will be run, and when a spoofer is unlikely
to be able to interfere.

   <p>This is a once-only task, and the chance of an attacker being able to
spoof a key-transfer is small. It would require skill and
inside-information about the exchange procedure, which would tend to
imply that the trust model was already broken.

   <p>Another approach would be to run <code>cf-runagent</code> against all the hosts
in the group from the central server and accept the keys one by one,
by hand, though there is little to be gained from this.

   <p>Trusting a host for key exchange is unavoidable. There is no clever
way to avoid it. Even transferring the files manually by diskette, and
examining every serial number of the computers you have, the host has
to trust the information you are giving it. It is all based on
assertion. You can make it almost impossible for keys to be faked
or attacked, but you cannot make it absolutely impossible. Security is
about managing reasonable levels of risk, not about magic.

   <p>All security is based on a moment of trust, that is granted by a user
at some point in time &ndash; and is assumed thereafter (once given, hard
to rescind). Cryptographic key methods only remove the need for a
repeat of the trust decision. After the first exchange, trust is no
longer needed, because they keys allow identity to be actually
verified.

   <p>Even if you leave the trust options switched on, you are not blindly
trusting the hosts you know about. The only potential insecurity lies
in any new keys that you have not thought about. If you use wildcards
or IP prefixes in the trust rules, then other hosts might be able to
spoof their way in on trust because you have left open a hole for them
to exploit. That is why it is recommended to return the system to the
default state of zero trust immediately after key transfer, by
commenting out the trust options.

   <p>It is possible, though somewhat laborious to transfer the keys out of
band, by copying <samp><span class="file">/var/cfengine/ppkeys/localhost.pub</span></samp> to
<code>/var/cfengine/ppkeys/user-aaa.bbb.ccc.mmm</code> (assuming IPv4) on
another host. e.g.

<pre class="smallexample">     
     localhost.pub -&gt; root-128.39.74.71.pub
     
</pre>
   <p>This would be a silly way to transfer keys between nearby hosts that you
control yourself, but if transferring to long distance, remote hosts
it might be an easier way to manage trust.

<div class="node">
<a name="Other-users-than-root"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Encryption">Encryption</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Time-windows">Time windows</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Remote-access-troubleshooting">Remote access troubleshooting</a>

</div>

<h4 class="subsection">1.13.4 Other users than root</h4>

<p>CFEngine normally runs as user "root" (except on Windows which does
not normally have a root user), i.e. a privileged administrator. If other users
are to be granted access to the system, they must also generate a key
and go through the same process. In addition, the users must be added
to the server configuration file.

<div class="node">
<a name="Encryption"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Other-users-than-root">Other users than root</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Remote-access-troubleshooting">Remote access troubleshooting</a>

</div>

<h4 class="subsection">1.13.5 Encryption</h4>

<p>CFEngine provides encryption for keeping file contents private during
transfer. It is assumed that users will use this judiciously. There is
nothing to be gained by encrypting the transfer of public files &ndash;
overt use of encryption just contributes to global warming, burning
unnecessary CPU cycles without offering any security.

   <p>The main role for encryption in configuration management is for
authentication. CFEngine always uses encryption during authentication, so
none of the encryption settings affect the security of authentication.

<!--  -->
<div class="node">
<a name="A-simple-crash-course"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#How-to-run-CFEngine-3-examples">How to run CFEngine 3 examples</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Getting-started">Getting started</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">2 A simple crash course in concepts</h2>

<ul class="menu">
<li><a accesskey="1" href="#Rules-are-promises">Rules are promises</a>
<li><a accesskey="2" href="#Best-practice-for-writing-promises">Best practice for writing promises</a>
<li><a accesskey="3" href="#Containers">Containers</a>
<li><a accesskey="4" href="#When-and-where-are-promises-made_003f">When and where are promises made?</a>
<li><a accesskey="5" href="#Types-in-CFEngine-3">Types in CFEngine 3</a>
<li><a accesskey="6" href="#Datatypes-in-CFEngine-3">Datatypes in CFEngine 3</a>
<li><a accesskey="7" href="#Variable-expansion-in-CFEngine-3">Variable expansion in CFEngine 3</a>
<li><a accesskey="8" href="#Name-spaces">Name spaces</a>
<li><a accesskey="9" href="#Normal-ordering">Normal ordering</a>
<li><a href="#Loops-and-lists-in-CFEngine-3">Loops and lists in CFEngine 3</a>
<li><a href="#Pattern-matching-and-referencing">Pattern matching and referencing</a>
<li><a href="#Distributed-discovery">Distributed discovery</a>
</ul>

<div class="node">
<a name="Rules-are-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Best-practice-for-writing-promises">Best practice for writing promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#A-simple-crash-course">A simple crash course</a>

</div>

<h3 class="section">2.1 Rules are promises</h3>

<p>Everything in CFEngine 3 can be interpreted as a promise. Promises can
be made about all kinds of different subjects, from file attributes,
to the execution of commands, to access control decisions and
knowledge relationships.

   <p>This simple but powerful idea allows a very practical uniformity in
CFEngine syntax.  There is only one grammatical form for statements in
the language that you need to know and it looks generically like this:

<pre class="smallexample">     
      type:
     
        classes::
     
         "promiser" -&gt; { "promisee1", "promisee2", ... }
     
            attribute_1 =&gt; value_1,
            attribute_2 =&gt; value_2,
            ...
            attribute_n =&gt; value_n;
     
</pre>
   <p class="noindent">We speak of a promiser (the abstract object making the promise), the promisee
is the abstract object to whom the promise is made, and them there is a list
of associations that we call the `body' of the promise, which together with the
promiser-type tells us what it is all about.

   <p>Not all of these elements are necessary every time. Some promises contain a lot
of implicit behaviour. In other cases we might want to be much more explicit. 
For example, the simplest promise looks like this:

<pre class="smallexample">     
     commands:
     
       "/bin/echo hello world";
     
</pre>
   <p class="noindent">This promise has default attributes for everything except the `promiser', i.e. the
command string that promises to execute. 
A more complex promise contains many attributes:

<pre class="smallexample">     
     files:
     
       "/home/mark/tmp/test_plain" -&gt; "system blue team",
     
            comment =&gt; "This comment follows the rule for knowledge integration",
            perms   =&gt; users("@(usernames)"),
            create  =&gt; "true";
     
</pre>
   <p>The list of promisees is not used by CFEngine except for documentation, just
as the comment attribute (which can be added to any promise) has no actual function
other than to provide more information to the user in error tracing and auditing.

   <p>You see several kinds of object in this example. All literal strings
(e.g. <code>"true"</code>) in CFEngine 3 must be quoted. This provides
absolute consistency and makes type-checking easy and error-correction
powerful. All function-like objects (e.g. <code>users("..")</code>) are either builtin
special functions or parameterized templates which contain the `meat' of the right hand
side.

   <p>The words <code>commands</code>, and <code>files</code> are built-in promise
types. Promise types generally belong each to a particular component
of CFEngine, as the components are designed to keep different kinds of
promises.  A few types, such as <code>vars</code>, <code>classes</code> and
<code>reports</code> are common to all the different component bundles. You
will find a full list of the promise types that can be made by the
different components in the `bundles' chapters that follow.

<!--  -->
<div class="node">
<a name="Best-practice-for-writing-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Containers">Containers</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Rules-are-promises">Rules are promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#A-simple-crash-course">A simple crash course</a>

</div>

<h3 class="section">2.2 Best practice for writing promises</h3>

<p>When writing promises, get into the habit of giving every promise a comment
that explains its intention.

   <p>Also, give related promises <i>handles</i>, or labels that can be used to
refer to them.

<pre class="verbatim">
files:

  "/var/cfengine/inputs"

    handle => "update_policy",
    comment => "Update the configuration from a master server",

    perms => system("600"),
    copy_from => mycopy("$(master_location)","$(policy_server)"),
    depth_search => recurse("inf"),
    file_select => input_files,
    action => immediate;

</pre>
If a promise affects another promise in some way, you can make the affected
promise one of the promisees, like this:

<pre class="verbatim">
access:

  "/master/cfengine/inputs" -> { "update_policy", "other_promisee" },

    comment => "Grant access to policy to our clients",
    handle  => "serve_updates",

    admit   => { "217.77.34.*" };

</pre>

<p class="noindent">Conversely, if a promise might depend on another in some (even indirect) way, document this too.

<pre class="verbatim">
files:

  "/var/cfengine/inputs"

    comment => "Update the configuration from a master server",
    handle     => "update_policy",

    depends_on => {"serve_updates"},

    perms => system("600"),
    copy_from => mycopy("$(master_location)","$(policy_server)"),
    depth_search => recurse("inf"),
    file_select => input_files,
    action => immediate;


</pre>

   <p>Get into the habit of adding the cause-effect lines of influence. 
Enterprise editions of CFEngine will track the dependencies between these
promises and map out impact analyses.

<!--  -->
<div class="node">
<a name="Containers"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#When-and-where-are-promises-made_003f">When and where are promises made?</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Best-practice-for-writing-promises">Best practice for writing promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#A-simple-crash-course">A simple crash course</a>

</div>

<h3 class="section">2.3 Containers</h3>

<p>CFEngine allows you to group multiple promise statements
    into containers called bundles.
<pre class="smallexample">     
     bundle agent identifier
     
     {
     commands:
     
       "/bin/echo These commands are a silly way to use CFEngine";
       "/bin/ls -l";
       "/bin/echo But they illustrate a point";
     
     }
     
</pre>
   <p>Bundles serve two purposes: they allow us to collect related promises under a
single heading, like a subroutine, and they allow us to mix configuration for different
parts of CFEngine in the same file. The type of a bundle is the name of the component
of CFEngine for which it is intended.

   <p>For instance, we can make a self-contained example agent-server
configuration by labelling the bundles:

<pre class="smallexample">     
     #
     # Not a complete example
     #
     
     bundle agent testbundle
     
     {
     files:
     
       "/home/mark/tmp/testcopy"
     
         comment      =&gt; "Throwaway example...",
         copy_from    =&gt; mycopy("/home/mark/LapTop/words","127.0.0.1"),
         perms        =&gt; system,
         depth_search =&gt; recurse("inf");
     
     }
     
     #
     
     bundle server access_rules
     
     {
     access:
     
       "/home/mark/LapTop"
     
         admit   =&gt; { "127.0.0.1" };
     }
     
</pre>
   <p>Another type of container in CFEngine 3 is a `body' part. Body parts
exist to hide complex parameter information in reusable containers. 
The right hand side of some attribute assignments use body containers
to reduce the amount of in-line information and preserve readability. 
You cannot choose where to use bodies: either they are used or they
are not used for a particular kind of attribute. What you can choose, however, is
the name and number of parameters for the body; and you can make as many of them as you like:
For example:

<pre class="smallexample">     
     body copy_from mycopy(from,server)
     
     {
     source      =&gt; "$(from)";
     servers     =&gt; { "$(server)" };
     copy_backup =&gt; "true";
     
     special_class::
     
       purge       =&gt; "true";
     }
     
</pre>
   <p>Notice also that classes can be used in bodies as well as parameters so that
you can hide environmental adaptations in these bodies also. The classes used
here are effectively ANDed with the classes under which the calling promise
is defined.

<!--  -->
<div class="node">
<a name="When-and-where-are-promises-made%3f"></a>
<a name="When-and-where-are-promises-made_003f"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Types-in-CFEngine-3">Types in CFEngine 3</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Containers">Containers</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#A-simple-crash-course">A simple crash course</a>

</div>

<h3 class="section">2.4 When and where are promises made?</h3>

<p>When you type a promise into a CFEngine bundle, the promise will be
read by every cf-agent that reads the file, each time it is
called into being. For some promises this is okay, but for others
you only want to verify the promise once in a while, e.g. once per day
or once per hour. There are two ways to say when and where a promise
applies in CFEngine:

     <dl>
<dt><i>Classes</i><dd>Classes are the double-colon decision syntax in CFEngine. They
determine in what context a promise is made, i.e. when and
where. Recall the basic syntax of a promise:
     <pre class="smallexample">          
           <var>promise-type</var>:
          
              <var>class-expression</var>::
          
                 <var>promiser</var> -&gt; <var>promisee</var>
          
                    <var>attribute</var> =&gt; <var>body</var>,
                         ifvarclass =&gt; <var>other-class-expression</var>;
          
</pre>
     <p>The class expression may contain words like &lsquo;<samp><span class="samp">Hr12</span></samp>&rsquo;, meaning
from 12:00 p.m - 13:00 p.m., or &lsquo;<samp><span class="samp">Hr12&amp;Min05_10</span></samp>&rsquo;, meaning
between 12:05 and 12:10. Classes may also have spatial descriptors
like &lsquo;<samp><span class="samp">myhost</span></samp>&rsquo; or &lsquo;<samp><span class="samp">solaris</span></samp>&rsquo;, which decide which hosts
in the namespace, or &lsquo;<samp><span class="samp">ipv4_192_168_1_101</span></samp>&rsquo; which decides the location
in IPv4 address space.

     <p>If the class expression is true, the promise can be considered made
for the duration of the current execution.

     <p>CFEngine 3 has a new class predicate <code>ifvarclass</code> which is
ANDed with the normal class expression, and which is evaluated
together with the promise. It may contain variables as long as the
resulting expansion is a legal class expression. 
<a name="index-ifvarclass-1"></a>
<br><dt><i>Locks</i><dd>Locks determine how often a promise is verified. 
</dl>

   <p>CFEngine is controlled by a series of locks which prevent it from
checking promises too often, and which prevent it from spending too
long trying to verify promises it already verified recently. The locks
work in such a way that you can start several CFEngine processes
simultaneously without them interfering with each other. You can
control two things about each kind of action in the action sequence:

     <dl>
<dt>&lsquo;<samp><span class="samp">ifelapsed</span></samp>&rsquo;<dd>The minimum time (in minutes) which should have passed since the last time
that promise was verified. It will not be executed again until
this amount of time has elapsed. 
(Default time is 1 minute.)

     <br><dt>&lsquo;<samp><span class="samp">expireafter</span></samp>&rsquo;<dd>The maximum amount (in minutes) of time cf-agent should wait for an old
instantiation to finish before killing it
and starting again. (Default time is 120 minutes.)

   </dl>

<p class="noindent">You can set these values either globally (for all
actions) or for each action separately. If you
set global and local values, the local values override
the global ones. All times are written in units
of <em>minutes</em>. Global setting is in the control body:

<pre class="verbatim">
body agent control
{
ifelapsed => "60";	# one hour
}

</pre>

<p class="noindent">or locally in the transaction bodies:

<pre class="verbatim">
body action example
{
ifelapsed => "90";	# 1.5 hours
}

</pre>

   <p>These locks do not prevent the whole of cf-agent from running, only
atomic promise checks. Several different atoms can be run concurrently
by different cf-agents.  The locks ensure that atoms will never be
started by two cf-agents at the same time, or too soon after a
verification, causing contention and wasting CPU cycles.

<!--  -->
<div class="node">
<a name="Types-in-CFEngine-3"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Datatypes-in-CFEngine-3">Datatypes in CFEngine 3</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#When-and-where-are-promises-made_003f">When and where are promises made?</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#A-simple-crash-course">A simple crash course</a>

</div>

<h3 class="section">2.5 Types in CFEngine 3</h3>

<p>A key difference in CFEngine 3 compared to earlier versions is the
presence of data types. Data types are a mechanism for associating
values and checking consistency in a language. Once again, there is a
simple pattern to types in CFEngine.

   <p>The principle is very simple: types exist in order to match like a
plug-socket relationship. In the examples above, you can see two places
where types are used to match templates:

     <ul>
<li>Matching bundles to CFEngine components (such as agent, server, common, etc.):
     <pre class="smallexample">          
          bundle TYPE name  # matches TYPE to running agent
          {
          }
          
</pre>
     <li>Match bodies templates to lvalues in <code>lvalues =&gt; rvalue</code> constraints:

     <pre class="smallexample">          
          body TYPE name    # matches TYPE =&gt; name in promise
          {
          }
          
</pre>
     </ul>

   <p>Check these by identifying the words &lsquo;<samp><span class="samp">agent</span></samp>&rsquo; and &lsquo;<samp><span class="samp">copy_from</span></samp>&rsquo;
in the examples above. Types are there to make configuration more robust.

<!--  -->
<div class="node">
<a name="Datatypes-in-CFEngine-3"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-expansion-in-CFEngine-3">Variable expansion in CFEngine 3</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Types-in-CFEngine-3">Types in CFEngine 3</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#A-simple-crash-course">A simple crash course</a>

</div>

<h3 class="section">2.6 Datatypes in CFEngine 3</h3>

<p>CFEngine variables have two meta-types: scalars and lists. A scalar is a single value,
a list is a collection of scalars. Each scalar may have one of three types:
<code>string</code>, <code>int</code> or <code>real</code>. Typing is dynamic, so these are
interchangable in many instances. However arguments to special functions check legal
type for consistency.

   <p>Integer constants may use suffixes to represent large numbers.

     <ul>
  <li>'k'
          = value times 1000.

     <li>'K'
          = value times 1024.

     <li>'m'
          = value times 1000^2
  <li>'M'
          = value times 1024^2
  <li>'g'
          = value times 1000^3
  <li>'G'
          = value times 1024^3

     <li>'%'
	  meaning percent, in limited contexts

     <li>'inf'
	  = a constant representing an unlimited value. 
</ul>

<!--  -->
<div class="node">
<a name="Variable-expansion-in-CFEngine-3"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Name-spaces">Name spaces</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Datatypes-in-CFEngine-3">Datatypes in CFEngine 3</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#A-simple-crash-course">A simple crash course</a>

</div>

<h3 class="section">2.7 Variable expansion in CFEngine 3</h3>

<p>CFEngine 3 has some simple rules for variable expansion. These make
a couple of restrictions that enforce discipline of clarity and
allow automatic dependency tracking in enterprise versions of CFEngine.

<ul class="menu">
<li><a accesskey="1" href="#Scalar-variable-expansion">Scalar variable expansion</a>
<li><a accesskey="2" href="#List-variable-substitution-and-expansion">List variable substitution and expansion</a>
<li><a accesskey="3" href="#Special-list-value-cf_005fnull">Special list value cf_null</a>
<li><a accesskey="4" href="#Arrays-in-CFEngine-3">Arrays in CFEngine 3</a>
</ul>

<div class="node">
<a name="Scalar-variable-expansion"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#List-variable-substitution-and-expansion">List variable substitution and expansion</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-expansion-in-CFEngine-3">Variable expansion in CFEngine 3</a>

</div>

<h4 class="subsection">2.7.1 Scalar variable expansion</h4>

<p>Scalar variables are written &lsquo;<samp><span class="samp">$(name)</span></samp>&rsquo; and they represent
a single value at a time.

     <ul>
<li>Scalars that are written without a context, e.g. &lsquo;<samp><span class="samp">$(myvar)</span></samp>&rsquo;
are local to the current bundle (and are equivalent to &lsquo;<samp><span class="samp">$(this.myvar)</span></samp>&rsquo;).

     <li>Scalars are globally available everywhere provided one
uses the context to verify them e.g. &lsquo;<samp><span class="samp">$(context.myvar)</span></samp>&rsquo;
may be written to access the variable `myvar' in bundle `context'.

   </ul>

<!--  -->
<div class="node">
<a name="List-variable-substitution-and-expansion"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Special-list-value-cf_005fnull">Special list value cf_null</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Scalar-variable-expansion">Scalar variable expansion</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-expansion-in-CFEngine-3">Variable expansion in CFEngine 3</a>

</div>

<h4 class="subsection">2.7.2 List variable substitution and expansion</h4>

     <ul>
<li>Scalar references to <i>local</i> list variables imply iteration, e.g. 
suppose we have local list variable &lsquo;<samp><span class="samp">@(list)</span></samp>&rsquo;, then the
scalar &lsquo;<samp><span class="samp">$(list)</span></samp>&rsquo; implies an iteration over every value of the
list.

     <li>Lists can be passed around in their entirety in any context
where a list is expected as &lsquo;<samp><span class="samp">@(list)</span></samp>&rsquo;., e.g.

     <pre class="verbatim">     
      vars:
     
        "longlist" slist => { @(shortlist), "plus", "plus" };
     
        "shortlist" slist => { "you", "me" };
     
</pre>

</ul>

   <p>You can pass lists to functions by parameter or by qualified reference. 
The first uses parameterization to map a global list into a local
context.
<pre class="verbatim">
#
# Show access of external lists.
#
# - to pass lists globally, use a parameter to dereference them
#

body common control
{
bundlesequence => { hardening(@(va.tmpdirs)) };
}

#########################################################

bundle common va
{
vars:

 "tmpdirs"  slist => { "/tmp", "/var/tmp", "/usr/tmp"  };

}

##########################################################

bundle agent hardening(x)
{
classes:

  "ok" expression => "any";

vars:

 "other"    slist => { "/tmp", "/var/tmp" };

reports:

  ok::

    "Do $(x)";
    "Other: $(other)";
}

</pre>

   <p>This alternative uses a direct `short-circuit' approach to map the global
list into the local context.

<pre class="verbatim">#
# Show access of external lists.
#

body common control
{
bundlesequence => { hardening };
}

#########################################################

bundle common va
{
vars:

 "tmpdirs"  slist => { "/tmp", "/var/tmp", "/usr/tmp"  };

}

##########################################################

bundle agent hardening
{
classes:

  "ok" expression => "any";

vars:

 "other"    slist => { "/tmp", "/var/tmp" };
 "x"        slist => { @(va.tmpdirs) };

reports:

  ok::

    "Do $(x)";
    "Other: $(other)";
}
</pre>

<!--  -->
<div class="node">
<a name="Special-list-value-cf_null"></a>
<a name="Special-list-value-cf_005fnull"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Arrays-in-CFEngine-3">Arrays in CFEngine 3</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#List-variable-substitution-and-expansion">List variable substitution and expansion</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-expansion-in-CFEngine-3">Variable expansion in CFEngine 3</a>

</div>

<h4 class="subsection">2.7.3 Special list value <code>cf_null</code></h4>

<p>As of CFEngine core version 3.1.0, the value &lsquo;<samp><span class="samp">cf_null</span></samp>&rsquo; may be used as a NULL
value within lists. This value is ignored in list variable expansion.

<pre class="verbatim">
vars:

  "empty_list" slist => { "cf_null" };

</pre>

<!--  -->
<div class="node">
<a name="Arrays-in-CFEngine-3"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Special-list-value-cf_005fnull">Special list value cf_null</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-expansion-in-CFEngine-3">Variable expansion in CFEngine 3</a>

</div>

<h4 class="subsection">2.7.4 Arrays in CFEngine 3</h4>

<p>Array variables are written with &lsquo;<samp><span class="samp">[</span></samp>&rsquo; and &lsquo;<samp><span class="samp">]</span></samp>&rsquo; brackets, e.g.

<pre class="verbatim">
bundle agent example

{
vars:

  "component" slist => { "cf-monitord", "cf-serverd", "cf-execd" };

  "array[cf-monitord]" string => "The monitor";
  "array[cf-serverd]" string => "The server";
  "array[cf-execd]" string => "The executor, not executioner";

commands:

   "/bin/echo $(component) is"

            args => "$(array[$(component)])";

}

</pre>

   <p>Arrays are associative and may be of type scalar or list. Enumerated
arrays are simply treated as a special case of associative arrays, since
there are no numerical loops in CFEngine. Special functions exist to
extract lists of keys from array variables for iteration purposes.

   <p>Thus one could have written the example above in the form of the
following example. Note, too, that the use of <code>getindices</code> avoids the earlier poor practice of repeating the enumeration of key names, and instead uses the better strategy of automatically deriving them.

<pre class="verbatim">
bundle agent example

{
vars:

  "array[cf-monitord]" string => "The monitor";
  "array[cf-serverd]" string => "The server";
  "array[cf-exced]" string => "The executor, not executioner";

  "component" slist => getindices("array");

commands:

  "/bin/echo $(component) is"

           args => "$(array[$(component)])";
}

</pre>

<!--  -->
<div class="node">
<a name="Name-spaces"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Normal-ordering">Normal ordering</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-expansion-in-CFEngine-3">Variable expansion in CFEngine 3</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#A-simple-crash-course">A simple crash course</a>

</div>

<h3 class="section">2.8 Name spaces</h3>

<p>Name spaces are private bundle and body contexts, allowing multiple files
to define the bundles and bodies with the same name, without conflict.

   <p>To isolate a file into its own name space, you add a control promise
to the file before the relevant bundles or bodies. All files start off in the
default namespace if you don't explicitly set this. Once set, this applies
until the end of the file or the next namespace change.

<pre class="verbatim">body file control
{
namespace => "myspace"; 
}
</pre>

   <p>To distinguish the bundle <code>mymethod</code> in the default namespace
from one in another namespace, you prefix the bundle name with the
namespace, separated by a colon.
<pre class="verbatim">methods:

  "namespace demo" usebundle => myspace:mymethod("arg1");

  "namespace demo" usebundle => mymethod("arg1","arg2");

</pre>

   <p>To distinguish a body from one in another namespace, you can prefix
the body name with the namespace, separated by a colon.
<pre class="verbatim">files:

   "/file"

       create => "true",
        perms => name1:settings;

</pre>

   <p>The default namespace, i.e. that which is implied by not making any namespace
declarations, can be accessed or referred to by prefixing with the default string

<pre class="verbatim">files:

   "/file"

       create => "true",
        perms => default:settings;

</pre>
For example, this can be used to refer to standard library objects from
within a private namespace.

   <p>Global classes are not handled by namespaces, and you are advised to prefix
them with the namespace like this:

<pre class="verbatim">files:

   "/file"

       create => "true",
       action => if_repaired("namespace_done");

</pre>
This is not prepended automatically because references to this
class in class expressions cannot be detected and modified automatically.

   <p>To access variables or meta-data in bundles in a different namespace, use the colon
as a namespace prefix:

<pre class="verbatim">
 $(namespace:bundle.variable)
 $(namespace:bundle_meta.variable)

</pre>

<!--  -->
<div class="node">
<a name="Normal-ordering"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Loops-and-lists-in-CFEngine-3">Loops and lists in CFEngine 3</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Name-spaces">Name spaces</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#A-simple-crash-course">A simple crash course</a>

</div>

<h3 class="section">2.9 Normal ordering</h3>

<p>CFEngine takes a pragmatic point of view to ordering. When promising
`scalar' attributes and properties, ordering is irrelevant and need
not be considered. More complex patterned data structures require
ordering to be preserved, e.g. editing in files. CFEngine
solves this in a two-part strategy:
     <ul>
<li>CFEngine maintains a default order of promise-types. This is based
on a simple logic of what needs to come first, e.g. it makes no sense to create something
and then delete it, but it could make sense to delete and then create (an equilibrium). 
This is called <i>normal ordering</i> and is described below.

     <li>You can override normal ordering in exceptional circumstances by making
a promise in a class context and defining that class based on the outcome of another
promise. 
</ul>

<ul class="menu">
<li><a accesskey="1" href="#Agent-normal-ordering">Agent normal ordering</a>
<li><a accesskey="2" href="#Server-normal-ordering">Server normal ordering</a>
<li><a accesskey="3" href="#Monitor-normal-ordering">Monitor normal ordering</a>
<li><a accesskey="4" href="#Knowledge-normal-ordering">Knowledge normal ordering</a>
</ul>

<div class="node">
<a name="Agent-normal-ordering"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Server-normal-ordering">Server normal ordering</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Normal-ordering">Normal ordering</a>

</div>

<h4 class="subsection">2.9.1 Agent normal ordering</h4>

     <ol type=1 start=1>
<li>CFEngine tries to keep variable and class promises before starting to
consider any other kind of promise.  In this way, global variable and
classes can be set, as well as creating <code>classes</code> promises, upon
which later agent-bundle <code>vars</code> promises may depend. Place these
at the start of your configuration (see next item).

     <li>If you set variables based on classes that are determined by variables, in a
complex dependency chain, then you introduce an order dependence to
the resolution that might be non-unique. Since CFEngine starts trying
to converge values as soon as possible, it is best to define variables
in bundles before using them, i.e. as early as possible in your
configuration.  In general it is wise to avoid class-variable
dependency as much as possible.

     <li>CFEngine executes agent promise bundles in the strict order defined by
the <code>bundlesequence</code> (possibly overridden by the <code>-b</code> or
<code>--bundlesequence</code> command line option). 
<li>Within a bundle, the promise types are executed in a round-robin
fashion according to so-called `normal ordering' (essentially deletion
first, followed by creation). The actual sequence continues for up to three
iterations of the following, converging towards a final state:

     <pre class="verbatim">        vars
        classes
        outputs
        interfaces
        files
        packages
        guest_environments
        methods
        processes
        services
        commands
        storage
        databases
        reports
</pre>

     <p>Within <code>edit_line</code> bundles in <code>files</code> promises
(See `File editing in CFEngine 3' for important details),
the normal ordering is:
<pre class="verbatim">        vars
        classes
        delete_lines
        field_edits
        insert_lines
        replace_patterns
        reports
</pre>

     <li>The order of promises within one of the above types follows their
top-down ordering within the bundle itself

     <li>The order may be overridden by making a promise depend on a class
that is set by another promise.

     </ol>

<div class="node">
<a name="Server-normal-ordering"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Monitor-normal-ordering">Monitor normal ordering</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Agent-normal-ordering">Agent normal ordering</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Normal-ordering">Normal ordering</a>

</div>

<h4 class="subsection">2.9.2 Server normal ordering</h4>

<p>As with the agent, common bundles are executed before any server bundles;
following this <i>all</i> server bundles are executed (the <code>bundlesequence</code>
is only used for <code>cf-agent</code>). 
Within a server bundle, the promise types are unamgibuous. 
Variables and classes are resolved in the same way as the agent. 
On connection, access control must be handled first, then a role
request might be made once access has been granted. Thus ordering
is fully constrained by process with no additional freedoms.

   <p>Within a server bundle, the normal ordering is:

<pre class="verbatim">   vars
   classes
   access
   roles
</pre>

<div class="node">
<a name="Monitor-normal-ordering"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Knowledge-normal-ordering">Knowledge normal ordering</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Server-normal-ordering">Server normal ordering</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Normal-ordering">Normal ordering</a>

</div>

<h4 class="subsection">2.9.3 Monitor normal ordering</h4>

<p>As with the agent, common bundles are executed before any monitor bundles;
following this <i>all</i> monitor bundles are executed (the <code>bundlesequence</code>
is only used for <code>cf-agent</code>). 
Variables and classes are resolved in the same way as the agent.

   <p>Within a monitor bundle, the normal ordering is:

<pre class="verbatim">   vars
   classes
   measurements
   reports
</pre>

<div class="node">
<a name="Knowledge-normal-ordering"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Monitor-normal-ordering">Monitor normal ordering</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Normal-ordering">Normal ordering</a>

</div>

<h4 class="subsection">2.9.4 Knowledge normal ordering</h4>

<p>As with the agent, common bundles are executed before any knowledge bundles;
following this <i>all</i> knowledge bundles are executed (the <code>bundlesequence</code>
is only used for <code>cf-agent</code>). 
Variables and classes are resolved in the same way as the agent.

   <p>Within a knowledge bundle, the normal ordering is:

<pre class="verbatim">   vars
   classes
   topics
   occurrences
   inferences
   reports
</pre>

<!--  -->
<div class="node">
<a name="Loops-and-lists-in-CFEngine-3"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Pattern-matching-and-referencing">Pattern matching and referencing</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Normal-ordering">Normal ordering</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#A-simple-crash-course">A simple crash course</a>

</div>

<h3 class="section">2.10 Loops and lists in CFEngine 3</h3>

<p>There are no explicit loops in CFEngine, instead there are lists. 
To make a loop, you simply refer to a list as a scalar and CFEngine
will assume a loop over all items in the list.

   <p>For example, in the examples below the list <code>component</code> has three
elements. The list as a whole may be referred to as
<code>@(component)</code>, in order to pass the whole list to a promise
where a list is expected. However, if we write <code>$(component)</code>,
i.e. the scalar variable, then CFEngine assumes that it should substitute
each scalar from the list in turn, and thus iterate over the list
elements using a loop.

<pre class="verbatim">
body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{
vars:

  "component" slist => { "cf-monitord", "cf-serverd", "cf-execd" };

  "new_list" slist => { "cf-know", @(component) };

processes:

  "$(component)" restart_class => canonify("start_$(component)");

commands:

   "/bin/echo /var/cfengine/bin/$(component)"

       ifvarclass => canonify("start_$(component)");
}

</pre>

   <p>If a variable is repeated, its value is tied throughout
the expression; so the output of:

<pre class="verbatim">
body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{
vars:

  "component" slist => { "cf-monitord", "cf-serverd", "cf-execd" };

  "array[cf-monitord]" string => "The monitor";
  "array[cf-serverd]" string => "The server";
  "array[cf-execd]" string => "The executor, not executioner";

commands:

   "/bin/echo $(component) is"

            args => "$(array[$(component)])";
}

</pre>

<p class="noindent">is as follows:

<pre class="verbatim">
Q ".../bin/echo cf-mo": cf-monitord is The monitor
 -> Last 1 QUOTEed lines were generated by "/bin/echo cf-monitord is The monitor"
Q ".../bin/echo cf-se": cf-serverd is The server
 -> Last 1 QUOTEed lines were generated by "/bin/echo cf-serverd is The server"
Q ".../bin/echo cf-ex": cf-execd is The executor, not executioner
 -> Last 1 QUOTEed lines were generated by "/bin/echo cf-execd is The executor, not executioner"

</pre>

<!--  -->
<div class="node">
<a name="Pattern-matching-and-referencing"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Distributed-discovery">Distributed discovery</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Loops-and-lists-in-CFEngine-3">Loops and lists in CFEngine 3</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#A-simple-crash-course">A simple crash course</a>

</div>

<h3 class="section">2.11 Pattern matching and referencing</h3>

<p>One of the strengths of CFEngine 3 is the ability to recognize and
exploit patterns.  All string patterns in CFEngine 3 are matched using
PCRE regular expressions.

   <p>CFEngine has the ability to extract back-references from pattern matches. 
This makes sense in two cases. Back references are fragments of a string
that match parenethetic expressions. For instance, suppose we have the string:

<pre class="smallexample">     
      Mary had a little lamb ...
     
</pre>
   <p class="noindent">and apply the regular expression

<pre class="smallexample">     
      "Mary ([^l]+)little (.*)"
     
</pre>
   <p>The pattern matches the entire string, and it
contains two parenthesized subexpressions, which respectively match
the fragments `had a ' and `lamb ...'. The regular
expression libraries assign <i>three</i> matches to this
result, labelled 0, 1 and 2.

   <p>The zeroth value is the entire string matched by the
total expression. The first value is the fragment matched
by the first parenthesis, and so on.

   <p>Each time CFEngine matches a string, these values are
assigned to a special variable context <code>$(match.</code><var>n</var><code>)</code>. 
The fragments can be referred to in the remainder of the promise. 
There are two places where this makes sense. One is in pattern replacement
during file editing, and the other is in searching for files.

   <p>Consider the examples below:
<pre class="verbatim">
bundle agent testbundle

{
files:

  # This might be a dangerous pattern - see explanation in the next section
  # on "Runaway change warning"

  "/home/mark/tmp/cf([23])?_(.*)"
       edit_line => myedit("second backref: $(match.2)");
}

</pre>
There are other filenames that could match this pattern, but if, for
example, there were to exist a file <samp><span class="file">/home/mark/tmp/cf3_test</span></samp>,
then we would have:

     <dl>
<dt>&lsquo;<samp><span class="samp">$(match.0)</span></samp>&rsquo;<dd>equal to `/home/mark/tmp/cf3_test'
<br><dt>&lsquo;<samp><span class="samp">$(match.1)</span></samp>&rsquo;<dd>equal to `3'
<br><dt>&lsquo;<samp><span class="samp">$(match.2)</span></samp>&rsquo;<dd>equal to `test'
</dl>

   <p>Note that because the pattern allows for an <i>optional</i> '2' or '3' to follow
the letters 'cf', it is possible that <code>$(match.1)</code> would contain the
empty string.  For example, if there was a file named
<samp><span class="file">/home/mark/tmp/cf_widgets</span></samp>, then we would have
     <dl>
<dt>&lsquo;<samp><span class="samp">$(match.0)</span></samp>&rsquo;<dd>equal to `/home/mark/tmp/cf_widgets'
<br><dt>&lsquo;<samp><span class="samp">$(match.1)</span></samp>&rsquo;<dd>equal to `'
<br><dt>&lsquo;<samp><span class="samp">$(match.2)</span></samp>&rsquo;<dd>equal to `widgets'
</dl>

   <p>Now look at the edit bundle. This takes a parameter (which is the
back-reference from the filename match), but it also uses back references to
replace shell comment lines with C comment lines  (the same
approach is used to hash-comment lines in files).  The back-reference
variables <code>$(match.</code><var>n</var><code>)</code> refer to the most recent pattern match, and
so in the &lsquo;<samp><span class="samp">C_comment</span></samp>&rsquo; body, they do not refer to the filename components,
but instead to the hash-commented line in the &lsquo;<samp><span class="samp">replace_patterns</span></samp>&rsquo; promise.

<pre class="verbatim">
bundle edit_line myedit(parameter)
  {
  vars:

   "edit_variable" string => "private edit variable is $(parameter)";

  insert_lines:

     "$(edit_variable)";

  replace_patterns:

  # replace shell comments with C comments

   "#(.*)"

      replace_with => C_comment,
     select_region => MySection("New section");

  }

########################################
# Bodies
########################################

body replace_with C_comment

{
replace_value => "/* $(match.1) */"; # backreference from replace_patterns
occurrences => "all";  # first, last, or all
}

########################################################

body select_region MySection(x)

{
select_start => "\[$(x)\]";
select_end => "\[.*\]";
}

</pre>

   <p>Try this example on the file
<pre class="verbatim">[First section]

one
two
three

[New section]

four
#five
six

[final]

seven
eleven
</pre>

<p class="noindent">The resulting file is edited like this:
<pre class="verbatim">[First section]

one
two
three

[New section]

four
/* five */
six

[final]

seven
eleven

private edit variable is second backref: test
</pre>

<ul class="menu">
<li><a accesskey="1" href="#Runaway-change-warning">Runaway change warning</a>
<li><a accesskey="2" href="#Commenting-lines">Commenting lines</a>
<li><a accesskey="3" href="#Regular-expressions-in-paths">Regular expressions in paths</a>
<li><a accesskey="4" href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>
<li><a accesskey="5" href="#Special-topics-on-Regular-Expressions">Special topics on Regular Expressions</a>
</ul>

<div class="node">
<a name="Runaway-change-warning"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Commenting-lines">Commenting lines</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Pattern-matching-and-referencing">Pattern matching and referencing</a>

</div>

<h4 class="subsection">2.11.1 Runaway change warning</h4>

<p>Be careful when using patterns to search for files that are altered by CFEngine
if you are not using a file repository. Each time CFEngine makes a change it
saves an old file into a copy like <samp><span class="file">cf3_test.cf-before-edit</span></samp>. These
new files then get matched by the same expression above &ndash; because it ends
in the generic<code>.*</code>), or does not
specify a tail for the expression. Thus CFEngine will happily edit backups
of the edit file too, and generate a recursive process, resulting in something
like the following:

<pre class="smallexample">     cf3_test                  cf3_test.cf-before-edit
     cf3_test~                 cf3_test~.cf-before-edit.cf-before-edit
     cf3_test~.cf-before-edit  cf3_test~.cf-before-edit.cf-before-edit.cf-before-edit
</pre>
   <p>Always try to be as specific as possible when specifying patterns. A lazy approach
will often come back to haunt you.

<div class="node">
<a name="Commenting-lines"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Regular-expressions-in-paths">Regular expressions in paths</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Runaway-change-warning">Runaway change warning</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Pattern-matching-and-referencing">Pattern matching and referencing</a>

</div>

<h4 class="subsection">2.11.2 Commenting lines</h4>

<p>The following example shows how you would hash-comment lines in a file
using CFEngine 3.

<pre class="verbatim">######################################################################
#
# HashCommentLines implemented in CFEngine 3
#
######################################################################

body common control

{
version => "1.2.3";
bundlesequence  => { "testbundle"  };
}

########################################################

bundle agent testbundle

{
files:

  "/home/mark/tmp/comment_test"

       create    => "true",
       edit_line => comment_lines_matching;
}

########################################################

bundle edit_line comment_lines_matching
  {
  vars:

    "regexes" slist => { "one.*", "two.*", "four.*" };

  replace_patterns:

   "^($(regexes))$"
      replace_with => comment("# ");
  }

########################################
# Bodies
########################################

body replace_with comment(c)

{
replace_value => "$(c) $(match.1)";
occurrences => "all";
}

</pre>

<div class="node">
<a name="Regular-expressions-in-paths"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Commenting-lines">Commenting lines</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Pattern-matching-and-referencing">Pattern matching and referencing</a>

</div>

<h4 class="subsection">2.11.3 Regular expressions in paths</h4>

<p>When applying regular expressions in paths, the path will first be
split at the path separators, and each element matched
independently. For example, this makes it possible to write
expressions like <code>"/home/.*/file"</code> to match a single file inside
a lot of directories &mdash; the .* does not eat the whole string.

   <p>Note that whenever regular expressions are used in paths, the <code>/</code> is
always used as the path separator, even on Windows.  However, on Windows, if
the pathname is interpreted literally (no regular expressions), then the
backslash is also recognized as the path separator.  This is because the
backslash has a special (and potentially ambiguous) meaning in regular
expressions (a <code>\d</code> means the same as <code>[0-9]</code>, but on Windows it
could also be a path separator and a directory named <code>d</code>).

   <p>The <code>pathtype</code> attribute allows you to force a specific behavior when
interpreting pathnames.  By default, CFEngine looks at your pathname and
makes an educated guess as to whether your pathname contains a regular
expression.  The values <code>"literal"</code> and <code>"regex"</code> explicitly force
CFEngine to interpret the pathname either one way or another.

   <p>(see the <code>pathtype</code> attribute).

<pre class="verbatim">
body common control
{
bundlesequence => { "wintest" };
}

########################################

bundle agent wintest
{
files:
  "c:/tmp/file/f.*"		# "best guess" interpretation
    delete => nodir;


  "c:\tmp\file"
    delete => nodir,
    pathtype => "literal";	# force literal string interpretation


  "C:/windows/tmp/f\d"
    delete => nodir,
    pathtype => "regex";	# force regular expression interpretation
}

########################################

body delete nodir
{
rmdirs => "false";
}

</pre>

   <p>Note that the path &lsquo;<samp><span class="samp">/tmp/gar.*</span></samp>&rsquo; will only match filenames
like <samp><span class="file">/tmp/gar</span></samp>, <samp><span class="file">/tmp/garbage</span></samp> and <samp><span class="file">/tmp/garden</span></samp>.  It will
<i>not</i> match filename like <samp><span class="file">/tmp/gar/baz</span></samp> (because even though the
&lsquo;<samp><span class="samp">.*</span></samp>&rsquo; in a regular expression means "zero or more of any character",
CFEngine restricts that to mean "zero or more of any character <i>in a path
component</i>").  Correspondingly, CFEngine
also restricts where you can use the &lsquo;<samp><span class="samp">/</span></samp>&rsquo; character (you can't use it
in a character class like &lsquo;<samp><span class="samp">[^/]</span></samp>&rsquo; or in a parenthesized or repeated
regular expression component.

   <p>This means that regular expressions which include "optional directory
components" won't work.  You can't have a files promise to tidy the directory
&lsquo;<samp><span class="samp">(/usr)?/tmp</span></samp>&rsquo;.  Instead, you need to be more verbose and specify
&lsquo;<samp><span class="samp">/usr/tmp|/tmp</span></samp>&rsquo;, or even better, think declaratively and create an
<i>slist</i> that contains both the strings &lsquo;<samp><span class="samp">/tmp</span></samp>&rsquo; and &lsquo;<samp><span class="samp">/usr/tmp</span></samp>&rsquo;,
and then allow CFEngine to iterate over the list!

   <p>This also means that the path &lsquo;<samp><span class="samp">/tmp/.*/something</span></samp>&rsquo; will match files like
<samp><span class="file">/tmp/abc/something</span></samp> or <samp><span class="file">/tmp/xyzzy/something</span></samp>.  However, even
though the pattern &lsquo;<samp><span class="samp">.*</span></samp>&rsquo; means "zero or more of any character (except
&lsquo;<samp><span class="samp">/</span></samp>&rsquo;)", CFEngine matches files bounded by directory separators.  So even
though the pathname <samp><span class="file">/tmp//something</span></samp> is technically the same as the
pathname <samp><span class="file">/tmp/something</span></samp>, the regular expression &lsquo;<samp><span class="samp">/tmp/.*/something</span></samp>&rsquo;
will <i>not</i> match on the degenerate case of <samp><span class="file">/tmp//something</span></samp> (or
<samp><span class="file">/tmp/something</span></samp>).

<div class="node">
<a name="Anchored-vs.-unanchored-regular-expressions"></a>
<a name="Anchored-vs_002e-unanchored-regular-expressions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Special-topics-on-Regular-Expressions">Special topics on Regular Expressions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Regular-expressions-in-paths">Regular expressions in paths</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Pattern-matching-and-referencing">Pattern matching and referencing</a>

</div>

<h4 class="subsection">2.11.4 Anchored vs. unanchored regular expressions</h4>

<p>CFEngine uses the full power of regular expressions, but there are two &ldquo;flavors&rdquo; of regex.  Because they
behave somewhat differently (while still utilizing the same syntax), it is
important to know which one is used for a particular component of CFEngine:

     <ul>
<li>An &ldquo;anchored&rdquo; regular expression will only successfully match an
entire string, from start to end.  An anchored regular expression
behaves as if it starts with &lsquo;<samp><span class="samp">^</span></samp>&rsquo; and ends with &lsquo;<samp><span class="samp">$</span></samp>&rsquo;, whether
you specify them yourself or not.  Furthermore, an anchored regular
expression cannot have these automatic anchors removed.

     <li>An &ldquo;unanchored&rdquo; regular expression may successfully match anywhere
in a string.  An unanchored regex may use anchors (such as &lsquo;<samp><span class="samp">^</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">$</span></samp>&rsquo;, &lsquo;<samp><span class="samp">\A</span></samp>&rsquo;, &lsquo;<samp><span class="samp">\Z</span></samp>&rsquo;, &lsquo;<samp><span class="samp">\b</span></samp>&rsquo;, etc.) to restrict where
in the string it may match.  That is, an unanchored regular expression
may be easily converted into a partially- or fully-anchored regex.

   </ul>

   <p>For example, the <code>comment</code> parameter in <code>readstringarray</code>
is an unanchored regex (see <a href="#Function-readstringarray">Function readstringarray</a>).  If you
specify the regular expression as <code>"#.*"</code>, then on any line
which contains a pound sign, everything from there until the end
of the line will be removed as a comment.  However, if you specify
the regular expression as <code>"^#.*"</code> (note the &lsquo;<samp><span class="samp">^</span></samp>&rsquo; anchor
at the start of the regex), then only lines which <i>start</i> with a
&lsquo;<samp><span class="samp">#</span></samp>&rsquo; will be removed as a comment!  If you want to ignore C-style
comment in a multi-line string, then you have to a bit more clever,
and use this regex: <code>"(?s)/\*.*?\*/"</code>

   <p>Conversely, <code>delete_lines</code> promises use anchored regular
expressions to delete lines.  If our promise uses <code>"bob:\d*</code>
as a line-matching regex, then only the second line of this file
will be deleted (because only the second line starts with &lsquo;<samp><span class="samp">bob:</span></samp>&rsquo;
and is then followed exclusively by digits, all the way to the end of
the string).

<pre class="verbatim">bobs:your:uncle
bob:111770
thingamabob:1234
robert:bob:xyz
i:am:not:bob
</pre>

   <p>If CFEngine expects an unanchored regular expression, then finding
every line that contains the letters &lsquo;<samp><span class="samp">bob</span></samp>&rsquo; is easy.  You just
use the regex <code>"bob"</code>.  But if CFEngine expects an anchored
regular expression, then you must use <code>".*bob.*"</code>.

   <p>If you want to find every line that has a field which is exactly
&lsquo;<samp><span class="samp">bob</span></samp>&rsquo; with no characters before or after, then it is only a
little more complicated if CFEngine expects an unanchored regex:
<code>"(^|:)bob(:|$)"</code>.  But if CFEngine expects an anchored
regular expression, then it starts getting ugly, and you'd need to
use <code>"bob:.*|.*:bob:.*|.*:bob"</code>.

<div class="node">
<a name="Special-topics-on-Regular-Expressions"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Pattern-matching-and-referencing">Pattern matching and referencing</a>

</div>

<h4 class="subsection">2.11.5 Special topics on Regular Expressions</h4>

<p>Regular expressions are a complicated subject, and really are beyond the
scope of this document.  However, it is worth mentioning a couple of special
topics that you might want to know of when using regular expressions.

   <p>The first is how to <i>not</i> get a backreference.  If you want to have a
parenthesized expression that does not generate a back reference, there is a
special PCRE syntax to use.  Instead of using <code>()</code> to bracket the piece
of a regular expression, use <code>(?:)</code> instead.  For example, this will
match the filenames <samp><span class="file">foolish</span></samp>, <samp><span class="file">foolishly</span></samp>, <samp><span class="file">bearish</span></samp>,
<samp><span class="file">bearishly</span></samp>, <samp><span class="file">garish</span></samp>, and <samp><span class="file">garishly</span></samp> in the <samp><span class="file">/tmp</span></samp>
directory.  The variable <code>$match.0</code> will contain the full filename, and
<code>$match.1</code> will either contain the string &lsquo;<samp><span class="samp">ly</span></samp>&rsquo; or the empty string. 
But the <code>(?:</code>expression<code>)</code> which matches foo, bear,
or gar does <i>not</i> create a back-reference:

<pre class="verbatim">files:
    "/tmp/(?:foo|bear|gar)ish(ly)?"

</pre>

   <p>Note that sometimes multi-line strings are subject to be matched by
regular expressions. CFEngine internally matches all regular
expressions using PCRE_DOTALL option, so <code>.</code> matches newlines. If
you want to match any character except newline you could use <code>\N</code>
escape sequence.

   <p>Another thing you might want to do is ignore capitalization.  CFEngine is
case-sensitive (in all things), so the files promise <samp><span class="file">/tmp/foolish</span></samp> will
not match the files <samp><span class="file">/tmp/Foolish</span></samp> or <samp><span class="file">/tmp/fOoLish</span></samp>, etc.  There are
two ways to acheive case-insensitivity.  The first is to use character classes:

<pre class="verbatim">files:
    "/tmp/[Ff][Oo][Oo][Ll][Ii][Ss][Hh]"

</pre>

   <p>While this is certainly correct, it can also lead to unreadability.  The PCRE
patterns in CFEngine have another way of introducing case-insensitvity into a
pattern:

<pre class="verbatim">files:
    "/tmp/(?i:foolish)"
</pre>

   <p>The <code>(?i:)</code> brackets impose case-insensitive matching on the text that
it surrounds, without creating a sub-expression.  You could also write the
regular expression like this (but be aware that the two expressions are
different, and work slightly differently, so check the documentation for the
specifics):

<pre class="verbatim">files:
    "/tmp/(?i)foolish"
</pre>

   <p>The <code>/s</code>, <code>/m</code>, and <code>/x</code> switches from PCRE are also
available, but use them with great care!

<!--  -->
<div class="node">
<a name="Distributed-discovery"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Pattern-matching-and-referencing">Pattern matching and referencing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#A-simple-crash-course">A simple crash course</a>

</div>

<h3 class="section">2.12 Distributed discovery</h3>

<p>CFEngine's philosophy and modus operandi is to make machines as self-reliant
as possible. This is the path to scalability. Sometimes we want machines
to be able to detect one another and sample each others' behaviour. This can
be accomplished using probes and server functions.

   <p>For example, testing whether services are up and running can be a useful
probe even from a local host. CFEngine has in-built functions for generically
probing the environment; these are designed to encourage decentralized
monitoring.

<pre class="verbatim">
body common control

{
bundlesequence  => { "test"  };
}

###########################################################

bundle agent test

{
vars:

 "hosts" slist => { "server1.example.org", "server2", "server3" };

 "up_servers" int =>  selectservers("@(hosts)","80","","","100","alive_servers");

classes:

  "someone_alive" expression => isgreaterthan("$(up_servers)","0");

  "i_am_a_server" expression => regarray("up_servers","$(host)|$(fqhost)");

reports:

  someone_alive::

    "Number of active servers $(up_servers)" action => always;

    "First server $(alive_servers[0]) fails over to $(alive_servers[1])";


}

</pre>

<!--  -->
<div class="node">
<a name="How-to-run-CFEngine-3-examples"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#A-complete-configuration">A complete configuration</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#A-simple-crash-course">A simple crash course</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">3 How to run CFEngine 3 examples</h2>

<p>The CFEngine <samp><span class="file">tests</span></samp> directory contains a multitude of examples of CFEngine 3 code. 
These instructions assume that you have all of your configuration in a
single test file, such as the example in the distribution directory
<samp><span class="file">tests/units</span></samp>.

     <ol type=1 start=1>
<li>Test the file as a non-privileged user first, if you can.

     <li>Always verify syntax first with <code>cf-promises</code>. This requires no privileges. 
An <code>cf-agent</code> will not execute a configuration that has not passed this test.

     <pre class="smallexample">          
          host$ cf-promises -f ./inputfile.cf
          
</pre>
     <li>Run the examples like this, e.g.

     <pre class="smallexample">          
          host$ src/cf-promises -f ./tests/units/unit_server_copy_localhost.cf
          host$ src/cf-serverd -f ./tests/units/unit_server_copy_localhost.cf
          host$ src/cf-agent -f ./tests/units/unit_server_copy_localhost.cf
          
</pre>
        </ol>

   <p>Running <code>cf-agent</code> in verbose mode provides detailed information
about the state of the systems promises.

<pre class="smallexample">     Outcome of version 1.2.3: Promises observed to be kept 99%,
     Promises repaired 1%, Promises not repaired 0%
</pre>
   <p>The log-file <samp><span class="file">WORKDIR/promise.log</span></samp> contains the summary of these reports
with timestamps. This is the simplest kind of high level audit record of the
system.

<!--  -->
<div class="node">
<a name="A-complete-configuration"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Control-Promises">Control Promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#How-to-run-CFEngine-3-examples">How to run CFEngine 3 examples</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">4 A complete configuration</h2>

<p>To illustrate a complete configuration for agents and daemons,
consider the following example code, supplied in the <samp><span class="file">inputs/</span></samp>
directory of the distribution. Comments indicate the thinking behind
this starting point.

<ul class="menu">
<li><a accesskey="1" href="#promises_002ecf">promises.cf</a>
<li><a accesskey="2" href="#site_002ecf">site.cf</a>
<li><a accesskey="3" href="#update_002ecf">update.cf</a>
<li><a accesskey="4" href="#failsafe_002ecf">failsafe.cf</a>
<li><a accesskey="5" href="#What-should-a-failsafe-or-update-file-contain">What should a failsafe or update file contain</a>
<li><a accesskey="6" href="#Recovery-from-errors-in-the-configuration">Recovery from errors in the configuration</a>
<li><a accesskey="7" href="#Recovery-from-errors-in-the-software">Recovery from errors in the software</a>
</ul>

<div class="node">
<a name="promises.cf"></a>
<a name="promises_002ecf"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#site_002ecf">site.cf</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#A-complete-configuration">A complete configuration</a>

</div>

<h3 class="section">4.1 <samp><span class="file">promises.cf</span></samp></h3>

<p>This file is the first file that <code>cf-agent</code> with no arguments
will try to look for. It should contain all of the basic
configuration settings, including a list of other files
to include. In normal operation, it must have a <code>bundlesequence</code>.

   <p>This file can stay fixed, except for extending the bundlesequence. 
The bundlesequence acts like the `genetic makeup' of the
configuration.  In a large configuration, you might want to have a
different bundlesequence for different classes of host, so that you
can build a complete system like a check-list from different
combinations of building blocks. You can construct different lists by
composing them from other lists, or you can use <code>methods</code>
promises as an alternative for composing bundles for different classes.

<pre class="verbatim">#######################################################
#
# promises.cf
#
#######################################################

body common control

{
# List the `genes' for this system..

bundlesequence  => {
                   "update",
                   "garbage_collection",
                   "main",
                   "cfengine"
                   };


inputs          => {
                   "update.cf",
                   "site.cf",
                   "library.cf"
                   };
}

#######################################################
# Now set defaults for all components' hard-promises
#######################################################

body agent control
{
# if default runtime is 5 mins, we need more for long jobs
ifelapsed => "15";
}

#######################################################

body monitor control
{
forgetrate => "0.7";
}

###########si###########################################

body executor control

{
splaytime => "1";
mailto => "cfengine_mail@example.org";
smtpserver => "localhost";
mailmaxlines => "30";

# Instead of a separate update script, now do this

exec_command => "$(sys.workdir)/bin/cf-agent -f failsafe.cf &amp;&amp; $(sys.workdir)/bin/cf-agent";
}

#######################################################

body reporter control

{
reports => { "performance", "last_seen", "monitor_history" };
build_directory => "/tmp/nerves";
report_output => "html";
}

#######################################################

body runagent control
{
hosts => {
          "127.0.0.1"
          # , "myhost.example.com:5308", ...
         };

}

#######################################################

body server control

{
allowconnects         => { "127.0.0.1" , "::1" };
allowallconnects      => { "127.0.0.1" , "::1" };
trustkeysfrom         => { "127.0.0.1" , "::1" };

# Make updates and runs happen in one

cfruncommand => "$(sys.workdir)/bin/cf-agent";

allowusers   => { "root" };
}

</pre>

<div class="node">
<a name="site.cf"></a>
<a name="site_002ecf"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#update_002ecf">update.cf</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#promises_002ecf">promises.cf</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#A-complete-configuration">A complete configuration</a>

</div>

<h3 class="section">4.2 <samp><span class="file">site.cf</span></samp></h3>

<p>Use this file to add your site-specific configuration. 
Common bundles can be used to define global variables. 
Otherwise, unqualified variables are local to the bundle in which
they are defined &ndash; however they can be accessed by
writing <code>$(bundle_name.variable_name)</code>.

<pre class="verbatim">#######################################################
#
# site.cf
#
#######################################################

bundle common g
{
vars:

  SuSE::

   "crontab" string => "/var/spool/cron/tabs/root";

 !SuSE::

   "crontab" string => "/var/spool/cron/crontabs/root";
}

</pre>

   <p>The CFEngine bundle below detects whether CFEngine 2 is already
running on the host or not, and if so attempts to kill off old daemon
processes and encapsulate the agent. It also looks for rules in the
old CFEngine configuration that would potentially spoil CFEngine 3's
control of the system: the last thing we want is for CFEngine 2 and
CFEngine 3 to fight each other for control of the system.  CFEngine 3
tries to edit an existing crontab entry to replace any references to
<code>cfexecd</code> with <code>cf-execd</code>; if none are found it will add a 5
minute run schedule.  You should never put <code>cf-agent</code>or
<code>cf-agent</code> directly inside <code>cron</code> without the <code>cf-execd</code>
wrapper.

<pre class="verbatim">#######################################################
# Start with CFEngine itself
#######################################################

bundle agent cfengine

{
classes:

  "integrate_cfengine2"

      and => {
             fileexists("$(sys.workdir)/inputs/cfagent.conf"),
             fileexists("$(sys.workdir)/bin/cfagent")
             };

vars:

   "cf2bits" slist => { "cfenvd", "cfservd", "cfexecd" };

commands:

 integrate_cfengine2::

   "$(sys.workdir)/bin/cfagent"

        action => longjob;

files:

  # Warn about rules relating to CFEngine 2 in inputs - could conflict

  "$(sys.workdir)/inputs/.*"

       comment     => "Check if there are still promises about CFEngine 2 that need removing",
       edit_line   => DeleteLinesMatching(".*$(cf2bits).*"),
       file_select => OldCf2Files,
       action      => WarnOnly;

  # Check cf-execd and schedule is in crontab

  "$(g.crontab)"
       edit_line => upgrade_cfexecd,
         classes => define("exec_fix");

processes:

  exec_fix::

    "cron" signals => { "hup" };


}

#######################################################
# General site issues can be in bundles like this one
#######################################################

bundle agent main

{
vars:

  "component" slist => { "cf-monitord", "cf-serverd" };

 # - - - - - - - - - - - - - - - - - - - - - - - -

files:

  "$(sys.resolv)"  # test on "/tmp/resolv.conf" #

     create        => "true",
     edit_line     => resolver,
     edit_defaults => def;

 # Uncomment this to perform a change-detection scan

 #  "/usr"
 #     changes      => lay_trip_wire,
 #     depth_search => recurse("inf"),
 #     action       => measure;

processes:

  "cfenvd"             signals => { "term" };

 # Uncomment this when you are ready to upgrade the server
 #
 #  "cfservd"             signals => { "term" };
 #

 # Now make sure the new parts are running, cf-serverd will fail if
 # the old server is still running

  "$(component)" restart_class => canonify("start_$(component)");

 # - - - - - - - - - - - - - - - - - - - - - - - -

commands:

   "$(sys.workdir)/bin/$(component)"

       ifvarclass => canonify("start_$(component)");

}

</pre>

   <p>This section takes a backup of a user home directory.  This is
especially useful for a single laptop or personal workstation that
does not have a regular external backup. If a user deletes a file by
accident, this shadow backup might contain the file even while
travelling offline.

<pre class="verbatim">
#######################################################
# Backup
#######################################################

bundle agent backup
{
files:

  "/home/backup"

     copy_from => cp("/home/mark"),
  depth_search => recurse("inf"),
   file_select => exclude_files,
        action => longjob;

}

#######################################################
# Garbage collection issues
#######################################################

bundle agent garbage_collection
{
files:

  "$(sys.workdir)/outputs"

    delete => tidy,
    file_select => days_old("3"),
    depth_search => recurse("inf");


}

###########################################################

body file_select OldCf2Files
{
leaf_name => {
             "promises\.cf",
             "site\.cf",
             "library\.cf",
             "failsafe\.cf",
             ".*\.txt",
             ".*\.html",
             ".*~",
             "#.*"
             };

file_result => "!leaf_name";
}

###########################################################

body action measure
{
measurement_class => "Detect Changes in /usr";
ifelapsed => "240";	# 4 hours
expireafter => "240";	# 4 hours
}

</pre>

   <p>Some basic anomaly detection: we respond with simple warnings
if resource anomalies are detected.

<pre class="verbatim">#######################################################
# Anomaly monitoring
#######################################################

bundle agent anomalies
{
reports:

rootprocs_high_dev2::

   "RootProc anomaly high 2 dev on $(mon.host) at $(mon.env_time)
    measured value $(mon.value_rootprocs) av $(mon.av_rootprocs)
    pm $(mon.dev_rootprocs)"

      showstate => { "rootprocs" };

entropy_www_in_high&amp;anomaly_hosts.www_in_high_anomaly::

   "HIGH ENTROPY Incoming www anomaly high anomaly dev!!
    on $(mon.host) at $(mon.env_time)
    - measured value $(mon.value_www_in)
    av $(mon.av_www_in) pm $(mon.dev_www_in)"

      showstate => { "incoming.www" };

 entropy_www_in_low.anomaly_hosts.www_in_high_anomaly::

   "LOW ENTROPY Incoming www anomaly high anomaly dev!!
    on $(mon.host) at $(mon.env_time)
     - measured value $(svalue_www_in)
    av $(av_www_in) pm $(dev_www_in)"

     showstate => { "incoming.www" };

entropy_tcpsyn_in_low.anomaly_hosts.tcpsyn_in_high_dev2::

   "Anomalous number of new TCP connections on $(mon.host)
    at $(mon.env_time)
    - measured value $(mon.value_tcpsyn_in)
    av $(mon.av_tcpsyn_in) pm $(mon.dev_tcpsyn_in)"

     showstate => { "incoming.tcpsyn" };

 entropy_dns_in_low.anomaly_hosts.dns_in_high_anomaly::

   "Anomalous (3dev) incoming DNS packets on $(mon.host)
    at $(mon.env_time) - measured value $(mon.value_dns_in)
    av $(av_dns_in) pm $(mon.dev_dns_in)"

     showstate => { "incoming.dns" };

 entropy_dns_in_low.anomaly_hosts.udp_in_high_dev2::

   "Anomalous (2dev) incoming (non-DNS) UDP traffic
    on $(mon.host) at $(mon.env_time) - measured value
    $(mon.value_udp_in) av $(mon.av_udp_in) pm $(mon.dev_udp_in)"

     showstate => { "incoming.udp" };

 anomaly_hosts.icmp_in_high_anomaly.!entropy_icmp_in_high::

   "Anomalous low entropy (3dev) incoming ICMP traffic
    on $(mon.host) at $(mon.env_time) - measured value $(mon.value_icmp_in)
    av $(mon.av_icmp_in) pm $(mon.dev_icmp_in)"

     showstate => { "incoming.icmp" };
}

</pre>

   <p>Server access rules are a touchy business. In an enterprise
setting you generally want every host to allow a monitoring
host to be able to download data, and a backup host to be able
to access important data on every host. On a laptop or personal
workstation, there might not be any reason to run a server
for external use; however you might configure it as below
to allow localhost access for testing.

<pre class="verbatim">
#######################################################
# Server configuration
#######################################################

bundle server access_rules()
{
access:

  "/home/mark/test_area"

    admit   => { "127.0.0.1" };

  # Rule for cf-runagent

  "/home/mark/.cfagent/bin/cf-agent"

    admit   => { "127.0.0.1" };

# New in cf3 - RBAC with cf-runagent

roles:

  ".*"  authorize => { "mark" };
}

</pre>

<div class="node">
<a name="update.cf"></a>
<a name="update_002ecf"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#failsafe_002ecf">failsafe.cf</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#site_002ecf">site.cf</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#A-complete-configuration">A complete configuration</a>

</div>

<h3 class="section">4.3 <samp><span class="file">update.cf</span></samp></h3>

<p>This file should rarely if ever change.  Should you ever change it (or when you
upgrade CFEngine), take special care to ensure the old and the new CFEngine can
parse and execute this file successfully. If not, you risk losing control of
your system (that is, if CFEngine cannot successfully execute this set of
promises, it has no mechanism for distributing <i>new</i> policy files).

   <p>By default, the policy defined in <samp><span class="file">update.cf</span></samp> is executed from two sets
of promise bodies.  The &ldquo;usual&rdquo; one (defined in the <code>bundlesequence</code>
in <samp><span class="file">promises.cf</span></samp>) and another in the backup/failsafe <code>bundlesequence</code>
(defined in <samp><span class="file">failsafe.cf</span></samp>).

<pre class="verbatim">#########################################################
#
# update.cf
#
#########################################################

bundle agent update
{
vars:

 "master_location" string => "/your/master/cfengine-inputs";

files:

  # Update the configuration

  "/var/cfengine/inputs"

    perms => system("600"),
    copy_from => mycopy("$(master_location)","localhost"),
    depth_search => recurse("inf"),
    action => immediate;

}

############################################

body perms system(p)

{
mode  => "$(p)";
}

############################################

body file_select cf3_files

{
leaf_name => { "cf-.*" };

file_result => "leaf_name";
}

#########################################################

body copy_from mycopy(from,server)

{
source      => "$(from)";
compare     => "digest";
}

#########################################################

body action immediate
{
ifelapsed => "1";
}
</pre>

<div class="node">
<a name="failsafe.cf"></a>
<a name="failsafe_002ecf"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#What-should-a-failsafe-or-update-file-contain">What should a failsafe or update file contain</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#update_002ecf">update.cf</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#A-complete-configuration">A complete configuration</a>

</div>

<h3 class="section">4.4 <samp><span class="file">failsafe.cf</span></samp></h3>

<p>This file should probably never change.  The only job of <samp><span class="file">failsafe.cf</span></samp> is
to execute the <code>update</code> bundle in a &ldquo;standalone&rdquo; context should there be
a syntax error somewhere in the main set of promises.  In this way, if a
client machine's policies are ever corrupted after downloading erroneous
policy from a server, that client will have a failsafe method for downloading
a corrected policy once it becomes available on the server.  Note that by
&ldquo;corrupted&rdquo; and &ldquo;erroneous&rdquo; we typically mean &ldquo;broken via administrator
error&rdquo; - mistakes happen, and the <samp><span class="file">failsafe.cf</span></samp> file is CFEngine's way
of being prepared for that eventuality.

   <p>If you ever change <samp><span class="file">failsafe.cf</span></samp> (or when you
upgrade CFEngine), make sure the old and the new CFEngine can successfully
parse and execute this file.  If not, you risk losing control of your system
(that is, if CFEngine cannot successfully execute this policy file, it has no
failsafe/fallback mechanism for distributing <i>new</i> policy files).

<pre class="verbatim">#########################################################
#
# Failsafe file
#
#########################################################

body common control

{
bundlesequence => { "update" };

inputs => { "update.cf" };
}

############################################

body depth_search recurse(d)

{
depth => "$(d)";
}

</pre>

<div class="node">
<a name="What-should-a-failsafe-or-update-file-contain"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Recovery-from-errors-in-the-configuration">Recovery from errors in the configuration</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#failsafe_002ecf">failsafe.cf</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#A-complete-configuration">A complete configuration</a>

</div>

<h3 class="section">4.5 What should a failsafe and update file contain?</h3>

<p>The <samp><span class="file">failsafe.cf</span></samp> file is to make sure that your system can
upgrade gracefully to new versions even when mistakes are made.

   <p>As a general rule:
     <ul>
<li>Upgrade the software first, then add new features
to the configuration.

     <li>Never use advanced features in the failsafe or update file.

     <li>Avoid using library code (including any bodies from <samp><span class="file">cfengine_stdlib.cf</span></samp>). 
Copy/paste any bodies you need using a unique name that does not collide with
a name in library (we recommend simply adding the prefix &ldquo;<code>u_</code>&rdquo;).  This
may mean that you create duplicate functionality, but that is okay in this
case to ensure a 100% functioning <i>standalone</i> update process).  The promises
which manage the update process should not have <i>any</i> dependencies on any
other files.

   </ul>

<p class="noindent">A CFEngine configuration will fail-over to the <code>failsafe.cf</code>
configuration
if it is unable to read or parse the contents successfully. That means
that any syntax errors you introduce (or any new features you utilize in a
configuration) will cause a
fail-over, because the parser will not be able to interpret the policy.  If
the failover is due to the use of new features, they will not parse until the
software itself has been updated (so we recommend that you always update
CFEngine before updating policy to use new features).  If you accidentally
cause a bad (i.e., unparseable) policy to be distributed to client machines,
the <code>failsafe.cf</code> policy on those machines will run (and will eventually
download a working policy, once you fix it on the policy host).

<div class="node">
<a name="Recovery-from-errors-in-the-configuration"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Recovery-from-errors-in-the-software">Recovery from errors in the software</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#What-should-a-failsafe-or-update-file-contain">What should a failsafe or update file contain</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#A-complete-configuration">A complete configuration</a>

</div>

<h3 class="section">4.6 Recovery from errors in the configuration</h3>

<p>The <samp><span class="file">failsafe.cf</span></samp> file should be able to download the latest
master configuration from source always.

<pre class="verbatim">
#######################################################
#
# failsafe.cf
#
#######################################################

body common control

{
bundlesequence => { "update" };
}

#########################################################

bundle agent update
{
files:

  "/var/cfengine/inputs"

    perms => system,
    copy_from => mycopy("/home/mark/cfengine-inputs","localhost"),
    file_select => cf3_files,
    depth_search => recurse("inf");
}

#########################################################

body perms system

{
mode  => "0700";
}

#########################################################

body depth_search recurse(d)

{
depth => "$(d)";
}

############################################

body file_select cf3_files

{
leaf_name => { "cf-.*" };

file_result => "leaf_name";
}

#########################################################

body copy_from mycopy(from,server)

{
source       => "$(from)";
servers      => { "$(server)" , "failover.domain.tld" };
#copy_backup => "true";
#trustkey    => "true";
encrypt      => "true";
}

</pre>

<p class="noindent">If the <code>copy_backup</code> option is true, CFEngine will keep a single
previous version of the file before copy, if the value is &lsquo;<samp><span class="samp">timestamp</span></samp>&rsquo;
CFEngine keeps time-stamped versions either in the location of the file, or in the
file repository if one is defined. The <code>trustkey</code> option should normally
be commented out so that public keys are only exchanged under controlled conditions.

<div class="node">
<a name="Recovery-from-errors-in-the-software"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Recovery-from-errors-in-the-configuration">Recovery from errors in the configuration</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#A-complete-configuration">A complete configuration</a>

</div>

<h3 class="section">4.7 Recovery from errors in the software</h3>

<p>The update should optionally include an update of software
so that a single failover from a configuration that is `too new'
for the software will still correct itself once the new software
is available.

<pre class="verbatim">
#######################################################
#
# update.cf
#
#######################################################

bundle agent update

{
files:

  "/var/cfengine/inputs"

    perms => system("600"),
    copy_from => mycopy("/home/mark/cfengine-inputs","localhost"),
    depth_search => recurse("inf");
}

############################################

body perms system(p)

{
mode  => "$(p)";
}

############################################

body file_select cf3_files

{
leaf_name => { "cf-.*" };

file_result => "leaf_name";
}

#########################################################

body copy_from mycopy(from,server)

{
source      => "$(from)";
compare     => "digest";
}

</pre>

<!-- ***************************************************** -->
<!-- * CHAPTER -->
<!-- ***************************************************** -->
<div class="node">
<a name="Control-Promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Bundles-for-common">Bundles for common</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#A-complete-configuration">A complete configuration</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">5 Control promises</h2>

<p><br>

   <p>While promises to configure your system are entirley user-defined, the
details of the operational behaviour of the CFEngine software is of
course hard-coded. You can still configure the details of this
behaviour using the control promise bodies. Control behaviour is
defined in bodies because the actual promises are fixed and you only
change their details within sensible limits.

   <p>Note that in CFEngine's previous versions, the <code>control</code> part of
the configuration contained a mixture of internal control parameters
and user definitions. There is now a cleaner separation in
CFEngine 3. User defined behaviour requires a promise, and must
therefore be defined in a bundle.

   <p>Below is a list of the control parameters for the different components
(Agents and Daemons<a rel="footnote" href="#fn-2" name="fnd-2"><sup>2</sup></a>) of the CFEngine software.

<ul class="menu">
<li><a accesskey="1" href="#control-common">control common</a>
<li><a accesskey="2" href="#control-agent">control agent</a>
<li><a accesskey="3" href="#control-server">control server</a>
<li><a accesskey="4" href="#control-monitor">control monitor</a>
<li><a accesskey="5" href="#control-runagent">control runagent</a>
<li><a accesskey="6" href="#control-executor">control executor</a>
<li><a accesskey="7" href="#control-knowledge">control knowledge</a>
<li><a accesskey="8" href="#control-reporter">control reporter</a>
<li><a accesskey="9" href="#control-hub">control hub</a>
<li><a href="#control-file">control file</a>
</ul>
<div class="node">
<a name="control-common"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#control-agent">control agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Control-Promises">Control Promises</a>

</div>

<h3 class="section">5.1 <code>common</code> control promises</h3>

<p><br>

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
     body common control
     
     {
     inputs  =&gt; {
                "update.cf",
                "library.cf"
                };
     
     bundlesequence  =&gt; {
                        update("policy_host.domain.tld"),
                        "main",
                        "cfengine2"
                        };
     
     goal_categories =&gt; { "goals", "targets", "milestones" };
     goal_patterns   =&gt; { "goal_.*", "target.*" };
     
     output_prefix =&gt; "cfengine&gt;";
     version =&gt; "1.2.3";
     }
     
</pre>
   </td></tr></table>

   <p><br>

   <p>The <code>common</code> control body refers to those promises that are
hard-coded into all the components of CFEngine, and therefore affect
the behaviour of all the components.

<ul class="menu">
<li><a accesskey="1" href="#bundlesequence-in-common">bundlesequence in common</a>
<li><a accesskey="2" href="#goal_005fpatterns-in-common">goal_patterns in common</a>
<li><a accesskey="3" href="#ignore_005fmissing_005fbundles-in-common">ignore_missing_bundles in common</a>
<li><a accesskey="4" href="#ignore_005fmissing_005finputs-in-common">ignore_missing_inputs in common</a>
<li><a accesskey="5" href="#inputs-in-common">inputs in common</a>
<li><a accesskey="6" href="#version-in-common">version in common</a>
<li><a accesskey="7" href="#lastseenexpireafter-in-common">lastseenexpireafter in common</a>
<li><a accesskey="8" href="#output_005fprefix-in-common">output_prefix in common</a>
<li><a accesskey="9" href="#domain-in-common">domain in common</a>
<li><a href="#require_005fcomments-in-common">require_comments in common</a>
<li><a href="#host_005flicenses_005fpaid-in-common">host_licenses_paid in common</a>
<li><a href="#site_005fclasses-in-common">site_classes in common</a>
<li><a href="#syslog_005fhost-in-common">syslog_host in common</a>
<li><a href="#syslog_005fport-in-common">syslog_port in common</a>
<li><a href="#fips_005fmode-in-common">fips_mode in common</a>
</ul>

<div class="node">
<a name="bundlesequence-in-common"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#goal_005fpatterns-in-common">goal_patterns in common</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-common">control common</a>

</div>

<h4 class="subsection">5.1.1 <code>bundlesequence</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: <code>.*</code>

<p class="noindent"><b>Synopsis</b>: List of promise bundles to verify in order

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">body common control

{
bundlesequence  => {
                   update("policy_host.domain.tld"),
                   "main",
                   "cfengine2"
                   };
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The <code>bundlesequence</code> determines which of the compiled bundles
will be executed and in what order they will be executed. The list
refers to the names of bundles (which might be parameterized
function-like objects).

   <p>The order in which you execute bundles can affect the outcome of your
promises. In general you should always define variables before you use them.

   <p>The <code>bundlesequence</code> is like a genetic makeup of a machine. The bundles
act like characteristics of the systems. If you want different systems to have
different bundlesequences, distinguish them with classes:

<pre class="verbatim">webservers::

  bundlesequence => { "main", "web" };

others::

  bundlesequence => { "main", "otherstuff" };

</pre>

   <p>If you want to add a basic common sequence to all sequences, then use
global variable lists to do this:

<pre class="verbatim">body common control
{
webservers::

  bundlesequence => { @(g.bs), "web" };

others::

  bundlesequence => { @(g.bs), "otherstuff" };

}

bundle common g
{
vars:

  "bs" slist => { "main", "basic_stuff" }; 
}

</pre>

<p class="noindent"><b>Default value</b>:<br>
<br>

   <p>There is no default value for <code>bundlesequence</code>, and the absence of a
<code>bundlesequence</code> will cause a compilation error.  A bundlesequence may
also be specified using the <code>-b</code> or <code>--bundlesequence</code> command line
option.

<div class="node">
<a name="goal_patterns-in-common"></a>
<a name="goal_005fpatterns-in-common"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#ignore_005fmissing_005fbundles-in-common">ignore_missing_bundles in common</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#bundlesequence-in-common">bundlesequence in common</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-common">control common</a>

</div>

<h4 class="subsection">5.1.2 <code>goal_patterns</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: A list of regular expressions that match promisees/topics considered to be organizational goals

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control
{
goal_patterns => { "goal_.*", "target.*" };
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.1.5, Nova 2.1.0 (2011)

   <p>Used as identifier to mark business and organizational goals in
commercial versions of CFEngine.  CFEngine uses this to match
promisees that represent business goals in promises.

<div class="node">
<a name="ignore_missing_bundles-in-common"></a>
<a name="ignore_005fmissing_005fbundles-in-common"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#ignore_005fmissing_005finputs-in-common">ignore_missing_inputs in common</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#goal_005fpatterns-in-common">goal_patterns in common</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-common">control common</a>

</div>

<h4 class="subsection">5.1.3 <code>ignore_missing_bundles</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: If any bundles in the bundlesequence do not exist, ignore and continue

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">ignore_missing_bundles => "true";
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This authorizes the bundlesequence to contain possibly "nonexistent" pluggable modules. 
It defaults to false, whereupon undefined bundles cause a fatal error in parsing,
and a transition to failsafe mode.

<div class="node">
<a name="ignore_missing_inputs-in-common"></a>
<a name="ignore_005fmissing_005finputs-in-common"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#inputs-in-common">inputs in common</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#ignore_005fmissing_005fbundles-in-common">ignore_missing_bundles in common</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-common">control common</a>

</div>

<h4 class="subsection">5.1.4 <code>ignore_missing_inputs</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: If any input files do not exist, ignore and continue

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
ignore_missing_inputs => "true";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The inputs lists determines which files are parsed by CFEngine. Normally
stringent security checks are made on input files to prevent abuse of the
system by unauthorized users. Sometimes however, it is appropriate to consider
the automatic plug-in of modules that might or might not exist. This option
permits CFEngine to list possible files that might not exist and continue
`best effort' with those that do exist. The default of all Booleans is false,
so the normal behaviour is to signal an error if an input is not found.

<div class="node">
<a name="inputs-in-common"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#version-in-common">version in common</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#ignore_005fmissing_005finputs-in-common">ignore_missing_inputs in common</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-common">control common</a>

</div>

<h4 class="subsection">5.1.5 <code>inputs</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: <code>.*</code>

<p class="noindent"><b>Synopsis</b>: List of additional filenames to parse for promises

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control
{
inputs  => {
           "update.cf",
           "library.cf"
           };
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>
The filenames specified are all assumed to be in the same directory as the
file which references them (this is usually <code>$(sys.workdir)/inputs</code>, but
may be overridden by the <code>-f</code> or <code>--file</code> command line option.

<p class="noindent"><b>Default value</b>:<br>
<br>

   <p>There is no default value.  If no filenames are specified, no other filenames
will be included in the compilation process.

<div class="node">
<a name="version-in-common"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#lastseenexpireafter-in-common">lastseenexpireafter in common</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#inputs-in-common">inputs in common</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-common">control common</a>

</div>

<h4 class="subsection">5.1.6 <code>version</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Scalar version string for this configuration

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control
{
version => "1.2.3";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The version string is used in error messages and reports.

   <p>This string should not contain the colon &lsquo;<samp><span class="samp">:</span></samp>&rsquo; character, as this has a special
meaning in the context of knowledge management. This restriction might be lifted later.

<div class="node">
<a name="lastseenexpireafter-in-common"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#output_005fprefix-in-common">output_prefix in common</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#version-in-common">version in common</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-common">control common</a>

</div>

<h4 class="subsection">5.1.7 <code>lastseenexpireafter</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

<p class="noindent"><b>Default value:</b> One week

<p class="noindent"><b>Synopsis</b>: Number of minutes after which last-seen entries are purged

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control
{
lastseenexpireafter => "72";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Default time is one week.

<div class="node">
<a name="output_prefix-in-common"></a>
<a name="output_005fprefix-in-common"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#domain-in-common">domain in common</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#lastseenexpireafter-in-common">lastseenexpireafter in common</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-common">control common</a>

</div>

<h4 class="subsection">5.1.8 <code>output_prefix</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: The string prefix for standard output

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control
{
output_prefix => "my_cf3";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>On native Windows versions of CFEngine (Nova and above), this string
is also prefixed messages in the event log.

<div class="node">
<a name="domain-in-common"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#require_005fcomments-in-common">require_comments in common</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#output_005fprefix-in-common">output_prefix in common</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-common">control common</a>

</div>

<h4 class="subsection">5.1.9 <code>domain</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>.*</code>

<p class="noindent"><b>Synopsis</b>: Specify the domain name for this host

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control
{
domain => "example.org";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>There is no standard, universal or reliable way of determining the
DNS domain name of a host, so it can be set explicitly to simplify
discovery and name-lookup.

<div class="node">
<a name="require_comments-in-common"></a>
<a name="require_005fcomments-in-common"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#host_005flicenses_005fpaid-in-common">host_licenses_paid in common</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#domain-in-common">domain in common</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-common">control common</a>

</div>

<h4 class="subsection">5.1.10 <code>require_comments</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: Warn about promises that do not have comment documentation

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control

{
common::

require_comments => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This may be used as a policy Quality Assurance measure, to remind
policy makers to properly document their promises. When true,
<code>cf-promises</code> will report loudly on promises that do not have
comments. Variables promises are exempted from this
rule, since they may be considered self-documenting.

<div class="node">
<a name="host_licenses_paid-in-common"></a>
<a name="host_005flicenses_005fpaid-in-common"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#site_005fclasses-in-common">site_classes in common</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#require_005fcomments-in-common">require_comments in common</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-common">control common</a>

</div>

<h4 class="subsection">5.1.11 <code>host_licenses_paid</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

<p class="noindent"><b>Default value:</b> 0

<p class="noindent"><b>Synopsis</b>: The number of licenses that you promise to have paid for by setting this value (legally binding for commercial license)

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">body common control
{
host_licenses_paid => "1000";
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Licensees of the commercial CFEngine releases have to make a promise
in acceptance of contract terms by setting this value to the number of licenses
they have paid for. This is tallied with the number of licenses granted. 
This declaration should be placed in all separate configuration files, e.g. 
<samp><span class="file">failsafe.cf</span></samp>, <samp><span class="file">promises.cf</span></samp>.

<div class="node">
<a name="site_classes-in-common"></a>
<a name="site_005fclasses-in-common"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslog_005fhost-in-common">syslog_host in common</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#host_005flicenses_005fpaid-in-common">host_licenses_paid in common</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-common">control common</a>

</div>

<h4 class="subsection">5.1.12 <code>site_classes</code></h4>

<p class="noindent"><b>Type</b>: clist

<p class="noindent"><b>Allowed input range</b>: <code>[a-zA-Z0-9_!&amp;@@$|.()\[\]{}:]+</code>

<p class="noindent"><b>Synopsis</b>: A list of classes that will represent geographical site locations for hosts. These should be defined elsewhere in the configuration in a classes promise.

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">body common control
{
site_classes => { "datacenters","datacentres"  }; # locations is by default
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.2.0, Nova 2.1.0 (2011)

   <p>This list is used to match against topics when connecting inferences about host locations in the knowledge
map. Normally any CFEngine classes promise whose name is defined as a thing or topic under class <code>locations::</code>
will be assumed to be a location defining classifier. This list will add alternative class contexts
for interpreting location.

<div class="node">
<a name="syslog_host-in-common"></a>
<a name="syslog_005fhost-in-common"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslog_005fport-in-common">syslog_port in common</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#site_005fclasses-in-common">site_classes in common</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-common">control common</a>

</div>

<h4 class="subsection">5.1.13 <code>syslog_host</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>[a-zA-Z0-9_$(){}.:-]+</code>

<p class="noindent"><b>Default value:</b> 514

<p class="noindent"><b>Synopsis</b>: The name or address of a host to which syslog messages should be sent directly by UDP

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">body common control
{
syslog_host => "syslog.example.org";
syslog_port => "514";
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The hostname or IP address of a local syslog service to which all CFEngine's components
may promise to send data. This feature is provided in CFEngine Nova and above.

<div class="node">
<a name="syslog_port-in-common"></a>
<a name="syslog_005fport-in-common"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#fips_005fmode-in-common">fips_mode in common</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslog_005fhost-in-common">syslog_host in common</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-common">control common</a>

</div>

<h4 class="subsection">5.1.14 <code>syslog_port</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

<p class="noindent"><b>Synopsis</b>: The port number of a UDP syslog service

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">body common control
{
syslog_host => "syslog.example.org";
syslog_port => "514";
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The UDP port of a local syslog service to which all CFEngine's components
may promise to send data. This feature is provided in CFEngine Nova and above.

<div class="node">
<a name="fips_mode-in-common"></a>
<a name="fips_005fmode-in-common"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslog_005fport-in-common">syslog_port in common</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-common">control common</a>

</div>

<h4 class="subsection">5.1.15 <code>fips_mode</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: Activate full FIPS mode restrictions

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control
{
fips_mode => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Appears as of Nova 2.0. 
If CFEngine commercial editions this value may be set to avoid the use
of old deprecated algorithms that are no longer FIPS 140-2 compliant. 
If not set, there is some degree of compatibility with older versions and
algorithms. During an upgrade, setting this parameter can cause a lot of
recomputation of checksums etc. Government bodies starting with Nova 2.0
or higher should set this to &lsquo;<samp><span class="samp">true</span></samp>&rsquo; from the start.

<div class="node">
<a name="control-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#control-server">control server</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#control-common">control common</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Control-Promises">Control Promises</a>

</div>

<h3 class="section">5.2 <code>agent</code> control promises</h3>

<p><br>

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
     body agent control
     {
     123_456_789::
     
       domain =&gt; "mydomain.com";
     
     123_456_789_111::
     
       auditing =&gt; "true";
     
     any::
     
       fullencryption =&gt; "true";
     
     }
     
</pre>
   </td></tr></table>

   <p><br>

   <p>Settings describing the details of the fixed behavioural promises made by
<code>cf-agent</code>.

<ul class="menu">
<li><a accesskey="1" href="#abortclasses-in-agent">abortclasses in agent</a>
<li><a accesskey="2" href="#abortbundleclasses-in-agent">abortbundleclasses in agent</a>
<li><a accesskey="3" href="#addclasses-in-agent">addclasses in agent</a>
<li><a accesskey="4" href="#agentaccess-in-agent">agentaccess in agent</a>
<li><a accesskey="5" href="#agentfacility-in-agent">agentfacility in agent</a>
<li><a accesskey="6" href="#allclassesreport-in-agent">allclassesreport in agent</a>
<li><a accesskey="7" href="#alwaysvalidate-in-agent">alwaysvalidate in agent</a>
<li><a accesskey="8" href="#auditing-in-agent">auditing in agent</a>
<li><a accesskey="9" href="#binarypaddingchar-in-agent">binarypaddingchar in agent</a>
<li><a href="#bindtointerface-in-agent">bindtointerface in agent</a>
<li><a href="#hashupdates-in-agent">hashupdates in agent</a>
<li><a href="#childlibpath-in-agent">childlibpath in agent</a>
<li><a href="#checksum_005falert_005ftime-in-agent">checksum_alert_time in agent</a>
<li><a href="#defaultcopytype-in-agent">defaultcopytype in agent</a>
<li><a href="#dryrun-in-agent">dryrun in agent</a>
<li><a href="#editbinaryfilesize-in-agent">editbinaryfilesize in agent</a>
<li><a href="#editfilesize-in-agent">editfilesize in agent</a>
<li><a href="#environment-in-agent">environment in agent</a>
<li><a href="#exclamation-in-agent">exclamation in agent</a>
<li><a href="#expireafter-in-agent">expireafter in agent</a>
<li><a href="#files_005fsingle_005fcopy-in-agent">files_single_copy in agent</a>
<li><a href="#files_005fauto_005fdefine-in-agent">files_auto_define in agent</a>
<li><a href="#hostnamekeys-in-agent">hostnamekeys in agent</a>
<li><a href="#ifelapsed-in-agent">ifelapsed in agent</a>
<li><a href="#inform-in-agent">inform in agent</a>
<li><a href="#intermittency-in-agent">intermittency in agent</a>
<li><a href="#max_005fchildren-in-agent">max_children in agent</a>
<li><a href="#maxconnections-in-agent">maxconnections in agent</a>
<li><a href="#mountfilesystems-in-agent">mountfilesystems in agent</a>
<li><a href="#nonalphanumfiles-in-agent">nonalphanumfiles in agent</a>
<li><a href="#repchar-in-agent">repchar in agent</a>
<li><a href="#refresh_005fprocesses-in-agent">refresh_processes in agent</a>
<li><a href="#default_005frepository-in-agent">default_repository in agent</a>
<li><a href="#secureinput-in-agent">secureinput in agent</a>
<li><a href="#sensiblecount-in-agent">sensiblecount in agent</a>
<li><a href="#sensiblesize-in-agent">sensiblesize in agent</a>
<li><a href="#skipidentify-in-agent">skipidentify in agent</a>
<li><a href="#suspiciousnames-in-agent">suspiciousnames in agent</a>
<li><a href="#syslog-in-agent">syslog in agent</a>
<li><a href="#track_005fvalue-in-agent">track_value in agent</a>
<li><a href="#timezone-in-agent">timezone in agent</a>
<li><a href="#default_005ftimeout-in-agent">default_timeout in agent</a>
<li><a href="#verbose-in-agent">verbose in agent</a>
</ul>

<div class="node">
<a name="abortclasses-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#abortbundleclasses-in-agent">abortbundleclasses in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.1 <code>abortclasses</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: <code>.*</code>

<p class="noindent"><b>Synopsis</b>: A list of classes which if defined lead to termination of cf-agent

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
 body agent control

  {
  abortclasses => { "danger.*", "should_not_continue" };
  }

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>A list of class regular expressions that <code>cf-agent</code> will watch
out for. If any matching class becomes defined, it will cause the
current execution of <code>cf-agent</code> to be aborted. This may be used
for validation, for example. To handle class expressions, simply create
an alias for the expression with a single name.

<div class="node">
<a name="abortbundleclasses-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#addclasses-in-agent">addclasses in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#abortclasses-in-agent">abortclasses in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.2 <code>abortbundleclasses</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: <code>.*</code>

<p class="noindent"><b>Synopsis</b>: A list of classes which if defined lead to termination of current bundle

<p class="noindent"><b>Example</b>:<br>
<br>

   <p>This example shows how to use the feature to validate input to a method bundle.

<pre class="verbatim">
body common control

{
bundlesequence  => { "testbundle"  };
version => "1.2.3";
}

###########################################

body agent control

{
abortbundleclasses => { "invalid.*" };
}

###########################################

bundle agent testbundle
{
vars:

 "userlist" slist => { "xyz", "mark", "jeang", "jonhenrik", "thomas", "eben" };

methods:

 "any" usebundle => subtest("$(userlist)");

}

###########################################

bundle agent subtest(user)

{
classes:

  "invalid" not => regcmp("[a-z]{4}","$(user)");

reports:

 !invalid::

  "User name $(user) is valid at exactly 4 letters";

 # abortbundleclasses will prevent this from being evaluated
 invalid::

  "User name $(user) is invalid";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>A list of regular expressions for classes, or class expressions that
<code>cf-agent</code> will watch out for. If any of these classes becomes
defined, it will cause the current bundle to be aborted. This may be
used for validation, for example.

<div class="node">
<a name="addclasses-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#agentaccess-in-agent">agentaccess in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#abortbundleclasses-in-agent">abortbundleclasses in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.3 <code>addclasses</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: <code>.*</code>

<p class="noindent"><b>Synopsis</b>: A list of classes to be defined always in the current context

<p class="noindent"><b>Example</b>:<br>
<br>

   <p>Add classes adds global, literal classes. The only predicates available during the control
section are hard-classes.

<pre class="verbatim">
any::

  addclasses => { "My_Organization" }

solaris::

  addclasses => { "some_solaris_alive", "running_on_sunshine" };


</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Another place to make global aliases for system hardclasses. Classes
here are added unqeuivocally to the system. If classes are used to
predicate definition, then they must be defined in terms of global
hard classes.

<div class="node">
<a name="agentaccess-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#agentfacility-in-agent">agentfacility in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#addclasses-in-agent">addclasses in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.4 <code>agentaccess</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: <code>.*</code>

<p class="noindent"><b>Synopsis</b>: A list of user names allowed to execute cf-agent

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
 agentaccess => { "mark", "root", "sudo" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>A list of user names that will be allowed to attempt execution of the
current configuration. This is mainly a sanity check rather than a
security measure.

<div class="node">
<a name="agentfacility-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#allclassesreport-in-agent">allclassesreport in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#agentaccess-in-agent">agentaccess in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.5 <code>agentfacility</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>LOG_USER</code>
               <code>LOG_DAEMON</code>
               <code>LOG_LOCAL0</code>
               <code>LOG_LOCAL1</code>
               <code>LOG_LOCAL2</code>
               <code>LOG_LOCAL3</code>
               <code>LOG_LOCAL4</code>
               <code>LOG_LOCAL5</code>
               <code>LOG_LOCAL6</code>
               <code>LOG_LOCAL7</code>
</pre>
   <p class="noindent"><b>Default value:</b> LOG_USER

<p class="noindent"><b>Synopsis</b>: The syslog facility for cf-agent

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
agentfacility => "LOG_USER";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Sets the agent's syslog facility level. See the manual pages for
syslog.  This is ignored on Windows, as CFEngine Nova creates event logs.

<div class="node">
<a name="allclassesreport-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#alwaysvalidate-in-agent">alwaysvalidate in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#agentfacility-in-agent">agentfacility in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.6 <code>allclassesreport</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Synopsis</b>: Generate allclasses.txt report

<p class="noindent"><b>Example</b>:<br>
<br>
<pre class="verbatim">body agent control
{
allclassesreport => "true";
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in 3.2.0, Nova 2.1.0 (2011)

   <p>This option determines whether state/allclasses.txt file is written to
disk during agent execution. This functionality is retained only for
CFEngine 2 compatibility as more convenient facilities exist in
CFEngine 3 language to achieve similar results.

   <p>This option is turned off by default.

<div class="node">
<a name="alwaysvalidate-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#auditing-in-agent">auditing in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#allclassesreport-in-agent">allclassesreport in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.7 <code>alwaysvalidate</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Synopsis</b>: true/false flag to determine whether configurations will always be checked before executing, or only after updates

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
Min00_05::

  # revalidate once per hour, regardless of change in configuration

  alwaysvalidate => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.1.2,Nova 2.0.1 (2010)

   <p>The agents <code>cf-agent</code>, and <code>cfserverd</code> etc can run <code>cf-promises</code> to validate
inputs before attempting to execute a configuration. As of version 3.1.2 core, this only
happens if the configuration file has changed to save CPU cycles. When this attribute is set,
<code>cf-agent</code> will force a revalidation of the input.

<div class="node">
<a name="auditing-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#binarypaddingchar-in-agent">binarypaddingchar in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#alwaysvalidate-in-agent">alwaysvalidate in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.8 <code>auditing</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false flag to activate the cf-agent audit log

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
auditing  => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>If this is set, CFEngine will perform auditing on promises in the
current configuration. This means that all details surrounding the
verification of the current promise will be recorded in the audit
database. The database may be inspected with <code>cf-report</code>, or
<code>cfshow</code> in CFEngine 2.

<div class="node">
<a name="binarypaddingchar-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#bindtointerface-in-agent">bindtointerface in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#auditing-in-agent">auditing in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.9 <code>binarypaddingchar</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Default value:</b> space (ASC=32)

<p class="noindent"><b>Synopsis</b>: Character used to pad unequal replacements in binary editing

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
binarypaddingchar => "#";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>When editing binary files, it can be dangerous to replace a text
string with one that is longer or shorter as byte references and jumps
would be destroyed. CFEngine will therefore not allow replacements that
are larger in size than the original, but shorter strings can be padded
out to the same length.

<p class="noindent"><b>Default value</b>:<br>

   <p>The <code>binarypaddingchar</code> defaults to the empty string (i.e., no padding)

<div class="node">
<a name="bindtointerface-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#hashupdates-in-agent">hashupdates in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#binarypaddingchar-in-agent">binarypaddingchar in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.10 <code>bindtointerface</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>.*</code>

<p class="noindent"><b>Synopsis</b>: Use this interface for outgoing connections

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bindtointerface => "192.168.1.1";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>On multi-homed hosts, the server and client can bind
to a specific interface for server traffic. The IP address
of the interface must be given as the argument, not the device name.

<div class="node">
<a name="hashupdates-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#childlibpath-in-agent">childlibpath in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#bindtointerface-in-agent">bindtointerface in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.11 <code>hashupdates</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false whether stored hashes are updated when change is detected in source

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">body agent control
{
hashupdates => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>If &lsquo;<samp><span class="samp">true</span></samp>&rsquo; the stored reference value is updated as soon as a warning
message has been given. As most changes are benign (package updates etc)
this is a common setting.

<div class="node">
<a name="childlibpath-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#checksum_005falert_005ftime-in-agent">checksum_alert_time in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#hashupdates-in-agent">hashupdates in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.12 <code>childlibpath</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>.*</code>

<p class="noindent"><b>Synopsis</b>: LD_LIBRARY_PATH for child processes

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
childlibpath => "/usr/local/lib:/usr/local/gnu/lib";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This string may be used to set the internal <code>LD_LIBRARY_PATH</code>
environment of the agent.

<div class="node">
<a name="checksum_alert_time-in-agent"></a>
<a name="checksum_005falert_005ftime-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#defaultcopytype-in-agent">defaultcopytype in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#childlibpath-in-agent">childlibpath in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.13 <code>checksum_alert_time</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>0,60</code>

<p class="noindent"><b>Default value:</b> 10 mins

<p class="noindent"><b>Synopsis</b>: The persistence time for the checksum_alert class

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">body agent control
{
checksum_alert_time => "30";
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>When checksum changes trigger an alert, this is registered as a persistent class. 
This value determines the longevity of that class.

<div class="node">
<a name="defaultcopytype-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#dryrun-in-agent">dryrun in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#checksum_005falert_005ftime-in-agent">checksum_alert_time in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.14 <code>defaultcopytype</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>mtime</code>
               <code>atime</code>
               <code>ctime</code>
               <code>digest</code>
               <code>hash</code>
               <code>binary</code>
</pre>
   <p class="noindent"><b>Synopsis</b>: ctime or mtime differ

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
#...
defaultcopytype => "digest";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Sets the global default policy for comparing source and image in copy transactions.

<div class="node">
<a name="dryrun-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#editbinaryfilesize-in-agent">editbinaryfilesize in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#defaultcopytype-in-agent">defaultcopytype in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.15 <code>dryrun</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: All talk and no action mode

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
dryrun => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>If set in the configuration, CFEngine makes no changes to a
system, only reports what it needs to do.

<div class="node">
<a name="editbinaryfilesize-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#editfilesize-in-agent">editfilesize in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#dryrun-in-agent">dryrun in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.16 <code>editbinaryfilesize</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

<p class="noindent"><b>Default value:</b> 100000

<p class="noindent"><b>Synopsis</b>: Integer limit on maximum binary file size to be edited

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
edibinaryfilesize => "10M";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The global setting for the file-editing safety-net for binary files (this
value may be overridden on a per-promise basis with <code>max_file_size</code>,
See <a href="#edit_005fdefaults-in-files">edit_defaults in files</a>. The default value for <code>editbinaryfilesize</code>
is <code>100k</code>.  Note the use of special units is allowed,
See <a href="#Datatypes-in-CFEngine-3">Datatypes in CFEngine 3</a>, for a list of permissible suffixes.

   <p>When setting limits, the limit on editing binary files should generally be
set higher than for text files.

<div class="node">
<a name="editfilesize-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#environment-in-agent">environment in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#editbinaryfilesize-in-agent">editbinaryfilesize in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.17 <code>editfilesize</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

<p class="noindent"><b>Default value:</b> 100000

<p class="noindent"><b>Synopsis</b>: Integer limit on maximum text file size to be edited

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
editfilesize => "120k";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The global setting for the file-editing safety-net (this value may be
overridden on a per-promise basis with <code>max_file_size</code>,
See <a href="#edit_005fdefaults-in-files">edit_defaults in files</a>. Note the use of special units is
allowed, See <a href="#Datatypes-in-CFEngine-3">Datatypes in CFEngine 3</a>, for a list of permissible
suffixes.

<div class="node">
<a name="environment-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#exclamation-in-agent">exclamation in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#editfilesize-in-agent">editfilesize in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.18 <code>environment</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: <code>[A-Za-z0-9_]+=.*</code>

<p class="noindent"><b>Synopsis</b>: List of environment variables to be inherited by children

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control
{
bundlesequence => { "one" };
}

body agent control
{
environment => { "A=123", "B=456", "PGK_PATH=/tmp"};
}

bundle agent one
{
commands:

  "/usr/bin/env";
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This may be used to set the runtime environment of the agent process. The values of environment variables
are inherited by child commands. Some interactive programs insist on values being set, e.g.

<pre class="verbatim">
# Required by apt-cache, debian

environment => { "LANG=C"};

</pre>

<div class="node">
<a name="exclamation-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#expireafter-in-agent">expireafter in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#environment-in-agent">environment in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.19 <code>exclamation</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> true

<p class="noindent"><b>Synopsis</b>: true/false print exclamation marks during security warnings

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
exclamation => "false";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This affects only the output format of warnings.

<div class="node">
<a name="expireafter-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#files_005fsingle_005fcopy-in-agent">files_single_copy in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#exclamation-in-agent">exclamation in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.20 <code>expireafter</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

<p class="noindent"><b>Default value:</b> 1 min

<p class="noindent"><b>Synopsis</b>: Global default for time before on-going promise repairs are interrupted

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">body action example
{
ifelapsed   => "120";	# 2 hours
expireafter => "240";	# 4 hours
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The locking time after which CFEngine will attempt to kill and restart
its attempt to keep a promise.

<div class="node">
<a name="files_single_copy-in-agent"></a>
<a name="files_005fsingle_005fcopy-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#files_005fauto_005fdefine-in-agent">files_auto_define in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#expireafter-in-agent">expireafter in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.21 <code>files_single_copy</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: List of filenames to be watched for multiple-source conflicts

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
files_single_copy => { "/etc/.*", "/special/file" };
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This list of regular expressions will ensure that files matching the
patterns of the list are never copied from more than one source during
a single run of <code>cf-agent</code>. This may be considered a protection
against accidential overlap of copies from diverse remote sources, or
as a first-come-first-served disambiguation tool for lazy-evaluation
of overlapping file-copy promises.

<div class="node">
<a name="files_auto_define-in-agent"></a>
<a name="files_005fauto_005fdefine-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#hostnamekeys-in-agent">hostnamekeys in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#files_005fsingle_005fcopy-in-agent">files_single_copy in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.22 <code>files_auto_define</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: List of filenames to define classes if copied

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
files_auto_define => { "/etc/syslog\.c.*", "/etc/passwd" };
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Classes are automatically defined by the files that are copied.  The
file is named according to the prefixed `canonization' of the file
name.  Canonization means that non-identifier characters are converted
into underscores. Thus <samp><span class="file">/etc/passwd</span></samp> would canonize to
&lsquo;<samp><span class="samp">_etc_passwd</span></samp>&rsquo;. The prefix &lsquo;<samp><span class="samp">auto_</span></samp>&rsquo; is added to clarify the
origin of the class. Thus in the example the copying of
<samp><span class="file">/etc/passwd</span></samp> would lead to the class &lsquo;<samp><span class="samp">auto__etc_passwd</span></samp>&rsquo;
being defined automatically.

<div class="node">
<a name="hostnamekeys-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#ifelapsed-in-agent">ifelapsed in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#files_005fauto_005fdefine-in-agent">files_auto_define in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.23 <code>hostnamekeys</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false label ppkeys by hostname not IP address

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body server control
{
hostnamekeys => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Client side choice to base key associations on host names rather than IP address. 
This is useful for hosts with dynamic addresses.

   <p><b>This feature has been deprecated since 3.1.0.</b> Host identification is now handled
transparently.

<div class="node">
<a name="ifelapsed-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#inform-in-agent">inform in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#hostnamekeys-in-agent">hostnamekeys in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.24 <code>ifelapsed</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

<p class="noindent"><b>Default value:</b> 1

<p class="noindent"><b>Synopsis</b>: Global default for time that must elapse before promise will be rechecked

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
#local

body action example
{
ifelapsed   => "120";	# 2 hours
expireafter => "240";	# 4 hours
}

# global

body agent control
{
ifelapsed   => "180";	# 3 hours
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This overrides the global settings. Promises which take a long time to
verify should usually be protected with a long value for this
parameter.  This serves as a resource `spam' protection. A CFEngine
check could easily run every 5 minutes provided resource intensive
operations are not performed on every run. Using time classes like
<code>Hr12</code> etc., is one part of this strategy; using <code>ifelapsed</code>
is another which is not tied to a specific time.

<div class="node">
<a name="inform-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#intermittency-in-agent">intermittency in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#ifelapsed-in-agent">ifelapsed in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.25 <code>inform</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false set inform level default

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
inform => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Equivalent to (and when present, overrides) the command line option &lsquo;<samp><span class="samp">-I</span></samp>&rsquo;. 
Sets the default output level `permanently' within the class context indicated.

   <p>Every promiser makes an implicit default promise to use output settings declared
using <code>outputs</code> promises.

<div class="node">
<a name="intermittency-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#max_005fchildren-in-agent">max_children in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#inform-in-agent">inform in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.26 <code>intermittency</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: This option is deprecated, does nothing and is kept for backward compatibility

<p class="noindent"><b>Example</b>:<br>
<br>

<p class="noindent"><b>Notes</b>:<br>
<br>

<div class="node">
<a name="max_children-in-agent"></a>
<a name="max_005fchildren-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#maxconnections-in-agent">maxconnections in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#intermittency-in-agent">intermittency in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.27 <code>max_children</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

<p class="noindent"><b>Default value:</b> 1 concurrent agent promise

<p class="noindent"><b>Synopsis</b>: Maximum number of background tasks that should be allowed concurrently

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body runagent control
{
max_children => "10";
}

# or

body agent control
{
max_children => "10";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>For the run-agent this represents the maximum number of forked
background processes allowed when parallelizing connections to
servers. For the agent it represents the number of background jobs
allowed concurrently. Background jobs often lead to contention of
the disk resources slowing down tasks considerably; there is thus a law
of diminishing returns.

<div class="node">
<a name="maxconnections-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#mountfilesystems-in-agent">mountfilesystems in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#max_005fchildren-in-agent">max_children in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.28 <code>maxconnections</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

<p class="noindent"><b>Default value:</b> 30 remote queries

<p class="noindent"><b>Synopsis</b>: Maximum number of outgoing connections to cf-serverd

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
# client side 

body agent control
{
maxconnections => "1000";
}

# server side

body server control
{
maxconnections => "1000";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Watch out for kernel limitations for maximum numbers of open file descriptors
which can limit this.

<div class="node">
<a name="mountfilesystems-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#nonalphanumfiles-in-agent">nonalphanumfiles in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#maxconnections-in-agent">maxconnections in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.29 <code>mountfilesystems</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false mount any filesystems promised

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
mountfilesystems => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Issues the generic command to mount file systems defined in the file system table.

<div class="node">
<a name="nonalphanumfiles-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#repchar-in-agent">repchar in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#mountfilesystems-in-agent">mountfilesystems in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.30 <code>nonalphanumfiles</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false warn about filenames with no alphanumeric content

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
nonalphanumfiles => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This test is applied in all recursive/depth searches.

<div class="node">
<a name="repchar-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#refresh_005fprocesses-in-agent">refresh_processes in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#nonalphanumfiles-in-agent">nonalphanumfiles in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.31 <code>repchar</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>.</code>

<p class="noindent"><b>Default value:</b> _

<p class="noindent"><b>Synopsis</b>: The character used to canonize pathnames in the file repository

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
repchar => "_";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

<div class="node">
<a name="refresh_processes-in-agent"></a>
<a name="refresh_005fprocesses-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#default_005frepository-in-agent">default_repository in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#repchar-in-agent">repchar in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.32 <code>refresh_processes</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: <code>[a-zA-Z0-9_$(){}\[\].:]+</code>

<p class="noindent"><b>Synopsis</b>: Reload the process table before verifying the bundles named in this list (lazy evaluation)

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
refresh_processes => { "mybundle" };
#refresh_processes => { "none" };
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.1.3,Nova 2.0.2 (2010)

   <p>If this list of regular expressions is non-null and an existing bundle
is mentioned or matched in this list, CFEngine will reload the process table at
the start of the named bundle, each time is is scheduled.  If the list
is null, the process list will be reloaded at the start of every
scheduled bundle.

   <p>In the example above we use a non-empty list with the name `none'. 
This is not a reserved word, but as long as there are no bundles with the name `none'
this has the effect of <i>never</i> reloading the process table. This keeps improves the
efficiency of the agent.

<div class="node">
<a name="default_repository-in-agent"></a>
<a name="default_005frepository-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#secureinput-in-agent">secureinput in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#refresh_005fprocesses-in-agent">refresh_processes in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.33 <code>default_repository</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>"?(/.*)</code>

<p class="noindent"><b>Default value:</b> in situ

<p class="noindent"><b>Synopsis</b>: Path to the default file repository

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
default_repository => "/var/cfengine/repository";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>If defined the default repository is the location where versions of
files altered by CFEngine are stored. This should be understood in
relation to the policy for &lsquo;<samp><span class="samp">backup</span></samp>&rsquo; in copying, editing etc.  If
the backups are time-stamped, this becomes effective a version control
repository.  See also <a href="#repository-in-files">repository</a> for a way
to locally override the global repository.

   <p>Note that when a repository is specified, the files are stored using the
canonified directory name of the original file, concatenated with the name of
the file.  So, for example, <samp><span class="file">/usr/local/etc/postfix.conf</span></samp> would ordinarily
be stored in an alternative repository as
<samp><span class="file">_usr_local_etc_postfix.conf.cfsaved</span></samp>.

<div class="node">
<a name="secureinput-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#sensiblecount-in-agent">sensiblecount in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#default_005frepository-in-agent">default_repository in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.34 <code>secureinput</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false check whether input files are writable by unauthorized users

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
secureinput => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>If this is set, the agent will not accept an input file that is not owned
by a privileged user.

<div class="node">
<a name="sensiblecount-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#sensiblesize-in-agent">sensiblesize in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#secureinput-in-agent">secureinput in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.35 <code>sensiblecount</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

<p class="noindent"><b>Default value:</b> 2 files

<p class="noindent"><b>Synopsis</b>: Minimum number of files a mounted filesystem is expected to have

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control 
{
sensiblecount => "20";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

<div class="node">
<a name="sensiblesize-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#skipidentify-in-agent">skipidentify in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#sensiblecount-in-agent">sensiblecount in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.36 <code>sensiblesize</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

<p class="noindent"><b>Default value:</b> 1000 bytes

<p class="noindent"><b>Synopsis</b>: Minimum number of bytes a mounted filesystem is expected to have

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
sensiblesize => "20K";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

<div class="node">
<a name="skipidentify-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#suspiciousnames-in-agent">suspiciousnames in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#sensiblesize-in-agent">sensiblesize in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.37 <code>skipidentify</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: Do not send IP/name during server connection because address resolution is broken

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
skipidentify => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Hosts that are not registered in DNS cannot supply reasonable credentials
for a secondary confirmation of their identity to a CFEngine server. This
causes the agent to ignore its missing DNS credentials.

<div class="node">
<a name="suspiciousnames-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslog-in-agent">syslog in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#skipidentify-in-agent">skipidentify in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.38 <code>suspiciousnames</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: List of names to warn about if found during any file search

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
suspiciousnames => { ".mo", "lrk3", "rootkit" };
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>If CFEngine sees these names during recursive (depth) file searches it will
warn about them.

<div class="node">
<a name="syslog-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#track_005fvalue-in-agent">track_value in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#suspiciousnames-in-agent">suspiciousnames in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.39 <code>syslog</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false switches on output to syslog at the inform level

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
syslog => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

<div class="node">
<a name="track_value-in-agent"></a>
<a name="track_005fvalue-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#timezone-in-agent">timezone in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslog-in-agent">syslog in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.40 <code>track_value</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false switches on tracking of promise valuation

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
track_value => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>If this is true, CFEngine generates a log in
<samp><span class="file">WORKDIR/state/cf_value.log</span></samp> of the estmated `business value' of
the system automation as a running log, <code>value_kept</code>, etc.  The
format of the file is
<pre class="verbatim">date,sum value kept,sum value repaired,sum value notkept
</pre>

<div class="node">
<a name="timezone-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#default_005ftimeout-in-agent">default_timeout in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#track_005fvalue-in-agent">track_value in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.41 <code>timezone</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: List of allowed timezones this machine must comply with

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
timezone => { "MET", "CET", "GMT+1" };
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

<div class="node">
<a name="default_timeout-in-agent"></a>
<a name="default_005ftimeout-in-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#verbose-in-agent">verbose in agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#timezone-in-agent">timezone in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.42 <code>default_timeout</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

<p class="noindent"><b>Default value:</b> 10 seconds

<p class="noindent"><b>Synopsis</b>: Maximum time a network connection should attempt to connect

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
default_timeout => "10";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The time is in seconds. It is not a guaranteed number, since it
depends on system behaviour. under Linux, the kernel version plays a
role, since not all system calls seem to respect the signals.

<div class="node">
<a name="verbose-in-agent"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#default_005ftimeout-in-agent">default_timeout in agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-agent">control agent</a>

</div>

<h4 class="subsection">5.2.43 <code>verbose</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false switches on verbose standard output

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
verbose => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Equivalent to (and when present, overrides) the command line option &lsquo;<samp><span class="samp">-v</span></samp>&rsquo;. 
Sets the default output level `permanently' for this promise.

   <p>Every promiser makes an implicit default promise to use output settings declared
using <code>outputs</code> promises.

<div class="node">
<a name="control-server"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#control-monitor">control monitor</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#control-agent">control agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Control-Promises">Control Promises</a>

</div>

<h3 class="section">5.3 <code>server</code> control promises</h3>

<p><br>

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
     body server control
     
     {
     allowconnects         =&gt; { "127.0.0.1" , "::1" ,  ".*\.example\.org" };
     allowallconnects      =&gt; { "127.0.0.1" , "::1" ,  ".*\.example\.org" };
     
     # Uncomment me under controlled circumstances
     #trustkeysfrom         =&gt; { "127.0.0.1" , "::1" ,  ".*\.example\.org" };
     }
     
</pre>
   </td></tr></table>

   <p><br>

   <p>Settings describing the details of the fixed behavioural promises made by
<code>cf-serverd</code>. 
Server controls are mainly about determining access policy for the
connection protocol: i.e. access to the server itself. Access to
specific files must be granted in addition.

<ul class="menu">
<li><a accesskey="1" href="#allowallconnects-in-server">allowallconnects in server</a>
<li><a accesskey="2" href="#allowconnects-in-server">allowconnects in server</a>
<li><a accesskey="3" href="#allowusers-in-server">allowusers in server</a>
<li><a accesskey="4" href="#auditing-in-server">auditing in server</a>
<li><a accesskey="5" href="#bindtointerface-in-server">bindtointerface in server</a>
<li><a accesskey="6" href="#cfruncommand-in-server">cfruncommand in server</a>
<li><a accesskey="7" href="#call_005fcollect_005finterval-in-server">call_collect_interval in server</a>
<li><a accesskey="8" href="#collect_005fwindow-in-server">collect_window in server</a>
<li><a accesskey="9" href="#denybadclocks-in-server">denybadclocks in server</a>
<li><a href="#denyconnects-in-server">denyconnects in server</a>
<li><a href="#dynamicaddresses-in-server">dynamicaddresses in server</a>
<li><a href="#hostnamekeys-in-server">hostnamekeys in server</a>
<li><a href="#keycacheTTL-in-server">keycacheTTL in server</a>
<li><a href="#logallconnections-in-server">logallconnections in server</a>
<li><a href="#logencryptedtransfers-in-server">logencryptedtransfers in server</a>
<li><a href="#maxconnections-in-server">maxconnections in server</a>
<li><a href="#port-in-server">port in server</a>
<li><a href="#serverfacility-in-server">serverfacility in server</a>
<li><a href="#skipverify-in-server">skipverify in server</a>
<li><a href="#trustkeysfrom-in-server">trustkeysfrom in server</a>
<li><a href="#listen-in-server">listen in server</a>
</ul>

<div class="node">
<a name="allowallconnects-in-server"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#allowconnects-in-server">allowconnects in server</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-server">control server</a>

</div>

<h4 class="subsection">5.3.1 <code>allowallconnects</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: List of IPs or hostnames that may have more than one connection to the server port

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
allowallconnects      => { 
                         "127.0.0.1", 
                         "::1", 
                         "200\.1\.10\..*", 
                         "host\.domain\.tld", 
                         "host[0-9]+\.domain\.com" 
                         };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This list of regular expressions matches hosts that are allowed to
connect an umlimited number of times up to the maximum connection
limit. Without this, a host may only connect once (which is a very
strong constraint, as the host must wait for the TCP FIN_WAIT to
expire before reconnection can be attempted).

   <p>In CFEngine 2 this corresponds to <code>AllowMultipleConnectionsFrom</code>.

   <p>Note that <code>127.0.0.1</code> is a regular expression (i.e., &ldquo;127 any character
0 any character 0 any character 1&rdquo;), but this will only match the IP address
<code>127.0.0.1</code>.  Take care with IP addresses and domain names, as the
hostname regular expression <code>www.domain.com</code> will potentially match more
than one hostname (e.g., <code>wwwxdomain.com</code>, in addition to the desired
hostname <code>www.domain.com</code>).

<div class="node">
<a name="allowconnects-in-server"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#allowusers-in-server">allowusers in server</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#allowallconnects-in-server">allowallconnects in server</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-server">control server</a>

</div>

<h4 class="subsection">5.3.2 <code>allowconnects</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: List of IPs or hostnames that may connect to the server port

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
allowconnects         => { 
                         "127.0.0.1", 
                         "::1", 
                         "200\.1\.10\..*", 
                         "host\.domain\.tld", 
                         "host[0-9]+\.domain\.com" 
                         };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>If a client's identity matches an entry in this list it is granted to
permission to send data to the server port. Clients who are not in this
list may not connect or send data to the server.

   <p>See also the warning about regular expressions in <code>allowallconnects</code>.

<div class="node">
<a name="allowusers-in-server"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#auditing-in-server">auditing in server</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#allowconnects-in-server">allowconnects in server</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-server">control server</a>

</div>

<h4 class="subsection">5.3.3 <code>allowusers</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: List of usernames who may execute requests from this server

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
allowusers => { "cfengine", "root" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The usernames listed in this list are those asserted as public key
identities during client-server connections. These may or may not
correspond to system identities on the server-side system.

<div class="node">
<a name="auditing-in-server"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#bindtointerface-in-server">bindtointerface in server</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#allowusers-in-server">allowusers in server</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-server">control server</a>

</div>

<h4 class="subsection">5.3.4 <code>auditing</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false activate auditing of server connections

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body agent control
{
auditing  => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>If this is set, CFEngine will perform auditing on promises in the
current configuration. This means that all details surrounding the
verification of the current promise will be recorded in the audit
database. The database may be inspected with <code>cf-report</code>, or
<code>cfshow</code> in CFEngine 2.

<div class="node">
<a name="bindtointerface-in-server"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#cfruncommand-in-server">cfruncommand in server</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#auditing-in-server">auditing in server</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-server">control server</a>

</div>

<h4 class="subsection">5.3.5 <code>bindtointerface</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: IP of the interface to which the server should bind on multi-homed hosts

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bindtointerface => "192.168.1.1";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>On multi-homed hosts, the server and client can bind
to a specific interface for server traffic. The IP address
of the interface must be given as the argument, not the device name.

<div class="node">
<a name="cfruncommand-in-server"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#call_005fcollect_005finterval-in-server">call_collect_interval in server</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#bindtointerface-in-server">bindtointerface in server</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-server">control server</a>

</div>

<h4 class="subsection">5.3.6 <code>cfruncommand</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>.+</code>

<p class="noindent"><b>Synopsis</b>: Path to the cf-agent command or cf-execd wrapper for remote execution

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body server control

{
cfruncommand => "/var/cfengine/bin/cf-agent";
}


</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>It is normal for this to point to the location of <code>cf-agent</code> but
it could also point to the <code>cf-execd</code>, or even another program or
shell command at your own risk.

<div class="node">
<a name="call_collect_interval-in-server"></a>
<a name="call_005fcollect_005finterval-in-server"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#collect_005fwindow-in-server">collect_window in server</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#cfruncommand-in-server">cfruncommand in server</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-server">control server</a>

</div>

<h4 class="subsection">5.3.7 <code>call_collect_interval</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

<p class="noindent"><b>Synopsis</b>: The interval in minutes in between collect calls to the policy hub offering a tunnel for report collection (Enterprise)

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
call_collect_interval => "5";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in 3.4.0, Enterprise 3.0.0 (2012)

   <p>If option time is set, it causes the server daemon to peer with a policy
hub by attempting a connection at regular intervals of the value of the
parameter in minutes.

   <p>This feature is designed to allow Enterprise report collection from
hosts that are not directly addressable from a hub data-aggregation
process.  For example, if some of the clients of a policy hub are
behind a network address translator then the hub is not able to open a
channel to address them directly. The effect is to place a `collect
call' with the policy hub.

   <p>If this option is set, the client's cf-serverd will `peer' with the
server daemon on a policy hub. This means that, cf-serverd on an
unreachable (e.g. NATed) host will attempt to report in to the
cf-serverd on its assigned policy hub and offer it a short time window
in which to download reports over the established connection. The
effect is to establish a temporary secure tunnel between hosts,
initiated from the satellite host end. The connection is made in such
a way that host autonomy is not compromised. Either hub may refuse or
decline to play their role at any time, in the usual way (avoiding DOS
attacks). Normal access controls must be set for communication in both
directions.

   <p>Collect calling cannot be as efficient as data collection by the
cf-hub, as the hub is not able to load balance.  Hosts that use this
approach should exclude themselves from the cf-hub data collection.

   <p>The sequence of events is this:

     <ul>
<li>Satellite cf-serverd connects to its registered policy hub
<li>The satellite indentifies itself to authentication and access control
and sends a collect-call `pull' request to the hub
<li>The hub might honour this, if the access control grants access. 
<li>If access is granted, the hub has <code>collect_window</code> seconds
to initiate a query to the satellite for its reports. 
<li>The policy hub indentifies itself to authentication and access control
and sends a query request to the hub to collect the reports. 
<li>When finished the satellite closes the tunnel. 
</ul>

   <p>The full configuration would look something like this
<pre class="verbatim">
#########################################################
# Server config
#########################################################

body server control 

{
allowconnects         => { "10.10.10" , "::1" };
allowallconnects      => { "10.10.10" , "::1" };
trustkeysfrom         => { "10.10.10" , "::1" };

call_collect_interval => "5";
}

#########################################################

bundle server access_rules()

{
access:

  policy_hub::

   "collect_calls"
       resource_type => "query",
             admit   => { "10.10.10" }; # the apparent NAT address of the satellite

  satellite_hosts::
 
    "delta"
            comment => "Grant access to cfengine hub to collect report deltas",
      resource_type => "query",
            admit   => { "policy_hub" };

    "full"
            comment => "Grant access to cfengine hub to collect full report dump",
      resource_type => "query",
            admit   => { "policy_hub"  };
}


</pre>

<div class="node">
<a name="collect_window-in-server"></a>
<a name="collect_005fwindow-in-server"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#denybadclocks-in-server">denybadclocks in server</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#call_005fcollect_005finterval-in-server">call_collect_interval in server</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-server">control server</a>

</div>

<h4 class="subsection">5.3.8 <code>collect_window</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

<p class="noindent"><b>Synopsis</b>: A time in seconds that a collect-call tunnel remains open to a hub to attempt a report transfer before it is closed (Enterprise)

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
collect_window => "15";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in 3.4.0, Enterprise 3.0.0 (2012)

   <p>The time is measured in seconds, default value 10s.

<div class="node">
<a name="denybadclocks-in-server"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#denyconnects-in-server">denyconnects in server</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#collect_005fwindow-in-server">collect_window in server</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-server">control server</a>

</div>

<h4 class="subsection">5.3.9 <code>denybadclocks</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> true

<p class="noindent"><b>Synopsis</b>: true/false accept connections from hosts with clocks that are out of sync

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body server control
{
#..
denybadclocks => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>A possible form of attack on the fileserver is to request files based
on time by setting the clocks incorrectly. This option prevents
connections from clients whose clocks are drifting too far from the
server clock (where "too far" is currently defined as "more than an hour
off"). This serves as a warning about clock asynchronization
and also a protection against Denial of Service attempts based on
clock corruption.

<div class="node">
<a name="denyconnects-in-server"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#dynamicaddresses-in-server">dynamicaddresses in server</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#denybadclocks-in-server">denybadclocks in server</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-server">control server</a>

</div>

<h4 class="subsection">5.3.10 <code>denyconnects</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: List of IPs or hostnames that may NOT connect to the server port

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">body server control
{
denyconnects => { "badhost\.domain\.evil", "host3\.domain\.com" };
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Hosts or IP addresses that are explicitly denied access. This should
only be used in special circumstances.  One should never grant generic
access to everything and then deny special cases. Since the default
server behaviour is to grant no access to anything, this list is
unnecessary unless you have already granted access to some set of
hosts using a generic pattern, to which you intend to make an exception.

   <p>See also the warning about regular expressions in <code>allowallconnects</code>.

<div class="node">
<a name="dynamicaddresses-in-server"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#hostnamekeys-in-server">hostnamekeys in server</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#denyconnects-in-server">denyconnects in server</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-server">control server</a>

</div>

<h4 class="subsection">5.3.11 <code>dynamicaddresses</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: List of IPs or hostnames for which the IP/name binding is expected to change

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body server control
{
dynamicaddresses => { "dhcp_.*" };
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The addresses or hostnames here are expected to have non-permanent
address-name bindings, we must therefor work harder to determine
whether hosts credentials are trusted by looking for existing public
keys in files that do not match the current hostname or IP.

   <p><b>This feature has been deprecated since 3.1.0.</b> This is now handled transparently.

<div class="node">
<a name="hostnamekeys-in-server"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#keycacheTTL-in-server">keycacheTTL in server</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#dynamicaddresses-in-server">dynamicaddresses in server</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-server">control server</a>

</div>

<h4 class="subsection">5.3.12 <code>hostnamekeys</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false store keys using hostname lookup instead of IP addresses

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body server control
{
hostnamekeys => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Client side choice to base key associations on host names rather than IP address. 
This is useful for hosts with dynamic addresses.

   <p><b>This feature has been deprecated since 3.1.0.</b> Host identification is now handled
transparently.

<div class="node">
<a name="keycacheTTL-in-server"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#logallconnections-in-server">logallconnections in server</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#hostnamekeys-in-server">hostnamekeys in server</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-server">control server</a>

</div>

<h4 class="subsection">5.3.13 <code>keycacheTTL</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

<p class="noindent"><b>Default value:</b> 24

<p class="noindent"><b>Synopsis</b>: Maximum number of hours to hold public keys in the cache

<p class="noindent"><b>Example</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.1.0b1,Nova 2.0.0b1 (2010)

<pre class="verbatim">
body server control
{
keycacheTTL => "24";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.1.0b1,Nova 2.0.0b1 (2010)

<div class="node">
<a name="logallconnections-in-server"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#logencryptedtransfers-in-server">logencryptedtransfers in server</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#keycacheTTL-in-server">keycacheTTL in server</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-server">control server</a>

</div>

<h4 class="subsection">5.3.14 <code>logallconnections</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false causes the server to log all new connections to syslog

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body server control
{
logallconnections => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>If set, the server will record connection attempts in syslog.

<div class="node">
<a name="logencryptedtransfers-in-server"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#maxconnections-in-server">maxconnections in server</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#logallconnections-in-server">logallconnections in server</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-server">control server</a>

</div>

<h4 class="subsection">5.3.15 <code>logencryptedtransfers</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false log all successful transfers required to be encrypted

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body server control
{
logencryptedtransfers => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>If true the server will log all transfers of files which the server
requires to encrypted in order to grant access (see
<code>ifencrypted</code>) to syslog. These files are deemed to be
particularly sensitive.

<div class="node">
<a name="maxconnections-in-server"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#port-in-server">port in server</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#logencryptedtransfers-in-server">logencryptedtransfers in server</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-server">control server</a>

</div>

<h4 class="subsection">5.3.16 <code>maxconnections</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

<p class="noindent"><b>Default value:</b> 30 remote queries

<p class="noindent"><b>Synopsis</b>: Maximum number of connections that will be accepted by cf-serverd

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
# client side 

body agent control
{
maxconnections => "1000";
}

# server side

body server control
{
maxconnections => "1000";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Watch out for kernel limitations for maximum numbers of open file descriptors
which can limit this.

<div class="node">
<a name="port-in-server"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#serverfacility-in-server">serverfacility in server</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#maxconnections-in-server">maxconnections in server</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-server">control server</a>

</div>

<h4 class="subsection">5.3.17 <code>port</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>1024,99999</code>

<p class="noindent"><b>Default value:</b> 5308

<p class="noindent"><b>Synopsis</b>: Default port for cfengine server

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body hub control
{
port => "5308";
}

body server control
{
specialhost::
 port => "5308";

!specialhost::
 port => "5308";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The standard or registered port number is tcp/5308. CFEngine does not
presently use its registered udp port with the same number, but this
could change in the future.

   <p>Changing the standard port number is not recommended practice. You should
not do it without a good reason.

<div class="node">
<a name="serverfacility-in-server"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#skipverify-in-server">skipverify in server</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#port-in-server">port in server</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-server">control server</a>

</div>

<h4 class="subsection">5.3.18 <code>serverfacility</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>LOG_USER</code>
               <code>LOG_DAEMON</code>
               <code>LOG_LOCAL0</code>
               <code>LOG_LOCAL1</code>
               <code>LOG_LOCAL2</code>
               <code>LOG_LOCAL3</code>
               <code>LOG_LOCAL4</code>
               <code>LOG_LOCAL5</code>
               <code>LOG_LOCAL6</code>
               <code>LOG_LOCAL7</code>
</pre>
   <p class="noindent"><b>Default value:</b> LOG_USER

<p class="noindent"><b>Synopsis</b>: Menu option for syslog facility level

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body server control
{
serverfacility => "LOG_USER";
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>See syslog notes.

<div class="node">
<a name="skipverify-in-server"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#trustkeysfrom-in-server">trustkeysfrom in server</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#serverfacility-in-server">serverfacility in server</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-server">control server</a>

</div>

<h4 class="subsection">5.3.19 <code>skipverify</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: List of IPs or hostnames for which we expect no DNS binding and cannot verify

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body server control
{
skipverify => { "special_host.*", "192.168\..*" };
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Server side decision to ignore requirements of DNS identity confirmation.

   <p>See also the warning about regular expressions in <code>allowallconnects</code>.

<div class="node">
<a name="trustkeysfrom-in-server"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#listen-in-server">listen in server</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#skipverify-in-server">skipverify in server</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-server">control server</a>

</div>

<h4 class="subsection">5.3.20 <code>trustkeysfrom</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: List of IPs from whom we accept public keys on trust

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body server control
{
trustkeysfrom => { "10\.0\.1\.1", "192\.168\..*"};
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>If connecting clients' public keys have not already been trusted, this
allows us to say `yes' to accepting the keys on trust. Normally this
should be an empty list except in controlled circumstances.

   <p>See also the warning about regular expressions in <code>allowallconnects</code>.

<div class="node">
<a name="listen-in-server"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#trustkeysfrom-in-server">trustkeysfrom in server</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-server">control server</a>

</div>

<h4 class="subsection">5.3.21 <code>listen</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> true

<p class="noindent"><b>Synopsis</b>: true/false enable server deamon to listen on defined port

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body server control
{
 
  listening_host_context::
    listen => "true";

  !listening_host_context::
    listen => "false";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in 3.4.0, Enterprise 3.0 (2012)

   <p>This attribute allows to disable <code>cf-serverd</code> from listening on any port. Should be used in conjunction with <code>call_collect_interval</code>.

   <p>This setting only applies to CFEngine clients, the policy hub will not be affected. Changing this setting requires a restart of <code>cf-serverd</code> for the change to take effect.

<div class="node">
<a name="control-monitor"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#control-runagent">control runagent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#control-server">control server</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Control-Promises">Control Promises</a>

</div>

<h3 class="section">5.4 <code>monitor</code> control promises</h3>

<p><br>

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
     body monitor control()
        {
        #version =&gt; "1.2.3.4";
     
        forgetrate =&gt; "0.7";
        tcpdump =&gt; "false";
        tcpdumpcommand =&gt; "/usr/sbin/tcpdump -i eth1 -n -t -v";
     
        }
     
</pre>
   </td></tr></table>

   <p><br>

   <p>Settings describing the details of the fixed behavioural promises made by
<code>cf-monitord</code>. 
The system defaults will be sufficient for most users. This
configurability potential, however, will be a key to developing the
integrated monitoring capabilities of CFEngine.

<ul class="menu">
<li><a accesskey="1" href="#forgetrate-in-monitor">forgetrate in monitor</a>
<li><a accesskey="2" href="#monitorfacility-in-monitor">monitorfacility in monitor</a>
<li><a accesskey="3" href="#histograms-in-monitor">histograms in monitor</a>
<li><a accesskey="4" href="#tcpdump-in-monitor">tcpdump in monitor</a>
<li><a accesskey="5" href="#tcpdumpcommand-in-monitor">tcpdumpcommand in monitor</a>
</ul>

<div class="node">
<a name="forgetrate-in-monitor"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#monitorfacility-in-monitor">monitorfacility in monitor</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-monitor">control monitor</a>

</div>

<h4 class="subsection">5.4.1 <code>forgetrate</code></h4>

<p class="noindent"><b>Type</b>: real

<p class="noindent"><b>Allowed input range</b>: <code>0,1</code>

<p class="noindent"><b>Default value:</b> 0.6

<p class="noindent"><b>Synopsis</b>: Decimal fraction [0,1] weighting of new values over old in 2d-average computation

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body monitor control
{
forgetrate => "0.7";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Configurable settings for the machine-learning algorithm that
tracks system behaviour. This is only for expert users. This parameter
effectively determines (together with the monitoring rate) how
quickly CFEngine forgets its previous history.

<div class="node">
<a name="monitorfacility-in-monitor"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#histograms-in-monitor">histograms in monitor</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#forgetrate-in-monitor">forgetrate in monitor</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-monitor">control monitor</a>

</div>

<h4 class="subsection">5.4.2 <code>monitorfacility</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>LOG_USER</code>
               <code>LOG_DAEMON</code>
               <code>LOG_LOCAL0</code>
               <code>LOG_LOCAL1</code>
               <code>LOG_LOCAL2</code>
               <code>LOG_LOCAL3</code>
               <code>LOG_LOCAL4</code>
               <code>LOG_LOCAL5</code>
               <code>LOG_LOCAL6</code>
               <code>LOG_LOCAL7</code>
</pre>
   <p class="noindent"><b>Default value:</b> LOG_USER

<p class="noindent"><b>Synopsis</b>: Menu option for syslog facility

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body monitor control
{
monitorfacility => "LOG_USER";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>See notes for syslog.

<div class="node">
<a name="histograms-in-monitor"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#tcpdump-in-monitor">tcpdump in monitor</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#monitorfacility-in-monitor">monitorfacility in monitor</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-monitor">control monitor</a>

</div>

<h4 class="subsection">5.4.3 <code>histograms</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> true

<p class="noindent"><b>Synopsis</b>: Ignored, kept for backward compatibility

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body monitor control
{
histograms => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><code>cf-monitord</code> now always keeps histograms information, so this
option is a no-op kept for backward compatibility. It used to cause
CFEngine to learn the conformally transformed distributions of
fluctuations about the mean.

<div class="node">
<a name="tcpdump-in-monitor"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#tcpdumpcommand-in-monitor">tcpdumpcommand in monitor</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#histograms-in-monitor">histograms in monitor</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-monitor">control monitor</a>

</div>

<h4 class="subsection">5.4.4 <code>tcpdump</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false use tcpdump if found

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body monitor control
{
tcpdump => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Interface with TCP stream if possible.

<div class="node">
<a name="tcpdumpcommand-in-monitor"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#tcpdump-in-monitor">tcpdump in monitor</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-monitor">control monitor</a>

</div>

<h4 class="subsection">5.4.5 <code>tcpdumpcommand</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>"?(/.*)</code>

<p class="noindent"><b>Synopsis</b>: Path to the tcpdump command on this system

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body monitor control
{
tcpdumpcommand => "/usr/sbin/tcpdump -i eth1";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>If this is defined, the monitor will try to interface with the TCP stream and
monitor generic package categories for anomalies.

<div class="node">
<a name="control-runagent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#control-executor">control executor</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#control-monitor">control monitor</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Control-Promises">Control Promises</a>

</div>

<h3 class="section">5.5 <code>runagent</code> control promises</h3>

<p><br>

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
     body runagent control
     {
     # default port is 5308
     
     hosts =&gt; { "127.0.0.1:5308", "eternity.iu.hio.no:80", "slogans.iu.hio.no" };
     
     #output_to_file =&gt; "true";
     }
     
</pre>
   </td></tr></table>

   <p><br>

   <p>Settings describing the details of the fixed behavioural promises made by
<code>cf-runagent</code>. 
The most important parameter here is the list of hosts that the agent
will poll for connections. This is easily read in from a file list,
however when doing so always have a stable input source that does not
depend on the network (including a database or directory service) in
any way: introducing such dependencies makes configuration brittle.

<ul class="menu">
<li><a accesskey="1" href="#hosts-in-runagent">hosts in runagent</a>
<li><a accesskey="2" href="#port-in-runagent">port in runagent</a>
<li><a accesskey="3" href="#force_005fipv4-in-runagent">force_ipv4 in runagent</a>
<li><a accesskey="4" href="#trustkey-in-runagent">trustkey in runagent</a>
<li><a accesskey="5" href="#encrypt-in-runagent">encrypt in runagent</a>
<li><a accesskey="6" href="#background_005fchildren-in-runagent">background_children in runagent</a>
<li><a accesskey="7" href="#max_005fchildren-in-runagent">max_children in runagent</a>
<li><a accesskey="8" href="#output_005fto_005ffile-in-runagent">output_to_file in runagent</a>
<li><a accesskey="9" href="#output_005fdirectory-in-runagent">output_directory in runagent</a>
<li><a href="#timeout-in-runagent">timeout in runagent</a>
</ul>

<div class="node">
<a name="hosts-in-runagent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#port-in-runagent">port in runagent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-runagent">control runagent</a>

</div>

<h4 class="subsection">5.5.1 <code>hosts</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: List of host or IP addresses to attempt connection with

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body runagent control
{
network1::
  hosts => { "host1.example.org", "host2", "host3" };

network2::
  hosts => { "host1.example.com", "host2", "host3" };
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The complete list of contactable hosts. The values may be either
numerical IP addresses or DNS names, optionally suffixed by a &lsquo;<samp><span class="samp">:</span></samp>&rsquo;
and a port number. If no port number is given, the default CFEngine
port 5308 is assumed.

<div class="node">
<a name="port-in-runagent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#force_005fipv4-in-runagent">force_ipv4 in runagent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#hosts-in-runagent">hosts in runagent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-runagent">control runagent</a>

</div>

<h4 class="subsection">5.5.2 <code>port</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>1024,99999</code>

<p class="noindent"><b>Default value:</b> 5308

<p class="noindent"><b>Synopsis</b>: Default port for cfengine server

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body hub control
{
port => "5308";
}

body server control
{
specialhost::
 port => "5308";

!specialhost::
 port => "5308";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The standard or registered port number is tcp/5308. CFEngine does not
presently use its registered udp port with the same number, but this
could change in the future.

   <p>Changing the standard port number is not recommended practice. You should
not do it without a good reason.

<div class="node">
<a name="force_ipv4-in-runagent"></a>
<a name="force_005fipv4-in-runagent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#trustkey-in-runagent">trustkey in runagent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#port-in-runagent">port in runagent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-runagent">control runagent</a>

</div>

<h4 class="subsection">5.5.3 <code>force_ipv4</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false force use of ipv4 in connection

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body copy_from example
{
force_ipv4 => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>IPv6 should be harmless to most users unless you have a partially
or misconfigured setup.

<div class="node">
<a name="trustkey-in-runagent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#encrypt-in-runagent">encrypt in runagent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#force_005fipv4-in-runagent">force_ipv4 in runagent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-runagent">control runagent</a>

</div>

<h4 class="subsection">5.5.4 <code>trustkey</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false automatically accept all keys on trust from servers

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body copy_from example
{
trustkey => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>If the server's public key has not already been trusted, this
allows us to accept the key in automated key-exchange.

   <p>Note that, as a simple security precaution, trustkey should normally
be set to &lsquo;<samp><span class="samp">false</span></samp>&rsquo;, to avoid key exchange with a server one is not
one hundred percent sure about, though the risks for a client are
rather low. On the server-side however, trust is often granted to
many clients or to a whole network in which possibly unauthorized
parties might be able to obtain an IP address, thus the trust issue
is most important on the server side.

   <p>As soon as a public key has been exchanged, the trust option has no
effect. A machine that has been trusted remains trusted until
its key is manually revoked by a system administrator. Keys are
stored in <samp><span class="file">WORKDIR/ppkeys</span></samp>.

<div class="node">
<a name="encrypt-in-runagent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#background_005fchildren-in-runagent">background_children in runagent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#trustkey-in-runagent">trustkey in runagent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-runagent">control runagent</a>

</div>

<h4 class="subsection">5.5.5 <code>encrypt</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false encrypt connections with servers

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body copy_from example
{
servers  => { "remote-host.example.org" };
encrypt => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Client connections are encrypted with using a Blowfish randomly
generated session key.  The intial connection is encrypted using the
public/private keys for the client and server hosts.

<div class="node">
<a name="background_children-in-runagent"></a>
<a name="background_005fchildren-in-runagent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#max_005fchildren-in-runagent">max_children in runagent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#encrypt-in-runagent">encrypt in runagent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-runagent">control runagent</a>

</div>

<h4 class="subsection">5.5.6 <code>background_children</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false parallelize connections to servers

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body runagent control
{
background_children => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Causes the runagent to attempt parallelized connections to the servers.

<div class="node">
<a name="max_children-in-runagent"></a>
<a name="max_005fchildren-in-runagent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#output_005fto_005ffile-in-runagent">output_to_file in runagent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#background_005fchildren-in-runagent">background_children in runagent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-runagent">control runagent</a>

</div>

<h4 class="subsection">5.5.7 <code>max_children</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

<p class="noindent"><b>Default value:</b> 50 runagents

<p class="noindent"><b>Synopsis</b>: Maximum number of simultaneous connections to attempt

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body runagent control
{
max_children => "10";
}

# or

body agent control
{
max_children => "10";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>For the run-agent this represents the maximum number of forked
background processes allowed when parallelizing connections to
servers. For the agent it represents the number of background jobs
allowed concurrently. Background jobs often lead to contention of
the disk resources slowing down tasks considerably; there is thus a law
of diminishing returns.

<div class="node">
<a name="output_to_file-in-runagent"></a>
<a name="output_005fto_005ffile-in-runagent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#output_005fdirectory-in-runagent">output_directory in runagent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#max_005fchildren-in-runagent">max_children in runagent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-runagent">control runagent</a>

</div>

<h4 class="subsection">5.5.8 <code>output_to_file</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false whether to send collected output to file(s)

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body runagent control
{
output_to_file => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Filenames are chosen automatically and placed in the
<samp><span class="file">WORKDIR/outputs/</span><var>hostname</var><span class="file">_runagent.out</span></samp>.

<div class="node">
<a name="output_directory-in-runagent"></a>
<a name="output_005fdirectory-in-runagent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#timeout-in-runagent">timeout in runagent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#output_005fto_005ffile-in-runagent">output_to_file in runagent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-runagent">control runagent</a>

</div>

<h4 class="subsection">5.5.9 <code>output_directory</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>"?(/.*)</code>

<p class="noindent"><b>Synopsis</b>: Directory where the output is stored

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body runagent control
{
output_directory => "/tmp/run_output";
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.2.0, Nova 2.1.0 (2011)

   <p>Defines the location for parallelized output to be saved when running <code>cf-runagent</code>
in parallel mode.

<div class="node">
<a name="timeout-in-runagent"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#output_005fdirectory-in-runagent">output_directory in runagent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-runagent">control runagent</a>

</div>

<h4 class="subsection">5.5.10 <code>timeout</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>1,9999</code>

<p class="noindent"><b>Synopsis</b>: Connection timeout, sec

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body runagent control
{
timeout => "10";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Timeout in seconds.

<div class="node">
<a name="control-executor"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#control-knowledge">control knowledge</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#control-runagent">control runagent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Control-Promises">Control Promises</a>

</div>

<h3 class="section">5.6 <code>executor</code> control promises</h3>

<p><br>

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
     body executor control
     
     {
     splaytime  =&gt; "5";
     mailto     =&gt; "cfengine@example.org";
     mailfrom   =&gt; "cfengine@$(host).example.org";
     smtpserver =&gt; "localhost";
     schedule   =&gt; { "Min00_05", "Min30_35" }
     }
     
</pre>
   </td></tr></table>

   <p><br>

   <p>These body settings determine the behaviour of <code>cf-execd</code>, including
scheduling times and output capture to <samp><span class="file">WORKDIR/outputs</span></samp> and relay via email. 
Note that the <code>splaytime</code> and <code>schedule</code> parameters
are now coded here rather than (as previously) in the agent.

<ul class="menu">
<li><a accesskey="1" href="#splaytime-in-executor">splaytime in executor</a>
<li><a accesskey="2" href="#mailfrom-in-executor">mailfrom in executor</a>
<li><a accesskey="3" href="#mailto-in-executor">mailto in executor</a>
<li><a accesskey="4" href="#smtpserver-in-executor">smtpserver in executor</a>
<li><a accesskey="5" href="#mailmaxlines-in-executor">mailmaxlines in executor</a>
<li><a accesskey="6" href="#schedule-in-executor">schedule in executor</a>
<li><a accesskey="7" href="#executorfacility-in-executor">executorfacility in executor</a>
<li><a accesskey="8" href="#exec_005fcommand-in-executor">exec_command in executor</a>
<li><a accesskey="9" href="#agent_005fexpireafter-in-executor">agent_expireafter in executor</a>
</ul>

<div class="node">
<a name="splaytime-in-executor"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#mailfrom-in-executor">mailfrom in executor</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-executor">control executor</a>

</div>

<h4 class="subsection">5.6.1 <code>splaytime</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

<p class="noindent"><b>Default value:</b> 0

<p class="noindent"><b>Synopsis</b>: Time in minutes to splay this host based on its name hash

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body executor control
{
splaytime => "2";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>
Whenever any class listed in the <code>schedule</code> attribute is
present, <code>cf-execd</code> can schedule an execution of <code>cf-agent</code>.  The
actual execution will be delayed an integer number of seconds between
0-<code>splaytime</code> minutes.  The
specific amount of delay for &ldquo;this&rdquo; host is based on a hash of the
hostname.  Thus a collection of hosts will all execute at different
times, and surges in network traffic can be avoided.

<p class="noindent">A rough rule of thumb for scaling of small
updates is set the splay
time between 1-5 minutes for up a few thousand hosts. 
The splaytime should not be set to a value larger than the
<code>cf-execd</code> scheduling interval, else multiple clients might
contend for data.

<p class="noindent"><b>Default value</b>:<br>
<br>

   <p>The default value is 0 minutes.

<p class="noindent"><b>See also:</b> The <code>splayclass()</code> function for a task-specific
means for setting splay times.

<div class="node">
<a name="mailfrom-in-executor"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#mailto-in-executor">mailto in executor</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#splaytime-in-executor">splaytime in executor</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-executor">control executor</a>

</div>

<h4 class="subsection">5.6.2 <code>mailfrom</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>.*@.*</code>

<p class="noindent"><b>Synopsis</b>: Email-address cfengine mail appears to come from

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body executor control
{
mailfrom => "mrcfengine@example.org";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

<div class="node">
<a name="mailto-in-executor"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#smtpserver-in-executor">smtpserver in executor</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#mailfrom-in-executor">mailfrom in executor</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-executor">control executor</a>

</div>

<h4 class="subsection">5.6.3 <code>mailto</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>.*@.*</code>

<p class="noindent"><b>Synopsis</b>: Email-address cfengine mail is sent to

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body executor control
{
mailto => "cfengine_alias@example.org";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The address to whom email is sent if an smtp host is configured.

<div class="node">
<a name="smtpserver-in-executor"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#mailmaxlines-in-executor">mailmaxlines in executor</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#mailto-in-executor">mailto in executor</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-executor">control executor</a>

</div>

<h4 class="subsection">5.6.4 <code>smtpserver</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>.*</code>

<p class="noindent"><b>Synopsis</b>: Name or IP of a willing smtp server for sending email

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body executor control
{
smtpserver => "smtp.example.org";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This should point to a standard port 25 server without encyption. 
If you are running secured or encrypted email then you should
run a mail relay on localhost and point this to localhost.

<div class="node">
<a name="mailmaxlines-in-executor"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#schedule-in-executor">schedule in executor</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#smtpserver-in-executor">smtpserver in executor</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-executor">control executor</a>

</div>

<h4 class="subsection">5.6.5 <code>mailmaxlines</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>0,1000</code>

<p class="noindent"><b>Default value:</b> 30

<p class="noindent"><b>Synopsis</b>: Maximum number of lines of output to send by email

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body executor control
{
mailmaxlines => "100";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This limit prevents anomalously large outputs from clogging up a
system administrator's mailbox.  The output is truncated in the email
report, but the complete original transcript is stored in
<samp><span class="file">WORKDIR/outputs/*</span></samp> where it can be viewed on demand. 
A reference to the appropriate file is given.

<div class="node">
<a name="schedule-in-executor"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#executorfacility-in-executor">executorfacility in executor</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#mailmaxlines-in-executor">mailmaxlines in executor</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-executor">control executor</a>

</div>

<h4 class="subsection">5.6.6 <code>schedule</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: The class schedule used by cf-execd for activating cf-agent

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body executor control
{
schedule => { "Min00", "(Evening|Night).Min15_20", "Min30", "(Evening|Night).Min45_50" };
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The list should contain class expressions comprised of classes which are
visible to the <code>cf-execd</code> daemon. In principle, any defined class
expression will cause the daemon to wake up
and schedule the execution of the <code>cf-agent</code>.  In practice, the classes
listed in the list are usually date- and time-based.

   <p>The actual execution of
<code>cf-agent</code> may be delayed by <code>splaytime</code>, and may be deferred by
promise caching and the value of <code>ifelapsed</code>.  Note also that the
effectiveness of the <code>splayclass</code> function may be affected by changing
the <code>schedule</code>.

<p class="noindent"><b>Default value</b>:<br>

<pre class="verbatim">
schedule => { "Min00", "Min05", "Min10", "Min15", "Min20", "Min25",
	      "Min30", "Min35", "Min40", "Min45", "Min50", "Min55" };
</pre>

<div class="node">
<a name="executorfacility-in-executor"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#exec_005fcommand-in-executor">exec_command in executor</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#schedule-in-executor">schedule in executor</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-executor">control executor</a>

</div>

<h4 class="subsection">5.6.7 <code>executorfacility</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>LOG_USER</code>
               <code>LOG_DAEMON</code>
               <code>LOG_LOCAL0</code>
               <code>LOG_LOCAL1</code>
               <code>LOG_LOCAL2</code>
               <code>LOG_LOCAL3</code>
               <code>LOG_LOCAL4</code>
               <code>LOG_LOCAL5</code>
               <code>LOG_LOCAL6</code>
               <code>LOG_LOCAL7</code>
</pre>
   <p class="noindent"><b>Default value:</b> LOG_USER

<p class="noindent"><b>Synopsis</b>: Menu option for syslog facility level

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body executor control
{
executorfacility => "LOG_USER";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>See the syslog manual pages.

<div class="node">
<a name="exec_command-in-executor"></a>
<a name="exec_005fcommand-in-executor"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#agent_005fexpireafter-in-executor">agent_expireafter in executor</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#executorfacility-in-executor">executorfacility in executor</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-executor">control executor</a>

</div>

<h4 class="subsection">5.6.8 <code>exec_command</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>"?(/.*)</code>

<p class="noindent"><b>Synopsis</b>: The full path and command to the executable run by default (overriding builtin)

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
exec_command => "$(sys.workdir)/bin/cf-agent -f failsafe.cf &amp;&amp; $(sys.workdir)/bin/cf-agent";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The command is run in a shell encapsulation so pipes and shell symbols
may be used if desired.  Unlike, CFEngine 2, CFEngine 3 does not
automatically run a separate update sequence before its normal
run. This can be handled using the approach in the example above.

<div class="node">
<a name="agent_expireafter-in-executor"></a>
<a name="agent_005fexpireafter-in-executor"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#exec_005fcommand-in-executor">exec_command in executor</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-executor">control executor</a>

</div>

<h4 class="subsection">5.6.9 <code>agent_expireafter</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>0,10080</code>

<p class="noindent"><b>Default value:</b> 10080

<p class="noindent"><b>Synopsis</b>: Maximum agent runtime (in minutes)

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body executor control
{
agent_expireafter => "120";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>
Sets a maximum time on any run of the command in <code>exec_command</code>. 
If no data is received from the pipe opened to the process created with
<code>exec_command</code> after the time has elapsed, the process gets killed.

<p class="noindent">Note that if you have long-running jobs, they may get killed
with this setting. Therefore, you should ensure it is higher than any run of
<code>cf-agent</code> that you want to leave alone. Alternatively, you can make
your jobs output something to STDOUT at least as often as this threshold. 
This will reset the timer.

<p class="noindent">The setting will effectively allow you to set a threshold on the
number of simultaneous agents that are running. For example, if you set it to
<code>120</code> and you are using a 5-minute agent schedule, a maximum of
120 / 5 = 24 agents should be enforced.

<p class="noindent"><b>Default value</b>:<br>
<br>

   <p>The default value is 10080 minutes (one week).

<div class="node">
<a name="control-knowledge"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#control-reporter">control reporter</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#control-executor">control executor</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Control-Promises">Control Promises</a>

</div>

<h3 class="section">5.7 <code>knowledge</code> control promises</h3>

<p><br>

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
     body knowledge control
     
     {
     query_output    =&gt; "html";
     }
     
</pre>
   </td></tr></table>

   <p><br>

   <p>Settings describing the details of the fixed behavioural promises made by
<code>cf-know</code>. 
These parameters control the way in which knowledge data are stored
and retrieved from a relational database and the output format
of the queries.

<ul class="menu">
<li><a accesskey="1" href="#build_005fdirectory-in-knowledge">build_directory in knowledge</a>
<li><a accesskey="2" href="#document_005froot-in-knowledge">document_root in knowledge</a>
<li><a accesskey="3" href="#generate_005fmanual-in-knowledge">generate_manual in knowledge</a>
<li><a accesskey="4" href="#graph_005fdirectory-in-knowledge">graph_directory in knowledge</a>
<li><a accesskey="5" href="#graph_005foutput-in-knowledge">graph_output in knowledge</a>
<li><a accesskey="6" href="#html_005fbanner-in-knowledge">html_banner in knowledge</a>
<li><a accesskey="7" href="#html_005ffooter-in-knowledge">html_footer in knowledge</a>
<li><a accesskey="8" href="#id_005fprefix-in-knowledge">id_prefix in knowledge</a>
<li><a accesskey="9" href="#manual_005fsource_005fdirectory-in-knowledge">manual_source_directory in knowledge</a>
<li><a href="#query_005fengine-in-knowledge">query_engine in knowledge</a>
<li><a href="#query_005foutput-in-knowledge">query_output in knowledge</a>
<li><a href="#sql_005ftype-in-knowledge">sql_type in knowledge</a>
<li><a href="#sql_005fdatabase-in-knowledge">sql_database in knowledge</a>
<li><a href="#sql_005fowner-in-knowledge">sql_owner in knowledge</a>
<li><a href="#sql_005fpasswd-in-knowledge">sql_passwd in knowledge</a>
<li><a href="#sql_005fserver-in-knowledge">sql_server in knowledge</a>
<li><a href="#sql_005fconnection_005fdb-in-knowledge">sql_connection_db in knowledge</a>
<li><a href="#style_005fsheet-in-knowledge">style_sheet in knowledge</a>
<li><a href="#view_005fprojections-in-knowledge">view_projections in knowledge</a>
</ul>

<div class="node">
<a name="build_directory-in-knowledge"></a>
<a name="build_005fdirectory-in-knowledge"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#document_005froot-in-knowledge">document_root in knowledge</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-knowledge">control knowledge</a>

</div>

<h4 class="subsection">5.7.1 <code>build_directory</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>.*</code>

<p class="noindent"><b>Default value:</b> Current working directory

<p class="noindent"><b>Synopsis</b>: The directory in which to generate output files

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body knowledge control

{
#..
build_directory => "/tmp/builddir";
}

body reporter control

{
#..
build_directory => "/tmp/builddir";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The directory where all auto-generated textual output is placed by <code>cf-report</code>. 
This includes manual generation, ontology and topic map data.

<div class="node">
<a name="document_root-in-knowledge"></a>
<a name="document_005froot-in-knowledge"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#generate_005fmanual-in-knowledge">generate_manual in knowledge</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#build_005fdirectory-in-knowledge">build_directory in knowledge</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-knowledge">control knowledge</a>

</div>

<h4 class="subsection">5.7.2 <code>document_root</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>.*</code>

<p class="noindent"><b>Synopsis</b>: The directory in which the web root resides

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body knowledge control

{
document_root => "/srv/www/htdocs";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The local file path of the system's web document root.

<div class="node">
<a name="generate_manual-in-knowledge"></a>
<a name="generate_005fmanual-in-knowledge"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#graph_005fdirectory-in-knowledge">graph_directory in knowledge</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#document_005froot-in-knowledge">document_root in knowledge</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-knowledge">control knowledge</a>

</div>

<h4 class="subsection">5.7.3 <code>generate_manual</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false generate texinfo manual page skeleton for this version

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body knowledge control
{
generate_manual => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Auto-creates a manual based on the self-documented code. As the
promise syntax is extended the manual self-heals. The resulting manual
is generated in Texinfo format, from which all other formats can be
generated.

<div class="node">
<a name="graph_directory-in-knowledge"></a>
<a name="graph_005fdirectory-in-knowledge"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#graph_005foutput-in-knowledge">graph_output in knowledge</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#generate_005fmanual-in-knowledge">generate_manual in knowledge</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-knowledge">control knowledge</a>

</div>

<h4 class="subsection">5.7.4 <code>graph_directory</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>"?(/.*)</code>

<p class="noindent"><b>Synopsis</b>: Path to directory where rendered .png files will be created

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body knowledge control
{
graph_directory => "/tmp/output";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>A separate location where the potentially large number of <samp><span class="file">.png</span></samp>
visualizations of a knowledge representation are pre-compiled. 
This feature only works if the necessary graphics libraries are
present.

<div class="node">
<a name="graph_output-in-knowledge"></a>
<a name="graph_005foutput-in-knowledge"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#html_005fbanner-in-knowledge">html_banner in knowledge</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#graph_005fdirectory-in-knowledge">graph_directory in knowledge</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-knowledge">control knowledge</a>

</div>

<h4 class="subsection">5.7.5 <code>graph_output</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Synopsis</b>: true/false generate png visualization of topic map if possible (requires lib)

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">body knowledge control

{
# fix/override -g option
graph_output => "true"; 
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Equivalent to the use of the &lsquo;<samp><span class="samp">-g</span></samp>&rsquo; option for <code>cf-know</code>.

<div class="node">
<a name="html_banner-in-knowledge"></a>
<a name="html_005fbanner-in-knowledge"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#html_005ffooter-in-knowledge">html_footer in knowledge</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#graph_005foutput-in-knowledge">graph_output in knowledge</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-knowledge">control knowledge</a>

</div>

<h4 class="subsection">5.7.6 <code>html_banner</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: HTML code for a banner to be added to rendered in html after the header

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body knowledge control
{
html_banner => "&lt;img src=\"http://www.example.org/img/banner.png\">";
}

body reporter control
{
html_banner => "&lt;img src=\"http://www.example.org/img/banner.png\">";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This content is cited when generating HTML output from the knowledge agent.

<div class="node">
<a name="html_footer-in-knowledge"></a>
<a name="html_005ffooter-in-knowledge"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#id_005fprefix-in-knowledge">id_prefix in knowledge</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#html_005fbanner-in-knowledge">html_banner in knowledge</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-knowledge">control knowledge</a>

</div>

<h4 class="subsection">5.7.7 <code>html_footer</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: HTML code for a page footer to be added to rendered in html before the end body tag

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body reporter control
{
html_footer => "
               &lt;div id=\"footer\">Bottom of the page&lt;/div>
               ";
}

body knowledge control
{
html_footer => "
               &lt;div id=\"footer\">Bottom of the page&lt;/div>
               ";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This allows us to cite HTML code for formatting reports generated by the reporting and knowledge
agents.

<div class="node">
<a name="id_prefix-in-knowledge"></a>
<a name="id_005fprefix-in-knowledge"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#manual_005fsource_005fdirectory-in-knowledge">manual_source_directory in knowledge</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#html_005ffooter-in-knowledge">html_footer in knowledge</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-knowledge">control knowledge</a>

</div>

<h4 class="subsection">5.7.8 <code>id_prefix</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>.*</code>

<p class="noindent"><b>Synopsis</b>: The LTM identifier prefix used to label topic maps (used for disambiguation in merging)

<p class="noindent"><b>Example</b>:<br>
<br>
<pre class="verbatim">
body knowledge control
{
id_prefix => "unique_prefix";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Use to disambiguate indentifiers for a successful merging of topic maps,
especially in Linear Topic Map (LTM) format using third party tools such
as Ontopia's Omnigator.

<div class="node">
<a name="manual_source_directory-in-knowledge"></a>
<a name="manual_005fsource_005fdirectory-in-knowledge"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#query_005fengine-in-knowledge">query_engine in knowledge</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#id_005fprefix-in-knowledge">id_prefix in knowledge</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-knowledge">control knowledge</a>

</div>

<h4 class="subsection">5.7.9 <code>manual_source_directory</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>"?(/.*)</code>

<p class="noindent"><b>Synopsis</b>: Path to directory where raw text about manual topics is found (defaults to build_directory)

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body knowledge control
{
manual_source => "/path/cfengine_manual_commentary";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This is used in the self-healing documentation. The directory points to
a location where the Texinfo sources for per-section commentary is maintained.

<div class="node">
<a name="query_engine-in-knowledge"></a>
<a name="query_005fengine-in-knowledge"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#query_005foutput-in-knowledge">query_output in knowledge</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#manual_005fsource_005fdirectory-in-knowledge">manual_source_directory in knowledge</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-knowledge">control knowledge</a>

</div>

<h4 class="subsection">5.7.10 <code>query_engine</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Name of a dynamic web-page used to accept and drive queries in a browser

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body knowledge control
{
query_engine => "http://www.example.org/script.php";
}

body reporter control
{
query_engine => "http://www.example.org/script.pl";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>When displaying topic maps in HTML format, <code>cf-know</code> will render
each topic as a link to this URL with the new topic as an argument. 
Thus it is possible to make a dynamic web query by embedding CFEngine
in the web page as system call and passing the argument to it.

<div class="node">
<a name="query_output-in-knowledge"></a>
<a name="query_005foutput-in-knowledge"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#sql_005ftype-in-knowledge">sql_type in knowledge</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#query_005fengine-in-knowledge">query_engine in knowledge</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-knowledge">control knowledge</a>

</div>

<h4 class="subsection">5.7.11 <code>query_output</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>html</code>
               <code>text</code>
</pre>
   <p class="noindent"><b>Synopsis</b>: Menu option for generated output format

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body knowledge control
{
query_output => "html";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

<div class="node">
<a name="sql_type-in-knowledge"></a>
<a name="sql_005ftype-in-knowledge"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#sql_005fdatabase-in-knowledge">sql_database in knowledge</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#query_005foutput-in-knowledge">query_output in knowledge</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-knowledge">control knowledge</a>

</div>

<h4 class="subsection">5.7.12 <code>sql_type</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>mysql</code>
               <code>postgres</code>
</pre>
   <p class="noindent"><b>Synopsis</b>: Menu option for supported database type

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body knowledge control
{
sql_type => "mysql";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

<div class="node">
<a name="sql_database-in-knowledge"></a>
<a name="sql_005fdatabase-in-knowledge"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#sql_005fowner-in-knowledge">sql_owner in knowledge</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#sql_005ftype-in-knowledge">sql_type in knowledge</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-knowledge">control knowledge</a>

</div>

<h4 class="subsection">5.7.13 <code>sql_database</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Name of database used for the topic map

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body knowledge control
{
sql_database => "cfengine_knowledge_db";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The name of an SQL database for caching knowledge.

<div class="node">
<a name="sql_owner-in-knowledge"></a>
<a name="sql_005fowner-in-knowledge"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#sql_005fpasswd-in-knowledge">sql_passwd in knowledge</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#sql_005fdatabase-in-knowledge">sql_database in knowledge</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-knowledge">control knowledge</a>

</div>

<h4 class="subsection">5.7.14 <code>sql_owner</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: User id of sql database user

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body knowledge control
{
sql_owner => "db_owner";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Part of the credentials for opening the database. This depends on the type of
database.

<div class="node">
<a name="sql_passwd-in-knowledge"></a>
<a name="sql_005fpasswd-in-knowledge"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#sql_005fserver-in-knowledge">sql_server in knowledge</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#sql_005fowner-in-knowledge">sql_owner in knowledge</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-knowledge">control knowledge</a>

</div>

<h4 class="subsection">5.7.15 <code>sql_passwd</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Embedded password for accessing sql database

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body knowledge control
{
sql_passwd => "";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Part of the credentials for connecting to the database server. 
This is system dependent. If the server host is localhost a password
might not be required.

<div class="node">
<a name="sql_server-in-knowledge"></a>
<a name="sql_005fserver-in-knowledge"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#sql_005fconnection_005fdb-in-knowledge">sql_connection_db in knowledge</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#sql_005fpasswd-in-knowledge">sql_passwd in knowledge</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-knowledge">control knowledge</a>

</div>

<h4 class="subsection">5.7.16 <code>sql_server</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Name or IP of database server (or localhost)

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body knowledge control
{
sql_server => "localhost";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The host name of IP address of the server. The default is to look on the localhost.

<div class="node">
<a name="sql_connection_db-in-knowledge"></a>
<a name="sql_005fconnection_005fdb-in-knowledge"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#style_005fsheet-in-knowledge">style_sheet in knowledge</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#sql_005fserver-in-knowledge">sql_server in knowledge</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-knowledge">control knowledge</a>

</div>

<h4 class="subsection">5.7.17 <code>sql_connection_db</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: The name of an existing database to connect to in order to create/manage other databases

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body knowledge control
{
sql_connection_db => "mysql";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>In order to create a database on a database server (all of which
practice voluntary cooperation), one has to be able to connect
to the server, however, without an existing database this is not allowed. 
Thus, database servers provide a default database that can be connected
to in order to thereafter create new databases. These are called
<code>postgres</code> and <code>mysql</code> for their respective database servers.

   <p>For the knowledge agent, this setting is made in the control body,
for database verification promises, it is made in the
<code>database_server</code> body.

<div class="node">
<a name="style_sheet-in-knowledge"></a>
<a name="style_005fsheet-in-knowledge"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#view_005fprojections-in-knowledge">view_projections in knowledge</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#sql_005fconnection_005fdb-in-knowledge">sql_connection_db in knowledge</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-knowledge">control knowledge</a>

</div>

<h4 class="subsection">5.7.18 <code>style_sheet</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Name of a style-sheet to be used in rendering html output (added to headers)

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body knowledge control
{
style_sheet => "http://www.example.org/css/sheet.css";
}

body reporter control
{
style_sheet => "http://www.example.org/css/sheet.css";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>For formatting the HTML generated output of <code>cf-know</code>.

<div class="node">
<a name="view_projections-in-knowledge"></a>
<a name="view_005fprojections-in-knowledge"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#style_005fsheet-in-knowledge">style_sheet in knowledge</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-knowledge">control knowledge</a>

</div>

<h4 class="subsection">5.7.19 <code>view_projections</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: Perform view-projection analytics in graph generation

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body knowledge control
{
view_projections => "true";
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>If this is set to true, CFEngine Nova computes additional graphical
representations in its knowledge map, representing causal dependencies
 between CFEngine promises.

<div class="node">
<a name="control-reporter"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#control-hub">control hub</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#control-knowledge">control knowledge</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Control-Promises">Control Promises</a>

</div>

<h3 class="section">5.8 <code>reporter</code> control promises</h3>

<p><br>

<pre class="verbatim">
body reporter control
{
reports => { "performance", "last_seen", "monitor_history" };
build_directory => "/tmp/nerves";
report_output => "html";
}

</pre>

   <p><br>

   <p>Determines a list of reports to write into the build directory. The
format may be in text, html or xml format. The reporter agent
<code>cf-report</code> replaces both <code>cfshow</code> and <code>cfenvgraph</code>. It
no longer produces output to the console.

   <p>Some reports are only available in enterprise level versions of CFEngine.

<ul class="menu">
<li><a accesskey="1" href="#aggregation_005fpoint-in-reporter">aggregation_point in reporter</a>
<li><a accesskey="2" href="#auto_005fscaling-in-reporter">auto_scaling in reporter</a>
<li><a accesskey="3" href="#build_005fdirectory-in-reporter">build_directory in reporter</a>
<li><a accesskey="4" href="#csv2xml-in-reporter">csv2xml in reporter</a>
<li><a accesskey="5" href="#error_005fbars-in-reporter">error_bars in reporter</a>
<li><a accesskey="6" href="#html_005fbanner-in-reporter">html_banner in reporter</a>
<li><a accesskey="7" href="#html_005fembed-in-reporter">html_embed in reporter</a>
<li><a accesskey="8" href="#html_005ffooter-in-reporter">html_footer in reporter</a>
<li><a accesskey="9" href="#query_005fengine-in-reporter">query_engine in reporter</a>
<li><a href="#reports-in-reporter">reports in reporter</a>
<li><a href="#report_005foutput-in-reporter">report_output in reporter</a>
<li><a href="#style_005fsheet-in-reporter">style_sheet in reporter</a>
<li><a href="#time_005fstamps-in-reporter">time_stamps in reporter</a>
</ul>

<div class="node">
<a name="aggregation_point-in-reporter"></a>
<a name="aggregation_005fpoint-in-reporter"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#auto_005fscaling-in-reporter">auto_scaling in reporter</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-reporter">control reporter</a>

</div>

<h4 class="subsection">5.8.1 <code>aggregation_point</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>"?(/.*)</code>

<p class="noindent"><b>Synopsis</b>: The root directory of the data cache for CMDB aggregation

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body reporter control
{
aggregation_point => "/srv/www/htdocs/reports";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This feature is only used in enterprise level versions of CFEngine. 
It specifies the directory where reports from multiple hosts are
to be aggregated in sub-directories. This should be somewhere under
the document root of the web server for the CFEngine knowledge base
in order to make the reports browsable.

<div class="node">
<a name="auto_scaling-in-reporter"></a>
<a name="auto_005fscaling-in-reporter"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#build_005fdirectory-in-reporter">build_directory in reporter</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#aggregation_005fpoint-in-reporter">aggregation_point in reporter</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-reporter">control reporter</a>

</div>

<h4 class="subsection">5.8.2 <code>auto_scaling</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> true

<p class="noindent"><b>Synopsis</b>: true/false whether to auto-scale graph output to optimize use of space

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body reporter control
{
auto_scaling => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Automatic scaling is the default.

<div class="node">
<a name="build_directory-in-reporter"></a>
<a name="build_005fdirectory-in-reporter"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#csv2xml-in-reporter">csv2xml in reporter</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#auto_005fscaling-in-reporter">auto_scaling in reporter</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-reporter">control reporter</a>

</div>

<h4 class="subsection">5.8.3 <code>build_directory</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>.*</code>

<p class="noindent"><b>Default value:</b> Current working directory

<p class="noindent"><b>Synopsis</b>: The directory in which to generate output files

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body knowledge control

{
#..
build_directory => "/tmp/builddir";
}

body reporter control

{
#..
build_directory => "/tmp/builddir";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The directory where all auto-generated textual output is placed by <code>cf-report</code>. 
This includes manual generation, ontology and topic map data.

<div class="node">
<a name="csv2xml-in-reporter"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#error_005fbars-in-reporter">error_bars in reporter</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#build_005fdirectory-in-reporter">build_directory in reporter</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-reporter">control reporter</a>

</div>

<h4 class="subsection">5.8.4 <code>csv2xml</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: A list of csv formatted files in the build directory to convert to simple xml

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body reporter control
{
csv2xml => { "myreport.csv", "custom_report.csv"  };
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>CSV files are easy to generate in CFEngine from individual promise logging functions. 
XML is not easily generated due to its hierarchical structure. This function allows
<code>cf-report</code> to convert a CSV file into pidgin XML for convenience. The schema
has the general form:

<pre class="verbatim">
&lt;output>
 &lt;line> &lt;one>...&lt;/one> &lt;two>...&lt;/two> ... &lt;/line>
 &lt;line> &lt;one>...&lt;/one> &lt;two>...&lt;/two> ... &lt;/line>
&lt;/output>

</pre>

<div class="node">
<a name="error_bars-in-reporter"></a>
<a name="error_005fbars-in-reporter"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#html_005fbanner-in-reporter">html_banner in reporter</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#csv2xml-in-reporter">csv2xml in reporter</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-reporter">control reporter</a>

</div>

<h4 class="subsection">5.8.5 <code>error_bars</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> true

<p class="noindent"><b>Synopsis</b>: true/false whether to generate error bars on graph output

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body reporter control
{
error_bars => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The default is to produce error bars. Without error bars from
CFEngine's machine learning data there is no way to assess
the significance of an observation about the system, i.e. whether
it is normal or anomalous.

<div class="node">
<a name="html_banner-in-reporter"></a>
<a name="html_005fbanner-in-reporter"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#html_005fembed-in-reporter">html_embed in reporter</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#error_005fbars-in-reporter">error_bars in reporter</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-reporter">control reporter</a>

</div>

<h4 class="subsection">5.8.6 <code>html_banner</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: HTML code for a banner to be added to rendered in html after the header

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body knowledge control
{
html_banner => "&lt;img src=\"http://www.example.org/img/banner.png\">";
}

body reporter control
{
html_banner => "&lt;img src=\"http://www.example.org/img/banner.png\">";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This content is cited when generating HTML output from the knowledge agent.

<div class="node">
<a name="html_embed-in-reporter"></a>
<a name="html_005fembed-in-reporter"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#html_005ffooter-in-reporter">html_footer in reporter</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#html_005fbanner-in-reporter">html_banner in reporter</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-reporter">control reporter</a>

</div>

<h4 class="subsection">5.8.7 <code>html_embed</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Synopsis</b>: If true, no header and footer tags will be added to html output

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body reporter control
{
html_embed => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Embedded HTML means something that could be put into a frame or table, without
html or body tags, headers footers etc.

<div class="node">
<a name="html_footer-in-reporter"></a>
<a name="html_005ffooter-in-reporter"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#query_005fengine-in-reporter">query_engine in reporter</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#html_005fembed-in-reporter">html_embed in reporter</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-reporter">control reporter</a>

</div>

<h4 class="subsection">5.8.8 <code>html_footer</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: HTML code for a page footer to be added to rendered in html before the end body tag

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body reporter control
{
html_footer => "
               &lt;div id=\"footer\">Bottom of the page&lt;/div>
               ";
}

body knowledge control
{
html_footer => "
               &lt;div id=\"footer\">Bottom of the page&lt;/div>
               ";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This allows us to cite HTML code for formatting reports generated by the reporting and knowledge
agents.

<div class="node">
<a name="query_engine-in-reporter"></a>
<a name="query_005fengine-in-reporter"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#reports-in-reporter">reports in reporter</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#html_005ffooter-in-reporter">html_footer in reporter</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-reporter">control reporter</a>

</div>

<h4 class="subsection">5.8.9 <code>query_engine</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Name of a dynamic web-page used to accept and drive queries in a browser

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body knowledge control
{
query_engine => "http://www.example.org/script.php";
}

body reporter control
{
query_engine => "http://www.example.org/script.pl";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>When displaying topic maps in HTML format, <code>cf-know</code> will render
each topic as a link to this URL with the new topic as an argument. 
Thus it is possible to make a dynamic web query by embedding CFEngine
in the web page as system call and passing the argument to it.

<div class="node">
<a name="reports-in-reporter"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#report_005foutput-in-reporter">report_output in reporter</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#query_005fengine-in-reporter">query_engine in reporter</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-reporter">control reporter</a>

</div>

<h4 class="subsection">5.8.10 <code>reports</code></h4>

<p class="noindent"><b>Type</b>: (option list)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>all</code>
               <code>audit</code>
               <code>performance</code>
               <code>all_locks</code>
               <code>active_locks</code>
               <code>hashes</code>
               <code>classes</code>
               <code>last_seen</code>
               <code>monitor_now</code>
               <code>monitor_history</code>
               <code>monitor_summary</code>
               <code>compliance</code>
               <code>setuid</code>
               <code>file_changes</code>
               <code>installed_software</code>
               <code>software_patches</code>
               <code>value</code>
               <code>variables</code>
</pre>
   <p class="noindent"><b>Default value:</b> none

<p class="noindent"><b>Synopsis</b>: A list of reports that may be generated

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body reporter control
{
reports => { "performance", "classes"  };
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>A list of report types that can be generated by this agent.  The
listed items from <code>compliance</code> onward are available only
Enterprise editions of CFEngine.

   <p>The keyword &lsquo;<samp><span class="samp">all</span></samp>&rsquo; can be used to get all reports except the audit
and locking reports. The latter are large and unwieldy and need specific confirmation.

<div class="node">
<a name="report_output-in-reporter"></a>
<a name="report_005foutput-in-reporter"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#style_005fsheet-in-reporter">style_sheet in reporter</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#reports-in-reporter">reports in reporter</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-reporter">control reporter</a>

</div>

<h4 class="subsection">5.8.11 <code>report_output</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>csv</code>
               <code>html</code>
               <code>text</code>
               <code>xml</code>
</pre>
   <p class="noindent"><b>Default value:</b> none

<p class="noindent"><b>Synopsis</b>: Menu option for generated output format. Applies only to text reports, graph data remain in xydy format.

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body reporter control
{
report_output => "html";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Sets the output format of embedded database reports.

<div class="node">
<a name="style_sheet-in-reporter"></a>
<a name="style_005fsheet-in-reporter"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#time_005fstamps-in-reporter">time_stamps in reporter</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#report_005foutput-in-reporter">report_output in reporter</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-reporter">control reporter</a>

</div>

<h4 class="subsection">5.8.12 <code>style_sheet</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Name of a style-sheet to be used in rendering html output (added to headers)

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body knowledge control
{
style_sheet => "http://www.example.org/css/sheet.css";
}

body reporter control
{
style_sheet => "http://www.example.org/css/sheet.css";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>For formatting the HTML generated output of <code>cf-know</code>.

<div class="node">
<a name="time_stamps-in-reporter"></a>
<a name="time_005fstamps-in-reporter"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#style_005fsheet-in-reporter">style_sheet in reporter</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-reporter">control reporter</a>

</div>

<h4 class="subsection">5.8.13 <code>time_stamps</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false whether to generate timestamps in the output directory name

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body reporter control
{
time_stamps => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This option is only necessary with the default build directory.  This
can be used to keep snapshots of the system but it will result in a
lot of storage be consumed. For most purposes CFEngine is programmed
to forget the past at a predictable rate and there is no need to
override this.

<div class="node">
<a name="control-hub"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#control-file">control file</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#control-reporter">control reporter</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Control-Promises">Control Promises</a>

</div>

<h3 class="section">5.9 <code>hub</code> control promises</h3>

<p><br>

<pre class="verbatim">
body hub control
{
export_zenoss => "/var/www/reports/summary.z";
}

</pre>

   <p><br>

<ul class="menu">
<li><a accesskey="1" href="#export_005fzenoss-in-hub">export_zenoss in hub</a>
<li><a accesskey="2" href="#exclude_005fhosts-in-hub">exclude_hosts in hub</a>
<li><a accesskey="3" href="#hub_005fschedule-in-hub">hub_schedule in hub</a>
<li><a accesskey="4" href="#port-in-hub">port in hub</a>
</ul>

<div class="node">
<a name="export_zenoss-in-hub"></a>
<a name="export_005fzenoss-in-hub"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#exclude_005fhosts-in-hub">exclude_hosts in hub</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-hub">control hub</a>

</div>

<h4 class="subsection">5.9.1 <code>export_zenoss</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>.+</code>

<p class="noindent"><b>Synopsis</b>: Generate report for Zenoss integration

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body hub control
{
am_policy_hub::

  export_zenoss => "/var/www/reports/summary.z";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.1.0b1,Nova 2.0.0b1 (2010)

   <p>For integration with the Zenoss monitoring software.

<div class="node">
<a name="exclude_hosts-in-hub"></a>
<a name="exclude_005fhosts-in-hub"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#hub_005fschedule-in-hub">hub_schedule in hub</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#export_005fzenoss-in-hub">export_zenoss in hub</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-hub">control hub</a>

</div>

<h4 class="subsection">5.9.2 <code>exclude_hosts</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: A list of IP addresses of hosts to exclude from report collection

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">body hub control
{
exclude_hosts => { "192.168.12.21", "10.10", "10.12.*" };
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in 3.3.0, Nova 2.1.1 (2011)

   <p>In commercial CFEngine editions, this list of IP addresses will not be
queried for reports by <code>cf-hub</code>, even though they are in the
last-seen database.

   <p>The lists may contain network addresses in CIDR notation or regular
expressions to match the IP address. However, host names are currently
not supported.

<div class="node">
<a name="hub_schedule-in-hub"></a>
<a name="hub_005fschedule-in-hub"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#port-in-hub">port in hub</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#exclude_005fhosts-in-hub">exclude_hosts in hub</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-hub">control hub</a>

</div>

<h4 class="subsection">5.9.3 <code>hub_schedule</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: The class schedule used by cf-hub for report collation

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body hub control
{
hub_schedule => { "Min00", "Min30", "(Evening|Night).Min45_50" };
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.1.0b1,Nova 2.0.0b1 (2010)

<div class="node">
<a name="port-in-hub"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#hub_005fschedule-in-hub">hub_schedule in hub</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#control-hub">control hub</a>

</div>

<h4 class="subsection">5.9.4 <code>port</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>1024,99999</code>

<p class="noindent"><b>Default value:</b> 5308

<p class="noindent"><b>Synopsis</b>: Default port for contacting hub nodes

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body hub control
{
port => "5308";
}

body server control
{
specialhost::
 port => "5308";

!specialhost::
 port => "5308";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The standard or registered port number is tcp/5308. CFEngine does not
presently use its registered udp port with the same number, but this
could change in the future.

   <p>Changing the standard port number is not recommended practice. You should
not do it without a good reason.

<div class="node">
<a name="control-file"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#control-hub">control hub</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Control-Promises">Control Promises</a>

</div>

<h3 class="section">5.10 <code>file</code> control promises</h3>

<p><br>

<pre class="verbatim">
body file control
{
namespace => "name1"; 
}

bundle agent private
{
....
}

</pre>

   <p><br>

   <p><i>History</i>: Was introduced in 3.4.0, Enterprise 3.0.0 (2012)

   <p>This directive can be given multiple times within any file, outside of
body and bundle definitions.

<ul class="menu">
<li><a accesskey="1" href="#namespace-in-file">namespace in file</a>
</ul>

<div class="node">
<a name="namespace-in-file"></a>
<p><hr>
Up:&nbsp;<a rel="up" accesskey="u" href="#control-file">control file</a>

</div>

<h4 class="subsection">5.10.1 <code>namespace</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>[a-zA-Z0-9_$(){}\[\].:]+</code>

<p class="noindent"><b>Synopsis</b>: Switch to a private namespace to protect current file from duplicate definitions

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body file control
{
namespace => "name1"; 
}

</pre>

   <p>For fuller examples see See <a href="#Name-spaces">Name spaces</a>.

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in 3.4.0, Enterprise 3.0.0 (2012)

   <p>This directive can be given within any file, outside of body and
bundle definitions, to change the namespace of subsequent bundles and
bodies.

<!-- ***************************************************** -->
<!-- * CHAPTER -->
<!-- ***************************************************** -->
<div class="node">
<a name="Bundles-for-common"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Bundles-for-agent">Bundles for agent</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Control-Promises">Control Promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">6 Bundles of <code>common</code></h2>

<p><br>

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
     bundle common globals
     {
     vars:
     
       "global_var" string =&gt; "value";
     
     classes:
     
       "global_class" expression =&gt; "value";
     }
     
</pre>
   </td></tr></table>

   <p><br>

   <p>Common bundles may only contain the promise types that are common to
all bodies.  Their main function is to define cross-component global
definitions. Common bundles are observed by every agent, whereas the
agent specific bundle types are ignored by components other than the
intended recipient.

<ul class="menu">
<li><a accesskey="1" href="#classes-in-common-promises">classes in common promises</a>: <li><a accesskey="2" href="#defaults-in-common-promises">defaults in common promises</a>: <li><a accesskey="3" href="#meta-in-common-promises">meta in common promises</a>: <li><a accesskey="4" href="#reports-in-common-promises">reports in common promises</a>: <li><a accesskey="5" href="#vars-in-common-promises">vars in common promises</a>: <li><a accesskey="6" href="#Miscellaneous-in-common-promises">* in common promises</a>: <li><a accesskey="7" href="#commands-in-agent-promises">commands in agent promises</a>: <li><a accesskey="8" href="#databases-in-agent-promises">databases in agent promises</a>: <li><a accesskey="9" href="#guest_005fenvironments-in-agent-promises">guest_environments in agent promises</a>: <li><a href="#files-in-agent-promises">files in agent promises</a>: <li><a href="#Miscellaneous-in-edit_005fline-promises">* in edit_line promises</a>: <li><a href="#delete_005flines-in-edit_005fline-promises">delete_lines in edit_line promises</a>: <li><a href="#insert_005flines-in-edit_005fline-promises">insert_lines in edit_line promises</a>: <li><a href="#field_005fedits-in-edit_005fline-promises">field_edits in edit_line promises</a>: <li><a href="#replace_005fpatterns-in-edit_005fline-promises">replace_patterns in edit_line promises</a>: <li><a href="#Miscellaneous-in-edit_005fxml-promises">* in edit_xml promises</a>: <li><a href="#build_005fxpath-in-edit_005fxml-promises">build_xpath in edit_xml promises</a>: <li><a href="#delete_005ftree-in-edit_005fxml-promises">delete_tree in edit_xml promises</a>: <li><a href="#insert_005ftree-in-edit_005fxml-promises">insert_tree in edit_xml promises</a>: <li><a href="#delete_005fattribute-in-edit_005fxml-promises">delete_attribute in edit_xml promises</a>: <li><a href="#set_005fattribute-in-edit_005fxml-promises">set_attribute in edit_xml promises</a>: <li><a href="#delete_005ftext-in-edit_005fxml-promises">delete_text in edit_xml promises</a>: <li><a href="#set_005ftext-in-edit_005fxml-promises">set_text in edit_xml promises</a>: <li><a href="#insert_005ftext-in-edit_005fxml-promises">insert_text in edit_xml promises</a>: <li><a href="#interfaces-in-agent-promises">interfaces in agent promises</a>: <li><a href="#methods-in-agent-promises">methods in agent promises</a>: <li><a href="#outputs-in-agent-promises">outputs in agent promises</a>: <li><a href="#packages-in-agent-promises">packages in agent promises</a>: <li><a href="#processes-in-agent-promises">processes in agent promises</a>: <li><a href="#services-in-agent-promises">services in agent promises</a>: <li><a href="#storage-in-agent-promises">storage in agent promises</a>: <li><a href="#access-in-server-promises">access in server promises</a>: <li><a href="#roles-in-server-promises">roles in server promises</a>: <li><a href="#inferences-in-knowledge-promises">inferences in knowledge promises</a>: <li><a href="#things-in-knowledge-promises">things in knowledge promises</a>: <li><a href="#topics-in-knowledge-promises">topics in knowledge promises</a>: <li><a href="#occurrences-in-knowledge-promises">occurrences in knowledge promises</a>: <li><a href="#measurements-in-monitor-promises">measurements in monitor promises</a>: </ul>

<div class="node">
<a name="classes-in-common-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#defaults-in-common-promises">defaults in common promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-common">Bundles for common</a>

</div>

<h3 class="section">6.1 <code>classes</code> promises in &lsquo;<samp><span class="samp">*</span></samp>&rsquo;</h3>

<p><br>

   <p>Classes promises refer to the classification of different
run-contexts.  These are not related to object oriented classes, they
are more like tag labels representing different properties of the
environement.

   <p>The term classes was introduced before the widespread use of the term in
Object Orientation, and has since stuck. Today, we use the words class
and context interchangeably.

   <p><br>

<pre class="verbatim">
bundle common g
{
classes:

  "one" expression => "any";

  "client_network" expression => iprange("128.39.89.0/24");
}

</pre>

   <p><br>

   <p>Classes promises may be made in any bundle, i.e. in bundles pertaining to
any agent. Classes that are defined in common bundles are global in scope,
while classes in all other bundles are local.

<ul class="menu">
<li><a accesskey="1" href="#and-in-classes">and in classes</a>
<li><a accesskey="2" href="#dist-in-classes">dist in classes</a>
<li><a accesskey="3" href="#expression-in-classes">expression in classes</a>
<li><a accesskey="4" href="#or-in-classes">or in classes</a>
<li><a accesskey="5" href="#persistence-in-classes">persistence in classes</a>
<li><a accesskey="6" href="#not-in-classes">not in classes</a>
<li><a accesskey="7" href="#select_005fclass-in-classes">select_class in classes</a>
<li><a accesskey="8" href="#xor-in-classes">xor in classes</a>
</ul>

<div class="node">
<a name="and-in-classes"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#dist-in-classes">dist in classes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#classes-in-common-promises">classes in common promises</a>

</div>

<h4 class="subsection">6.1.1 <code>and</code></h4>

<p class="noindent"><b>Type</b>: clist

<p class="noindent"><b>Allowed input range</b>: <code>[a-zA-Z0-9_!&amp;@@$|.()\[\]{}:]+</code>

<p class="noindent"><b>Synopsis</b>: Combine class sources with AND

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
classes:

  "compound_class" and => { classmatch("host[0-9].*"), "Monday", "Hr02" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>If an expression contains a mixture of different object types that
need to be ANDed together, this list form is more convenient than
providing an expression.  If all of the class expressions listed in the
RHS match, then the class on the LHS is defined.

<div class="node">
<a name="dist-in-classes"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#expression-in-classes">expression in classes</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#and-in-classes">and in classes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#classes-in-common-promises">classes in common promises</a>

</div>

<h4 class="subsection">6.1.2 <code>dist</code></h4>

<p class="noindent"><b>Type</b>: rlist

<p class="noindent"><b>Allowed input range</b>: <code>-9.99999E100,9.99999E100</code>

<p class="noindent"><b>Synopsis</b>: Generate a probabilistic class distribution (from strategies in cfengine 2)

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
classes:

  "my_dist"  

    dist => { "10", "20", "40", "50" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Assign one generic class (always) and one additional class, randomly weighted
on a probability distribution.  The sum of <code>10+20+40+50 = 120</code> in the
example above, so in generating a distribution, CFEngine picks a number
between <code>1-120</code>. This will generate the following classes:

<pre class="smallexample">     my_dist    (always)
     my_dist_10 (10/120 of the time)
     my_dist_20 (20/120 of the time)
     my_dist_40 (40/120 of the time)
     my_dist_50 (50/120 of the time)
</pre>
   <p>This was previous called a &lsquo;<samp><span class="samp">strategy</span></samp>&rsquo; in CFEngine 2.

<div class="node">
<a name="expression-in-classes"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#or-in-classes">or in classes</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#dist-in-classes">dist in classes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#classes-in-common-promises">classes in common promises</a>

</div>

<h4 class="subsection">6.1.3 <code>expression</code></h4>

<p class="noindent"><b>Type</b>: class

<p class="noindent"><b>Allowed input range</b>: <code>[a-zA-Z0-9_!&amp;@@$|.()\[\]{}:]+</code>

<p class="noindent"><b>Synopsis</b>: Evaluate string expression of classes in normal form

<p class="noindent"><b>Example</b>:<br>
<br>
<pre class="verbatim">
classes:

  "class_name" expression => "solaris|(linux.specialclass)";
  "has_toor"   expression => userexists("toor");

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>A way of aliasing class combinations.

<div class="node">
<a name="or-in-classes"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#persistence-in-classes">persistence in classes</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#expression-in-classes">expression in classes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#classes-in-common-promises">classes in common promises</a>

</div>

<h4 class="subsection">6.1.4 <code>or</code></h4>

<p class="noindent"><b>Type</b>: clist

<p class="noindent"><b>Allowed input range</b>: <code>[a-zA-Z0-9_!&amp;@@$|.()\[\]{}:]+</code>

<p class="noindent"><b>Synopsis</b>: Combine class sources with inclusive OR

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
classes:

    "compound_test" 

      or => { classmatch("linux_x86_64_2_6_22.*"), "suse_10_3" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>A useful construction for writing expressions that contain special functions. 
The class in the LHS will be defined if any one (or more) of the class
expressions in the RHS are true.

<div class="node">
<a name="persistence-in-classes"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#not-in-classes">not in classes</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#or-in-classes">or in classes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#classes-in-common-promises">classes in common promises</a>

</div>

<h4 class="subsection">6.1.5 <code>persistence</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

<p class="noindent"><b>Synopsis</b>: Make the class persistent (cached) to avoid reevaluation, time in minutes

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">bundle common setclasses
{
classes:

  "cached_classes" 
                or => { "any" },
       persistence => "1";

  "cached_class" 
       expression => "any",
       persistence => "1";

}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in 3.4.0, Nova 2.2.0 (2012)

   <p>This feature can be used to avoid recomputing expensive classes
calculations on each invocation. If a class discovered is essentially
constant or only slowly varying (like a hostname or alias from a
non-standard naming facility)

   <p>For example, to create a conditional inclusion of costly class
definitions, put them into a separate bundle in a file <samp><span class="file">classes.cf</span></samp>.
<pre class="verbatim"># promises.cf

body common control 
{
cached_classes::
  bundlesequence => { "test" };

!cached_classes::
  bundlesequence => {  "setclasses", "test" };

!cached_classes::
  inputs => { "classes.cf" };
}
 

bundle agent test
{
reports:

  !my_cached_class::
   "no cached class";

  my_cached_class::
    "cached class defined";
}
 
</pre>
Then create <samp><span class="file">classes.cf</span></samp>
<pre class="verbatim"># classes.cf

bundle common setclasses
{
classes:

  "cached_classes"            # timer flag 
         expression => "any",
        persistence => "480";

  "my_cached_class" 
                or => { ...long list or heavy function... } ,
       persistence => "480";

}

</pre>

<div class="node">
<a name="not-in-classes"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#select_005fclass-in-classes">select_class in classes</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#persistence-in-classes">persistence in classes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#classes-in-common-promises">classes in common promises</a>

</div>

<h4 class="subsection">6.1.6 <code>not</code></h4>

<p class="noindent"><b>Type</b>: class

<p class="noindent"><b>Allowed input range</b>: <code>[a-zA-Z0-9_!&amp;@@$|.()\[\]{}:]+</code>

<p class="noindent"><b>Synopsis</b>: Evaluate the negation of string expression in normal form

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
classes:

   "others"  not => "linux|solaris";
   "no_toor" not => userexists("toor");

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This negates the effect of the promiser-pattern regular
expression.  The class in the LHS will only be defined if the class
expression in the RHS is false.

<div class="node">
<a name="select_class-in-classes"></a>
<a name="select_005fclass-in-classes"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#xor-in-classes">xor in classes</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#not-in-classes">not in classes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#classes-in-common-promises">classes in common promises</a>

</div>

<h4 class="subsection">6.1.7 <code>select_class</code></h4>

<p class="noindent"><b>Type</b>: clist

<p class="noindent"><b>Allowed input range</b>: <code>[a-zA-Z0-9_!&amp;@@$|.()\[\]{}:]+</code>

<p class="noindent"><b>Default value:</b> random_selection

<p class="noindent"><b>Synopsis</b>: Select one of the named list of classes to define based on host identity

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">bundle common g
{
classes:
  "selection" select_class => { "one", "two" };

reports:
  one::
    "One was selected";
  two::
    "Two was selected";
  selection::
     "A selection was made";
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.1.5, Nova 2.1.0 (2011)

   <p>This feature is somewhat like the <code>splayclass</code> function, but instead of selecting
a class for a moment in time, it always chooses one class in the list &ndash; the same class each
time for a given host. This allows hosts to be distributed across a controlled list of classes,
e.g for load balancing purposes.

   <p>The class is chosen deterministically (not randomly) but it is not possible to say which
host will end up in which class in advance &ndash; only that hosts will always end up in the same class
every time.

<div class="node">
<a name="xor-in-classes"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#select_005fclass-in-classes">select_class in classes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#classes-in-common-promises">classes in common promises</a>

</div>

<h4 class="subsection">6.1.8 <code>xor</code></h4>

<p class="noindent"><b>Type</b>: clist

<p class="noindent"><b>Allowed input range</b>: <code>[a-zA-Z0-9_!&amp;@@$|.()\[\]{}:]+</code>

<p class="noindent"><b>Synopsis</b>: Combine class sources with XOR

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
classes:

 "another_global" xor => { "any", "linux", "solaris"};

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Behaves as the XOR operation on class expressions. 
It can be used to define a class if exactly one of the class expressions
on the RHS matches.

<div class="node">
<a name="defaults-in-common-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#meta-in-common-promises">meta in common promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#classes-in-common-promises">classes in common promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-common">Bundles for common</a>

</div>

<h3 class="section">6.2 <code>defaults</code> promises in &lsquo;<samp><span class="samp">*</span></samp>&rsquo;</h3>

<p><br>

   <p>Defaults promises are related to variables. If a variable or paramter
in a promise bundle is undefined, or its value is defined to be invalid,
a default value can be promised instead.

   <p><br>

   <p>A basic example, illustrating different ways to test for missing
input.  Note carefully that CFEngine does not use Perl semantics:
i.e. undefined variables do not map to the empty string, they remain
as variables for possible future expansion.  Because of
the convergence of CFEngine, some variables might in the strictest sense
be defined but still contain unresolved variables, to handle this
you will need to match the <code>$(abc)</code> form of the variables.

<pre class="verbatim">
body common control
{
bundlesequence => { "main" };
}

bundle agent main
{
methods:

  "example"  usebundle => test("one","x","","$(four)");

}

bundle agent test(a,b,c,d)
{
defaults:

 "a" string => "default a", if_match_regex => "";
 "b" string => "default b", if_match_regex => "x";
 "c" string => "default c", if_match_regex => "";
 "d" string => "default d", if_match_regex => "\$\([a-zA-Z0-9_.]+\)";

reports:

   !nothing::

   "a = '$(a)', b = '$(b)', c = '$(c)' d = '$(d)'";
}

</pre>
Another example:

<pre class="verbatim">
bundle agent example

{     
defaults:

  "X" string => "I am a default value";
  "Y" slist => { "I am a default list item 1", "I am a default list item 2" };

methods:

 "example" usebundle => mymethod("","bbb");

reports:

 !xyz::

   "The default value of X is $(X)";
   "The default value of Y is $(Y)";
}

###########################################################

bundle agent mymethod(a,b)

{
vars:

  "no_return" string => "ok"; # readfile("/dont/exist","123");

defaults:

  "a" string => "AAAAAAAAA",   if_match_regex => "";

  "b" string => "BBBBBBBBB",   if_match_regex => "";

  "no_return" string => "no such file";

reports:

  !xyz::

     "The value of a is $(a)";
     "The value of b is $(b)";

     "The value of no_return is $(no_return)";

}

</pre>

   <p><br>

   <p>This was introduced in CFEngine core 3.4.0. (2012)

<ul class="menu">
<li><a accesskey="1" href="#if_005fmatch_005fregex-in-defaults">if_match_regex in defaults</a>
<li><a accesskey="2" href="#string-in-defaults">string in defaults</a>
<li><a accesskey="3" href="#slist-in-defaults">slist in defaults</a>
</ul>

<div class="node">
<a name="if_match_regex-in-defaults"></a>
<a name="if_005fmatch_005fregex-in-defaults"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#string-in-defaults">string in defaults</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#defaults-in-common-promises">defaults in common promises</a>

</div>

<h4 class="subsection">6.2.1 <code>if_match_regex</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: If this regular expression matches the current value of the variable, replace it with default

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">bundle agent mymethod(a,b)
{
defaults:

  "a" string => "AAAAAAAAA",   if_match_regex => "";
  "b" string => "BBBBBBBBB",   if_match_regex => "";
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in 3.4.0, Enterprise 3.0.0 (2012)

   <p>If a parameter or variable is already defined in the current context and
the value matches this regular expression, it will be deemed invalid and
replaced with the default value.

<div class="node">
<a name="string-in-defaults"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#slist-in-defaults">slist in defaults</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#if_005fmatch_005fregex-in-defaults">if_match_regex in defaults</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#defaults-in-common-promises">defaults in common promises</a>

</div>

<h4 class="subsection">6.2.2 <code>string</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: A scalar string

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
vars:

 "xxx"    string => "Some literal string...";

 "yyy"    string => readfile( "/home/mark/tmp/testfile" , "33" );

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>In CFEngine previously lists were represented (as in the shell) using
separted scalars, e.g. like the PATH variable. This design feature
turned out to be an error of judgement which has resulted in much
trouble. This is no longer supported in CFEngine 3. By keeping lists
an independent type many limitations have been removed.

<div class="node">
<a name="slist-in-defaults"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#string-in-defaults">string in defaults</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#defaults-in-common-promises">defaults in common promises</a>

</div>

<h4 class="subsection">6.2.3 <code>slist</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: A list of scalar strings

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">vars:

 "xxx"    slist  => {  "literal1",  "literal2" };

 "yyy"    slist  => { 
                    readstringlist(
                                  "/home/mark/tmp/testlist",
                                  "#[a-zA-Z0-9 ]*",
                                  "[^a-zA-Z0-9]",
                                  15,
                                  4000
                                  ) 
                    };

 "zzz"    slist  => { readstringlist("/home/mark/tmp/testlist2","#[^\n]*",",",5,4000) };


</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>
Some functions return <code>slist</code>s (see <a href="#Introduction-to-functions">Introduction to functions</a>),
and an <code>slist</code> may contain the values copied from another <code>slist</code>,
<code>rlist</code>, or <code>ilist</code> (see <a href="#List-variable-substitution-and-expansion">List variable substitution and expansion</a>,
see <a href="#policy-in-vars">policy in vars</a>).

<div class="node">
<a name="meta-in-common-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#reports-in-common-promises">reports in common promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#defaults-in-common-promises">defaults in common promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-common">Bundles for common</a>

</div>

<h3 class="section">6.3 <code>meta</code> promises in &lsquo;<samp><span class="samp">*</span></samp>&rsquo;</h3>

<p><br>

   <p>Meta-data promises have no internal function. They are intended to be
used to represent arbitrary information about promise
bundles. Formally, meta promises are implemented as variables, and the
values map to a variable context called <var>bundlename_meta</var>, and
therefore the values can be used as variables and will appear in
Enterprise variable reports.

   <p><br>

<pre class="verbatim">
bundle agent example

{     
meta:

  "bundle_version" string => "1.2.3";
  "works_with_cfengine" string => "3.4.0";

reports:

 cfengine_3::

  "Not a local variable: $(bundle_version)";
  "Meta data (variable): $(example_meta.bundle_version)";

}

</pre>

   <p><br>

   <p><i>History</i>: Was introduced in 3.4.0, Enterprise 3.0.0 (2012)

<ul class="menu">
<li><a accesskey="1" href="#string-in-meta">string in meta</a>
<li><a accesskey="2" href="#slist-in-meta">slist in meta</a>
</ul>

<div class="node">
<a name="string-in-meta"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#slist-in-meta">slist in meta</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#meta-in-common-promises">meta in common promises</a>

</div>

<h4 class="subsection">6.3.1 <code>string</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: A scalar string

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
vars:

 "xxx"    string => "Some literal string...";

 "yyy"    string => readfile( "/home/mark/tmp/testfile" , "33" );

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>In CFEngine previously lists were represented (as in the shell) using
separted scalars, e.g. like the PATH variable. This design feature
turned out to be an error of judgement which has resulted in much
trouble. This is no longer supported in CFEngine 3. By keeping lists
an independent type many limitations have been removed.

<div class="node">
<a name="slist-in-meta"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#string-in-meta">string in meta</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#meta-in-common-promises">meta in common promises</a>

</div>

<h4 class="subsection">6.3.2 <code>slist</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: A list of scalar strings

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">vars:

 "xxx"    slist  => {  "literal1",  "literal2" };

 "yyy"    slist  => { 
                    readstringlist(
                                  "/home/mark/tmp/testlist",
                                  "#[a-zA-Z0-9 ]*",
                                  "[^a-zA-Z0-9]",
                                  15,
                                  4000
                                  ) 
                    };

 "zzz"    slist  => { readstringlist("/home/mark/tmp/testlist2","#[^\n]*",",",5,4000) };


</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>
Some functions return <code>slist</code>s (see <a href="#Introduction-to-functions">Introduction to functions</a>),
and an <code>slist</code> may contain the values copied from another <code>slist</code>,
<code>rlist</code>, or <code>ilist</code> (see <a href="#List-variable-substitution-and-expansion">List variable substitution and expansion</a>,
see <a href="#policy-in-vars">policy in vars</a>).

<div class="node">
<a name="reports-in-common-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#vars-in-common-promises">vars in common promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#meta-in-common-promises">meta in common promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-common">Bundles for common</a>

</div>

<h3 class="section">6.4 <code>reports</code> promises in &lsquo;<samp><span class="samp">*</span></samp>&rsquo;</h3>

<p><br>

   <p>Reports promises simply print messages. Outputting a message without
qualfication can be a `dangerous' operation. In a large installation
it could unleash an avalanche of messaging. For that reason reports
promises are not allowed to be in the class &lsquo;<samp><span class="samp">any</span></samp>&rsquo;; they must
be in a more specific class &ndash; this is not a fool-proof protection
but it generally weeds out simple carelessness.

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
      reports:
     
       "<var>literal string or file refererence</var>",
     
           printfile =&gt; <var>printfile_body</var>,
           ...;
     
</pre>
   </td></tr></table>

   <p>Messages outputted from report promises are prefixed with the letter
&lsquo;<samp><span class="samp">R</span></samp>&rsquo; to distinguish them from other output, e.g. from <code>commands</code>.

   <p>In CFEngine 2 reporting was performed with <code>alerts</code>. The phrase
alerts seems too strong and has been replaced by <code>reports</code>.

   <p><br>

<pre class="verbatim">
bundle agent report
{
reports:

  linux::

   "/etc/passwd except $(const.n)"

    # printfile => pr("/etc/passwd","5");

     showstate => { "otherprocs", "rootprocs" };

}

</pre>

   <p><br>

<ul class="menu">
<li><a accesskey="1" href="#friend_005fpattern-in-reports">friend_pattern in reports</a>
<li><a accesskey="2" href="#intermittency-in-reports">intermittency in reports</a>
<li><a accesskey="3" href="#lastseen-in-reports">lastseen in reports</a>
<li><a accesskey="4" href="#printfile-in-reports">printfile in reports</a>
<li><a accesskey="5" href="#report_005fto_005ffile-in-reports">report_to_file in reports</a>
<li><a accesskey="6" href="#bundle_005freturn_005fvalue_005findex-in-reports">bundle_return_value_index in reports</a>
<li><a accesskey="7" href="#showstate-in-reports">showstate in reports</a>
</ul>

<div class="node">
<a name="friend_pattern-in-reports"></a>
<a name="friend_005fpattern-in-reports"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#intermittency-in-reports">intermittency in reports</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#reports-in-common-promises">reports in common promises</a>

</div>

<h4 class="subsection">6.4.1 <code>friend_pattern</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Regular expression to keep selected hosts from the friends report list

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
reports:

  linux::

   "Friend status report"

          lastseen => "0",
     friend_pattern => "host1|host2|.*\.domain\.tld";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This regular expression should match hosts we want to exclude from friend reports.

<div class="node">
<a name="intermittency-in-reports"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#lastseen-in-reports">lastseen in reports</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#friend_005fpattern-in-reports">friend_pattern in reports</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#reports-in-common-promises">reports in common promises</a>

</div>

<h4 class="subsection">6.4.2 <code>intermittency</code></h4>

<p class="noindent"><b>Type</b>: real

<p class="noindent"><b>Allowed input range</b>: <code>0,1</code>

<p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: Real number threshold [0,1] of intermittency about current peers, report above

<p class="noindent"><b>Example</b>:<br>
<br>

<p class="noindent"><b>Notes</b>:<br>
<br>

<div class="node">
<a name="lastseen-in-reports"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#printfile-in-reports">printfile in reports</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#intermittency-in-reports">intermittency in reports</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#reports-in-common-promises">reports in common promises</a>

</div>

<h4 class="subsection">6.4.3 <code>lastseen</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

<p class="noindent"><b>Synopsis</b>: Integer time threshold in hours since current peers were last seen, report absence

<p class="noindent"><b>Example</b>:<br>
<br>

   <p>In control:
<pre class="verbatim">
body agent control
{
lastseen => "false";
}

</pre>

   <p>See also in reports:
<pre class="verbatim">
reports:

  "Comment"

    lastseen => "10";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>In reports: after this time (hours) has passed, CFEngine will begin to
warn about the host being overdue. After the <code>lastseenexpireafter</code> expiry time, hosts
will be purged from this host's database (default is a week).

   <p>In control: determines whether CFEngine will records last seen
intermittency profiles (reliability diagnostics) in
<samp><span class="file">WORKDIR/lastseen</span></samp>. This generates a separate file for each each
host that connects to the current host.  For central hubs this can
result is a huge number of files.

<div class="node">
<a name="printfile-in-reports"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#report_005fto_005ffile-in-reports">report_to_file in reports</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#lastseen-in-reports">lastseen in reports</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#reports-in-common-promises">reports in common promises</a>

</div>

<h4 class="subsection">6.4.4 <code>printfile</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>file_to_print</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>"?(/.*)</code>

     <p class="noindent"><b>Synopsis</b>: Path name to the file that is to be sent to standard output

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body printfile example
     {
     file_to_print   => "/etc/motd";
     number_of_lines => "10";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Include part of a file in a report.

     <br><dt>&lsquo;<samp><code>number_of_lines</code></samp>&rsquo;<dd><b>Type</b>: int

     <p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

     <p class="noindent"><b>Synopsis</b>: Integer maximum number of lines to print from selected file

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body printfile example
     {
     number_of_lines => "10";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

   </dl>

<div class="node">
<a name="report_to_file-in-reports"></a>
<a name="report_005fto_005ffile-in-reports"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#bundle_005freturn_005fvalue_005findex-in-reports">bundle_return_value_index in reports</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#printfile-in-reports">printfile in reports</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#reports-in-common-promises">reports in common promises</a>

</div>

<h4 class="subsection">6.4.5 <code>report_to_file</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>"?(/.*)</code>

<p class="noindent"><b>Synopsis</b>: The path and filename to which output should be appended

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle agent test
{
reports:

  linux::

   "$(sys.date),This is a report from $(sys.host)"

       report_to_file => "/tmp/test_log";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Append the output of the report to the named file instead of standard
output.  If the file cannot be opened for writing then the report
defaults to the standard output.

<div class="node">
<a name="bundle_return_value_index-in-reports"></a>
<a name="bundle_005freturn_005fvalue_005findex-in-reports"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#showstate-in-reports">showstate in reports</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#report_005fto_005ffile-in-reports">report_to_file in reports</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#reports-in-common-promises">reports in common promises</a>

</div>

<h4 class="subsection">6.4.6 <code>bundle_return_value_index</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>[a-zA-Z0-9_$(){}\[\].:]+</code>

<p class="noindent"><b>Synopsis</b>: The promiser is to be interpreted as a literal value that the caller can accept as a result for this bundle, i.e. a return value with array index defined by this attribute.

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">body common control
{
bundlesequence => { "test" };
}


bundle agent test
{
methods:

   "any" usebundle => child,
    useresult => "my_return_var";


reports:

  cfengine_3::

    "My return was: \"$(my_return_var[1])\" and \"$(my_return_var[2])\""; 
    
}

bundle agent child
{
reports:

 cfengine_3::

   # Map these indices into the useresult namespace

   "this is a return value"  
      bundle_return_value_index => "1";

   "this is another return value"  
      bundle_return_value_index => "2";

}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in 3.4.0 (2012)

   <p>It is currently believed that only scalar return values make sense, hence
return values are limited to scalars.

<div class="node">
<a name="showstate-in-reports"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#bundle_005freturn_005fvalue_005findex-in-reports">bundle_return_value_index in reports</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#reports-in-common-promises">reports in common promises</a>

</div>

<h4 class="subsection">6.4.7 <code>showstate</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: List of services about which status reports should be reported to standard output

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
reports:
  cfengine::

    "Comment"

      showstate => {"www_in", "ssh_out", "otherprocs" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The basic list of services is:

     <dl>
<dt>&lsquo;<samp><span class="samp">users</span></samp>&rsquo;<dd>Users logged in
<br><dt>&lsquo;<samp><span class="samp">rootprocs</span></samp>&rsquo;<dd>Privileged system processes
<br><dt>&lsquo;<samp><span class="samp">otherprocs</span></samp>&rsquo;<dd>Non-privileged process
<br><dt>&lsquo;<samp><span class="samp">diskfree</span></samp>&rsquo;<dd>Free disk on / partition
<br><dt>&lsquo;<samp><span class="samp">loadavg</span></samp>&rsquo;<dd>% kernel load utilization
<br><dt>&lsquo;<samp><span class="samp">netbiosns_in</span></samp>&rsquo;<dd>netbios name lookups (in)
<br><dt>&lsquo;<samp><span class="samp">netbiosns_out</span></samp>&rsquo;<dd>netbios name lookups (out)
<br><dt>&lsquo;<samp><span class="samp">netbiosdgm_in</span></samp>&rsquo;<dd>netbios name datagrams (in)
<br><dt>&lsquo;<samp><span class="samp">netbiosdgm_out</span></samp>&rsquo;<dd>netbios name datagrams (out)
<br><dt>&lsquo;<samp><span class="samp">netbiosssn_in</span></samp>&rsquo;<dd>netbios name sessions (in)
<br><dt>&lsquo;<samp><span class="samp">netbiosssn_out</span></samp>&rsquo;<dd>netbios name sessions (out)
<br><dt>&lsquo;<samp><span class="samp">irc_in</span></samp>&rsquo;<dd>IRC connections (in)
<br><dt>&lsquo;<samp><span class="samp">irc_out</span></samp>&rsquo;<dd>IRC connections (out)
<br><dt>&lsquo;<samp><span class="samp">cfengine_in</span></samp>&rsquo;<dd>CFEngine connections (in)
<br><dt>&lsquo;<samp><span class="samp">cfengine_out</span></samp>&rsquo;<dd>CFEngine connections (out)
<br><dt>&lsquo;<samp><span class="samp">nfsd_in</span></samp>&rsquo;<dd>nfs connections (in)
<br><dt>&lsquo;<samp><span class="samp">nfsd_out</span></samp>&rsquo;<dd>nfs connections (out)
<br><dt>&lsquo;<samp><span class="samp">smtp_in</span></samp>&rsquo;<dd>smtp connections (in)
<br><dt>&lsquo;<samp><span class="samp">smtp_out</span></samp>&rsquo;<dd>smtp connections (out)
<br><dt>&lsquo;<samp><span class="samp">www_in</span></samp>&rsquo;<dd>www connections (in)
<br><dt>&lsquo;<samp><span class="samp">www_out</span></samp>&rsquo;<dd>www connections (out)
<br><dt>&lsquo;<samp><span class="samp">ftp_in</span></samp>&rsquo;<dd>ftp connections (in)
<br><dt>&lsquo;<samp><span class="samp">ftp_out</span></samp>&rsquo;<dd>ftp connections (out)
<br><dt>&lsquo;<samp><span class="samp">ssh_in</span></samp>&rsquo;<dd>ssh connections (in)
<br><dt>&lsquo;<samp><span class="samp">ssh_out</span></samp>&rsquo;<dd>ssh connections (out)
<br><dt>&lsquo;<samp><span class="samp">wwws_in</span></samp>&rsquo;<dd>wwws connections (in)
<br><dt>&lsquo;<samp><span class="samp">wwws_out</span></samp>&rsquo;<dd>wwws connections (out)
<br><dt>&lsquo;<samp><span class="samp">icmp_in</span></samp>&rsquo;<dd>ICMP packets (in)
<br><dt>&lsquo;<samp><span class="samp">icmp_out</span></samp>&rsquo;<dd>ICMP packets (out)
<br><dt>&lsquo;<samp><span class="samp">udp_in</span></samp>&rsquo;<dd>UDP dgrams (in)
<br><dt>&lsquo;<samp><span class="samp">udp_out</span></samp>&rsquo;<dd>UDP dgrams (out)
<br><dt>&lsquo;<samp><span class="samp">dns_in</span></samp>&rsquo;<dd>DNS requests (in)
<br><dt>&lsquo;<samp><span class="samp">dns_out</span></samp>&rsquo;<dd>DNS requests (out)
<br><dt>&lsquo;<samp><span class="samp">tcpsyn_in</span></samp>&rsquo;<dd>TCP sessions (in)
<br><dt>&lsquo;<samp><span class="samp">tcpsyn_out</span></samp>&rsquo;<dd>TCP sessions (out)
<br><dt>&lsquo;<samp><span class="samp">tcpack_in</span></samp>&rsquo;<dd>TCP acks (in)
<br><dt>&lsquo;<samp><span class="samp">tcpack_out</span></samp>&rsquo;<dd>TCP acks (out)
<br><dt>&lsquo;<samp><span class="samp">tcpfin_in</span></samp>&rsquo;<dd>TCP finish (in)
<br><dt>&lsquo;<samp><span class="samp">tcpfin_out</span></samp>&rsquo;<dd>TCP finish (out)
<br><dt>&lsquo;<samp><span class="samp">tcpmisc_in</span></samp>&rsquo;<dd>TCP misc (in)
<br><dt>&lsquo;<samp><span class="samp">tcpmisc_out</span></samp>&rsquo;<dd>TCP misc (out)
<br><dt>&lsquo;<samp><span class="samp">webaccess</span></samp>&rsquo;<dd>Webserver hits
<br><dt>&lsquo;<samp><span class="samp">weberrors</span></samp>&rsquo;<dd>Webserver errors
<br><dt>&lsquo;<samp><span class="samp">syslog</span></samp>&rsquo;<dd>New log entries (Syslog)
<br><dt>&lsquo;<samp><span class="samp">messages</span></samp>&rsquo;<dd>New log entries (messages)
<br><dt>&lsquo;<samp><span class="samp">temp0</span></samp>&rsquo;<dd>CPU Temperature 0
<br><dt>&lsquo;<samp><span class="samp">temp1</span></samp>&rsquo;<dd>CPU Temperature 1
<br><dt>&lsquo;<samp><span class="samp">temp2</span></samp>&rsquo;<dd>CPU Temperature 2
<br><dt>&lsquo;<samp><span class="samp">temp3</span></samp>&rsquo;<dd>CPU Temperature 3
<br><dt>&lsquo;<samp><span class="samp">cpu</span></samp>&rsquo;<dd>%CPU utilization (all)
<br><dt>&lsquo;<samp><span class="samp">cpu0</span></samp>&rsquo;<dd>%CPU utilization 0
<br><dt>&lsquo;<samp><span class="samp">cpu1</span></samp>&rsquo;<dd>%CPU utilization 1
<br><dt>&lsquo;<samp><span class="samp">cpu2</span></samp>&rsquo;<dd>%CPU utilization 2
<br><dt>&lsquo;<samp><span class="samp">cpu3</span></samp>&rsquo;<dd>%CPU utilization 3
</dl>

<div class="node">
<a name="vars-in-common-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Miscellaneous-in-common-promises">Miscellaneous in common promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#reports-in-common-promises">reports in common promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-common">Bundles for common</a>

</div>

<h3 class="section">6.5 <code>vars</code> promises in &lsquo;<samp><span class="samp">*</span></samp>&rsquo;</h3>

<p><br>

   <p>Variables in CFEngine are defined as promises that an identifier
represents a particular value. Variables in CFEngine are dynamically
typed as strings, integers and real numbers. Lists of these types
are also possible.

   <p>CFEngine supports a few operations on arrays. Arrays are simply a
naming convention for scalar variables, using square brackets &lsquo;<samp><span class="samp">[]</span></samp>&rsquo;
to enclose an arbitrary key. Arrays are thus <code>associative</code>.

   <p><br>

<pre class="verbatim">
bundle agent example

{     
vars:

  "scalar1" string => "SCALAR 1";
  "list1" slist => { "LIST1_1", "LIST1_2" } ;
  "array[1]" string => "ARRAY 1";
  "array[2]" string => "ARRAY 2";

  "i" slist => getindices("array");

reports:

  cfengine_3::

    "Scalar $(scalar1)";
    "List $(list1)";
    "Array $(array[$(i)])";
}


</pre>

   <p><br>

<ul class="menu">
<li><a accesskey="1" href="#string-in-vars">string in vars</a>
<li><a accesskey="2" href="#int-in-vars">int in vars</a>
<li><a accesskey="3" href="#real-in-vars">real in vars</a>
<li><a accesskey="4" href="#slist-in-vars">slist in vars</a>
<li><a accesskey="5" href="#ilist-in-vars">ilist in vars</a>
<li><a accesskey="6" href="#rlist-in-vars">rlist in vars</a>
<li><a accesskey="7" href="#policy-in-vars">policy in vars</a>
</ul>

<div class="node">
<a name="string-in-vars"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#int-in-vars">int in vars</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#vars-in-common-promises">vars in common promises</a>

</div>

<h4 class="subsection">6.5.1 <code>string</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: A scalar string

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
vars:

 "xxx"    string => "Some literal string...";

 "yyy"    string => readfile( "/home/mark/tmp/testfile" , "33" );

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>In CFEngine previously lists were represented (as in the shell) using
separted scalars, e.g. like the PATH variable. This design feature
turned out to be an error of judgement which has resulted in much
trouble. This is no longer supported in CFEngine 3. By keeping lists
an independent type many limitations have been removed.

<div class="node">
<a name="int-in-vars"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#real-in-vars">real in vars</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#string-in-vars">string in vars</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#vars-in-common-promises">vars in common promises</a>

</div>

<h4 class="subsection">6.5.2 <code>int</code></h4>

<p class="noindent"><b>Type</b>: int

<p class="noindent"><b>Allowed input range</b>: <code>-99999999999,9999999999</code>

<p class="noindent"><b>Synopsis</b>: A scalar integer

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">vars:

 "scalar" int    => "16k";

 "ran"    int    => randomint(4,88);

 "dim_array" int =>  readstringarray("array_name","/etc/passwd","#[^\n]*",":",10,4000);

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>
Int variables are strings that are expected to be used as integer numbers. The
typing in CFEngine is dynamic, so the variable types are interchangable, but
when you declare a variable to be type <code>int</code>, CFEngine verifies that
the value you assign to it looks like an integer (e.g., &lsquo;<samp><span class="samp">3</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">-17</span></samp>&rsquo;, &lsquo;<samp><span class="samp">16K</span></samp>&rsquo;, etc).

   <p>Integer values may use suffices &lsquo;<samp><span class="samp">k</span></samp>&rsquo;, &lsquo;<samp><span class="samp">K</span></samp>&rsquo;, &lsquo;<samp><span class="samp">m</span></samp>&rsquo;, &lsquo;<samp><span class="samp">M</span></samp>&rsquo;, etc.,
but must only have an integer numeric part (so &lsquo;<samp><span class="samp">1.5M</span></samp>&rsquo; is not allowed).

     <dl>
<dt>&lsquo;<samp><span class="samp">k</span></samp>&rsquo;<dd>The value multipled by 1000. 
<br><dt>&lsquo;<samp><span class="samp">K</span></samp>&rsquo;<dd>The value multipled by 1024. 
<br><dt>&lsquo;<samp><span class="samp">m</span></samp>&rsquo;<dd>The value multipled by 1000 * 1000. 
<br><dt>&lsquo;<samp><span class="samp">M</span></samp>&rsquo;<dd>The value multipled by 1024 * 1024. 
<br><dt>&lsquo;<samp><span class="samp">g</span></samp>&rsquo;<dd>The value multipled by 1000 * 1000 * 1000. 
<br><dt>&lsquo;<samp><span class="samp">G</span></samp>&rsquo;<dd>The value multipled by 1024 * 1024 * 1024. 
<br><dt>&lsquo;<samp><span class="samp">%</span></samp>&rsquo;<dd>A percentage between 1 and 100 - mainly for use in a storage context.

   </dl>

   <p>The value &lsquo;<samp><span class="samp">inf</span></samp>&rsquo; may also be used to represent an unlimited positive value.

<div class="node">
<a name="real-in-vars"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#slist-in-vars">slist in vars</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#int-in-vars">int in vars</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#vars-in-common-promises">vars in common promises</a>

</div>

<h4 class="subsection">6.5.3 <code>real</code></h4>

<p class="noindent"><b>Type</b>: real

<p class="noindent"><b>Allowed input range</b>: <code>-9.99999E100,9.99999E100</code>

<p class="noindent"><b>Synopsis</b>: A scalar real number

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
vars:
   
 "scalar" real   => "0.5";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>
Real variables are strings that are expected to be used as real numbers. The
typing in CFEngine is dynamic, so the variable types are interchangable, but
when you declare a variable to be type <code>real</code>, CFEngine verifies that
the value you assign to it looks like a real number (e.g., &lsquo;<samp><span class="samp">3</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">3.1415</span></samp>&rsquo;, &lsquo;<samp><span class="samp">.17</span></samp>&rsquo;, &lsquo;<samp><span class="samp">6.02e23</span></samp>&rsquo;, &lsquo;<samp><span class="samp">-9.21e-17</span></samp>&rsquo;, etc).

   <p>Real numbers are not used in many places in CFEngine, but they are
useful for representing probabilties and performance data.

<div class="node">
<a name="slist-in-vars"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#ilist-in-vars">ilist in vars</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#real-in-vars">real in vars</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#vars-in-common-promises">vars in common promises</a>

</div>

<h4 class="subsection">6.5.4 <code>slist</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: A list of scalar strings

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">vars:

 "xxx"    slist  => {  "literal1",  "literal2" };

 "yyy"    slist  => { 
                    readstringlist(
                                  "/home/mark/tmp/testlist",
                                  "#[a-zA-Z0-9 ]*",
                                  "[^a-zA-Z0-9]",
                                  15,
                                  4000
                                  ) 
                    };

 "zzz"    slist  => { readstringlist("/home/mark/tmp/testlist2","#[^\n]*",",",5,4000) };


</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>
Some functions return <code>slist</code>s (see <a href="#Introduction-to-functions">Introduction to functions</a>),
and an <code>slist</code> may contain the values copied from another <code>slist</code>,
<code>rlist</code>, or <code>ilist</code> (see <a href="#List-variable-substitution-and-expansion">List variable substitution and expansion</a>,
see <a href="#policy-in-vars">policy in vars</a>).

<div class="node">
<a name="ilist-in-vars"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#rlist-in-vars">rlist in vars</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#slist-in-vars">slist in vars</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#vars-in-common-promises">vars in common promises</a>

</div>

<h4 class="subsection">6.5.5 <code>ilist</code></h4>

<p class="noindent"><b>Type</b>: ilist

<p class="noindent"><b>Allowed input range</b>: <code>-99999999999,9999999999</code>

<p class="noindent"><b>Synopsis</b>: A list of integers

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
vars:

  "variable_id"

       ilist => { "10", "11", "12" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Integer lists are lists of strings that are expected to be treated as integers. 
The typing in CFEngine is dynamic, so the variable types are interchangable,
but when you declare a variable to be type <code>ilist</code>, CFEngine verifies that
each value you assign to it looks like an integer (e.g., &lsquo;<samp><span class="samp">3</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">-17</span></samp>&rsquo;, &lsquo;<samp><span class="samp">16K</span></samp>&rsquo;, etc).

   <p>Some functions return <code>ilist</code>s (see <a href="#Introduction-to-functions">Introduction to functions</a>),
and an <code>ilist</code> may contain the values copied from another <code>slist</code>,
<code>rlist</code>, or <code>ilist</code> (see <a href="#List-variable-substitution-and-expansion">List variable substitution and expansion</a>,
see <a href="#policy-in-vars">policy in vars</a>).

<div class="node">
<a name="rlist-in-vars"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#policy-in-vars">policy in vars</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#ilist-in-vars">ilist in vars</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#vars-in-common-promises">vars in common promises</a>

</div>

<h4 class="subsection">6.5.6 <code>rlist</code></h4>

<p class="noindent"><b>Type</b>: rlist

<p class="noindent"><b>Allowed input range</b>: <code>-9.99999E100,9.99999E100</code>

<p class="noindent"><b>Synopsis</b>: A list of real numbers

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
vars:

  "varid" rlist => { "0.1", "0.2", "0.3" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>
Real lists are lists of strings that are expected to be used as real numbers. 
The typing in CFEngine is dynamic, so the variable types are interchangable,
but when you declare a variable to be type <code>rlist</code>, CFEngine verifies that
each value you assign to it looks like a real number (e.g., &lsquo;<samp><span class="samp">3</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">3.1415</span></samp>&rsquo;, &lsquo;<samp><span class="samp">.17</span></samp>&rsquo;, &lsquo;<samp><span class="samp">6.02e23</span></samp>&rsquo;, &lsquo;<samp><span class="samp">-9.21e-17</span></samp>&rsquo;, etc).

   <p>Some functions return <code>rlist</code>s (see <a href="#Introduction-to-functions">Introduction to functions</a>),
and an <code>rlist</code> may contain the values copied from another <code>slist</code>,
<code>rlist</code>, or <code>ilist</code> (see <a href="#List-variable-substitution-and-expansion">List variable substitution and expansion</a>,
see <a href="#policy-in-vars">policy in vars</a>).

<div class="node">
<a name="policy-in-vars"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#rlist-in-vars">rlist in vars</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#vars-in-common-promises">vars in common promises</a>

</div>

<h4 class="subsection">6.5.7 <code>policy</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>free</code>
               <code>overridable</code>
               <code>constant</code>
               <code>ifdefined</code>
</pre>
   <p class="noindent"><b>Synopsis</b>: The policy for (dis)allowing (re)definition of variables

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
vars:

  "varid" string => "value...",
          policy => "constant";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Variables can either be allowed to change their value dynamically (be
redefined) or they can be constant. The use of private variable spaces
in CFEngine 3 makes it unlikely that variable redefinition would be
necessary in CFEngine 3.

   <p>The value <code>constant</code> indicates that the variable value may not be
changed.  The values <code>free</code> and <code>overridable</code> are synonymous, and
indicated the the variable's value may be changed.

   <p>The value <code>ifdefined</code> applies only to lists and implies that unexpanded
or undefined lists are dropped. The default behaviour is otherwise to
retain this value as an indicator of the failure to quench the variable
reference, e.g.
<pre class="verbatim">   
    "one" slist => { "1", "2", "3" };

   "list" slist => { "@(one)", @(two) },

            policy => "ifdefined";

</pre>
would result in &lsquo;<samp><span class="samp">@(list)</span></samp>&rsquo; being the same as &lsquo;<samp><span class="samp">@(one)</span></samp>&rsquo;,
and the reference to &lsquo;<samp><span class="samp">@(two)</span></samp>&rsquo; would disappear. This is useful for combining
lists, `inheritance-style' where one can extend a base with special cases if they
are defined.

<p class="noindent"><b>Default value</b>:<br>
<br>

   <p><code>policy =&gt; constant</code>

<div class="node">
<a name="Miscellaneous-in-common-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#commands-in-agent-promises">commands in agent promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#vars-in-common-promises">vars in common promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-common">Bundles for common</a>

</div>

<h3 class="section">6.6 <code>*</code> promises</h3>

<p><br>

   <p>Whereas most promise types are specific to a particular kind of
interpretation that requires a typed interpreter (the bundle type),
a number of promises can be made in any kind of bundle since they
are of a generic input/output nature. These are <code>vars</code>, <code>classes</code>,
and <code>reports</code> promises.  The specific promise attributes are listed below.

<ul class="menu">
<li><a accesskey="1" href="#action-in-_002a">action in *</a>
<li><a accesskey="2" href="#classes-in-_002a">classes in *</a>
<li><a accesskey="3" href="#comment-in-_002a">comment in *</a>
<li><a accesskey="4" href="#depends_005fon-in-_002a">depends_on in *</a>
<li><a accesskey="5" href="#handle-in-_002a">handle in *</a>
<li><a accesskey="6" href="#ifvarclass-in-_002a">ifvarclass in *</a>
<li><a accesskey="7" href="#meta-in-_002a">meta in *</a>
</ul>

<div class="node">
<a name="action-in-*"></a>
<a name="action-in-_002a"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#classes-in-_002a">classes in *</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Miscellaneous-in-common-promises">Miscellaneous in common promises</a>

</div>

<h4 class="subsection">6.6.1 <code>action</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>action_policy</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>fix</code>
                    <code>warn</code>
                    <code>nop</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Whether to repair or report about non-kept promises

     <p><b>Example</b>:<br>
<br>

     <p>The following example shows a simple use of transaction control,
causing the promise to be verified as a separate background process.

     <pre class="verbatim">     
     body action background
     
     {
     action_policy => "warn";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The <code>action</code> settings allow general transaction control to be
implemented on promise verification. Action bodies place limits on how
often to verify the promise and what classes to raise in the case that
the promise can or cannot be kept.

     <p>Note that actions can be added to sub-bundles like methods and editing
bundles, and that promises within these do not inherit action settings
at higher levels. Thus, in the following example there are two levels
of action setting:

     <pre class="verbatim">     ########################################################
     #
     # Warn if line matched
     #
     ########################################################
     
     body common control
     
     {
     bundlesequence  => { "testbundle" };
     }
     
     ########################################################
     
     bundle agent testbundle
     
     {
     files:
     
       "/var/cfengine/inputs/.*"
     
            edit_line => DeleteLinesMatching(".*cfenvd.*"),
            action => WarnOnly;
     }
     
     ########################################################
     
     bundle edit_line DeleteLinesMatching(regex)
       {
       delete_lines:
     
         "$(regex)" action => WarnOnly;
     
       }
     
     ########################################################
     
     body action WarnOnly
     {
     action_policy => "warn";
     }
</pre>

     <p>The <code>action</code> setting for the <code>files</code> promise means that file
edits will not be committed to disk, only warned about. This is a master-level
promise that overrides anything that happens during the editing. The
<code>action</code> setting for the edit bundle means that the internal
memory modelling of the file will only warn about changes rather than
committing them to the memory model. This makes little difference to the
end result, but it means that CFEngine will report

     <pre class="smallexample">          Need to delete line - ... - but only a warning was promised
</pre>
     <p class="noindent">Instead of

     <pre class="smallexample">          Deleting the prpomised line ...
          Need to save file - but only a warning was promised
</pre>
     <p class="noindent">In either case, no changes will be made to the disk, but the messages
given by <code>cf-agent</code> will differ.

     <br><dt>&lsquo;<samp><code>ifelapsed</code></samp>&rsquo;<dd><b>Type</b>: int

     <p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

     <p class="noindent"><b>Synopsis</b>: Number of minutes before next allowed assessment of promise

     <p class="noindent"><b>Default value:</b> control body value

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     #local
     
     body action example
     {
     ifelapsed   => "120";	# 2 hours
     expireafter => "240";	# 4 hours
     }
     
     # global
     
     body agent control
     {
     ifelapsed   => "180";	# 3 hours
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This overrides the global settings. Promises which take a long time to
verify should usually be protected with a long value for this
parameter.  This serves as a resource `spam' protection. A CFEngine
check could easily run every 5 minutes provided resource intensive
operations are not performed on every run. Using time classes like
<code>Hr12</code> etc., is one part of this strategy; using <code>ifelapsed</code>
is another which is not tied to a specific time.

     <br><dt>&lsquo;<samp><code>expireafter</code></samp>&rsquo;<dd><b>Type</b>: int

     <p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

     <p class="noindent"><b>Synopsis</b>: Number of minutes before a repair action is interrupted and retried

     <p class="noindent"><b>Default value:</b> control body value

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     body action example
     {
     ifelapsed   => "120";	# 2 hours
     expireafter => "240";	# 4 hours
     }
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The locking time after which CFEngine will attempt to kill and restart
its attempt to keep a promise.

     <br><dt>&lsquo;<samp><code>log_string</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: A message to be written to the log when a promise verification leads to a repair

     <p><b>Example</b>:<br>
<br>

     <pre class="example">          
          <var>promise-type</var>:
          
           "promiser"
          
             attr =&gt; "value",
             action =&gt; log_me("checked $(this.promiser) in promise $(this.handle)");
          
          # ..
          
          body action log_me(s)
          {
          log_string =&gt; "$(s)";
          }
          
</pre>
     <p><b>Notes</b>:<br>
<br>

     <p>The <code>log_string</code> works together with <code>log_repair</code>,
<code>log_kept</code> etc, to define a string for logging to one of the named
files depending on promise outcome, or to standard output of the log file
is stipulared as &lsquo;<samp><span class="samp">stdout</span></samp>&rsquo;. Log strings on standard output are denoted
by an &lsquo;<samp><span class="samp">L:</span></samp>&rsquo; prefix.

     <p>Note that <code>log_string</code> does not interact with <code>log_level</code>,
which is about regular system output messages.

     <p>Hint: the promise handle &lsquo;<samp><span class="samp">$(this.handle)</span></samp>&rsquo; can be a useful
referent in a log message, indicating the origin of the message. In
CFEngine Nova and above, every promise has a default handle (which is based o
the filename and line number - specifying your own handle will probably be
more mnemonic)..

     <br><dt>&lsquo;<samp><code>log_level</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>inform</code>
                    <code>verbose</code>
                    <code>error</code>
                    <code>log</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: The reporting level sent to syslog

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body action example
     {
     log_level => "inform";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Use this as an alternative to auditing to use the syslog mechanism to centralize
or manage messaging from CFEngine. A backup of these messages will still be
kept in <samp><span class="file">WORKDIR/outputs</span></samp> if you are using <code>cf-execd</code>.

     <p>On native Windows version of CFEngine (Nova or above), using
&lsquo;<samp><span class="samp">verbose</span></samp>&rsquo; will include a message when the promise is kept or
repaired in the event log.

     <br><dt>&lsquo;<samp><code>log_kept</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>stdout|udp_syslog|("?[a-zA-Z]:\\.*)|(/.*)</code>

     <p class="noindent"><b>Synopsis</b>: This should be filename of a file to which log_string will be saved, if undefined it goes to the system logger

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body action logme(x)
     {
     log_kept => "/tmp/private_keptlog.log";
     log_failed => "/tmp/private_faillog.log";
     log_repaired => "/tmp/private_replog.log";
     log_string => "$(sys.date) $(x) promise status";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>If this option is specified together with <code>log_string</code>, the
current promise will log promise-kept status using the log string to
this named file. If these log names are absent, the default logging
destination for the log string is syslog, but only for non-kept
promises. Only the <code>log_string</code> is affected by this setting. Other messages
destined for logging are sent to syslog.

     <p>It is intended that named file logs should be different for the three
cases: promise kept, promise not kept and promise repaired.

     <p>This string should be the full path to a text file which will contain
the log, of one of the following special values:

          <dl>
<dt>&lsquo;<samp><span class="samp">stdout</span></samp>&rsquo;<dd>Send the log message to the standard output, prefixed with an &lsquo;<samp><span class="samp">L:</span></samp>&rsquo; to indicate a log message. 
<br><dt>&lsquo;<samp><span class="samp">udp_syslog</span></samp>&rsquo;<dd>Attempt to connect to the <code>syslog_server</code> defined in &lsquo;<samp><span class="samp">body common control</span></samp>&rsquo; and log the message there,
assuming the server is configured to receive the request. 
</dl>

     <br><dt>&lsquo;<samp><code>log_priority</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>emergency</code>
                    <code>alert</code>
                    <code>critical</code>
                    <code>error</code>
                    <code>warning</code>
                    <code>notice</code>
                    <code>info</code>
                    <code>debug</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: The priority level of the log message, as interpreted by a syslog server

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     body action low_priority
     {
     log_priority => "info";
     }
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This determines the importance of messages from CFEngine.

     <br><dt>&lsquo;<samp><code>log_repaired</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>stdout|udp_syslog|("?[a-zA-Z]:\\.*)|(/.*)</code>

     <p class="noindent"><b>Synopsis</b>: This should be filename of a file to which log_string will be saved, if undefined it goes to the system logger

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     bundle agent test
     {
     vars:
     
       "software" slist => { "/root/xyz", "/tmp/xyz" };
     
     files:
     
       "$(software)"
     
         create => "true",
          action => logme("$(software)");
     
     }
     
     body action logme(x)
     {
     log_kept => "/tmp/private_keptlog.log";
     log_failed => "/tmp/private_faillog.log";
     log_repaired => "/tmp/private_replog.log";
     log_string => "$(sys.date) $(x) promise status";
     }
     
     body action immediate_syslog(x) 
     {
     log_repaired => "udp_syslog"; # Nova and above 
     log_string => "CFEngine repaired promise $(this.handle) - $(x)";
     }
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This may be the name of a log to which the <code>log_string</code> is written if a promise is repaired. 
It should be the full path to a text file which will contain the log, of one of the following special
values:

          <dl>
<dt>&lsquo;<samp><span class="samp">stdout</span></samp>&rsquo;<dd>Send the log message to the standard output, prefixed with an &lsquo;<samp><span class="samp">L:</span></samp>&rsquo; to indicate a log message. 
<br><dt>&lsquo;<samp><span class="samp">udp_syslog</span></samp>&rsquo;<dd>Attempt to connect to the <code>syslog_server</code> defined in &lsquo;<samp><span class="samp">body common control</span></samp>&rsquo; and log the message there,
assuming the server is configured to receive the request. 
</dl>

     <br><dt>&lsquo;<samp><code>log_failed</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>stdout|udp_syslog|("?[a-zA-Z]:\\.*)|(/.*)</code>

     <p class="noindent"><b>Synopsis</b>: This should be filename of a file to which log_string will be saved, if undefined it goes to the system logger

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     bundle agent test
     {
     vars:
     
       "software" slist => { "/root/xyz", "/tmp/xyz" };
     
     files:
     
       "$(software)"
     
         create => "true",
          action => logme("$(software)");
     
     }
     
     
     body action logme(x)
     {
     log_kept => "/tmp/private_keptlog.log";
     log_failed => "/tmp/private_faillog.log";
     log_repaired => "/tmp/private_replog.log";
     log_string => "$(sys.date) $(x) promise status";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>If this option is specified together with <code>log_string</code>, the
current promise will log promise-kept status using the log string to
this named file. If these log names are absent, the default logging
destination for the log string is syslog, but only for non-kept
promises. Only the <code>log_string</code> is affected by this setting. Other messages
destined for logging are sent to syslog.

     <p>It is intended that named file logs should be different for the three
cases: promise kept, promise not kept and promise repaired. 
This string should be the full path to a text file which will contain
the log, of one of the following special values:

          <dl>
<dt>&lsquo;<samp><span class="samp">stdout</span></samp>&rsquo;<dd>Send the log message to the standard output, prefixed with an &lsquo;<samp><span class="samp">L:</span></samp>&rsquo; to indicate a log message. 
<br><dt>&lsquo;<samp><span class="samp">udp_syslog</span></samp>&rsquo;<dd>Attempt to connect to the <code>syslog_server</code> defined in &lsquo;<samp><span class="samp">body common control</span></samp>&rsquo; and log the message there,
assuming the server is configured to receive the request. 
</dl>

     <br><dt>&lsquo;<samp><code>value_kept</code></samp>&rsquo;<dd><b>Type</b>: real

     <p class="noindent"><b>Allowed input range</b>: <code>-9.99999E100,9.99999E100</code>

     <p class="noindent"><b>Synopsis</b>: A real number value attributed to keeping this promise

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body action mydef
     {
     value_kept     => "4.5";   # this promise is worth 4.5 dollars per hour
     value_repaired => "2.5";   # fixing this promise is worth 2.5 dollars per hour
     value_notkept  => "-10.0"; # not keeping this promise costs is 10 dollars per hour
     ifelapsed       => "60";   # one hour
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>If nothing is specified, the default value is +1.0. 
However, nothing is logged unless the agent control body switched on
&lsquo;<samp><span class="samp">track_value =&gt; "true"</span></samp>&rsquo;.

     <br><dt>&lsquo;<samp><code>value_repaired</code></samp>&rsquo;<dd><b>Type</b>: real

     <p class="noindent"><b>Allowed input range</b>: <code>-9.99999E100,9.99999E100</code>

     <p class="noindent"><b>Synopsis</b>: A real number value attributed to reparing this promise

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body action mydef
     {
     value_kept     => "4.5";   # this promise is worth 4.5 dollars per hour
     value_repaired => "2.5";   # fixing this promise is worth 2.5 dollars per hour
     value_notkept  => "-10.0"; # not keeping this promise costs is 10 dollars per hour
     ifelapsed       => "60";   # one hour
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>If nothing is specified, the default value is 0.5. 
However, nothing is logged unless the agent control body switched on
&lsquo;<samp><span class="samp">track_value =&gt; "true"</span></samp>&rsquo;.

     <br><dt>&lsquo;<samp><code>value_notkept</code></samp>&rsquo;<dd><b>Type</b>: real

     <p class="noindent"><b>Allowed input range</b>: <code>-9.99999E100,9.99999E100</code>

     <p class="noindent"><b>Synopsis</b>: A real number value (possibly negative) attributed to not keeping this promise

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body action mydef
     {
     value_kept     => "4.5";   # this promise is worth 4.5 dollars per hour
     value_repaired => "2.5";   # fixing this promise is worth 2.5 dollars per hour
     value_notkept  => "-10.0"; # not keeping this promise costs is 10 dollars per hour
     ifelapsed       => "60";   # one hour
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>If nothing is specified, the default value is -1.0. 
However, nothing is logged unless the agent control body switched on
&lsquo;<samp><span class="samp">track_value =&gt; "true"</span></samp>&rsquo;.

     <br><dt>&lsquo;<samp><code>audit</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false switch for detailed audit records of this promise

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body action example
     {
     # ...
     
     audit => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>If this is set, CFEngine will perform auditing on this specific
promise. This means that all details surrounding the verification of
the current promise will be recorded in the audit database. The
database may be inspected with <code>cf-report</code>, or <code>cfshow</code> in
CFEngine 2.

     <br><dt>&lsquo;<samp><code>background</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false switch for parallelizing the promise repair

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body action example
     {
     background => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>If possible, perform the verification of the current promise in the background. 
This is advantageous only if the verification might take a significant
amount of time, e.g. in remote copying of filesystem/disk scans.

     <p>On the windows version of CFEngine Nova, this can be useful if we
don't want to wait for a particular command to finish execution before
checking the next promise. This is particular for the windows platform
because there is no way that a program can start itself in the
background here (i.e. fork off a child process). However, file
operations can not be performed in the background on windows.

     <br><dt>&lsquo;<samp><code>report_level</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>inform</code>
                    <code>verbose</code>
                    <code>error</code>
                    <code>log</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: The reporting level for standard output for this promise

     <p class="noindent"><b>Default value:</b> none

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body action example
     {
     report_level => "verbose";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>cf-agent can be run in verbose mode (-v), inform mode (-I) and just print errors (no arguments). 
This attribute allows to set these three output levels on a per promise basis, allowing
the promise to be more verbose than the global setting (but not less).

     <p>In CFEngine 2 one would say &lsquo;<samp><span class="samp">inform=true</span></samp>&rsquo; or &lsquo;<samp><span class="samp">syslog=true</span></samp>&rsquo;, etc. 
This replaces these levels since they act as encapsulating super-sets.

     <br><dt>&lsquo;<samp><code>measurement_class</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: If set performance will be measured and recorded under this identifier

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     
     body action measure
     {
     measurement_class => "$(this.promiser) long job scan of /usr";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>By setting this string you switch on performance measurement for the
current promise, and also give the measurement a name. The identifier forms a
partial identity for optional performance scanning of promises of the form:

     <pre class="example">          <var>ID:promise-type:promiser</var>.
</pre>
     <p>These can be seen identifying  using <code>cf-report</code>, e.g. in the
generated file <samp><span class="file">performance.html</span></samp>.

   </dl>

<div class="node">
<a name="classes-in-*"></a>
<a name="classes-in-_002a"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#comment-in-_002a">comment in *</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#action-in-_002a">action in *</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Miscellaneous-in-common-promises">Miscellaneous in common promises</a>

</div>

<h4 class="subsection">6.6.2 <code>classes</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>promise_repaired</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>[a-zA-Z0-9_$(){}\[\].:]+</code>

     <p class="noindent"><b>Synopsis</b>: A list of classes to be defined globally

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body classes example
     {
     promise_repaired => { "change_happened" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>If a promise is `repaired' it means that a corrective action had to be
taken to keep the promise.

     <p>Note that any strings passed to this list are automatically
canonified, so it is unecessary to call a canonify function on such inputs.

     <p>Important: complex promises, e.g. <code>files</code> promises that set
multiple parameters on a file simultaneously can report misleadingly. 
The classes for different parts of a promise are not separable. Thus,
if you promise to create and file and change its permissions, when the
file exists with incorrect permissions, <code>cf-agent</code> will report
that the &lsquo;<samp><span class="samp">promise_kept</span></samp>&rsquo; for the file existence, but
&lsquo;<samp><span class="samp">promise_repaired</span></samp>&rsquo; for the permissions. If you need separate
reports, you should code two separate promises rather than `overloading'
a single one.

     <br><dt>&lsquo;<samp><code>repair_failed</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>[a-zA-Z0-9_$(){}\[\].:]+</code>

     <p class="noindent"><b>Synopsis</b>: A list of classes to be defined globally

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body classes example
     {
     repair_failed => { "unknown_error" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>A promise could not be repaired because the corrective
action failed for some reason.

     <p>Note that any strings passed to this list are automatically
canonified, so it is unecessary to call a canonify function on such inputs.

     <br><dt>&lsquo;<samp><code>repair_denied</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>[a-zA-Z0-9_$(){}\[\].:]+</code>

     <p class="noindent"><b>Synopsis</b>: A list of classes to be defined globally

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body classes example
     {
     repair_denied => { "permission_failure" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>A promise could not be kept because access to a key resource
was denied.

     <p>Note that any strings passed to this list are automatically
canonified, so it is unecessary to call a canonify function on such inputs.

     <br><dt>&lsquo;<samp><code>repair_timeout</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>[a-zA-Z0-9_$(){}\[\].:]+</code>

     <p class="noindent"><b>Synopsis</b>: A list of classes to be defined globally

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body classes example
     {
     repair_timeout => { "too_slow", "did_not_wait" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>A promise maintenance repair timed-out waiting for some dependent resource.

     <br><dt>&lsquo;<samp><code>promise_kept</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>[a-zA-Z0-9_$(){}\[\].:]+</code>

     <p class="noindent"><b>Synopsis</b>: A list of classes to be defined globally

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body classes example
     {
     promise_kept => { "success", "kaplah" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This class is set if no action was necessary by <code>cf-agent</code>
because the promise concerned was already kept without further action
required.

     <p>Note that any strings passed to this list are automatically
canonified, so it is unecessary to call a canonify function on such inputs.

     <p>Important: complex promises, e.g. <code>files</code> promises that set
multiple parameters on a file simultaneously can report misleadingly. 
The classes for different parts of a promise are not separable. Thus,
if you promise to create and file and change its permissions, when the
file exists with incorrect permissions, <code>cf-agent</code> will report
that the &lsquo;<samp><span class="samp">promise_kept</span></samp>&rsquo; for the file existence, but
&lsquo;<samp><span class="samp">promise_repaired</span></samp>&rsquo; for the permissions. If you need separate
reports, you should code two separate promises rather than `overloading'
a single one.

     <br><dt>&lsquo;<samp><code>cancel_kept</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>[a-zA-Z0-9_$(){}\[\].:]+</code>

     <p class="noindent"><b>Synopsis</b>: A list of classes to be cancelled if the promise is kept

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body classes example
     {
     cancel_kept => { "success", "kaplah" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>If the promise was already kept and nothing was done, cancel (undefine) any of
the listed classes so that they are no longer defined.

     <p>Note that any strings passed to this list are automatically
canonified, so it is unecessary to call a canonify function on such inputs.

     <p><b>History</b>: This attribute was introduced in CFEngine version 3.0.4 (2010)

     <br><dt>&lsquo;<samp><code>cancel_repaired</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>[a-zA-Z0-9_$(){}\[\].:]+</code>

     <p class="noindent"><b>Synopsis</b>: A list of classes to be cancelled if the promise is repaired

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body classes example
     {
     cancel_repaired => { "change_happened" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>If the promise was repaired and changes were made to the system,
cancel (undefine) any of the listed classes so that they are no longer defined.

     <p>Note that any strings passed to this list are automatically
canonified, so it is unecessary to call a canonify function on such inputs.

     <p><b>History</b>: This attribute was introduced in CFEngine version 3.0.4 (2010)

     <br><dt>&lsquo;<samp><code>cancel_notkept</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>[a-zA-Z0-9_$(){}\[\].:]+</code>

     <p class="noindent"><b>Synopsis</b>: A list of classes to be cancelled if the promise is not kept for any reason

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body classes example
     {
     cancel_notkept => { "failure" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>If the promise was not kept but nothing could be done, cancel (undefine)
any of the listed classes so that they are no longer defined.

     <p>Note that any strings passed to this list are automatically
canonified, so it is unecessary to call a canonify function on such inputs.

     <p><b>History</b>: This attribute was introduced in CFEngine version 3.0.4 (2010)

     <br><dt>&lsquo;<samp><code>kept_returncodes</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>[-0-9_$(){}\[\].]+</code>

     <p class="noindent"><b>Synopsis</b>: A list of return codes indicating a kept command-related promise

     <p><b>Example</b>:<br>
<br>
<pre class="verbatim">     bundle agent cmdtest
     {
     commands:
       "/bin/false"
        classes => example;
     
     reports:
     waskept::
       "The command-promise was kept!";
     }
     
     body classes example
     {
     kept_returncodes => { "0", "1" };
     promise_kept => { "waskept" };
     }
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>A list of integer return codes indicating that a command-related
promise has been kept. This can in turn be used to define classes
using the <code>promise_kept</code> attribute, or merely alter the total
compliance statistics.

     <p>Currently, the attribute has impact on the following command-related
promises.

          <ul>
<li>All promises of type <code>commands:</code>
<li><code>files</code>-promises containing a <code>transformer</code>-attribute
<li>The package manager change command in <code>packages</code>-promises
(e.g. the command for add, remove, etc.) 
</ul>

     <p>If none of the attributes <code>kept_returncodes</code>, <code>repaired_returncodes</code>,
or <code>failed_returncodes</code> are set, the default is to consider a
return code zero as promise repaired, and nonzero as promise failed.

     <p>Note that the return codes may overlap, so multiple classes may be set
from one return code. In Unix systems the possible return codes are
usually in the range from 0 to 255.

     <p><i>History</i>: Was introduced in version 3.1.3, Nova 2.0.2 (2010)

     <br><dt>&lsquo;<samp><code>repaired_returncodes</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>[-0-9_$(){}\[\].]+</code>

     <p class="noindent"><b>Synopsis</b>: A list of return codes indicating a repaired command-related promise

     <p><b>Example</b>:<br>
<br>
<pre class="verbatim">     bundle agent cmdtest
     {
     commands:
       "/bin/false"
        classes => example;
     
     reports:
     wasrepaired::
       "The command-promise got repaired!";
     }
     
     body classes example
     {
     repaired_returncodes => { "0", "1" };
     promise_repaired => { "wasrepaired" };
     }
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>A list of integer return codes indicating that a command-related
promise has been repaired. This can in turn be used to define classes
using the <code>promise_repaired</code> attribute, or merely alter the total
compliance statistics.

     <p>Currently, the attribute has impact on the following command-related
promises.

          <ul>
<li>All promises of type <code>commands:</code>
<li><code>files</code>-promises containing a <code>transformer</code>-attribute
<li>The package manager change command in <code>packages</code>-promises
(e.g. the command for add, remove, etc.) 
</ul>

     <p>If none of the attributes <code>kept_returncodes</code>, <code>repaired_returncodes</code>,
or <code>failed_returncodes</code> are set, the default is to consider a
return code zero as promise repaired, and nonzero as promise failed.

     <p>Note that the return codes may overlap, so multiple classes may be set
from one return code. In Unix systems the possible return codes are
usually in the range from 0 to 255.

     <p><i>History</i>: Was introduced in version 3.1.3, Nova 2.0.2 (2010)

     <br><dt>&lsquo;<samp><code>failed_returncodes</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>[-0-9_$(){}\[\].]+</code>

     <p class="noindent"><b>Synopsis</b>: A list of return codes indicating a failed command-related promise

     <p><b>Example</b>:<br>
<br>
<pre class="verbatim">     body common control
     {
     bundlesequence => { "cmdtest" };
     }
     
     bundle agent cmdtest
     {
     files:
     "/tmp/test"
       copy_from => copy("/etc/passwd");
     
     
     "/tmp/test"
       classes => example,
       transformer => "/bin/grep -q lkajfo999999 $(this.promiser)";
     
     reports:
     wasfailed::
       "The files-promise failed!";
     }
     
     body classes example
     {
     failed_returncodes => { "1" };
     repair_failed => { "wasfailed" };
     }
     
     body copy_from copy(file)
     {
     source => "$(file)";
     } 
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>A list of integer return codes indicating that a command-related
promise has failed. This can in turn be used to define classes using
the <code>promise_repaired</code> attribute, or merely alter the total
compliance statistics.

     <p>Currently, the attribute has impact on the following command-related
promises.

          <ul>
<li>All promises of type <code>commands:</code>
<li><code>files</code>-promises containing a <code>transformer</code>-attribute
<li>The package manager change command in <code>packages</code>-promises
(e.g. the command for add, remove, etc.) 
</ul>

     <p>If none of the attributes <code>kept_returncodes</code>, <code>repaired_returncodes</code>,
or <code>failed_returncodes</code> are set, the default is to consider a
return code zero as promise repaired, and nonzero as promise failed.

     <p>Note that the return codes may overlap, so multiple classes may be set
from one return code. In Unix systems the possible return codes are
usually in the range from 0 to 255.

     <p><i>History</i>: Was introduced in version 3.1.3, Nova 2.0.2 (2010)

     <br><dt>&lsquo;<samp><code>persist_time</code></samp>&rsquo;<dd><b>Type</b>: int

     <p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

     <p class="noindent"><b>Synopsis</b>: A number of minutes the specified classes should remain active

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body classes example
     {
     persist_time => "10";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>By default classes are ephemeral entities that disappear when <code>cf-agent</code>
terminates. By setting a persistence time, they can last even when the agent
is not running.

     <br><dt>&lsquo;<samp><code>timer_policy</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>absolute</code>
                    <code>reset</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Whether a persistent class restarts its counter when rediscovered

     <p class="noindent"><b>Default value:</b> reset

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body classes example
     {
     timer_policy => "reset";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The in most cases resetting a timer will give a more honest appraisal
of which classes are currently important, but if we want to activate
a response of limited duration as a rare event then an asbolute
time limit is useful.

   </dl>

<div class="node">
<a name="comment-in-*"></a>
<a name="comment-in-_002a"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#depends_005fon-in-_002a">depends_on in *</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#classes-in-_002a">classes in *</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Miscellaneous-in-common-promises">Miscellaneous in common promises</a>

</div>

<h4 class="subsection">6.6.3 <code>comment</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: A comment about this promise's real intention that follows through the program

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
comment => "This comment follows the data for reference ...",

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Comments written in code follow the program, they are not merely discarded. 
They appear in reports and error messages.

<div class="node">
<a name="depends_on-in-*"></a>
<a name="depends_005fon-in-_002a"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#handle-in-_002a">handle in *</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#comment-in-_002a">comment in *</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Miscellaneous-in-common-promises">Miscellaneous in common promises</a>

</div>

<h4 class="subsection">6.6.4 <code>depends_on</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: A list of promise handles that this promise builds on or depends on somehow (for knowledge management)

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control
{
bundlesequence => { "one"  };
}

bundle agent one
{
reports:

 cfengine_3::

   "two"
     depends_on => { "handle_one" };

   "one"
     handle => "handle_one";

}


</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This is a list of promise handles for whom this promise is a
promisee. In other words, we acknowledge that this promise will be
affected by the list of promises whose handles are specified.

   <p>It has the effect of partially ordering promises.

   <p>As of version 3.4.0, promise this feature is active and may be
considered a short-hand for setting classes. If one promise depends on
a list of others, it will not be verified unless the dependent
promises have already been verified and kept: i.e. as long as the
dependent promises are either kept or repaired the dependee can be
verified.

   <p>Handles in other namespaces may be referred to by <var>namespace:handle</var>.

<div class="node">
<a name="handle-in-*"></a>
<a name="handle-in-_002a"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#ifvarclass-in-_002a">ifvarclass in *</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#depends_005fon-in-_002a">depends_on in *</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Miscellaneous-in-common-promises">Miscellaneous in common promises</a>

</div>

<h4 class="subsection">6.6.5 <code>handle</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: A unique id-tag string for referring to this as a promisee elsewhere

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
access:

  "/source"

    handle  => "update_rule",
    admit   => { "127.0.0.1" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>A promise handle is like a `goto' label. It allows you to refer to a
promise as the promisee of <code>depends_on</code> client of another
promise. Handles are essential for mapping dependencies and performing
impact analyses.  In Enterprise versions of CFEngine, promise handles
can also be used in <code>outputs</code> promises, See <a href="#outputs-in-agent-promises">outputs in agent promises</a>.

   <p>Handles may consist of regular indentifier characters. CFEngine automatically `canonifies' the names of handles to conform to this standard. Caution: if the handle name is based on a variable, and the variable fails to expand, the handle will be based on the name of the variable rather than its content.

<div class="node">
<a name="ifvarclass-in-*"></a>
<a name="ifvarclass-in-_002a"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#meta-in-_002a">meta in *</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#handle-in-_002a">handle in *</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Miscellaneous-in-common-promises">Miscellaneous in common promises</a>

</div>

<h4 class="subsection">6.6.6 <code>ifvarclass</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Extended classes ANDed with context

<p class="noindent"><b>Example</b>:<br>
<br>

   <p>The generic example has the form:
<pre class="example">     
     <var>promise-type</var>:
     
       "<var>promiser</var>"
     
         ifvarclass =&gt; "$(program)_running|($(program)_notfound&amp;Hr12)";
     
</pre>
   <p class="noindent">A specific example would be:

<pre class="verbatim">
bundle agent example

{     
commands:

 any::

    "/bin/echo This is linux"

       ifvarclass => "linux";


    "/bin/echo This is solaris"

       ifvarclass => "solaris";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This is an additional class expression that will be evaluated after
the &lsquo;<samp><var>class</var><span class="samp">::</span></samp>&rsquo; classes have selected promises. It is
provided in order to enable a channel between variables and classes. 
The result is thus the logical AND of the ordinary classes and the
variable classes.

   <p>This function is provided so that one can form expressions that link
variables and classes, e.g.

<pre class="verbatim"># Check that all components are running

vars:

  "component" slist => { "cf-monitord", "cf-serverd" };

processes:

  "$(component)" restart_class => canonify("start_$(component)");

commands:

   "/var/cfengine/bin/$(component)"

       ifvarclass => canonify("start_$(component)");

</pre>

   <p>Notice that the function <code>canonify()</code> is provided to convert a
general variable input into a string composed only of legal
characters, using the same algorithm that CFEngine uses.

<div class="node">
<a name="meta-in-*"></a>
<a name="meta-in-_002a"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#ifvarclass-in-_002a">ifvarclass in *</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Miscellaneous-in-common-promises">Miscellaneous in common promises</a>

</div>

<h4 class="subsection">6.6.7 <code>meta</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: User-data associated with policy, e.g. key=value strings

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
files:

  "/etc/special_file"

    comment => "Special file is a requirement. Talk to Fred X.",
    create => "true",

    meta => { "owner=John",  "version=2.0" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in 3.3.0, Nova 2.2.0 (2012)

   <p>Attending to knowledge management, it is sometimes convenient to
attach meta-data of a more technical nature to policy. It may be
used for arbitrary key=value strings for example.

<!-- ***************************************************** -->
<!-- * CHAPTER -->
<!-- ***************************************************** -->
<div class="node">
<a name="Bundles-for-agent"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Bundles-for-server">Bundles for server</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Bundles-for-common">Bundles for common</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">7 Bundles of <code>agent</code></h2>

<p><br>

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
     bundle agent main(parameter)
     
     {
     vars:
     
       "sys_files"    slist        =&gt; {
                                      "/etc/passwd",
                                      "/etc/services"
                                      };
     files:
     
       "$(sys_files)" perms        =&gt; p("root","0644"),
                      changes      =&gt; trip_wire;
     
       "/etc/shadow"  perms        =&gt; p("root","0600"),
                      changes      =&gt; trip_wire;
     
       "/usr"         changes      =&gt; trip_wire,
                      depth_search =&gt; recurse("inf");
     
       "/tmp"         delete       =&gt; tidy,
                      file_select  =&gt; days("2"),
                      depth_search =&gt; recurse("inf");
     
     }
     
</pre>
   </td></tr></table>

   <p><br>

   <p>Agent bundles contain user-defined promises for <code>cf-agent</code>. The
types of promises and their corresponding bodies are detailed below.

<ul class="menu">
<li><a accesskey="1" href="#classes-in-common-promises">classes in common promises</a>: <li><a accesskey="2" href="#defaults-in-common-promises">defaults in common promises</a>: <li><a accesskey="3" href="#meta-in-common-promises">meta in common promises</a>: <li><a accesskey="4" href="#reports-in-common-promises">reports in common promises</a>: <li><a accesskey="5" href="#vars-in-common-promises">vars in common promises</a>: <li><a accesskey="6" href="#Miscellaneous-in-common-promises">* in common promises</a>: <li><a accesskey="7" href="#commands-in-agent-promises">commands in agent promises</a>: <li><a accesskey="8" href="#databases-in-agent-promises">databases in agent promises</a>: <li><a accesskey="9" href="#guest_005fenvironments-in-agent-promises">guest_environments in agent promises</a>: <li><a href="#files-in-agent-promises">files in agent promises</a>: <li><a href="#Miscellaneous-in-edit_005fline-promises">* in edit_line promises</a>: <li><a href="#delete_005flines-in-edit_005fline-promises">delete_lines in edit_line promises</a>: <li><a href="#insert_005flines-in-edit_005fline-promises">insert_lines in edit_line promises</a>: <li><a href="#field_005fedits-in-edit_005fline-promises">field_edits in edit_line promises</a>: <li><a href="#replace_005fpatterns-in-edit_005fline-promises">replace_patterns in edit_line promises</a>: <li><a href="#Miscellaneous-in-edit_005fxml-promises">* in edit_xml promises</a>: <li><a href="#build_005fxpath-in-edit_005fxml-promises">build_xpath in edit_xml promises</a>: <li><a href="#delete_005ftree-in-edit_005fxml-promises">delete_tree in edit_xml promises</a>: <li><a href="#insert_005ftree-in-edit_005fxml-promises">insert_tree in edit_xml promises</a>: <li><a href="#delete_005fattribute-in-edit_005fxml-promises">delete_attribute in edit_xml promises</a>: <li><a href="#set_005fattribute-in-edit_005fxml-promises">set_attribute in edit_xml promises</a>: <li><a href="#delete_005ftext-in-edit_005fxml-promises">delete_text in edit_xml promises</a>: <li><a href="#set_005ftext-in-edit_005fxml-promises">set_text in edit_xml promises</a>: <li><a href="#insert_005ftext-in-edit_005fxml-promises">insert_text in edit_xml promises</a>: <li><a href="#interfaces-in-agent-promises">interfaces in agent promises</a>: <li><a href="#methods-in-agent-promises">methods in agent promises</a>: <li><a href="#outputs-in-agent-promises">outputs in agent promises</a>: <li><a href="#packages-in-agent-promises">packages in agent promises</a>: <li><a href="#processes-in-agent-promises">processes in agent promises</a>: <li><a href="#services-in-agent-promises">services in agent promises</a>: <li><a href="#storage-in-agent-promises">storage in agent promises</a>: <li><a href="#access-in-server-promises">access in server promises</a>: <li><a href="#roles-in-server-promises">roles in server promises</a>: <li><a href="#inferences-in-knowledge-promises">inferences in knowledge promises</a>: <li><a href="#things-in-knowledge-promises">things in knowledge promises</a>: <li><a href="#topics-in-knowledge-promises">topics in knowledge promises</a>: <li><a href="#occurrences-in-knowledge-promises">occurrences in knowledge promises</a>: <li><a href="#measurements-in-monitor-promises">measurements in monitor promises</a>: </ul>

<div class="node">
<a name="commands-in-agent-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#databases-in-agent-promises">databases in agent promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Miscellaneous-in-common-promises">Miscellaneous in common promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-agent">Bundles for agent</a>

</div>

<h3 class="section">7.1 <code>commands</code> promises in &lsquo;<samp><span class="samp">agent</span></samp>&rsquo;</h3>

<p><br>

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
     commands:
     
       <var>"/path/to/command args"</var>
     
                  args =&gt; "<var>more args</var>",
                  contain =&gt; <var>contain_body</var>,
                  module =&gt; <var>true/false</var>;
     
</pre>
   </td></tr></table>

   <p>Command <i>containment</i> allows you to make a `sandbox' around a
command, to run it as a non-privileged user inside an isolated
directory tree. CFEngine <code>modules</code> are commands that support a simple
protocol (see below) in order to set additional variables and classes
on execution from user defined code. Modules are intended for use as
system probes rather than additional configuration promises.

   <p>In CFEngine 3 commands and processes have been separated
cleanly. Restarting of processes must be coded as a separate
command. This stricter type separation will allow more careful
conflict analysis to be carried out.

   <p>Output from commands executed here is quoted inline, but prefixed
with the letter &lsquo;<samp><span class="samp">Q</span></samp>&rsquo; to distinguish it from other output, e.g. 
from <code>reports</code> (which is prefixed with the letter &lsquo;<samp><span class="samp">R</span></samp>&rsquo;).

   <p>It is possible to set classes based on the return code of a
commands-promise in a very flexible way. See the
<code>kept_returncodes</code>, <code>repaired_returncodes</code> and
<code>failed_returncodes</code> attributes.

   <p>Commands were called <code>shellcommands</code> in CFEngine 2.

   <p><i>NOTE: a common mistake in using CFEngine is to embed many shell
commands instead of using the built-in functionality. Use of CFEngine
internals is preferred as it assures convergence and proper integrated
checking. Extensive use of shell commands will make a CFEngine
execution very heavy-weight like other management systems. To minimize
the system cost of execution, always use CFEngine internals.</i>

   <p><br>

<pre class="verbatim">
bundle agent example

{
commands:

  "/bin/sleep 10"
     action  => background;

  "/bin/sleep"
     args => "20",
     action  => background;

}

</pre>

   <p><br>

   <p>NOTE: when referring to executables whose paths contain spaces, you
should quote the entire program string separately so that CFEngine
knows the name of the executable file. e.g.

<pre class="smallexample">     
      commands:
     
       windows::
     
        "\"c:\Program Files\my name with space\" arg1 arg2";
     
       linux::
     
        "\"/usr/bin/funny command name\" -a -b -c";
     
</pre>
   <ul class="menu">
<li><a accesskey="1" href="#args-in-commands">args in commands</a>
<li><a accesskey="2" href="#contain-in-commands">contain in commands</a>
<li><a accesskey="3" href="#module-in-commands">module in commands</a>
</ul>

<div class="node">
<a name="args-in-commands"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#contain-in-commands">contain in commands</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#commands-in-agent-promises">commands in agent promises</a>

</div>

<h4 class="subsection">7.1.1 <code>args</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Alternative string of arguments for the command (concatenated with promiser string)

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
commands:

  "/bin/echo one"

   args => "two three";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Sometimes it is convenient to separate the arguments to a command from
the command itself. The final arguments are the concatenation with one
space. So in the example above the command would be

<pre class="verbatim">
 /bin/echo one two three

</pre>

<div class="node">
<a name="contain-in-commands"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#module-in-commands">module in commands</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#args-in-commands">args in commands</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#commands-in-agent-promises">commands in agent promises</a>

</div>

<h4 class="subsection">7.1.2 <code>contain</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>useshell</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false embed the command in a shell environment

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body contain example
     {
     useshell => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The default is to <i>not</i> use a shell when executing commands.  Use of a
shell has both resource and security consequences. A shell consumes an
extra process and inherits environment variables, reads commands from
files and performs other actions beyond the control of CFEngine. If
one does not need shell functionality such as piping through multiple
commands then it is best to manage without it. In the windows version
of CFEngine Nova, the command is run in the the &ldquo;Command Prompt&rdquo; if
useshell is true.

     <br><dt>&lsquo;<samp><code>umask</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>0</code>
                    <code>77</code>
                    <code>22</code>
                    <code>27</code>
                    <code>72</code>
                    <code>077</code>
                    <code>022</code>
                    <code>027</code>
                    <code>072</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: The umask value for the child process

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body contain example
     {
     umask => "077";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Sets the internal umask for the process. Default value for the mask is
&lsquo;<samp><span class="samp">077</span></samp>&rsquo;. On windows, umask is not supported and is thus ignored by
windows versions of CFEngine.

     <br><dt>&lsquo;<samp><code>exec_owner</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: The user name or id under which to run the process

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body contain example
     {
     exec_owner => "mysql_user";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This is part of the restriction of privilege for child processes when
running <code>cf-agent</code> as the root user, or a user with privileges.

     <p>Windows requires the clear text password for the user account to run
under. Keeping this in CFEngine policies could be a security
hazard. Therefore, this option is not yet implemented on windows
versions of CFEngine.

     <br><dt>&lsquo;<samp><code>exec_group</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: The group name or id under which to run the process

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body contain example
     {
     exec_group => "nogroup";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This is part of the restriction of privilege for child processes when
running <code>cf-agent</code> as the root group, or a group with
privileges. It is ignored on windows, as processes do not have any
groups associated with them.

     <br><dt>&lsquo;<samp><code>exec_timeout</code></samp>&rsquo;<dd><b>Type</b>: int

     <p class="noindent"><b>Allowed input range</b>: <code>1,3600</code>

     <p class="noindent"><b>Synopsis</b>: Timeout in seconds for command completion

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body contain example
     {
     exec_timeout => "30";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Attempt to time-out after this number of seconds. This cannot be guaranteed as not all
commands are willing to be interrupted in case of failure.

     <br><dt>&lsquo;<samp><code>chdir</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>"?(/.*)</code>

     <p class="noindent"><b>Synopsis</b>: Directory for setting current/base directory for the process

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body contain example
     
     {
     chdir => "/containment/directory";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This command has the effect of placing the running command into a current working
directory equal to the parameter given, i.e. it works like the &lsquo;<samp><span class="samp">cd</span></samp>&rsquo; shell command.

     <br><dt>&lsquo;<samp><code>chroot</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>"?(/.*)</code>

     <p class="noindent"><b>Synopsis</b>: Directory of root sandbox for process

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body contain example
     
     {
     chroot => "/private/path";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Sets the path of the directory that will be experienced as the top-most
root directory for the process. In security parlance, this creates
a `sandbox' for the process. Windows does not support this feature.

     <br><dt>&lsquo;<samp><code>preview</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false preview command when running in dry-run mode (with -n)

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body contain example
     {
     preview => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Previewing shell scripts during a dry-run is a potentially misleading
activity. It should only be used on scripts that make no changes to
the system. It is CFEngine best practice to never write
change-functionality into user-written scripts except as a last
resort: CFEngine can apply its safety checks to user defined scripts.

     <br><dt>&lsquo;<samp><code>no_output</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false discard all output from the command

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body contain example
     {
     no_output => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This is equivalent to piping standard output and error to <samp><span class="file">/dev/null</span></samp>.

   </dl>

<div class="node">
<a name="module-in-commands"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#contain-in-commands">contain in commands</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#commands-in-agent-promises">commands in agent promises</a>

</div>

<h4 class="subsection">7.1.3 <code>module</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false whether to expect the cfengine module protocol

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
commands:

   "/masterfiles/user_script"

     module => "true";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>If true, the module protocol is supported for this script, i.e. it is
treated as a user module. A plug-in module may be written in any
language, it can return any output you like, but lines which begin
with a &lsquo;<samp><span class="samp">+</span></samp>&rsquo; sign are treated as classes to be defined (like
<samp><span class="option">-D</span></samp>), while lines which begin with a &lsquo;<samp><span class="samp">-</span></samp>&rsquo; sign are treated
as classes to be undefined (like <samp><span class="option">-N</span></samp>).  Lines starting with
&lsquo;<samp><span class="samp">=</span></samp>&rsquo; are scalar variables to be defined, and lines beginning with
&lsquo;<samp><span class="samp">@</span></samp>&rsquo; are lists.  Any other lines of output are cited by
<code>cf-agent</code> as being erroneous, so you should normally make your
module completely silent. Here is an example written in shell:

<pre class="smallexample">     #!/bin/sh
     /bin/echo "@mylist= { \"one\", \"two\", \"three\" }"
     /bin/echo "=myscalar= scalar val"
     /bin/echo "+module_class"
</pre>
   <p>And here is an example using it:
<pre class="verbatim">body common control
   {
   any::

      bundlesequence  => { 
                         def,
                         modtest
                         };
   }

###################################################################

bundle agent def

{
commands:

  "$(sys.workdir)/modules/module_name" module => "true";

reports:

  #
  # Each module forms a private context with its name as id
  #

 module_class::

  "Module set variable $(module_name.myscalar)";

}

###################################################################

bundle agent modtest

{
vars:

 "mylist" slist => { @(module_name.mylist) };

reports:

 module_class::

  "Module set variable $(mylist)";

}

</pre>
Here is an example module written in perl.

<pre class="smallexample">     #!/usr/bin/perl
     #
     # module:myplugin
     #
     
       # lots of computation....
     
     if (<var>special-condition</var>)
        {
        print "+specialclass";
        }
     
</pre>
   <p>If your module is &ldquo;simple&rdquo; and is best expressed as a shell command, then
we suggest that you <i>expose</i> the class being defined in the command being
executed (making it easier to see what classes are used when reading the
promises file).  For example, the promises could read as follows (the two
<code>echo</code> commands are to ensure that the shell always exits with a
successful execution of a command):

<pre class="verbatim">bundle agent sendmail
{
commands:
    # This next module checks a specific failure mode of dcc, namely
    # more than 3 error states since the last time we ran cf-agent
    is_mailhost::
        "/bin/test `/usr/bin/tail -100 /var/log/maillog | /usr/bin/grep 'Milter (dcc): to error state' | /usr/bin/wc -l` -gt 3 &amp;&amp; echo '+start_dccm' || echo
''"
            contain => shell_command,
            module => "true";

    start_dccm::
        "/var/dcc/libexec/start-dccm"
            contain => not_paranoid;
}

body contain shell_command
{
    useshell    => "yes";
}

body contain not_paranoid
{
    useshell    => "no";
    exec_owner  => "root";
    umask       => "22";
}

</pre>

   <p>Modules inherit the environment variables from cfagent and accept arguments, just
as a regular command does.

<pre class="smallexample">     #!/bin/sh
     #
     # module:myplugin
     #
     
     /bin/echo $*
     
</pre>
   <p>Modules define variables in <code>cf-agent</code> by outputting strings of the form

<pre class="smallexample">     
     =<var>variablename</var>=<var>value</var>
     
</pre>
   <p>These variables end up in a context which has the same name as the module. 
When the <code>$(allclasses)</code> variable becomes too large to manipulate conveniently,
you can access the complete list of currently defined classes in the file
<samp><span class="file">/var/cfengine/state/allclasses</span></samp>.

<div class="node">
<a name="databases-in-agent-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#guest_005fenvironments-in-agent-promises">guest_environments in agent promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#commands-in-agent-promises">commands in agent promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-agent">Bundles for agent</a>

</div>

<h3 class="section">7.2 <code>databases</code> promises in &lsquo;<samp><span class="samp">agent</span></samp>&rsquo;</h3>

<p><br>

   <p>CFEngine Nova can interact with commonly used database servers to keep
promises about the structure and content of data within them.

   <p>There are two main cases of database management to address: small
embedded databases and large centralized databases.

   <p>CFEngine is a tool whose strength lies distributed management of
computers.  Databases are often centralized entities that have
single point of management, so a large monolithic database
is more easily managed with other tools. However, CFEngine can still
monitor changes and discrepancies, and it can manage smaller embedded
databases that are distributed in nature, whether they are SQL,
registry or future types.

   <p>So creating 100 new databases for test purposes is a task for
CFEngine, but adding a new item to an important production database is
not a task that we recommend using CFEngine for.

   <p>There are three kinds of database supported by Nova:

     <dl>
<dt><em>LDAP - The Lightweight Directory Access Protocol</em><dd>A hierarchical network database primarily for reading simple schema.

     <br><dt><em>SQL - Structured Query Language</em><dd>A number of relational databases (currently supported: MySQL, Postgres)
for reading and writing complex data.

     <br><dt><em>Registry - Microsoft Registry</em><dd>An embedded database for interfacing with system values in Microsoft Windows (Only CFEngine Nova)

   </dl>
   In addition, CFEngine uses a  variety of embedded databases
for its own internals.

   <p>CFEngine's ability to make promises about databases depends on the
good grace of the database server. Embedded databases are directly
part of the system and promises can be made directly. However,
databases running through a server process (either on the same host or
on a different host) are independent agents and CFEngine cannot make
promises on their behalf, unless they promise (grant) permission for
CFEngine to make the changes. Thus the pre-requisite for making
SQL database promises is to grant a point of access on the server.

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
      databases:
     
       "<var>database</var>/<var>subkey or table</var>"
     
         database_operation =&gt; "<var>create/delete/drop</var>",
         database_type =&gt; "<var>sql/ms_registry</var>",
         database_columns =&gt; {
                             "<var>name</var>,<var>type</var>,<var>size</var>",
                             "<var>name</var>,<var>type</var>",
                             },
     
         database_server =&gt; <var>body</var>;
     
     
      body database_server <var>name</var>
       {
       db_server_owner =&gt; "<var>account name</var>";
       db_server_password =&gt; "<var>password</var>";
       db_server_host =&gt; "<var>hostname or omit for localhost</var>";
       db_server_type =&gt; "<var>mysql/posgres</var>";
       db_server_connection_db =&gt; "<var>database we can connect to</var>";
       }
     
</pre>
   </td></tr></table>

   <p><br>

<pre class="verbatim">
body common control
{
bundlesequence => { "databases" };
}

bundle agent databases

{
#commands:

#  "/usr/bin/createdb cf_topic_maps",

#        contain => as_user("mysql");

databases:

  "cf_topic_maps/topics"

    database_operation => "create",
    database_type => "sql",
    database_columns => { 
                        "topic_name,varchar,256",
                        "topic_comment,varchar,1024",
                        "topic_id,varchar,256",
                        "topic_type,varchar,256",
                        "topic_extra,varchar,26" 
                        },

    database_server => myserver;



}

################################################

body database_server myserver
{
any::
 db_server_owner => "postgres";
 db_server_password => "";
 db_server_host => "localhost";
 db_server_type => "postgres";
 db_server_connection_db => "postgres";
none::
 db_server_owner => "root";
 db_server_password => "";
 db_server_host => "localhost";
 db_server_type => "mysql";
 db_server_connection_db => "mysql";
}

body contain as_user(x)
{
exec_owner => "$(x)";
}
</pre>

   <p><br>

   <p>The promiser in database promises is a concatenation of the database name and underlying tables. 
This presents a simple hierarchical model that looks like a file-system. This is the normal
structure within the Windows registry for instance. Entity-Relation databases do not normally
present tables in this way, but no harm is done in representing them as a hierarchy of depth 1.

<ul class="menu">
<li><a accesskey="1" href="#database_005fserver-in-databases">database_server in databases</a>
<li><a accesskey="2" href="#database_005ftype-in-databases">database_type in databases</a>
<li><a accesskey="3" href="#database_005foperation-in-databases">database_operation in databases</a>
<li><a accesskey="4" href="#database_005fcolumns-in-databases">database_columns in databases</a>
<li><a accesskey="5" href="#database_005frows-in-databases">database_rows in databases</a>
<li><a accesskey="6" href="#registry_005fexclude-in-databases">registry_exclude in databases</a>
</ul>

<div class="node">
<a name="database_server-in-databases"></a>
<a name="database_005fserver-in-databases"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#database_005ftype-in-databases">database_type in databases</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#databases-in-agent-promises">databases in agent promises</a>

</div>

<h4 class="subsection">7.2.1 <code>database_server</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>db_server_owner</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: User name for database connection

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     db_server_owner => "mark";
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <br><dt>&lsquo;<samp><code>db_server_password</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: Clear text password for database connection

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     db_server_password => "xyz.1234";
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <br><dt>&lsquo;<samp><code>db_server_host</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: Hostname or address for connection to database, blank means localhost

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     db_server_host => "sqlserv.example.org";
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Hostname or IP address of the server.

     <br><dt>&lsquo;<samp><code>db_server_type</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>postgres</code>
                    <code>mysql</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: The dialect of the database server

     <p class="noindent"><b>Default value:</b> none

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     db_server_type => "postgres";
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <br><dt>&lsquo;<samp><code>db_server_connection_db</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: The name of an existing database to connect to in order to create/manage other databases

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body database_server myserver(x)
     {
     db_server_owner => "$(x)";
     db_server_password => "";
     db_server_host => "localhost";
     db_server_type => "$(mysql)";
     db_server_connection_db => "$(x)";
     }
     
</pre>

     <p class="noindent">where &lsquo;<samp><span class="samp">x</span></samp>&rsquo; is currently <code>mysql</code> or <code>postgres</code>.

     <p><b>Notes</b>:<br>
<br>

     <p>In order to create a database on a database server (all of which
practice voluntary cooperation), one has to be able to connect
to the server, however, without an existing database this is not allowed. 
Thus, database servers provide a default database that can be connected
to in order to thereafter create new databases. These are called
<code>postgres</code> and <code>mysql</code> for their respective database servers.

     <p>For the knowledge agent, this setting is made in the control body,
for database verification promises, it is made in the
<code>database_server</code> body.

   </dl>

<div class="node">
<a name="database_type-in-databases"></a>
<a name="database_005ftype-in-databases"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#database_005foperation-in-databases">database_operation in databases</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#database_005fserver-in-databases">database_server in databases</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#databases-in-agent-promises">databases in agent promises</a>

</div>

<h4 class="subsection">7.2.2 <code>database_type</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>sql</code>
               <code>ms_registry</code>
</pre>
   <p class="noindent"><b>Default value:</b> none

<p class="noindent"><b>Synopsis</b>: The type of database that is to be manipulated

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
database_type => "ms_registry";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

<div class="node">
<a name="database_operation-in-databases"></a>
<a name="database_005foperation-in-databases"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#database_005fcolumns-in-databases">database_columns in databases</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#database_005ftype-in-databases">database_type in databases</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#databases-in-agent-promises">databases in agent promises</a>

</div>

<h4 class="subsection">7.2.3 <code>database_operation</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>create</code>
               <code>delete</code>
               <code>drop</code>
               <code>cache</code>
               <code>verify</code>
               <code>restore</code>
</pre>
   <p class="noindent"><b>Synopsis</b>: The nature of the promise - to be or not to be

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
database_operation => "create";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

<div class="node">
<a name="database_columns-in-databases"></a>
<a name="database_005fcolumns-in-databases"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#database_005frows-in-databases">database_rows in databases</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#database_005foperation-in-databases">database_operation in databases</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#databases-in-agent-promises">databases in agent promises</a>

</div>

<h4 class="subsection">7.2.4 <code>database_columns</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: <code>.*</code>

<p class="noindent"><b>Synopsis</b>: A list of column definitions to be promised by SQL databases

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
  "cf_topic_maps/topics"

    database_operation => "create",
    database_type => "sql",
    database_columns => { 
                        "topic_name,varchar,256",
                        "topic_comment,varchar,1024",
                        "topic_id,varchar,256",
                        "topic_type,varchar,256",
                        "topic_extra,varchar,26" 
                        },

    database_server => myserver;

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Columns are a list of tuplets (<var>Name,type,size</var>). Array items are triplets, and fixed size data elements are doublets.

<div class="node">
<a name="database_rows-in-databases"></a>
<a name="database_005frows-in-databases"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#registry_005fexclude-in-databases">registry_exclude in databases</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#database_005fcolumns-in-databases">database_columns in databases</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#databases-in-agent-promises">databases in agent promises</a>

</div>

<h4 class="subsection">7.2.5 <code>database_rows</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: <code>.*,.*</code>

<p class="noindent"><b>Synopsis</b>: An ordered list of row values to be promised by SQL databases

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle agent databases

{
databases:

 windows::

  # Regsitry has (value,data) pairs in "keys" which are directories

  "HKEY_LOCAL_MACHINE\SOFTWARE\CFEngine AS\CFEngine"

    database_operation => "create",
    database_rows => { "value1,REG_SZ,new value 1", "value2,REG_DWORD,12345"} ,
    database_type     => "ms_registry";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This constraint is used only in adding data to database columns. Rows are considered to be
instances of individual columns.

   <p>In the case of the system registry on Windows, the rows represent data on data-value pairs. 
The currently supported types (the middle field) for the Windows registry are <code>REG_SZ</code> (string),
<code>REG_EXPAND_SZ</code> (expandable string) and <code>REG_DWORD</code> (double word).

<div class="node">
<a name="registry_exclude-in-databases"></a>
<a name="registry_005fexclude-in-databases"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#database_005frows-in-databases">database_rows in databases</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#databases-in-agent-promises">databases in agent promises</a>

</div>

<h4 class="subsection">7.2.6 <code>registry_exclude</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: A list of regular expressions to ignore in key/value verification

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
databases:

 "HKEY_LOCAL_MACHINE\SOFTWARE"

    database_operation => "cache",

    registry_exclude => { ".*Windows.*CurrentVersion.*", 
                          ".*Touchpad.*",
                          ".*Capabilities.FileAssociations.*", 
                          ".*Rfc1766.*" , 
                          ".*Synaptics.SynTP.*", 
                          ".*SupportedDevices.*8086", 
                          ".*Microsoft.*ErrorThresholds" 
                        },

    database_type     => "ms_registry";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>During recursive Windows registry scanning, this option allows us to ignore keys of values matching a
list of regular expressions. Some values in the registry are ephemeral and some should not be considered. 
This provdes a convenient way of avoiding names. It is analogous to <code>exclude_dirs</code> for files.

<div class="node">
<a name="guest_environments-in-agent-promises"></a>
<a name="guest_005fenvironments-in-agent-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#files-in-agent-promises">files in agent promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#databases-in-agent-promises">databases in agent promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-agent">Bundles for agent</a>

</div>

<h3 class="section">7.3 <code>guest_environments</code> promises in &lsquo;<samp><span class="samp">agent</span></samp>&rsquo;</h3>

<p><br>

   <p>Guest environment promises describe enclosed computing environments that can
host physical and virtual machines, solaris zones, grids, clouds or
other enclosures, including embedded systems.  CFEngine will support
the convergent maintenance of such inner environments in a fixed
location, with interfaces to an external environment.

   <p>CFEngine currently seeks to add convergence properties to existing
interfaces for automatic self-healing of guest environments. The
current implementation integrates with <i>libvirt</i>, supporting host
virtualization for Xen, KVM, VMWare, etc. Thus CFEngine, running on a
virtual host, can maintain the state and deployment of virtual guest
machines defined within the <i>libvirt</i> framework. Guest environment
promises are not meant to manage what goes on within the virtual
guests: for that purpose, you should run CFEngine directly on the
virtual machine, as if it were any other machine.

   <p><br>

<pre class="verbatim">
 site1::

  "unique_name1"

       environment_resources => myresources("2GB","512MB"),
       environment_interface => mymachine("hostname"),
            environment_type => "xen",
            environment_state => "running",
            environment_host => "atlas";

  "unique_name2"

            environment_type => "xen_network",
           environment_state => "create",
            environment_host => "atlas";

</pre>

   <p><br>

   <p>CFEngine currently provides a convergent interface to <i>libvirt</i>.

<ul class="menu">
<li><a accesskey="1" href="#environment_005fhost-in-guest_005fenvironments">environment_host in guest_environments</a>
<li><a accesskey="2" href="#environment_005finterface-in-guest_005fenvironments">environment_interface in guest_environments</a>
<li><a accesskey="3" href="#environment_005fresources-in-guest_005fenvironments">environment_resources in guest_environments</a>
<li><a accesskey="4" href="#environment_005fstate-in-guest_005fenvironments">environment_state in guest_environments</a>
<li><a accesskey="5" href="#environment_005ftype-in-guest_005fenvironments">environment_type in guest_environments</a>
</ul>

<div class="node">
<a name="environment_host-in-guest_environments"></a>
<a name="environment_005fhost-in-guest_005fenvironments"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#environment_005finterface-in-guest_005fenvironments">environment_interface in guest_environments</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#guest_005fenvironments-in-agent-promises">guest_environments in agent promises</a>

</div>

<h4 class="subsection">7.3.1 <code>environment_host</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>[a-zA-Z0-9_]+</code>

<p class="noindent"><b>Synopsis</b>: A class indicating which physical node will execute this guest machine

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
guest_environments:

 linux::

 "host1"
                 comment => "Keep this vm suspended",
   environment_resources => myresources,
        environment_type => "kvm",
       environment_state => "suspended",
        environment_host => "ubuntu";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The promise will only apply to the machine with this class set. Thus,
CFEngine must be running locally on the hypervisor for the promise to
take effect.

   <p>This attribute is required.

   <p><i>History</i>: this feature was introduced in Nova 2.0.0 (2010), Community 3.3.0 (2012)

<div class="node">
<a name="environment_interface-in-guest_environments"></a>
<a name="environment_005finterface-in-guest_005fenvironments"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#environment_005fresources-in-guest_005fenvironments">environment_resources in guest_environments</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#environment_005fhost-in-guest_005fenvironments">environment_host in guest_environments</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#guest_005fenvironments-in-agent-promises">guest_environments in agent promises</a>

</div>

<h4 class="subsection">7.3.2 <code>environment_interface</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>env_addresses</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: The IP addresses of the environment's network interfaces

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body environment_interface vnet(primary)
     {
     env_name      => "$(this.promiser)";
     env_addresses => { "$(primary)" };
     
     host1::
     
       env_network => "default_vnet1";
     
     host2::
     
       env_network => "default_vnet2";
     
     }
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The IP addresses of the virtual machine can be overridden here at run time.

     <br><dt>&lsquo;<samp><code>env_name</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: The hostname of the virtual environment

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     body environment_interface vnet(primary)
     {
     env_name      => "$(this.promiser)";
     env_addresses => { "$(primary)" };
     
     host1::
       env_network => "default_vnet1";
     
     host2::
       env_network => "default_vnet2";
     }
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The `hostname' of a virtual guest may or may not be the same as the identifier used
as `promiser' by the virtualization manager.

     <br><dt>&lsquo;<samp><code>env_network</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: The hostname of the virtual network

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body environment_interface vnet(primary)
          {
          env_name      => "$(this.promiser)";
          env_addresses => { "$(primary)" };
     
          host1::
            env_network => "default_vnet1";
     
          host2::
            env_network => "default_vnet2";
          }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

   </dl>

<div class="node">
<a name="environment_resources-in-guest_environments"></a>
<a name="environment_005fresources-in-guest_005fenvironments"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#environment_005fstate-in-guest_005fenvironments">environment_state in guest_environments</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#environment_005finterface-in-guest_005fenvironments">environment_interface in guest_environments</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#guest_005fenvironments-in-agent-promises">guest_environments in agent promises</a>

</div>

<h4 class="subsection">7.3.3 <code>environment_resources</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>env_cpus</code></samp>&rsquo;<dd><b>Type</b>: int

     <p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

     <p class="noindent"><b>Synopsis</b>: Number of virtual CPUs in the environment

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body environment_resources my_environment
     {
     env_cpus => "2";
     env_memory => "512"; # in KB
     env_disk => "1024";  # in MB
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The maximum number of cores or processors in the physical environment will
set a natural limit on this value.

     <p>This attribute conflicts with <code>env_spec</code>.

     <br><dt>&lsquo;<samp><code>env_memory</code></samp>&rsquo;<dd><b>Type</b>: int

     <p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

     <p class="noindent"><b>Synopsis</b>: Amount of primary storage (RAM) in the virtual environment (KB)

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body environment_resources my_environment
     {
     env_cpus => "2";
     env_memory => "512"; # in KB
     env_disk => "1024";  # in MB
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The maximum amount of memory in the physical environment will set a
natural limit on this value.

     <p>This attribute conflicts with <code>env_spec</code>.

     <br><dt>&lsquo;<samp><code>env_disk</code></samp>&rsquo;<dd><b>Type</b>: int

     <p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

     <p class="noindent"><b>Synopsis</b>: Amount of secondary storage (DISK) in the virtual environment (MB)

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body environment_resources my_environment
     {
     env_cpus => "2";
     env_memory => "512"; # in KB
     env_disk => "1024";  # in MB
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This parameter is currently unsupported, for future extension.

     <p>This attribute conflicts with <code>env_spec</code>.

     <br><dt>&lsquo;<samp><code>env_baseline</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>"?(/.*)</code>

     <p class="noindent"><b>Synopsis</b>: The path to an image with which to baseline the virtual environment

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     env_baseline => "/path/to/image";
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This function is for future development.

     <br><dt>&lsquo;<samp><code>env_spec</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>.*</code>

     <p class="noindent"><b>Synopsis</b>: A string containing a technology specific set of promises for the virtual instance

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     body environment_resources virt_xml(host)
     {
     env_spec => 
     
     "&lt;domain type='xen'>
       &lt;name>$(host)&lt;/name>
       &lt;os>
         &lt;type>linux&lt;/type>
         &lt;kernel>/var/lib/xen/install/vmlinuz-ubuntu10.4-x86_64&lt;/kernel>
         &lt;initrd>/var/lib/xen/install/initrd-vmlinuz-ubuntu10.4-x86_64&lt;/initrd>
         &lt;cmdline> kickstart=http://example.com/myguest.ks &lt;/cmdline>
       &lt;/os>
       &lt;memory>131072&lt;/memory>
       &lt;vcpu>1&lt;/vcpu>
       &lt;devices>
         &lt;disk type='file'>
           &lt;source file='/var/lib/xen/images/$(host).img'/>
           &lt;target dev='sda1'/>
         &lt;/disk>
         &lt;interface type='bridge'>
           &lt;source bridge='xenbr0'/>
           &lt;mac address='aa:00:00:00:00:11'/>
           &lt;script path='/etc/xen/scripts/vif-bridge'/>
         &lt;/interface>
         &lt;graphics type='vnc' port='-1'/>
         &lt;console tty='/dev/pts/5'/>
       &lt;/devices>
     &lt;/domain>
     ";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>
The preferred way to specify the resources of an environment on creation,
i.e. when <code>envrionment_state</code> is &lsquo;<samp><span class="samp">create</span></samp>&rsquo;.

     <p>This attibute conflicts with <code>env_cpus</code>, <code>env_memory</code> and
<code>env_disk</code>.

     <p><i>History</i>: Was introduced in version 3.1.0b1,Nova 2.0.0b1 (2010)

   </dl>

<div class="node">
<a name="environment_state-in-guest_environments"></a>
<a name="environment_005fstate-in-guest_005fenvironments"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#environment_005ftype-in-guest_005fenvironments">environment_type in guest_environments</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#environment_005fresources-in-guest_005fenvironments">environment_resources in guest_environments</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#guest_005fenvironments-in-agent-promises">guest_environments in agent promises</a>

</div>

<h4 class="subsection">7.3.4 <code>environment_state</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>create</code>
               <code>delete</code>
               <code>running</code>
               <code>suspended</code>
               <code>down</code>
</pre>
   <p class="noindent"><b>Synopsis</b>: The desired dynamical state of the specified environment

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
guest_environments:

 linux::

 "bishwa-kvm1"
                 comment => "Keep this vm suspended",
   environment_resources => myresources,
        environment_type => "kvm",
       environment_state => "suspended",
        environment_host => "ubuntu";


</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The allowed states have the following convergent semantics.

     <dl>
<dt>&lsquo;<samp><span class="samp">create</span></samp>&rsquo;<dd>The guest machine is allocated, installed and left in a running state.

     <br><dt>&lsquo;<samp><span class="samp">delete</span></samp>&rsquo;<dd>The guest machine is shut down and de-allocated but no files are removed.

     <br><dt>&lsquo;<samp><span class="samp">running</span></samp>&rsquo;<dd>The guest machine is in a running state, if it previously exists.

     <br><dt>&lsquo;<samp><span class="samp">suspended</span></samp>&rsquo;<dd>The guest exists in a suspended state or a shutdown state. If the guest
is running, it is suspended, else it is ignored.

     <br><dt>&lsquo;<samp><span class="samp">down</span></samp>&rsquo;<dd>The guest machine is shut down, but not de-allocated.

   </dl>

<div class="node">
<a name="environment_type-in-guest_environments"></a>
<a name="environment_005ftype-in-guest_005fenvironments"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#environment_005fstate-in-guest_005fenvironments">environment_state in guest_environments</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#guest_005fenvironments-in-agent-promises">guest_environments in agent promises</a>

</div>

<h4 class="subsection">7.3.5 <code>environment_type</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>xen</code>
               <code>kvm</code>
               <code>esx</code>
               <code>vbox</code>
               <code>test</code>
               <code>xen_net</code>
               <code>kvm_net</code>
               <code>esx_net</code>
               <code>test_net</code>
               <code>zone</code>
               <code>ec2</code>
               <code>eucalyptus</code>
</pre>
   <p class="noindent"><b>Synopsis</b>: Virtual environment type

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">bundle agent my_vm_cloud
{
guest_environments:

 scope::

   "vguest1"

       environment_resources => my_environment_template,
       environment_interface => vnet("eth0,192.168.1.100/24"),
       environment_type      => "test",
       environment_state     => "create",
       environment_host      => "atlas";

   "vguest2"

       environment_resources => my_environment_template,
       environment_interface => vnet("eth0,192.168.1.101/24"),
       environment_type      => "test",
       environment_state     => "delete",
       environment_host      => "atlas";
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The currently supported types are those supported by <i>libvirt</i>. 
More will be added as time goes on.

<div class="node">
<a name="files-in-agent-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Miscellaneous-in-edit_005fline-promises">Miscellaneous in edit_line promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#guest_005fenvironments-in-agent-promises">guest_environments in agent promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-agent">Bundles for agent</a>

</div>

<h3 class="section">7.4 <code>files</code> promises in &lsquo;<samp><span class="samp">agent</span></samp>&rsquo;</h3>

<p><br>

   <p>Files promises are an umbrella concept for all attributes of files. 
Operations fall basically into three categories: create, delete and
edit.

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
      files:
     
        "<var>/path/file_object</var>"
     
            perms =&gt; <var>perms_body</var>,
            ... ;
     
</pre>
   </td></tr></table>

   <p>Prior to version 3, file promises were scattered into many different
types such as <code>files</code>, <code>tidy</code>, <code>copy</code>, <code>links</code>,
etc.  File handling in CFEngine 3 uses regular expressions everywhere for pattern
matching. The old `wildcard/globbing' expressions &lsquo;<samp><span class="samp">*</span></samp>&rsquo; and
&lsquo;<samp><span class="samp">?</span></samp>&rsquo;  are deprecated, and everything is based consistently on Perl
Compatible Regular Expressions.

   <p>There is a natural ordering in file processing that obviates the need
for the actionsequence. The trick of using multiple actionsequence
items with different classes, e.g.

<pre class="verbatim"> actionsequence = ( ... files.one  ..  files.two )
</pre>

   <p>can now be handled more elegantly using bundles. The natural ordering
uses that fact that some operations are mutually exclusive and that
some operations do not make sense in reverse order. For example,
editing a file and then copying onto it would be nonsense. 
Similarly, you cannot both remove a file and rename it.

<p class="noindent"><b>File copying</b>

   <p>One of the first things users of CFEngine 2 will notice is that copying is now `backwards'. 
Instead of the default object being source and the option being the destination,
in CFEngine 3 the destination is paramount and the source is an option. 
This is because the model of voluntary cooperation tells us that it is the
object that is changed which is the agent making the promise. One cannot
force change onto a destination with CFEngine, one can only invite change from
a source.

<p class="noindent"><b>Normal ordering of promise attributes</b>

   <p>CFEngine 3 no longer has an `action sequence'. Ordering of operations has,
in most cases, a natural ordering which is assumed by the agent. For instance:
`delete then create' (normal ordering) makes sense, but
`create then delete' does not. This sort of principle can be extended to
deal with all aspects of file promises.

   <p>The diagram below shows the ordering. Notice that the same ordering
applies regardless of file type (plain-file or directory).  Note also that
file editing is done "atomically" (see `File editing in CFEngine 3' for
important details).

   <div class="block-image"><img src="filelogic.png" alt="The normal ordering of file operators in CFEngine 3"></div>

   <p>The pseudo-code for this logic is shown in the diagram and below:

<pre class="verbatim"> for each file promise-object
    {
    if (depth_search) 
      do 
        DepthSearch (HandleLeaf)
      else 
        (HandleLeaf)
      done
    }

 HandleLeaf()
   {
   Does leaf-file exist?

     NO:  create
     YES: rename,delete,touch, 

     do
      for all servers in {localhost, @(servers)}
         {
         if (server-will-provide)
            do
              if (depth_search)
                 embedded source-depth-search (use file source)
                 break
              else
                 (use file source)
                 break
              done
            done
         }
     done
      
   Do all links (always local)

   Check Permissions

   Do edits
   }

</pre>

<p class="noindent"><b>Depth searches (recursion) during searches</b>

   <p>In CFEngine 2 there was the concept of recursion during file
searches. Recursion is now called "depth-search". 
In addition, it was possible to specify
wildcards in the base-path for this search. CFEngine 3 replaces
the `globbing' symbols with standard regular expressions:

<pre class="verbatim">
      CFEngine 2               CFEngine 3

/one/*/two/thr*/four    /one/.*/two/thr.*/four

</pre>

   <p>Note that this now means when searching for &ldquo;hidden&rdquo; files (files with names
starting with a `.') or files with specific extensions, you should take care to
escape the dot (e.g., <code>\.cshrc</code> or <code>.*\.txt</code> when you wish it to
mean a literal character and not the &ldquo;any character&rdquo; interpretation provided
by regular expression interpretation. 
Note that when you do a recursive search, the files <samp><span class="file">'.'</span></samp> and
<samp><span class="file">'..'</span></samp> are never included in the matched files, even if the regular
expresion in the &lsquo;<samp><span class="samp">leaf_name</span></samp>&rsquo; specifically allows them.

   <p>Note also the the filename &lsquo;<samp><span class="samp">/dir/ect/ory/.</span></samp>&rsquo; is a special case used with
the &lsquo;<samp><span class="samp">create</span></samp>&rsquo; attribute to indicate the directory named &lsquo;<samp><span class="samp">/dir/ect/ory</span></samp>&rsquo;
and not any of the files under it.  If you really want to specify a regular
expression that matches any single-character filename, use
&lsquo;<samp><span class="samp">/dir/ect/ory/[\w\W]</span></samp>&rsquo; as your promise regular expression (you can't use
&lsquo;<samp><span class="samp">/dir/ect/ory[^/]</span></samp>&rsquo;, see below for an explanation.

   <p>When we talk about a depth search, it refers to a search for file
objects which starts from the one or more matched base-paths as shown
in the example above.

<p class="noindent"><b>Filenames and regular expressions</b>

   <p>CFEngine allows regular expressions within filenames, but only after first
doing some sanity checking to prevent some readily avoidable problems.  The
biggest rule you need to know about filenames and regular expressions is that
<i>all</i> regular expressions in filenames are bounded by directory separators,
and that each component expression is anchored between the directory separators
See <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>. 
In other words, CFEngine splits up any file paths into its component parts,
and then it evaluates any regular expressions at a component-level.

   <p>What this means is that the path &lsquo;<samp><span class="samp">/tmp/gar.*</span></samp>&rsquo; will only match filenames
like <samp><span class="file">/tmp/gar</span></samp>, <samp><span class="file">/tmp/garbage</span></samp> and <samp><span class="file">/tmp/garden</span></samp>.  It will
<i>not</i> match filename like <samp><span class="file">/tmp/gar/baz</span></samp> (because even though the
&lsquo;<samp><span class="samp">.*</span></samp>&rsquo; in a regular expression means "zero or more of any character",
CFEngine restricts that to mean "zero or more of any character <i>in a path
component</i>").  Correspondingly, CFEngine
also restricts where you can use the &lsquo;<samp><span class="samp">/</span></samp>&rsquo; character (you can't use it
in a character class like &lsquo;<samp><span class="samp">[^/]</span></samp>&rsquo; or in a parenthesized or repeated
regular expression component.

   <p>This means that regular expressions which include "optional directory
components" won't work.  You can't have a files promise to tidy the directory
&lsquo;<samp><span class="samp">(/usr)?/tmp</span></samp>&rsquo;.  Instead, you need to be more verbose and specify
&lsquo;<samp><span class="samp">/usr/tmp|/tmp</span></samp>&rsquo;, or even better, think declaratively and create an
<i>slist</i> that contains both the strings &lsquo;<samp><span class="samp">/tmp</span></samp>&rsquo; and &lsquo;<samp><span class="samp">/usr/tmp</span></samp>&rsquo;,
and then allow CFEngine to iterate over the list!

   <p>This also means that the path &lsquo;<samp><span class="samp">/tmp/.*/something</span></samp>&rsquo; will match files like
<samp><span class="file">/tmp/abc/something</span></samp> or <samp><span class="file">/tmp/xyzzy/something</span></samp>.  However, even
though the pattern &lsquo;<samp><span class="samp">.*</span></samp>&rsquo; means "zero or more of any character (except
&lsquo;<samp><span class="samp">/</span></samp>&rsquo;)", CFEngine matches files bounded by directory separators.  So even
though the pathname <samp><span class="file">/tmp//something</span></samp> is technically the same as the
pathname <samp><span class="file">/tmp/something</span></samp>, the regular expression &lsquo;<samp><span class="samp">/tmp/.*/something</span></samp>&rsquo;
will <i>not</i> match on the degenerate case of <samp><span class="file">/tmp//something</span></samp> (or
<samp><span class="file">/tmp/something</span></samp>).

<p class="noindent"><b>Promises involving regular expressions</b>

   <p>CFEngine can only keep (or repair, or fail to keep) a promise on files which
actually exist.  If you make a promise based on a wildcard match, then the
promise is only ever attempted if the match succeeds.  However, if you make a
promise which includes a recursive search which includes a wildcard match,
then the promise can be kept or repaired (provided that the directory
specified in the promise exists).  Consider the following two examples,
(assuming that there first exist files named <samp><span class="file">/tmp/gar</span></samp>,
<samp><span class="file">/tmp/garbage</span></samp> and <samp><span class="file">/tmp/garden</span></samp>).  At first blush, the two
promises look like they should do the same thing, but there is a subtle
difference:

<pre class="verbatim">bundle agent foobaz		    bundle agent foobaz
{				    {
files:				    files:
 "/tmp/gar.*"			     "/tmp"
    delete => tidy,		    	delete => tidy,
    classes => if_ok("done");	    	depth_search => recurse("0"),
				    	file_select => gars,
				    	classes => if_ok("done");
				    }

				    body file_select gars
				    {
					leaf_name => { "gar.*" };
					file_result => "leaf_name";
				    }

body classes if_ok(x)		    body classes if_ok(x)
{				    {
promise_repaired => { "$(x)" };	    promise_repaired => { "$(x)" };
promise_kept => { "$(x)" };	    promise_kept => { "$(x)" };
}				    }
</pre>

   <p>In the first example, when the configuration containing this promise is first
executed, any file starting with "gar" that exists in the &lsquo;<samp><span class="samp">/tmp</span></samp>&rsquo;
directory will be removed, and the &lsquo;<samp><span class="samp">done</span></samp>&rsquo; class will be set.  However,
when the configuration is executed a second time, the pattern
&lsquo;<samp><span class="samp">/tmp/gar.*</span></samp>&rsquo; will not match any files, and that promise will not even
be <i>attempted</i> (and, consequently the &lsquo;<samp><span class="samp">done</span></samp>&rsquo; class will <i>not</i> be set).

   <p>In the second example, when the configuration containing this promise is first
executed, any file starting with "gar" that exists in the &lsquo;<samp><span class="samp">/tmp</span></samp>&rsquo;
directory will also be removed, and the &lsquo;<samp><span class="samp">done</span></samp>&rsquo; class will also be set. 
The second time the configuration is executed, however, the promise on the
&lsquo;<samp><span class="samp">/tmp</span></samp>&rsquo; directory will still be executed (because &lsquo;<samp><span class="samp">/tmp</span></samp>&rsquo; of course
still exists), and the &lsquo;<samp><span class="samp">done</span></samp>&rsquo; class <i>will</i> be set, because all files
matching the &lsquo;<samp><span class="samp">file_select</span></samp>&rsquo; attribute have been deleted from that
directory.

<p class="noindent"><b>Local and remote searches</b>

   <p>There are two distinct kinds of depth
search:

     <ul>
<li>A local search over promiser agents. 
<li>A remote search over provider agents. 
</ul>

   <p>When we are <i>copying</i> or <i>linking</i> to a file source, it is the search over
the <i>remote</i> source that drives the content of a promise (the
promise is a promise to use what the remote source provides). In
general, the sources are on a different device to the images that make
the promises.  For all other promises, we search over existing local
objects.

   <p>If we specify depth search together with copy of a directory, then the
implied remote source search is assumed, and it is made after the
search over local base-path objects has been made. If you mix complex
promise body operations in a single prmose, this could lead to
confusion about the resulting behaviour, and a warning is issued. In
general it is not recommended to mix searches without a full
understanding of the consequences, but this might occasionally be
useful.

   <p>Depth search is not allowed with <code>edit_line</code> promises.

<p class="noindent"><b>File editing in CFEngine 3</b>

   <p>CFEngine 2 assumed that all files were line-edited, because it was
based on Unix traditions. Since then many new file formats have
emerged, including XML.  CFEngine 3 opens up the possibiltiy for
multiple models of file editing. Line based editing is still present and
is both much simplified and much more powerful than previously.

   <p>File editing is not just a single kind of promise but a whole range of
`promises within files'. It is therefore not merely a body to a single kind of
promise, but a bundle of sub-promises. After all, inside each file is a new
world of objects that can make promises, quite separate from files' external
attributes.

   <p>A typical file editing stanza has the elements in the following
example.

<pre class="verbatim">######################################################################
#
# File editing
#
######################################################################

body common control

{
version => "1.2.3";
bundlesequence  => { "outerbundle"  };
}

########################################################

bundle agent outerbundle

{
files:

  "/home/mark/tmp/cf3_test"

       create    => "true",     # Like autocreate in cf2
       edit_line => inner_bundle;
}

########################################################

bundle edit_line inner_bundle
  {
  vars:

   "who" string => "SysAdmin John";	# private variable in bundle

  insert_lines:
    "/* This file is maintained by CFEngine (see $(who) for details) */",
	location => first_line;
  
  replace_patterns:

   # replace shell comments with C comments

   "#(.*)"

      replace_with => C_comment,
     select_region => MySection("New section");

  reports:

    someclass::

      "This is file $(edit.filename)";
  }

########################################
# Bodies for the library ...
########################################

body replace_with C_comment

{
replace_value => "/* $(match.1) */"; # backreference
occurrences => "all";          # first, last all
}

########################################################

body select_region MySection(x)

{
select_start => "\[$(x)\]";
select_end => "\[.*\]";
}

########################################################

body location first_line

{
before_after => "before";
first_last => "first";
select_line_matching => ".*";
}


</pre>

<p class="noindent">There are several things to notice:

     <ul>
<li>The line-editing promises are all convergent promises about patterns within
the file. They have bodies, just like other attributes do and these allow us
to make simple templates about file editing while extending the power of the
basic primitives.

     <li>All file edits specified in a single <code>edit_line</code> bundle are handled
"atomically".  CFEngine edits files like this:
          <ul>
<li>CFEngine makes a copy of the file you you want to edit
<li>CFEngine makes all the edits in the <b>copy</b> of the file.  The filename is the
same as your original file with the extension <samp><span class="file">.cf-after-edit</span></samp> appended. 
<li>After all edits are complete (the <code>delete_lines</code>, <code>field_edits</code>,
<code>insert_lines</code>, and finally <code>replace_patterns</code> promises), CFEngine
checks to see if the new file is the same as the original one.  If there are
no differences, the promises have converged, so it deletes the copy, and the
original is left completely unmodified. 
<li>If there are any differences, CFEngine makes a copy of your original file with
the extension <samp><span class="file">.cf-before-edit</span></samp> (so you always have the most recent backup
available), and then renames the edited version
to your original filename. 
</ul>
     Because file rename is an atomic operation (guaranteed by the operating
system), any application program will either see the old version of the file
or the new one &ndash; there is no "window of opportunity" where a partially edited
file can be seen (unless an application intentionally looks for the
<samp><span class="file">.cf-after-edit</span></samp> file).  Problems during editing (such as disk-full or
permission errors) are likewise detected, and CFEngine will not rename a
partial file over your original.

     <li>All pattern matching is through perl compatible regular expressions
<li>Editing takes place within a marked region (which defaults to the whole file
if not otherwise specified). 
<li>Search/replace functions now allow back-references. 
<li>The line edit model now contains a field or column model for dealing with tabular files such
as Unix <samp><span class="file">passwd</span></samp> and <samp><span class="file">group</span></samp> files. We can now apply powerful convergent editing operations
to single fields inside a table, to append, order and delete items from lists inside fields.

     <li>The special variable <code>$(edit.filename)</code> contains the name of the file being edited within
an edit bundle. 
</ul>

<p class="noindent">In the example above, back references are used to allow conversion of comments from shell-style
to C-style.

   <p><br>
Another example of files promises is to look for changes in files.  The
following example reports on all recent changes to files in a directory by
maintaining the most recent version of the <code>md5</code> hash of the file
contents.  Similar checks can be used to examine metadata or both the contents
and metadata, as well as using different difference checks.  The Community
Edition only reports that changes were found, but Enterprise versions of
CFEngine can also report on what exactly the significant changes were.

<pre class="verbatim">
bundle agent example
{
files:

  "/home/mark/tmp" -> "Security team"

       changes      => lay_a_tripwire,
       depth_search => recurse("inf"),
       action       => background;
}

#########################################################

body changes lay_a_tripwire

{
hash           => "md5";
report_changes => "content";
update         => "yes";
}

</pre>

   <p><br>

<ul class="menu">
<li><a accesskey="1" href="#acl-in-files">acl in files</a>
<li><a accesskey="2" href="#changes-in-files">changes in files</a>
<li><a accesskey="3" href="#copy_005ffrom-in-files">copy_from in files</a>
<li><a accesskey="4" href="#create-in-files">create in files</a>
<li><a accesskey="5" href="#delete-in-files">delete in files</a>
<li><a accesskey="6" href="#depth_005fsearch-in-files">depth_search in files</a>
<li><a accesskey="7" href="#edit_005fdefaults-in-files">edit_defaults in files</a>
<li><a accesskey="8" href="#edit_005fline-in-files">edit_line in files</a>
<li><a accesskey="9" href="#edit_005ftemplate-in-files">edit_template in files</a>
<li><a href="#edit_005fxml-in-files">edit_xml in files</a>
<li><a href="#file_005fselect-in-files">file_select in files</a>
<li><a href="#link_005ffrom-in-files">link_from in files</a>
<li><a href="#move_005fobstructions-in-files">move_obstructions in files</a>
<li><a href="#pathtype-in-files">pathtype in files</a>
<li><a href="#perms-in-files">perms in files</a>
<li><a href="#rename-in-files">rename in files</a>
<li><a href="#repository-in-files">repository in files</a>
<li><a href="#touch-in-files">touch in files</a>
<li><a href="#transformer-in-files">transformer in files</a>
</ul>

<div class="node">
<a name="acl-in-files"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#changes-in-files">changes in files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#files-in-agent-promises">files in agent promises</a>

</div>

<h4 class="subsection">7.4.1 <code>acl</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>aces</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>((user|group):[^:]+:[-=+,rwx()dtTabBpcoD]*(:(allow|deny))?)|((all|mask):[-=+,rwx()]*(:(allow|deny))?)</code>

     <p class="noindent"><b>Synopsis</b>: Native settings for access control entry

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body acl template
     
     {
     acl_method => "overwrite";
     acl_type => "posix";
     acl_directory_inherit => "parent";
     
     aces => { 
             "user:*:r(wwx),-r:allow", 
             "group:*:+rw:allow", 
             "mask:x:allow", 
             "all:r"
             };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>POSIX ACL are available in CFEngine Community starting with
3.4.0. NTFS ACL are available with CFEngine Nova or above.  Form of
the permissions is:

     <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
     <pre class="smallexample">                aces =&gt; {
                        "<var>user:uid:mode[:perm_type]</var>", ...,
                        "<var>group:gid:mode[:perm_type]</var>", ...,
                        "<var>all:mode[:perm_type]</var>"
                        };
</pre>
     </td></tr></table>

          <ul>
<li><code>user</code> indicates that the line applies to a user specified
  by the user identitfier <code>uid</code>. <code>mode</code> is the permission
  mode string.

          <li><code>group</code> indicates that the line applies to a group specified
  by the group identitfier <code>gid</code>. <code>mode</code> is the permission
  mode string.

          <li><code>all</code> indicates that the line applies to every
  user. <code>mode</code> is the permission mode string.

          <li><code>uid</code> is a valid user identifier for the system and
  cannot be empty. However, <code>uid</code> can be set to * as a synonym
  for the entity that owns the file system object (e.g. user:*:r).

          <li><code>gid</code> is a valid group identifier for the system and
  cannot be empty. However, in some acl types, <code>gid</code> can be set
  to * to indicate a special group (e.g. in POSIX this refers to the
  file group).

          <li><code>mode</code> is one or more strings
  <code>op</code>|<code>perms</code>|(<code>nperms</code>); a concatenation of <code>op</code>,
  <code>perms</code> and optionally (<code>nperms</code>), see below, separated
  with commas (e.g. +rx,-w(s)). <code>mode</code> is parsed from left to
  right. 
<!-- TODO: include support for @code{fullaccess}, @code{noaccess}, -->
<!-- and @code{remove} -->

          <li><code>op</code> specifies the operation on any existing permissions,
  if the defined ACE already exists. <code>op</code> can be =, empty, + or
  -. = or empty sets the permissions to the ACE as stated, + adds and
  - removes the permissions from any existing ACE. 
  <!-- TODO: what to do if + or - is used when ACE does not exist? -->

          <li><code>nperms</code> (optional) specifies file system specific
  (native) permissions. Only valid if <code>acl_type</code> is
  defined. <code>nperms</code> will only be enforced if the file object is
  stored on a file system supporting the acl type set in
  <code>acl_type</code> (e.g. <code>nperms</code> will be ignored if
  <code>acl_type:</code><code>ntfs</code> and the object is stored on a file system
  not supporting ntfs ACLs). Valid values for <code>nperms</code> varies with
  different ACL types, and is defined in subsequent sections.

          <li><code>perm_type</code> (optional) can be set to either <code>allow</code> or
  <code>deny</code>, and defaults to <code>allow</code>. <code>deny</code> is only valid
  if <code>acl_type</code> is set to an ACL type that support deny
  permissions. A <code>deny</code> ACE will only be enforced if the file
  object is stored on a file system supporting the acl type set in
  <code>acl_type</code>. 
</ul>

     <p><code>gperms</code> (generic permissions) is a concatenation of zero or more
of the characters shown in the table below. If left empty,
none of the permissions are set. 
<!-- TODO: Should be allowed to set no permissions (empty perms?) -->

     <p><table summary=""><tr align="left"><th valign="top" width="5%">Flag </th><th valign="top" width="20%">Description </th><th valign="top" width="30%">Semantics on file </th><th valign="top" width="35%">Semantics on directory

     <p><br></th></tr><tr align="left"><td valign="top" width="5%"><code>r</code> </td><td valign="top" width="20%">Read </td><td valign="top" width="30%">Read data, permissions, attributes </td><td valign="top" width="35%">Read
directory contents, permissions, attributes
<br></td></tr><tr align="left"><td valign="top" width="5%"><code>w</code> </td><td valign="top" width="20%">Write </td><td valign="top" width="30%">Write data </td><td valign="top" width="35%">Create, delete, rename subobjects
<br></td></tr><tr align="left"><td valign="top" width="5%"><code>x</code> </td><td valign="top" width="20%">Execute </td><td valign="top" width="30%">Execute file </td><td valign="top" width="35%">Access subobjects
     <br></td></tr></table>

     <p>Note that the <code>r</code> permission is not neccessary to read an object's
permissions and attributes in all file systems (e.g. in POSIX, having
<code>x</code> on its containing directory is sufficient).

     <br><dt>&lsquo;<samp><code>acl_directory_inherit</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>nochange</code>
                    <code>parent</code>
                    <code>specify</code>
                    <code>clear</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Access control list type for the affected file system

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body acl template
     
     {
     acl_method => "overwrite";
     acl_type => "posix";
     acl_directory_inherit => "parent";
     
     aces => {
             "user:*:rwx:allow",
             "group:*:+rw:allow",
             "mask:rx:allow",
             "all:r"
             };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Directories have ACLs associated with them, but they also have the
ability to inherit an ACL to sub-objects created within them. POSIX
calls the former ACL type "access ACL" and the latter "default ACL",
and we will use the same terminology.

     <p>The constraint <code>acl_directory_inherit</code> gives control over the
default ACL of directories. The default ACL can be left unchanged
(<code>nochange</code>), empty (<code>clear</code>), or be explicitly specified
(<code>specify</code>). In addition, the default ACL can be set equal to the
directory's access ACL (<code>parent</code>). This has the effect that child
objects of the directory gets the same access ACL as the directory.

     <br><dt>&lsquo;<samp><code>acl_method</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>append</code>
                    <code>overwrite</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Editing method for access control list

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body acl template
     
     {
     acl_method => "overwrite";
     acl_type => "posix";
     aces => { "user:*:rw:allow", "group:*:+r:allow", "all:"};
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>When defining an ACL, we can either use an existing ACL as the
starting point, or state all entries of the ACL. If we just care about
one entry, say that the superuser has full access, the <code>method</code>
constraint can be set to <code>append</code>, which is the default. This has
the effect that all the existing ACL entries that are not mentioned
will be left unchanged. On the other hand, if <code>method</code> is set to
<code>overwrite</code>, the resulting ACL will only contain the mentioned
entries. When doing this, it is important to check that all the
required ACL entries are set, e.g. owning user, group and all in Posix
ACLs.

     <br><dt>&lsquo;<samp><code>acl_type</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>generic</code>
                    <code>posix</code>
                    <code>ntfs</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Access control list type for the affected file system

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body acl template
     
     {
     acl_type => "ntfs";
     aces => { "user:Administrator:rwx(po)", "user:Auditor:r(o)"};
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>ACLs are supported on multiple platforms, which may have different
sets of available permission flags. By using the constraint
<code>acl_type</code>, we can specify which platform, or ACL API, we are
targeting with the ACL. The default, <code>generic</code>, is designed to
work on all supported platforms. However, if very specific permission
flags are required, like &ldquo;Take Ownership&rdquo; on the NTFS platform, we
must set <code>acl_type</code> to indicate the target platform. Currently,
the supported values are <code>posix</code> and <code>ntfs</code>.

     <br><dt>&lsquo;<samp><code>specify_inherit_aces</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>((user|group):[^:]+:[-=+,rwx()dtTabBpcoD]*(:(allow|deny))?)|((all|mask):[-=+,rwx()]*(:(allow|deny))?)</code>

     <p class="noindent"><b>Synopsis</b>: Native settings for access control entry

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     body acl template
     {
     specify_inherit_aces => {  "all:r" };
     }
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p><code>specify_inherit_aces</code> (optional) is a list of access control
  entries that are set on child objects. It is also parsed from left
  to right and allows multiple entries with same entity-type and
  id. Only valid if <code>acl_directory_inherit</code> is set to
  <code>specify</code>.

     <p>This is an acl which makes explicit setting for the acl inherited by
new objects within a directory. It is included for those implementations
that do not have a clear inheritance policy.

   </dl>

<div class="node">
<a name="changes-in-files"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#copy_005ffrom-in-files">copy_from in files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#acl-in-files">acl in files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#files-in-agent-promises">files in agent promises</a>

</div>

<h4 class="subsection">7.4.2 <code>changes</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>hash</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>md5</code>
                    <code>sha1</code>
                    <code>sha224</code>
                    <code>sha256</code>
                    <code>sha384</code>
                    <code>sha512</code>
                    <code>best</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Hash files for change detection

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body changes example
     {
     hash => "md5";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The <code>best</code> option cross correlates the best two available
algorithms known in the OpenSSL library.

     <br><dt>&lsquo;<samp><code>report_changes</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>all</code>
                    <code>stats</code>
                    <code>content</code>
                    <code>none</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Specify criteria for change warnings

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body changes example
     {
     report_changes => "content";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Files can change in permissions and contents, i.e. external or internal attributes. 
If &lsquo;<samp><span class="samp">all</span></samp>&rsquo; is chosen all attributes are checked.

     <br><dt>&lsquo;<samp><code>update_hashes</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Update hash values immediately after change warning

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body changes example
     {
     update_hashes => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>If this is positive, file hashes should be updated as soon as a change
is registered so that multiple warnings are not given about a single
change. This applies to addition and removal too.

     <br><dt>&lsquo;<samp><code>report_diffs</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Generate reports summarizing the major differences between individual text files

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body changes example
     {
     report_diffs => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p><i>This feature is available only in enterprise levels Nova and above.</i>

     <p>If true, CFEngine will log a `diff' summary of major changes to the
files.  It is not permitted to combine this promise with a depth
search, since this would consume a dangerous amount of resources and
would lead to unreadable reports.

     <p>The feature is intented as a informational summary, not as a version
control function suitable for transaction control. If you want to
do versioning on system files, you should keep a single repository
for them and use CFEngine to synchronize changes from the repository
source. Repositories should not be used to attempt to capture random
changes of the system.

   </dl>

<div class="node">
<a name="copy_from-in-files"></a>
<a name="copy_005ffrom-in-files"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#create-in-files">create in files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#changes-in-files">changes in files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#files-in-agent-promises">files in agent promises</a>

</div>

<h4 class="subsection">7.4.3 <code>copy_from</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>source</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>.+</code>

     <p class="noindent"><b>Synopsis</b>: Reference source file from which to copy

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body copy_from example
     {
     source => "/path/to/source";
     }
     
     # or
     
     body link_from example
     {
     source => "/path/to/source";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>For remote copies this refers to the file name on the remote server.

     <br><dt>&lsquo;<samp><code>servers</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>[A-Za-z0-9_.:-]+</code>

     <p class="noindent"><b>Synopsis</b>: List of servers in order of preference from which to copy

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body copy_from example
     {
     servers => { "primary.example.org", "secondary.example.org", 
                      "tertiary.other.domain" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The servers are tried in order until one of them succeeds.

     <br><dt>&lsquo;<samp><code>collapse_destination_dir</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false Place files in subdirectories into the root destination directory during copy

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body copy_from mycopy(from,server)
     
     {
     source      => "$(from)";
     servers     => { "$(server)" };
     collapse_destination_dir => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Under normal operations, recursive copies cause CFEngine to track subdirectories
of files. So, for instance, if we copy recurively from <samp><span class="file">src</span></samp> to <samp><span class="file">dest</span></samp>,
then <samp><span class="file">src/subdir/file</span></samp> will map to <samp><span class="file">dest/subdir/file</span></samp>.

     <p>By setting this option to &lsquo;<samp><span class="samp">true</span></samp>&rsquo;, the promiser destination
directory promises to aggregate files searched from all subdirectories
into itself, i.e. a single destination directory.

     <br><dt>&lsquo;<samp><code>compare</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>atime</code>
                    <code>mtime</code>
                    <code>ctime</code>
                    <code>digest</code>
                    <code>hash</code>
                    <code>exists</code>
                    <code>binary</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Menu option policy for comparing source and image file attributes

     <p class="noindent"><b>Default value:</b> mtime or ctime differs

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body copy_from example
     
     {
     compare => "digest";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The default copy method is &lsquo;<samp><span class="samp">mtime</span></samp>&rsquo; (modification time), meaning that
the source file is copied to the destination (promiser) file, if the
source file has been modified more recently than the destination.

     <p>The different options are:
          <ul>
<li><code>mtime</code> CFEngine copies the file if the modification time of the source
file is more recent than that of the promised file

          <li><code>ctime</code> CFEngine copies the file if the creation time of the source file
is more recent than that of the promised file

          <li><code>atime</code> CFEngine copies the file if the modification time or creation
time of the source file is more recent than that of the promised file.  If the
times are equal, a byte-for-bye comparison is done on the files to determine
if it needs to be copied.

          <li><code>exists</code> CFEngine copies the file if the promised file does not already
exist.

          <li><code>binary</code> CFEngine copies the file if they are both plain files and a
byte-for-byte comparison determines that they are different.  If both are not
plain files, CFEngine reverts to comparing the <code>mtime</code> and <code>ctime</code>
of the files.  If the source file is on a different machine (i.e., network
copy), then <code>hash</code> is used instead to reduce network bandwidth.

          <li><code>hash</code> CFEngine copies the file if they are both plain files and a
message digest comparison indicates that the files are different.  In
Enterprise versions of CFEngine version 3.1.0 and later, SHA256 is used as a
message digest hash to conform with FIPS; in older Enterprise versions of
CFEngine and all Community versions, MD5 is used.

          <li><code>digest</code> a synonym for <code>hash</code>

     </ul>

     <br><dt>&lsquo;<samp><code>copy_backup</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>timestamp</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Menu option policy for file backup/version control

     <p class="noindent"><b>Default value:</b> true

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body copy_from example
     {
     copy_backup => "timestamp";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Determines whether a backup of the previous version is kept on the
system. This should be viewed in connection with the system repository,
since a defined repository affects the location at which the backup
is stored.  See
<a href="#default_005frepository-in-agent">default_repository</a> and
<a href="#repository-in-files">repository</a> for further details.

     <br><dt>&lsquo;<samp><code>encrypt</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false use encrypted data stream to connect to remote host

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body copy_from example
     {
     servers  => { "remote-host.example.org" };
     encrypt => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Client connections are encrypted with using a Blowfish randomly
generated session key.  The intial connection is encrypted using the
public/private keys for the client and server hosts.

     <br><dt>&lsquo;<samp><code>check_root</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false check permissions on the root directory when depth_search

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body copy_from example
     {
     check_root => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>When copying files recursively (by depth search), this flag determines
whether the permissions of the root directory should be set from the
root of the source. The default is to check only copied file objects
and subdirectories within this root (false).

     <br><dt>&lsquo;<samp><code>copylink_patterns</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: List of patterns matching files that should be copied instead of linked

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body copy_from example
     {
     copylink_patterns => { "special_node1", "other_node.*" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The matches are performed on the last node of the filename, i.e.  the
file without its path. As windows does not support symbolic links,
this feature is not available there.

     <br><dt>&lsquo;<samp><code>copy_size</code></samp>&rsquo;<dd><b>Type</b>: irange [int,int]

     <p class="noindent"><b>Allowed input range</b>: <code>0,inf</code>

     <p class="noindent"><b>Synopsis</b>: Integer range of file sizes that may be copied

     <p class="noindent"><b>Default value:</b> any size range

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body copy_from example
     {
     copy_size => irange("0","50000");
     } 
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The use of the irange function is optional. Ranges may also be
specified as a comma separated numbers.

     <br><dt>&lsquo;<samp><code>findertype</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>MacOSX</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Menu option for default finder type on MacOSX

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body copy_from example
     {
     findertype => "MacOSX";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This applies only to the Macintosh OSX variants.

     <br><dt>&lsquo;<samp><code>linkcopy_patterns</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: List of patterns matching files that should be replaced with symbolic links

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body copy_from mycopy(from)
     
     {
     source            => "$(from)";
     linkcopy_patterns => { ".*" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The pattern matches the last node filename (i.e. without the absolute
path). Windows only supports hard links, see <code>link_type</code>.

     <br><dt>&lsquo;<samp><code>link_type</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>symlink</code>
                    <code>hardlink</code>
                    <code>relative</code>
                    <code>absolute</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Menu option for type of links to use when copying

     <p class="noindent"><b>Default value:</b> symlink

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body link_from example
     {
     link_type => "symlink";
     source => "/tmp/source";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>What kind of link should be used to link files. Users are advised to
be wary of `hard links' (see Unix manual pages for the &lsquo;<samp><span class="samp">ln</span></samp>&rsquo;
command). The behaviour of non-symbolic links is often precarious and
unpredictable. However, hard links are the only supported type by
windows.

     <p>Note that &lsquo;<samp><span class="samp">symlink</span></samp>&rsquo; is synonymous with &lsquo;<samp><span class="samp">absolute</span></samp>&rsquo; links, which
are different from &lsquo;<samp><span class="samp">relative</span></samp>&rsquo; links. Although all of these are symbolic
links, the nomenclature here is defined such that &lsquo;<samp><span class="samp">symlink</span></samp>&rsquo; and
&lsquo;<samp><span class="samp">absolute</span></samp>&rsquo; are equivalent . When verifying a link, choosing
`relative' means that the link <i>must</i> be relative to the source, so
relative and absolute links are mutually exclusive.

     <br><dt>&lsquo;<samp><code>force_update</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false force copy update always

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body copy_from example
     {
     force_update => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Warning: this is a non-convergent operation. Although the end point
might stabilize in content, the operation will never quiesce. Use of
this feature is not recommended except in exceptional circumstances
since it creates a busy-dependency. If the copy is a network copy,
the system will be disturbed by network disruptions.

     <br><dt>&lsquo;<samp><code>force_ipv4</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false force use of ipv4 on ipv6 enabled network

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body copy_from example
     {
     force_ipv4 => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>IPv6 should be harmless to most users unless you have a partially
or misconfigured setup.

     <br><dt>&lsquo;<samp><code>portnumber</code></samp>&rsquo;<dd><b>Type</b>: int

     <p class="noindent"><b>Allowed input range</b>: <code>1024,99999</code>

     <p class="noindent"><b>Synopsis</b>: Port number to connect to on server host

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body copy_from example
     {
     portnumber => "5308";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The standard or registered port number is tcp/5308. CFEngine does not
presently use its registered udp port with the same number, but this
could change in the future.

     <br><dt>&lsquo;<samp><code>preserve</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false whether to preserve file permissions on copied file

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body copy_from example
     {
     preserve => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Ensures the destination file (promiser) gets the same Unix mode
as the source. This also applies to remote copies.

     <p><i>History</i>: Was introduced in version 3.1.0b3,Nova 2.0.0b1 (2010)

     <br><dt>&lsquo;<samp><code>purge</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false purge files on client that do not match files on server when a depth_search is used

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body copy_from example
     {
     purge => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Purging files is a potentially dangerous matter during a file copy it
implies that any promiser (destination) file which is not matched by a
source will be deleted. Since there is no source, this means the file
will be irretrievable. Great care should be exercised when using this
feature.

     <p>Note that purging will also delete backup files generated during
the file copying if <code>copy_backup</code> is set to true.

     <br><dt>&lsquo;<samp><code>stealth</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false whether to preserve time stamps on copied file

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body copy_from example
     {
     stealth => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Preserves file access and modification times on the promiser files.

     <br><dt>&lsquo;<samp><code>timeout</code></samp>&rsquo;<dd><b>Type</b>: int

     <p class="noindent"><b>Allowed input range</b>: <code>1,3600</code>

     <p class="noindent"><b>Synopsis</b>: Connection timeout, seconds

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body runagent control
     {
     timeout => "10";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Timeout in seconds.

     <br><dt>&lsquo;<samp><code>trustkey</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false trust public keys from remote server if previously unknown

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body copy_from example
     {
     trustkey => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>If the server's public key has not already been trusted, this
allows us to accept the key in automated key-exchange.

     <p>Note that, as a simple security precaution, trustkey should normally
be set to &lsquo;<samp><span class="samp">false</span></samp>&rsquo;, to avoid key exchange with a server one is not
one hundred percent sure about, though the risks for a client are
rather low. On the server-side however, trust is often granted to
many clients or to a whole network in which possibly unauthorized
parties might be able to obtain an IP address, thus the trust issue
is most important on the server side.

     <p>As soon as a public key has been exchanged, the trust option has no
effect. A machine that has been trusted remains trusted until
its key is manually revoked by a system administrator. Keys are
stored in <samp><span class="file">WORKDIR/ppkeys</span></samp>.

     <br><dt>&lsquo;<samp><code>type_check</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false compare file types before copying and require match

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body copy_from example
     {
     type_check => "false";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>File types at source and destination should normally match in order for
updates to overwrite them. This option allows this checking to be switched off.

     <br><dt>&lsquo;<samp><code>verify</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false verify transferred file by hashing after copy (resource penalty)

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body copy_from example
     {
     verify => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This is a highly resource intensive option, not recommended
for large file transfers.

   </dl>

<div class="node">
<a name="create-in-files"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#delete-in-files">delete in files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#copy_005ffrom-in-files">copy_from in files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#files-in-agent-promises">files in agent promises</a>

</div>

<h4 class="subsection">7.4.4 <code>create</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false whether to create non-existing file

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
files:

  "/path/plain_file"

     create =>   "true";

  "/path/dir/."
  
     create =>   "true";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Directories are created by using the &lsquo;<samp><span class="samp">/.</span></samp>&rsquo; to signify a directory type. 
Note that, if no permissions are specified, mode 600 is chosen for a file,
and mode 755 is chosen for a directory. If you cannot accept these defaults,
you <i>should</i> specify permissions.

   <p>Note that technically, &lsquo;<samp><span class="samp">/.</span></samp>&rsquo; is a regular expression.  However, it is
used as a special case meaning "directory".  See the <b>filenames and regular
expressions</b> near the beginning of the section on
<a href="#files-in-agent-promises">files promises</a> for a more complete discussion.

   <p><b>Note:</b> In general, you should not use <code>create</code> with
<a href="#copy_005ffrom-in-files">copy_from</a> or <a href="#link_005ffrom-in-files">link_from</a>
in files promises.  These latter attributes automatically
create the promised file, and using <code>create</code> may actually prevent the
copy or link promise from being kept (since <code>create</code> acts first, which
may affect file comparison or linking operations).

<div class="node">
<a name="delete-in-files"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#depth_005fsearch-in-files">depth_search in files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#create-in-files">create in files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#files-in-agent-promises">files in agent promises</a>

</div>

<h4 class="subsection">7.4.5 <code>delete</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>dirlinks</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>delete</code>
                    <code>tidy</code>
                    <code>keep</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Menu option policy for dealing with symbolic links to directories during deletion

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body delete example
     {
     dirlinks => "keep";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Links to directories are normally removed just like any other link or
file objects. By keeping directory links, you preserve the logical
directory structure of the file system so that a link to a directory
is not removed but is treated as a directory to be descended into.

     <p>The value <code>keep</code> instructs CFEngine not to remove directory links. 
The values <code>delete</code> and <code>tidy</code> are synonymous, and instruct
CFEngine to remove directory links.

     <p class="noindent"><b>Default value</b> (only if body is present):<br>
<br>

     <p>The default value only has significance if there is a <code>delete</code> body
present.  If there is no <code>delete</code> body, then files (and directory links)
are <b>not</b> deleted.

     <p><code>dirlinks =&gt; delete</code>

     <br><dt>&lsquo;<samp><code>rmdirs</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false whether to delete empty directories during recursive deletion

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body delete example
     {
     rmdirs => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>When deleting files recursively from a base directory, should we
delete empty directories also, or keep the directory structure intact?

     <p>Note the parent directory of a search is not deleted in recursive
deletions.  In CFEngine 2 there was an option to delete the parent of
the search, but now in CFEngine 3, you must code a separate promise to
delete the single parent object.

     <pre class="verbatim">     
     bundle agent cleanup
     {
     files:
     
       # This will not delete the parent
     
       "/home/mark/tmp/testcopy" 
     
         delete => tidyfiles,
         file_select => changed_within_1_year,
         depth_search => recurse("inf");
     
       # Now delete the parent.
     
       "/home/mark/tmp/testcopy" 
         delete => tidyfiles;
     }
     
     body delete tidyfiles
     {
     dirlinks => "delete";
     rmdirs   => "true";
     }
     
     body file_select changed_within_1_year
     {
     mtime     => irange(ago(1,0,0,0,0,0),now);
     file_result => "mtime";
     }
     
</pre>

     <p class="noindent"><b>Default value</b> (only if body is present):<br>
<br>

     <p>The default value only has significance if there is a <code>delete</code> body
present.  If there is no <code>delete</code> body, then files (and directories)
are <b>not</b> deleted.

     <p><code>rmdirs =&gt; true</code>

   </dl>

<div class="node">
<a name="depth_search-in-files"></a>
<a name="depth_005fsearch-in-files"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#edit_005fdefaults-in-files">edit_defaults in files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#delete-in-files">delete in files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#files-in-agent-promises">files in agent promises</a>

</div>

<h4 class="subsection">7.4.6 <code>depth_search</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>depth</code></samp>&rsquo;<dd><b>Type</b>: int

     <p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

     <p class="noindent"><b>Synopsis</b>: Maximum depth level for search

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body depth_search example
     {
     depth => "inf";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This was previous called `recurse' in earlier versions of CFEngine. 
Note that the value &lsquo;<samp><span class="samp">inf</span></samp>&rsquo; may be used for an unlimited value.

     <p>When searching recursively from a directory, the parent directory is
not part of the search. It is only the anchor point. To alter the parent,
a separate non-recursive promise should be made.

     <br><dt>&lsquo;<samp><code>exclude_dirs</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>.*</code>

     <p class="noindent"><b>Synopsis</b>: List of regexes of directory names NOT to include in depth search

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body depth_search
     {
     # no dot directories
     exclude_dirs => { "\..*" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Directory names are treated specially when searching recursively through a
file system.

     <br><dt>&lsquo;<samp><code>include_basedir</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false include the start/root dir of the search results

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body depth_search example
     {
     include_basedir => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>When checking files recursively (with <code>depth_search</code>) the promiser
is a directory. This parameter determines whether that initial directory
should be considered part of the promise or simply a boundary which marks
the edge of the search. If true, the promiser directory will also promise
the same attributes as the files inside it.

     <br><dt>&lsquo;<samp><code>include_dirs</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>.*</code>

     <p class="noindent"><b>Synopsis</b>: List of regexes of directory names to include in depth search

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body depth_search example
     {
     include_dirs => { "subdir1", "subdir2", "pattern.*" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This is the complement of <code>exclude_dirs</code>.

     <br><dt>&lsquo;<samp><code>rmdeadlinks</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false remove links that point to nowhere

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body depth_search example
     {
     rmdeadlinks => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>If we find links that point to non-existence files, should we delete them or keep them?

     <br><dt>&lsquo;<samp><code>traverse_links</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false traverse symbolic links to directories

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body depth_search example
     {
     traverse_links => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>If this is true, <code>cf-agent</code> will treat symbolic links to
directories as if they were directories. Normally this is considered a
potentially dangerous assumption and links are not traversed.

     <br><dt>&lsquo;<samp><code>xdev</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false exclude directories that are on different devices

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body depth_search example
     {
     xdev => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

   </dl>

<div class="node">
<a name="edit_defaults-in-files"></a>
<a name="edit_005fdefaults-in-files"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#edit_005fline-in-files">edit_line in files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#depth_005fsearch-in-files">depth_search in files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#files-in-agent-promises">files in agent promises</a>

</div>

<h4 class="subsection">7.4.7 <code>edit_defaults</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>edit_backup</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>timestamp</code>
                    <code>rotate</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Menu option for backup policy on edit changes

     <p class="noindent"><b>Default value:</b> true

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body edit_defaults example
     {
     edit_backup => "timestamp";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <br><dt>&lsquo;<samp><code>empty_file_before_editing</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Baseline memory model of file to zero/empty before commencing promised edits

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body edit_defaults example
     {
     empty_file_before_editing => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Emptying a file before reconstructing its contents according to a
fixed recipe allows an ordered procedure to be convergent.

     <br><dt>&lsquo;<samp><code>inherit</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: If true this causes the sub-bundle to inherit the private classes of its parent

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     bundle agent name
     {
     methods:
     
       "group name" usebundle => my_method,
                      inherit => "true";
     }
     
     
     body edit_defaults example
     {
     inherit => "true";
     }
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p><i>History</i>: Was introduced in 3.4.0, Enterprise 3.0.0 (2012)

     <p class="noindent"><b>Default value</b>: false

     <p>The <code>inherit</code> constraint can be added to the CFEngine code in two
places: for <code>edit_defaults</code> and in <code>methods</code> promises.  If
set to true, it causes the child-bundle named in the promise to
inherit (only) the classes of the parent bundle. Inheriting the
variables is unnecessary as the child can always access the parent's
variables by a qualified reference using its bundle name,
e.g. &lsquo;<samp><span class="samp">$(bundle.variable)</span></samp>&rsquo;.

     <br><dt>&lsquo;<samp><code>max_file_size</code></samp>&rsquo;<dd><b>Type</b>: int

     <p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

     <p class="noindent"><b>Synopsis</b>: Do not edit files bigger than this number of bytes

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body edit_defaults example
     {
     max_file_size => "50K";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>A local, per-file sanity check to make sure the file editing is sensible. 
If this is set to zero, the check is disabled and any size may be edited. 
The default value of <code>max_file_size</code> is determined by the global
control body setting, See <a href="#editfilesize-in-agent">editfilesize in agent</a>, whose default value is
<code>100k</code>.

     <br><dt>&lsquo;<samp><code>recognize_join</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Join together lines that end with a backslash, up to 4kB limit

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     files:
     
       "/tmp/test_insert"
                 create => "true",
              edit_line => Insert("$(insert.v)"),
          edit_defaults => join;
     }
     
     #
     
     body edit_defaults join
     {
     recognize_join => "true";
     }
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>If set to true, this option allows CFEngine to process line based files
with backslash continuation. The default is to not process continuation backslashes.

     <p>Back slash lines will only be concatenated if the file requires editing,
and will not be restored. Restoration of the backslashes is not
possible in a meaningful and convergent fashion.

     <br><dt>&lsquo;<samp><code>rotate</code></samp>&rsquo;<dd><b>Type</b>: int

     <p class="noindent"><b>Allowed input range</b>: <code>0,99</code>

     <p class="noindent"><b>Synopsis</b>: How many backups to store if 'rotate' edit_backup strategy is selected. Defaults to 1

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body rename example
     {
     rotate => "4";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Used for log rotation. If the file is named <samp><span class="file">foo</span></samp> and the &lsquo;<samp><span class="samp">rotate</span></samp>&rsquo;
attribute is set to &lsquo;<samp><span class="samp">4</span></samp>&rsquo;, as above, then initially <samp><span class="file">foo</span></samp> is copied
to <samp><span class="file">foo.1</span></samp> and the old file <samp><span class="file">foo</span></samp> is zeroed out (that is, the inode
of the original logfile does not change, but the original logfile will be
empty after the rotation is complete).

     <p>The next time the promise is executed, <samp><span class="file">foo.1</span></samp> will be renamed
<samp><span class="file">foo.2</span></samp>, <samp><span class="file">foo</span></samp> is again copied to <samp><span class="file">foo.1</span></samp> and the old file
<samp><span class="file">foo</span></samp> is again zeroed out.

     <p>Each time the promise is executed (and typically, the promise would be
executed as guarded by time-based or file-size-based classes), the files are
copied/zeroed or rotated as above until there are &lsquo;<samp><span class="samp">rotate</span></samp>&rsquo; numbered files
plus the one "main" file.  In the example above, the file <samp><span class="file">foo.3</span></samp> will be
renamed <samp><span class="file">foo.4</span></samp>, but the old version of the file <samp><span class="file">foo.4</span></samp> will be
deleted (that is, it "falls off the end" of the rotation).

   </dl>

<div class="node">
<a name="edit_line-in-files"></a>
<a name="edit_005fline-in-files"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#edit_005ftemplate-in-files">edit_template in files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#edit_005fdefaults-in-files">edit_defaults in files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#files-in-agent-promises">files in agent promises</a>

</div>

<h4 class="subsection">7.4.8 <code>edit_line</code></h4>

<p><b>Type</b>: (ext bundle) (Separate Bundle)

<div class="node">
<a name="edit_template-in-files"></a>
<a name="edit_005ftemplate-in-files"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#edit_005fxml-in-files">edit_xml in files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#edit_005fline-in-files">edit_line in files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#files-in-agent-promises">files in agent promises</a>

</div>

<h4 class="subsection">7.4.9 <code>edit_template</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>"?(/.*)</code>

<p class="noindent"><b>Synopsis</b>: The name of a special CFEngine template file to expand

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">#This is a template file /templates/input.tmpl

These lines apply to anyone

[%CFEngine solaris.Monday:: %]
Everything after here applies only to solaris on Mondays
until overridden...

[%CFEngine linux:: %]
Everything after here now applies now to linux only.

[%CFEngine BEGIN %]
This is a block of text
That contains list variables: $(some.list)
With text before and after.
[%CFEngine END %]

nameserver $(some.list)
</pre>

   <p>For example:

<pre class="verbatim">[%CFEngine any:: %]
&lt;VirtualHost $(sys.ipv4[eth0]):80>
        ServerAdmin             $(stage_file.params[apache_mail_address][1])
        DocumentRoot            /var/www/htdocs
        ServerName              $(stage_file.params[apache_server_name][1])
        AddHandler              cgi-script cgi
        ErrorLog                /var/log/httpd/error.log
        AddType                 application/x-x509-ca-cert .crt
        AddType                 application/x-pkcs7-crl    .crl
        SSLEngine               off
        CustomLog               /var/log/httpd/access.log
&lt;/VirtualHost>

[%CFEngine webservers_prod:: %]
[%CFEngine BEGIN %]
&lt;VirtualHost $(sys.ipv4[$(bundle.interfaces)]):443>                                               
        ServerAdmin             $(stage_file.params[apache_mail_address][1]) 
        DocumentRoot            /var/www/htdocs                                  
        ServerName              $(stage_file.params[apache_server_name][1])            
        AddHandler              cgi-script cgi                                 
        ErrorLog                /var/log/httpd/error.log                  
        AddType                 application/x-x509-ca-cert .crt                
        AddType                 application/x-pkcs7-crl    .crl                
        SSLEngine               on                                             
        SSLCertificateFile      $(stage_file.params[apache_ssl_crt][1])
        SSLCertificateKeyFile   $(stage_file.params[apache_ssl_key][1])
        CustomLog               /var/log/httpd/access.log                      
&lt;/VirtualHost>
[%CFEngine END %]
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in 3.3.0, Nova 2.2.0 (2012)

   <p>The template format uses inline tags to mark regions and classes. 
Each line represents an <code>insert_lines</code> promise, unless the promises
are grouped into a block using:

<pre class="verbatim">[%CFEngine BEGIN %]
...
[%CFEngine END %]
</pre>

<p class="noindent">Variables, scalars and list variables are expanded within each
promise; so, if lines are grouped into a block, the whole block is repeated
when lists are expanded (see the Special Topics Guide on editing).

   <p>If a class-context modified is used:

<pre class="verbatim">[%CFEngine class-expression:: %]
</pre>
then the lines that follow are only inserted if the context
matches the agent's current context. This allows conditional insertion.

<div class="node">
<a name="edit_xml-in-files"></a>
<a name="edit_005fxml-in-files"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#file_005fselect-in-files">file_select in files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#edit_005ftemplate-in-files">edit_template in files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#files-in-agent-promises">files in agent promises</a>

</div>

<h4 class="subsection">7.4.10 <code>edit_xml</code></h4>

<p><b>Type</b>: (ext bundle) (Separate Bundle)

<div class="node">
<a name="file_select-in-files"></a>
<a name="file_005fselect-in-files"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#link_005ffrom-in-files">link_from in files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#edit_005fxml-in-files">edit_xml in files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#files-in-agent-promises">files in agent promises</a>

</div>

<h4 class="subsection">7.4.11 <code>file_select</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>leaf_name</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: List of regexes that match an acceptable name

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body file_select example
     {
     leaf_name => { "S[0-9]+[a-zA-Z]+", "K[0-9]+[a-zA-Z]+" };
     file_result => "leaf_name";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This pattern matches only the node name of the file, not its path.

     <br><dt>&lsquo;<samp><code>path_name</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>"?(/.*)</code>

     <p class="noindent"><b>Synopsis</b>: List of pathnames to match acceptable target

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body file_select example
     {
     leaf_name => { "prog.pid", "prog.log" };
     path_name => { "/etc/.*", "/var/run/.*" };
     
     file_result => "leaf_name.path_name"
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Path name and leaf name can be conveniently tested for separately by use
of appropriate regular expressions.

     <br><dt>&lsquo;<samp><code>search_mode</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>[0-7augorwxst,+-]+</code>

     <p class="noindent"><b>Synopsis</b>: A list of mode masks for acceptable file permissions

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     #######################################################
     #
     # Searching for permissions
     #
     #######################################################
     
     body common control
        {
        any::
     
           bundlesequence  => { 
                              "testbundle"
                              };
     
        version => "1.2.3";
        }
     
     ############################################
     
     bundle agent testbundle
     
     {
     files:
     
       "/home/mark/tmp/testcopy" 
     
         file_select => by_modes,
         transformer => "/bin/echo DETECTED $(this.promiser)",
         depth_search => recurse("inf");
     
     }
     
     ############################################
     
     body file_select by_modes
     
     {
     search_mode => { "711" , "666" };
     file_result => "mode";
     }
     
     ############################################
     
     body depth_search recurse(d)
     
     {
     depth => "$(d)";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The mode may be specified in symbolic or numerical form with &lsquo;<samp><span class="samp">+</span></samp>&rsquo;
and &lsquo;<samp><span class="samp">-</span></samp>&rsquo; constraints. 
Note that concatenation <code>ug+s</code> implies <code>u</code> OR <code>g</code>,
 and <code>u+g,u+s</code> implies <code>u</code> AND <code>g</code>.

     <br><dt>&lsquo;<samp><code>search_size</code></samp>&rsquo;<dd><b>Type</b>: irange [int,int]

     <p class="noindent"><b>Allowed input range</b>: <code>0,inf</code>

     <p class="noindent"><b>Synopsis</b>: Integer range of file sizes

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body file_select example
     {
     search_size => irange("0","20k");
     file_result => "size";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <br><dt>&lsquo;<samp><code>search_owners</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: List of acceptable user names or ids for the file, or regexes to match

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body file_select example
     {
     search_owners => { "mark", "jeang", "student_.*" };
     file_result => "owner";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>A list of regular expressions any of which must match the entire userid,
(that is, it is anchored, see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>). 
Note that windows does not have user ids, only names.

     <br><dt>&lsquo;<samp><code>search_groups</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: List of acceptable group names or ids for the file, or regexes to match

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body file_select example
     {
     search_groups => { "users", "special_.*" };
     file_result => "group";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>A list of regular expressions, any of which which must match the entire group,
(that is, it is anchored, see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>). 
Note that on windows, files do not have group associations.

     <br><dt>&lsquo;<samp><code>search_bsdflags</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>[+-]*[(arch|archived|nodump|opaque|sappnd|sappend|schg|schange|simmutable|sunlnk|sunlink|uappnd|uappend|uchg|uchange|uimmutable|uunlnk|uunlink)]+</code>

     <p class="noindent"><b>Synopsis</b>: String of flags for bsd file system flags expected set

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body file_select xyz
     {
     search_bsdflags => "archived|dump";
     file_result => "bsdflags";
     }
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Extra BSD file system flags (these have no effect on non-BSD versions of
CFEngine).  See the manual page for <code>chflags</code> for more details.

     <br><dt>&lsquo;<samp><code>ctime</code></samp>&rsquo;<dd><b>Type</b>: irange [int,int]

     <p class="noindent"><b>Allowed input range</b>: <code>0,2147483647</code>

     <p class="noindent"><b>Synopsis</b>: Range of change times (ctime) for acceptable files

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body files_select example
     {
     ctime => irange(ago(1,0,0,0,0,0),now);
     file_result => "ctime";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The file's change time refers to both modification of content and attributes
such as permissions. On windows, <code>ctime</code> refers to creation time.

     <br><dt>&lsquo;<samp><code>mtime</code></samp>&rsquo;<dd><b>Type</b>: irange [int,int]

     <p class="noindent"><b>Allowed input range</b>: <code>0,2147483647</code>

     <p class="noindent"><b>Synopsis</b>: Range of modification times (mtime) for acceptable files

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body files_select example
     
     {
     # Files modified more than one year ago (i.e., not in mtime range)
     mtime => irange(ago(1,0,0,0,0,0),now);
     file_result => "!mtime";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The file's modification time refers to both modification of content but not other attributes
such as permissions.

     <br><dt>&lsquo;<samp><code>atime</code></samp>&rsquo;<dd><b>Type</b>: irange [int,int]

     <p class="noindent"><b>Allowed input range</b>: <code>0,2147483647</code>

     <p class="noindent"><b>Synopsis</b>: Range of access times (atime) for acceptable files

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     body file_select used_recently
     {
     
     # files accessed within the last hour
     atime     => irange(ago(0,0,0,1,0,0),now);
     file_result => "atime";
     }
     
     
     body file_select not_used_much
     
     {
     # files not accessed since 00:00 1st Jan 2000 (in the local timezime)
     atime     => irange(on(2000,1,1,0,0,0),now);
     file_result => "!atime";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>A range of times during which a file was accessed can be specified in
a <code>file_select</code> body. (Like file filters in CFEngine 2.)

     <br><dt>&lsquo;<samp><code>exec_regex</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>.*</code>

     <p class="noindent"><b>Synopsis</b>: Matches file if this regular expression matches any full line returned by the command

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body file_select example
     {
     exec_regex => "SPECIAL_LINE: .*";
     exec_program => "/path/test_program $(this.promiser)";
     file_result => "exec_program.exec_regex";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The regular expression must be used in conjunction with the <code>exec_program</code> test. 
In this way the program must both return exit status 0 and its
output must match the regular expression.  The entire output must
be matched (that is, as if the regex is anchored, see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>).

     <br><dt>&lsquo;<samp><code>exec_program</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>"?(/.*)</code>

     <p class="noindent"><b>Synopsis</b>: Execute this command on each file and match if the exit status is zero

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body file_select example
     {
     exec_program => "/path/test_program $(this.promiser)";
     file_result => "exec_program";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This is part of the customizable file search criteria. 
If the user-defined  program returns exit status 0, the file is considered matched.

     <br><dt>&lsquo;<samp><code>file_types</code></samp>&rsquo;<dd><b>Type</b>: (option list)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>plain</code>
                    <code>reg</code>
                    <code>symlink</code>
                    <code>dir</code>
                    <code>socket</code>
                    <code>fifo</code>
                    <code>door</code>
                    <code>char</code>
                    <code>block</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: List of acceptable file types from menu choices

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body file_select filter
     {
     file_types => { "plain","symlink" };
     
     file_result => "file_types";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>File types vary in details between operating systems. The main POSIX
types are provided here as menu options, with &lsquo;<samp><span class="samp">reg</span></samp>&rsquo; being a synonym for
&lsquo;<samp><span class="samp">plain</span></samp>&rsquo; (meaning, in both cases, not one of the "special" file types).

     <br><dt>&lsquo;<samp><code>issymlinkto</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: List of regular expressions to match file objects

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body file_select example
     {
     issymlinkto => { "/etc/[^/]*", "/etc/init\.d/[a-z0-9]*" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>A list of regular expressions. If the file is a symbolic link which
points to files matched by one of these expressions, the file will be
selected. As windows does not support symbolic links, this attribute
is not applicable there.

     <br><dt>&lsquo;<samp><code>file_result</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>[!*(leaf_name|path_name|file_types|mode|size|owner|group|atime|ctime|mtime|issymlinkto|exec_regex|exec_program|bsdflags)[|&amp;.]*]*</code>

     <p class="noindent"><b>Synopsis</b>: Logical expression combining classes defined by file search criteria

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body file_select year_or_less
     
     {
     mtime       => irange(ago(1,0,0,0,0,0),now);  
     file_result => "mtime"; 
     }
     
     body file_select my_pdf_files_morethan1dayold
     
     {
     mtime         => irange(ago(0,0,1,0,0,0),now);  
     leaf_name     => { ".*\.pdf" , ".*\.fdf" };
     search_owners => { "mark" };
     
     file_result => "owner.leaf_name.!mtime";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Sets the criteria for file selection outcome during file searches. The
syntax is the same as for a class expression, since the file selection
is a classification of the file-search in the same way that system
classes are a classification of the abstract host-search (that is, you
may specify a boolean expression involving any of the file-matching
components).  In this way, you
may specify arbitrarily complex file-matching parameters, such as what is
shown above, "is owned by
mark, has the extension '.pdf' or '.fdf', and whose modification time is not
between 1 day ago and now (that is, it is older than 1 day)".

     <p>Items in the boolean expression in <code>file_result</code> must be from the
following list:

          <ul>
<li>leaf_name
<li>path_name
<li>file_types
<li>mode
<li>size
<li>owner
<li>group
<li>atime
<li>ctime
<li>mtime
<li>issymlinkto
<li>exec_regex
<li>exec_program
<li>bsdflags
</ul>

   </dl>

<div class="node">
<a name="link_from-in-files"></a>
<a name="link_005ffrom-in-files"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#move_005fobstructions-in-files">move_obstructions in files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#file_005fselect-in-files">file_select in files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#files-in-agent-promises">files in agent promises</a>

</div>

<h4 class="subsection">7.4.12 <code>link_from</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>copy_patterns</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: A set of patterns that should be copied and synchronized instead of linked

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body link_from example
     {
     copy_patterns =>  { "special_node1", "/path/special_node2" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>During the linking of files, it is sometimes useful to buffer changes
with an actual copy, especially if the link is to an emphemeral file
system. This list of patterns matches files that arise during a
linking policy. A positive match means that the file should be copied
and updated by modification time.

     <br><dt>&lsquo;<samp><code>link_children</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false whether to link all directory's children to source originals

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body link_from example
     {
     link_children => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>If the promiser is a directory, instead of copying the children, link them to the
source.

     <br><dt>&lsquo;<samp><code>link_type</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>symlink</code>
                    <code>hardlink</code>
                    <code>relative</code>
                    <code>absolute</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: The type of link used to alias the file

     <p class="noindent"><b>Default value:</b> symlink

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body link_from example
     {
     link_type => "symlink";
     source => "/tmp/source";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>What kind of link should be used to link files. Users are advised to
be wary of `hard links' (see Unix manual pages for the &lsquo;<samp><span class="samp">ln</span></samp>&rsquo;
command). The behaviour of non-symbolic links is often precarious and
unpredictable. However, hard links are the only supported type by
windows.

     <p>Note that &lsquo;<samp><span class="samp">symlink</span></samp>&rsquo; is synonymous with &lsquo;<samp><span class="samp">absolute</span></samp>&rsquo; links, which
are different from &lsquo;<samp><span class="samp">relative</span></samp>&rsquo; links. Although all of these are symbolic
links, the nomenclature here is defined such that &lsquo;<samp><span class="samp">symlink</span></samp>&rsquo; and
&lsquo;<samp><span class="samp">absolute</span></samp>&rsquo; are equivalent . When verifying a link, choosing
`relative' means that the link <i>must</i> be relative to the source, so
relative and absolute links are mutually exclusive.

     <br><dt>&lsquo;<samp><code>source</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>.+</code>

     <p class="noindent"><b>Synopsis</b>: The source file to which the link should point

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body copy_from example
     {
     source => "/path/to/source";
     }
     
     # or
     
     body link_from example
     {
     source => "/path/to/source";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>For remote copies this refers to the file name on the remote server.

     <br><dt>&lsquo;<samp><code>when_linking_children</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>override_file</code>
                    <code>if_no_such_file</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Policy for overriding existing files when linking directories of children

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body link_from example
     {
     when_linking_children => "if_no_such_file";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The options refer to what happens if the directory exists already and
is already partially populated with files. If the directory being
copied from contains a file with the same name as that of a link
to be created, we must decide whether to override the existing
destination object with a link or simply omit the automatic
linkage for files that already exist. The latter case can
be used to make a copy of one directory with certain fields
overridden.

     <br><dt>&lsquo;<samp><code>when_no_source</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>force</code>
                    <code>delete</code>
                    <code>nop</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Behaviour when the source file to link to does not exist

     <p class="noindent"><b>Default value:</b> nop

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body link_from example
     {
     when_no_source => "force";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>If we try to create a link to a file that does not exist a link, how
should CFEngine respond? The options are to force the creation to
a file that does not (yet) exist, delete any existing link, or do nothing.

   </dl>

<div class="node">
<a name="move_obstructions-in-files"></a>
<a name="move_005fobstructions-in-files"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#pathtype-in-files">pathtype in files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#link_005ffrom-in-files">link_from in files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#files-in-agent-promises">files in agent promises</a>

</div>

<h4 class="subsection">7.4.13 <code>move_obstructions</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false whether to move obstructions to file-object creation

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
files:

  "/tmp/testcopy" 

    copy_from    => mycopy("/tmp/source"),
    move_obstructions => "true",
    depth_search => recurse("inf");

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>If we have promised to make file <samp><span class="file">X</span></samp> a link, but it already
exists as a file, or vice-versa, or if a file is blocking the creation
of a directory etc, then normally CFEngine will report an error. If
this is set, existing objects will be moved aside to allow the system
to heal without intervention. Files and directories are saved/renamed, but
symbolic links are deleted.

   <p>Note that symbolic links for directories are treated as directories, not links. 
This behaviour can be discussed, but the aim is to err on the side of caution. 
Some operating systems (Solaris) use symbolic links in path names. Copying
to a directory could then result in renaming of the important link, if the behaviour
were different.

<div class="node">
<a name="pathtype-in-files"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#perms-in-files">perms in files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#move_005fobstructions-in-files">move_obstructions in files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#files-in-agent-promises">files in agent promises</a>

</div>

<h4 class="subsection">7.4.14 <code>pathtype</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>literal</code>
               <code>regex</code>
               <code>guess</code>
</pre>
   <p class="noindent"><b>Synopsis</b>: Menu option for interpreting promiser file object

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
files:

   "/var/lib\d"
      pathtype => "guess", 	# best guess (default)
         perms => system;

   "/var/lib\d"
      pathtype => "regex",	# force regex interpretation
         perms => system;

   "/var/.*/lib"

      pathtype => "literal", 	# force literal interpretation
         perms => system;

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>
By default, CFEngine makes an educated guess as to whether the promise
pathname involves a regular expression or not.  This guesswork is needed due
to cross-platform differences in filename interpretation.

   <p>If CFEngine guesses (or is told) that the pathname uses a regular
expression pattern, it will undertake a file search to find possible
matches. This can consume significant resources, and so the
&lsquo;<samp><span class="samp">guess</span></samp>&rsquo; option will always try to optimize this. Guesswork is,
however, imperfect, so you have the option to declare your intention.

   <p>If the keyword <code>literal</code> is invoked, a path will be treated as a
literal string regardless of what characters is contains. If it is
declared &lsquo;<samp><span class="samp">regex</span></samp>&rsquo;, it will be treated as a pattern to match.

   <p>Note that CFEngine splits the promiser up into path links before
matching, so that each link in the path chain is matched
separately. Thus it it meaningless to have a &lsquo;<samp><span class="samp">/</span></samp>&rsquo; in a regular
expression, as the comparison will never see this character.

   <p>In the examples above, at least one case implies an iteration over all
files/directories matching the regular expression, while the last case
means a single literal object with a name composed of dots and stars.

   <p>Furthermore, on Windows paths using <code>regex</code> must use the forward slash
(<code>/</code>) as path separator, since the backward slash has a special meaning
in a regular expression. Literal paths may also use backslash (<code>\</code>) as a
path separator, See <a href="#Regular-expressions-in-paths">Regular expressions in paths</a>, for more information.

<div class="node">
<a name="perms-in-files"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#rename-in-files">rename in files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#pathtype-in-files">pathtype in files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#files-in-agent-promises">files in agent promises</a>

</div>

<h4 class="subsection">7.4.15 <code>perms</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>bsdflags</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>[+-]*[(arch|archived|nodump|opaque|sappnd|sappend|schg|schange|simmutable|sunlnk|sunlink|uappnd|uappend|uchg|uchange|uimmutable|uunlnk|uunlink)]+</code>

     <p class="noindent"><b>Synopsis</b>: List of menu options for bsd file system flags to set

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body perms example
     
     {
     bsdflags => { "uappnd","uchg","uunlnk","nodump",
                   "opaque","sappnd","schg","sunlnk" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The BSD Unices (FreeBSD, OpenBSD, NetBSD) and MacOSX have additional
filesystem flags which can be set. Refer to the BSD <code>chflags</code>
documentation for this.

     <br><dt>&lsquo;<samp><code>groups</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>[a-zA-Z0-9_$.-]+</code>

     <p class="noindent"><b>Synopsis</b>: List of acceptable groups of group ids, first is change target

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     body perms example
     {
     groups => { "users", "administrators" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The first named group is the list is the defaul that will be
configured if the file does not match an element of the list.  The
reserved word &lsquo;<samp><span class="samp">none</span></samp>&rsquo; may be used to match files that are not
owned by a registered group. On windows, files do not have file groups
associated with them and thus this attribute is ignored.

     <p>ACLs may be used in place for this.

     <br><dt>&lsquo;<samp><code>mode</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>[0-7augorwxst,+-]+</code>

     <p class="noindent"><b>Synopsis</b>: File permissions (like posix chmod)

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body perms example
     {
     mode => "a+rx,o+w";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The mode string may be symbolic or numerical, like <code>chmod</code>. This
is ignored on windows, as the permission model uses ACLs. ACLs are
supported by CFEngine Nova.

     <br><dt>&lsquo;<samp><code>owners</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>[a-zA-Z0-9_$.-]+</code>

     <p class="noindent"><b>Synopsis</b>: List of acceptable owners or user ids, first is change target

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body perms example
     {
     owners => { "mark", "wwwrun", "jeang" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The first user is the reference value that CFEngine will set the file
to if none of the list items matches the true state of the file. The
reserved word &lsquo;<samp><span class="samp">none</span></samp>&rsquo; may be used to match files that are not
owned by a registered user.

     <p>On windows, users can only take ownership of files, never give
it. Thus, the first user in the list should be the user running the
CFEngine process (usually &ldquo;Administrator&rdquo;). Additionally, some
groups may be owners on windows (such as the &ldquo;Administrators&rdquo;
group).

     <br><dt>&lsquo;<samp><code>rxdirs</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false add execute flag for directories if read flag is set

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body perms rxdirs
     {
     rxdirs => "false";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Default behaviour is to set the &lsquo;<samp><span class="samp">x</span></samp>&rsquo; flag on directories
automatically if the &lsquo;<samp><span class="samp">r</span></samp>&rsquo; flag is specified when specifying
multiple files in a single promise. This is ignored on windows, as the
permission model uses ACLs.

   </dl>

<div class="node">
<a name="rename-in-files"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#repository-in-files">repository in files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#perms-in-files">perms in files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#files-in-agent-promises">files in agent promises</a>

</div>

<h4 class="subsection">7.4.16 <code>rename</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>disable</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false automatically rename and remove permissions

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body rename example
     {
     disable => "true"; 
     disable_suffix => ".nuked";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Disabling a file means making is impotent in the context in which it
has an effect. For executables this means preventing execution, for an
information file it means making the file unreadable.

     <br><dt>&lsquo;<samp><code>disable_mode</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>[0-7augorwxst,+-]+</code>

     <p class="noindent"><b>Synopsis</b>: The permissions to set when a file is disabled

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body rename example
     {
     disable_mode => "0600"; 
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>To disable an executable it is not enough to rename it, you should also remove the
executable flag.

     <br><dt>&lsquo;<samp><code>disable_suffix</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: The suffix to add to files when disabling (.cfdisabled)

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body rename example
     {
     disable => "true"; 
     disable_suffix => ".nuked";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>To make disabled files in a particular manner, use this string suffix. 
The default value is <samp><span class="file">.cf-disabled</span></samp>.

     <br><dt>&lsquo;<samp><code>newname</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: The desired name for the current file

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body rename example(s)
     {
     newname => "$(s)";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <br><dt>&lsquo;<samp><code>rotate</code></samp>&rsquo;<dd><b>Type</b>: int

     <p class="noindent"><b>Allowed input range</b>: <code>0,99</code>

     <p class="noindent"><b>Synopsis</b>: Maximum number of file rotations to keep

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body rename example
     {
     rotate => "4";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Used for log rotation. If the file is named <samp><span class="file">foo</span></samp> and the &lsquo;<samp><span class="samp">rotate</span></samp>&rsquo;
attribute is set to &lsquo;<samp><span class="samp">4</span></samp>&rsquo;, as above, then initially <samp><span class="file">foo</span></samp> is copied
to <samp><span class="file">foo.1</span></samp> and the old file <samp><span class="file">foo</span></samp> is zeroed out (that is, the inode
of the original logfile does not change, but the original logfile will be
empty after the rotation is complete).

     <p>The next time the promise is executed, <samp><span class="file">foo.1</span></samp> will be renamed
<samp><span class="file">foo.2</span></samp>, <samp><span class="file">foo</span></samp> is again copied to <samp><span class="file">foo.1</span></samp> and the old file
<samp><span class="file">foo</span></samp> is again zeroed out.

     <p>Each time the promise is executed (and typically, the promise would be
executed as guarded by time-based or file-size-based classes), the files are
copied/zeroed or rotated as above until there are &lsquo;<samp><span class="samp">rotate</span></samp>&rsquo; numbered files
plus the one "main" file.  In the example above, the file <samp><span class="file">foo.3</span></samp> will be
renamed <samp><span class="file">foo.4</span></samp>, but the old version of the file <samp><span class="file">foo.4</span></samp> will be
deleted (that is, it "falls off the end" of the rotation).

   </dl>

<div class="node">
<a name="repository-in-files"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#touch-in-files">touch in files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#rename-in-files">rename in files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#files-in-agent-promises">files in agent promises</a>

</div>

<h4 class="subsection">7.4.17 <code>repository</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>"?(/.*)</code>

<p class="noindent"><b>Synopsis</b>: Name of a repository for versioning

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
files:

 "/path/file"

   copy_from => source,
   repository => "/var/cfengine/repository";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>A local repository for this object, overrides the default,
See <a href="#default_005frepository-in-agent">default_repository</a>.

   <p>Note that when a repository is specified, the files are stored using the
canonified directory name of the original file, concatenated with the name of
the file.  So, for example, <samp><span class="file">/usr/local/etc/postfix.conf</span></samp> would ordinarily
be stored in an alternative repository as
<samp><span class="file">_usr_local_etc_postfix.conf.cfsaved</span></samp>.

<div class="node">
<a name="touch-in-files"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#transformer-in-files">transformer in files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#repository-in-files">repository in files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#files-in-agent-promises">files in agent promises</a>

</div>

<h4 class="subsection">7.4.18 <code>touch</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Synopsis</b>: true/false whether to touch time stamps on file

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
files:

 "/path/file"

   touch => "true";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

<div class="node">
<a name="transformer-in-files"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#touch-in-files">touch in files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#files-in-agent-promises">files in agent promises</a>

</div>

<h4 class="subsection">7.4.19 <code>transformer</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>"?(/.*)</code>

<p class="noindent"><b>Synopsis</b>: Command (with full path) used to transform current file (no shell wrapper used)

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
files:
  "/home/mark/tmp/testcopy"

    file_select => pdf_files,
    transformer => "/usr/bin/gzip $(this.promiser)",
    depth_search => recurse("inf");

</pre>

<pre class="verbatim">
 classes:
    "do_update" expression => isnewerthan("/etc/postfix/alias",
                                          "/etc/postfix/alias.cdb");

 files:
    "/etc/postfix/alias.cdb"
       create => "true",		# Must have this!
       transformer => "/usr/sbin/postalias /etc/postfix/alias",
       ifvarclass => "do_update";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>A command to execute, usually for the promised file to transform it to
something else (but possibly to create the promised file based on a different
origin file).  The examples above show both types of promises.

   <p>The promiser file must exist in order to effect the transformer.

   <p>In the first example, the promise is made on the file that we wish to
transform.  If the promised file exists, the transformer will change the
file to a compressed version (and the next time CFEngine runs, the promised
file will no longer exist, because it now has the &lsquo;<samp><span class="samp">.gz</span></samp>&rsquo; extension).

   <p>In the second example, the promise is made on the file <i>resulting from</i> the
transformation (and the promise is conditional on the original file being
newer than the result file).  In this case, we <i>must</i> specify  &lsquo;<samp><span class="samp">create
=&gt; true</span></samp>&rsquo;.  If we do not, then if the promised file is removed, the
transformer will not be executed.

   <p>Note also that if you use the <code>$(this.promiser)</code>
variable or other variable in this command, and the file object contains
spaces you should quote the variable, e.g.

<pre class="verbatim">    transformer => "/usr/bin/gzip \"$(this.promiser)\"",
</pre>

   <p>Note also that the transformer does not actually need to change the file. 
You can, for example, simply report on the existence of files with

<pre class="verbatim">    transformer => "/bin/echo I found a file named $(this.promiser)",
</pre>

   <p>The file streams <code>stdout</code> and <code>stderr</code> are redirected by CFEngine, and
will not appear in any output unless you run <code>cf-agent</code> with the
&lsquo;<samp><span class="samp">-v</span></samp>&rsquo; switch (or enable <code>verbose</code> in an <code>outputs</code>
promise).

   <p>It is possible to set classes based on the return code of a
transformer-command in in a very flexible way. See the
<code>kept_returncodes</code>, <code>repaired_returncodes</code> and
<code>failed_returncodes</code> attributes.

   <p>Finally, you should note that the command is not run in a shell - which means
that you cannot perform file redirection or create pipelines.

<div class="node">
<a name="Miscellaneous-in-edit_line-promises"></a>
<a name="Miscellaneous-in-edit_005fline-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#delete_005flines-in-edit_005fline-promises">delete_lines in edit_line promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#files-in-agent-promises">files in agent promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-agent">Bundles for agent</a>

</div>

<h3 class="section">7.5 Miscelleneous in <code>edit_line</code> promises</h3>

<p><br>

   <p>Line based editing is a simple model for editing files. Before XML,
and later JSON, most configuration files were line based. The
line-based editing offers a powerful environment for model-based editing and
templating.

<ul class="menu">
<li><a accesskey="1" href="#select_005fregion-in-_002a">select_region in *</a>
</ul>

<div class="node">
<a name="select_region-in-*"></a>
<a name="select_005fregion-in-_002a"></a>
<p><hr>
Up:&nbsp;<a rel="up" accesskey="u" href="#Miscellaneous-in-edit_005fline-promises">Miscellaneous in edit_line promises</a>

</div>

<h4 class="subsection">7.5.1 <code>select_region</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>include_start_delimiter</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Whether to include the section delimiter

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body select_region MySection(x)
     {
     select_start => "\[$(x)\]";
     select_end => "\[.*\]";
     include_start_delimiter => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>In a sectioned file, the line that marks the opening of a section is not
normally included in the defined region (that is, it is recognized as a
delimiter, but it is not included as one of the lines available for editing). 
Setting this option to true makes it included. e.g. in this example

     <pre class="verbatim">     [My section]
     one
     two
     three
</pre>
     the section does not normally include the line &lsquo;<samp><span class="samp">[My section]</span></samp>&rsquo;. 
By setting <code>include_start_delimiter</code> to &lsquo;<samp><span class="samp">true</span></samp>&rsquo;it would be possible
for example, to delete the entire section, including the section header.  If
however <code>include_start_delimiter</code> is &lsquo;<samp><span class="samp">false</span></samp>&rsquo;, the <i>contents</i> of
the section could be deleted, but the header would be unaffected by any
<code>delete_lines</code> promises.  See the next section on
<code>include_start_delimiter</code> for further details.

     <p><b>History</b>: This attribute was introduced in CFEngine version 3.0.5 (2010)

     <br><dt>&lsquo;<samp><code>include_end_delimiter</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Whether to include the section delimiter

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body select_region BracketSection(x)
     {
     select_start => "$(x) \{";
     select_end => "}";
     include_end_delimiter => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>In a sectioned file, the line that marks the end of a section is not
normally included in the defined region (that is, it is recognized as a
delimiter, but it is not included as one of the lines available for editing). 
Setting this option to true makes it included. e.g. in this example

     <pre class="verbatim">     /var/log/mail.log {
         monthly
         missingok
         notifempty
         rotate 7
         }
</pre>
     the section does not normally include the line containing &lsquo;<samp><span class="samp">}</span></samp>&rsquo;. 
By setting <code>include_end_delimiter</code> to &lsquo;<samp><span class="samp">true</span></samp>&rsquo;it would be possible
for example, to delete the entire section, including the section trailer.  If
however <code>include_end_delimiter</code> is &lsquo;<samp><span class="samp">false</span></samp>&rsquo;, the <i>contents</i> of
the section could be deleted, but the header would be unaffected by any
<code>delete_lines</code> promises.

     <p>The use of <code>include_start_delimiter</code> and <code>include_end_delimiter</code>
depend on the type of sections you are dealing with, and what you want to do
with them.  Note that sections can be bounded at both the start and end (as
in the example above) or just at the start (as in the sample shown in
<code>include_start_delimiter</code>).

     <p><b>History</b>: This attribute was introduced in CFEngine version 3.0.5 (2010)

     <br><dt>&lsquo;<samp><code>select_start</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>.*</code>

     <p class="noindent"><b>Synopsis</b>: Regular expression matching start of edit region

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body select_region example(x)
     
     {
     select_start => "\[$(x)\]";
     select_end => "\[.*\]";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>See also <code>select_end</code>. These delimiters mark out the region
of a file to be edited. In the example, it is assumed that the file
has section markers.

     <pre class="smallexample">          [section 1]
          
          lines.
          lines...
          
          
          [section 2]
          
          lines ....
          etc..
          
</pre>
     <p class="noindent">The start marker includes the first matched line.

     <br><dt>&lsquo;<samp><code>select_end</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>.*</code>

     <p class="noindent"><b>Synopsis</b>: Regular expression matches end of edit region from start

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body select_region example(x)
     
     {
     select_start => "\[$(x)\]";
     select_end => "\[.*\]";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>See also <code>select_start</code>. These delimiters mark out the region
of a file to be edited. In the example, it is assumed that the file
has section markes

     <pre class="smallexample">          [section 1]
          
          lines.
          lines...
          
          
          [section 2]
          
          lines ....
          etc..
          
</pre>
     <p>If you want to match from a starting location to the end of the file (even if
there are other lines matching <code>select_start</code> intervening), then just omit
the <code>select_end</code> promise and the selected region will run to the end of
the file.

   </dl>

<div class="node">
<a name="delete_lines-in-edit_line-promises"></a>
<a name="delete_005flines-in-edit_005fline-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#insert_005flines-in-edit_005fline-promises">insert_lines in edit_line promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Miscellaneous-in-edit_005fline-promises">Miscellaneous in edit_line promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-agent">Bundles for agent</a>

</div>

<h3 class="section">7.6 <code>delete_lines</code> promises in &lsquo;<samp><span class="samp">edit_line</span></samp>&rsquo;</h3>

<p><br>

   <p>This promise assures that certain lines matching regular expression
patterns exactly will not be present in a text file. If the lines are
found, the default promise is to remove them (this behavior may be modified
with further pattern matching in <code>delete_select</code> and/or changed with
<code>not_matching</code>).

   <p><br>

<pre class="verbatim">
bundle edit_line example
  {
  delete_lines:

    "olduser:.*";

  }

</pre>

   <p>Note that typically, only a single line is specified in each <code>delete_lines</code>
promise (you may of course have multiple promises that each delete a line).

   <p>It is also possible to specify multi-line <code>delete_lines</code> promises. 
However, these promises will only delete those lines if <i>all</i> the lines are
present in the file <i>in exactly the same order</i> as specified in the promise
(with no intervening lines).  That is, all the lines must match as a unit for
the <code>delete_lines</code> promise to be kept.

   <p><br>

   <p>If the promiser is contains multiple lines, then CFEngine assumes that
all of the lines must exist as a contiguous block in order to be
deletes. This gives &lsquo;<samp><span class="samp">preserve_block</span></samp>&rsquo; semantics to any multiline
<code>delete_lines</code> promise.

<ul class="menu">
<li><a accesskey="1" href="#delete_005fselect-in-delete_005flines">delete_select in delete_lines</a>
<li><a accesskey="2" href="#not_005fmatching-in-delete_005flines">not_matching in delete_lines</a>
</ul>

<div class="node">
<a name="delete_select-in-delete_lines"></a>
<a name="delete_005fselect-in-delete_005flines"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#not_005fmatching-in-delete_005flines">not_matching in delete_lines</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#delete_005flines-in-edit_005fline-promises">delete_lines in edit_line promises</a>

</div>

<h4 class="subsection">7.6.1 <code>delete_select</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>delete_if_startwith_from_list</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>.*</code>

     <p class="noindent"><b>Synopsis</b>: Delete line if it starts with a string in the list

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body delete_select example(s)
     {
     delete_if_startwith_from_list => { @(s) };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Delete lines from a file if they begin with the sub-strings listed. 
Note that this determination is made only on promised lines (that is, this
attribute modifies the selection criteria, it does not make the initial
selection).  Therefore, if the file contains the following lines:

     <pre class="verbatim">     start alpha igniter
     start beta igniter
     init alpha burner
     init beta burner
     stop beta igniter
     stop alpha igniter
     stop alpha burner
</pre>

     <p>Then the following promise initially selects the four lines containing
&lsquo;<samp><span class="samp">alpha</span></samp>&rsquo;, but is moderated by the <code>delete_select</code> attribute.  Thus,
the promise will delete only the first and third lines of the file:

     <pre class="verbatim">     bundle edit_line alpha
     {
     delete_lines:
         ".*alpha.*"
     	delete_select => starters;
     }
     
     body delete_select starters
     {
         delete_if_startwith_from_list => { "begin", "start", "init" };
     }
</pre>

     <br><dt>&lsquo;<samp><code>delete_if_not_startwith_from_list</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>.*</code>

     <p class="noindent"><b>Synopsis</b>: Delete line if it DOES NOT start with a string in the list

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body delete_select example(s)
     {
     delete_if_not_startwith_from_list => { @(s) };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Delete lines from a file unless they start with the sub-strings in the list
given.  Note that this determination is made only on promised lines (that is,
this attribute modifies the selection criteria, it does not make the initial
selection).

     <br><dt>&lsquo;<samp><code>delete_if_match_from_list</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>.*</code>

     <p class="noindent"><b>Synopsis</b>: Delete line if it fully matches a regex in the list

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body delete_select example(s)
     {
     delete_if_match_from_list => { @(s) };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Delete lines from a file if the lines <i>completely</i> match any of
the regular expressions listed (that is, the regular expression
is anchored, see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>).

     <p>Note that the &ldquo;match&rdquo; determination is made only on promised lines (that is, this
attribute modifies the selection criteria, it does not make the initial
selection).

     <br><dt>&lsquo;<samp><code>delete_if_not_match_from_list</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>.*</code>

     <p class="noindent"><b>Synopsis</b>: Delete line if it DOES NOT fully match a regex in the list

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body delete_select example(s)
     {
     delete_if_not_match_from_list => { @(s) };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Delete lines from a file unless the lines <i>completely</i> match any of
the regular expressions listed (that is, the regular expressions
are anchored, see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>).

     <p>Note that the &ldquo;match&rdquo; determination is made only on promised lines (that is, this
attribute modifies the selection criteria, it does not make the initial
selection).

     <br><dt>&lsquo;<samp><code>delete_if_contains_from_list</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>.*</code>

     <p class="noindent"><b>Synopsis</b>: Delete line if a regex in the list match a line fragment

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body delete_select example(s)
     {
     delete_if_contains_from_list => { @(s) };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Delete lines from a file if they contain the sub-strings listed. 
Note that this determination is made only on promised lines (that is, this
attribute modifies the selection criteria, it does not make the initial
selection).

     <br><dt>&lsquo;<samp><code>delete_if_not_contains_from_list</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>.*</code>

     <p class="noindent"><b>Synopsis</b>: Delete line if a regex in the list DOES NOT match a line fragment

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body delete_select discard(s)
     {
     delete_if_not_contains_from_list => { "substring1", "substring2" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Delete lines from the file which do not contain the sub-strings listed. 
Note that this determination is made only on promised lines (that is, this
attribute modifies the selection criteria, it does not make the initial
selection).

   </dl>

<div class="node">
<a name="not_matching-in-delete_lines"></a>
<a name="not_005fmatching-in-delete_005flines"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#delete_005fselect-in-delete_005flines">delete_select in delete_lines</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#delete_005flines-in-edit_005fline-promises">delete_lines in edit_line promises</a>

</div>

<h4 class="subsection">7.6.2 <code>not_matching</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false negate match criterion

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">delete_lines:

  # edit /etc/passwd - account names that are not "mark" or "root"

  "(mark|root):.*" not_matching => "true";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>When this option is true, it negates the pattern match of the promised lines
(for convenience).  <b>NOTE</b> that this does not negate any condition expressed
in <code>delete_select</code> - it only negates the match of the initially promised
lines.

   <p>Note, this makes no sense for multi-line deletions and is therefore
disallowed.  Either a multi-line promiser matches and it should be
removed (i.e. <code>not_matching</code> is false) or it doesn't match the
whole thing and the ordered lines have no meaning anymore as an
entity. In this case, the lines can be separately stated.

<div class="node">
<a name="insert_lines-in-edit_line-promises"></a>
<a name="insert_005flines-in-edit_005fline-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#field_005fedits-in-edit_005fline-promises">field_edits in edit_line promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#delete_005flines-in-edit_005fline-promises">delete_lines in edit_line promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-agent">Bundles for agent</a>

</div>

<h3 class="section">7.7 <code>insert_lines</code> promises in &lsquo;<samp><span class="samp">edit_line</span></samp>&rsquo;</h3>

<p><br>

   <p>This promise is part of the line-editing model. It inserts lines into
the file at a specified location. The location is determined by
body-attributes.  The promise object referred to can be a literal line
of a file-reference from which to read lines.

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
      insert_lines:
     
        "<var>literal line or file reference</var>"
     
           location =&gt; <var>location_body</var>,
           ...;
     
</pre>
   </td></tr></table>

   <p><br>

<pre class="verbatim">
body common control

{
any::

  bundlesequence  => {
                     example
                     };   
}

#######################################################

bundle agent example

{
files:

  "/var/spool/cron/crontabs/root"

     edit_line => addline;
}

#######################################################
# For the library
#######################################################

bundle edit_line addline

{
insert_lines:

 "0,5,10,15,20,25,30,35,40,45,50,55 * * * * /var/cfengine/bin/cf-execd -F";

}

</pre>

   <p><br>

   <p>By parameterizing the editing bundle, one can make generic and reusable editing bundles.

   <p>Note, when inserting multiple lines anchored to a particular place in
a file, be careful with your intuition.  If your intention is to
insert a set of lines in a given order after a marker, then the
following is incorrect:

<pre class="verbatim">
bundle edit_line x
{
insert_lines:

  "line one" location => myloc;
  "line two" location => myloc;
}

body location myloc

{
select_line_matching => "# Right here.*";
before_after => "after";
}

</pre>
This will reverse the order of the lines and will not converge, since
the anchoring after the marker applies independently for each new
line. This is not a bug, but an error of logic.

   <p>What was probably intended was to add multiple ordered lines after the marker,
which should be a single correlated promise.

<pre class="verbatim">
bundle edit_line x
{
insert_lines:
 
 "line one$(const.n)line two" location => myloc;

}

</pre>
Or:
<pre class="verbatim">
bundle edit_line x
{
insert_lines:
 
  "line one
line two" location => myloc;

}

</pre>

<ul class="menu">
<li><a accesskey="1" href="#expand_005fscalars-in-insert_005flines">expand_scalars in insert_lines</a>
<li><a accesskey="2" href="#insert_005ftype-in-insert_005flines">insert_type in insert_lines</a>
<li><a accesskey="3" href="#insert_005fselect-in-insert_005flines">insert_select in insert_lines</a>
<li><a accesskey="4" href="#location-in-insert_005flines">location in insert_lines</a>
<li><a accesskey="5" href="#whitespace_005fpolicy-in-insert_005flines">whitespace_policy in insert_lines</a>
</ul>

<div class="node">
<a name="expand_scalars-in-insert_lines"></a>
<a name="expand_005fscalars-in-insert_005flines"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#insert_005ftype-in-insert_005flines">insert_type in insert_lines</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#insert_005flines-in-edit_005fline-promises">insert_lines in edit_line promises</a>

</div>

<h4 class="subsection">7.7.1 <code>expand_scalars</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: Expand any unexpanded variables

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control

{
bundlesequence  => { "testbundle"  };
}

########################################################

bundle agent testbundle

{
files:

  "/home/mark/tmp/file_based_on_template"

       create    => "true",
       edit_line => ExpandMeFrom("/tmp/source_template");


}

########################################################

bundle edit_line ExpandMeFrom(template)
{
insert_lines:

   "$(template)"

          insert_type => "file",
       expand_scalars => "true";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>A way of incorporating templates with variable expansion into file
operations. Variables should be named and scoped appropriately for the
bundle in which this promise is made. i.e. you should qualify the variables
with the bundle in which they are defined:

<pre class="verbatim">$(bundle.variable)
$(sys.host)
$(mon.www_in)
</pre>

   <p>In CFEngine 2 <code>editfiles</code> this was called &lsquo;<samp><span class="samp">ExpandVariables</span></samp>&rsquo;.

<div class="node">
<a name="insert_type-in-insert_lines"></a>
<a name="insert_005ftype-in-insert_005flines"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#insert_005fselect-in-insert_005flines">insert_select in insert_lines</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#expand_005fscalars-in-insert_005flines">expand_scalars in insert_lines</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#insert_005flines-in-edit_005fline-promises">insert_lines in edit_line promises</a>

</div>

<h4 class="subsection">7.7.2 <code>insert_type</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>literal</code>
               <code>string</code>
               <code>file</code>
               <code>file_preserve_block</code>
               <code>preserve_block</code>
</pre>
   <p class="noindent"><b>Default value:</b> literal

<p class="noindent"><b>Synopsis</b>: Type of object the promiser string refers to

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">bundle edit_line lynryd_skynyrd
{
 vars:
    "keepers" slist => { "Won't you give me", "Gimme three steps" };

 insert_lines:

     "And you'll never see me no more"
       insert_type => "literal";	# the default

     "/song/lyrics"
       insert_type => "file",		# read selected lines from /song/lyrics
       insert_select => keep("@{keepers}");
}

body insert_select keep(s)
{
insert_if_startwith_from_list => { "@(s)" };
}

</pre>

   <p>This will ensure that the following lines are inserted into the promised file:

<pre class="verbatim">And you'll never see me no more
Gimme three steps, Mister
Gimme three steps towards the door
Gimme three steps
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The default is to treat the promiser as a literal string of convergent
lines (the values <code>literal</code> and <code>string</code> are synonymonous).

   <p>The default behaviour assumes that multi-line entries are not ordered
specifically, and should be treated as a collection of lines of text
and not as a single unbroken object.

   <p>If the option &lsquo;<samp><span class="samp">preserve_block</span></samp>&rsquo; is used, then CFEngine will not
break up multiple lines into individual, non-ordered objects, so that
the block of text will be preserved. Even if some of the lines in the block
already exist, they will be added again as a coherent block. Thus if
you suspect that some stray / conflicting lines might be present they
should be cleaned up with <code>delete_lines</code> first.

   <p>The value <code>file</code> is used to tell CFEngine that the string is
non-literal and should be interpreted as a filename from which to
import lines, see <a href="#insert_005fselect-in-insert_005flines">insert_select</a>. Inserted files assume non-&lsquo;<samp><span class="samp">preserve_block</span></samp>&rsquo;
semantics. An equivalent files setting that does preserve the
ordering of lines in the file is called <code>file_preserve_block</code>. This
was added in CFEngine Core 3.5.x.

<div class="node">
<a name="insert_select-in-insert_lines"></a>
<a name="insert_005fselect-in-insert_005flines"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#location-in-insert_005flines">location in insert_lines</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#insert_005ftype-in-insert_005flines">insert_type in insert_lines</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#insert_005flines-in-edit_005fline-promises">insert_lines in edit_line promises</a>

</div>

<h4 class="subsection">7.7.3 <code>insert_select</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>insert_if_startwith_from_list</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>.*</code>

     <p class="noindent"><b>Synopsis</b>: Insert line if it starts with a string in the list

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body insert_select example
     {
     insert_if_startwith_from_list => { "find_me_1", "find_me_2" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>
The list contains literal strings to search for in the secondary
file (the file being read via the <code>insert_type</code> attribute, not
the main file being edited).  If a string with matching starting
characters is found, then that line from the secondary file will
be inserted at the present location in the primary file.

     <p><code>insert_if_startswith_from_list</code> is ignored unless <code>insert_type</code> is <code>file</code>
(see <a href="#insert_005ftype-in-insert_005flines">insert_type in insert_lines</a>),
or the promiser is a multi-line block.

     <br><dt>&lsquo;<samp><code>insert_if_not_startwith_from_list</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>.*</code>

     <p class="noindent"><b>Synopsis</b>: Insert line if it DOES NOT start with a string in the list

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body insert_select example
     {
     insert_if_not_startwith_from_list => { "find_me_1", "find_me_2" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The complement of <code>insert_if_startwith_from_list</code>.  If the start of a
line does <i>not</i> match one of the strings, that line is inserted into the
file being edited.

     <p><code>insert_if_not_startswith_from_list</code> is ignored unless <code>insert_type</code> is <code>file</code>
(see <a href="#insert_005ftype-in-insert_005flines">insert_type in insert_lines</a>),
or the promiser is a multi-line block.

     <br><dt>&lsquo;<samp><code>insert_if_match_from_list</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>.*</code>

     <p class="noindent"><b>Synopsis</b>: Insert line if it fully matches a regex in the list

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body insert_select example
     {
     insert_if_match_from_list => { ".*find_.*_1.*", ".*find_.*_2.*" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>
The list contains literal strings to search for in the secondary file
(the file being read via the <code>insert_type</code> attribute, not the
main file being edited).  If the regex matches a <i>complete</i> line of
the file, that line from the secondary file will be inserted at the
present location in the primary file.  That is, the regex's in the
list are anchored, see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>).

     <p><code>insert_if_match_from_list</code> is ignored unless <code>insert_type</code>
is <code>file</code>, see <a href="#insert_005ftype-in-insert_005flines">insert_type in insert_lines</a>), or the promiser
is a multi-line block.

     <br><dt>&lsquo;<samp><code>insert_if_not_match_from_list</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>.*</code>

     <p class="noindent"><b>Synopsis</b>: Insert line if it DOES NOT fully match a regex in the list

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body insert_select example
     {
     insert_if_not_match_from_list => { ".*find_.*_1.*", ".*find_.*_2.*" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The complement of <code>insert_if_match_from_list</code>.  If the line does <i>not</i>
match a line in the secondary file, it is inserted into the file being edited.

     <p><code>insert_if_not_match_from_list</code> is ignored unless <code>insert_type</code> is <code>file</code>
(see <a href="#insert_005ftype-in-insert_005flines">insert_type in insert_lines</a>),
or the promiser is a multi-line block.

     <br><dt>&lsquo;<samp><code>insert_if_contains_from_list</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>.*</code>

     <p class="noindent"><b>Synopsis</b>: Insert line if a regex in the list match a line fragment

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body insert_select example
     {
     insert_if_contains_from_list => { "find_me_1", "find_me_2" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The list contains literal strings to search for in the secondary file (the file
being read via the <code>insert_type</code> attribute, not the main file being edited). 
If the string is found in a line of the file, that line from the secondary
file will be inserted at the present location in the primary file.

     <p><code>insert_if_contains_from_list</code> is ignored unless <code>insert_type</code> is <code>file</code>
(see <a href="#insert_005ftype-in-insert_005flines">insert_type in insert_lines</a>),
or the promiser is a multi-line block.

     <br><dt>&lsquo;<samp><code>insert_if_not_contains_from_list</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: <code>.*</code>

     <p class="noindent"><b>Synopsis</b>: Insert line if a regex in the list DOES NOT match a line fragment

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body insert_select example
     {
     insert_if_not_contains_from_list => { "find_me_1", "find_me_2" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The complement of <code>insert_if_contains_from_list</code>.  If the line is <i>not</i>
found in the secondary file, it is inserted into the file being edited.

     <p><code>insert_if_not_contains_from_list</code> is ignored unless <code>insert_type</code> is <code>file</code>
(see <a href="#insert_005ftype-in-insert_005flines">insert_type in insert_lines</a>),
or the promiser is a multi-line block.

   </dl>

<div class="node">
<a name="location-in-insert_lines"></a>
<a name="location-in-insert_005flines"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#whitespace_005fpolicy-in-insert_005flines">whitespace_policy in insert_lines</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#insert_005fselect-in-insert_005flines">insert_select in insert_lines</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#insert_005flines-in-edit_005fline-promises">insert_lines in edit_line promises</a>

</div>

<h4 class="subsection">7.7.4 <code>location</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>before_after</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>before</code>
                    <code>after</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Menu option, point cursor before of after matched line

     <p class="noindent"><b>Default value:</b> after

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body location append
     
     {
     #...
     before_after => "before";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Determines whether an edit will occur before or after the currently
matched line.

     <br><dt>&lsquo;<samp><code>first_last</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>first</code>
                    <code>last</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Menu option, choose first or last occurrence of match in file

     <p class="noindent"><b>Default value:</b> last

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body location example
     {
     first_last => "last";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>In multiple matches, decide whether the first or last occurrence of
the matching pattern in the case affected by the change. In principle
this could be generalized to more cases but this seems like a fragile
quality to evaluate, and only these two cases are deemed of
reproducible significance.

     <br><dt>&lsquo;<samp><code>select_line_matching</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>.*</code>

     <p class="noindent"><b>Synopsis</b>: Regular expression for matching file line location

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     # Editing
     
     body location example
     {
     select_line_matching => "Expression match.* whole line";
     }
     
     # Measurement promises
     
     body match_value example
     {
     select_line_matching => "Expression match.* whole line";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The expression must match a whole line, not a fragment within a line
(that is, it is anchored, see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>).

     <p>This attribute is mutually exclusive of <code>select_line_number</code>.

   </dl>

<div class="node">
<a name="whitespace_policy-in-insert_lines"></a>
<a name="whitespace_005fpolicy-in-insert_005flines"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#location-in-insert_005flines">location in insert_lines</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#insert_005flines-in-edit_005fline-promises">insert_lines in edit_line promises</a>

</div>

<h4 class="subsection">7.7.5 <code>whitespace_policy</code></h4>

<p class="noindent"><b>Type</b>: (option list)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>ignore_leading</code>
               <code>ignore_trailing</code>
               <code>ignore_embedded</code>
               <code>exact_match</code>
</pre>
   <p class="noindent"><b>Synopsis</b>: Criteria for matching and recognizing existing lines

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">bundle edit_line Insert(service, filename)
{
insert_lines:

  "$(service).* $(filename)"

      whitespace_policy => { "ignore_trailing", "ignore_embedded" };

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The white space matching policy applies only to <code>insert_lines</code>,
as a convenience. It works by rewriting the insert string as a regular
expression when <i>matching</i> lines (that is, when determining if the line is
already in the file), but leaving the string as specified when
actually inserting it.

   <p>Simply put, the `does this line exist' test will be changed to a
regexp match.  The line being tested will optionally have "\s*"
prepended or appended if <code>ignore_leading</code> or
<code>ignore_trailing</code> is specified, and if <code>ignore_imbedded</code> is
used then all embedded whitespaces are replaced with &lsquo;<samp><span class="samp">\s+</span></samp>&rsquo;.  You may
specify more than one <code>whitespace_policy</code> &ndash; they are additive.

   <p>Any regular
expression meta-characters that exist in your input line will be escaped, so
that you can still, for example,  safely insert a line like
&lsquo;<samp><span class="samp">"authpriv.* /var/log/something"</span></samp>&rsquo; into your syslog config file.

   <p><b>History</b>: This attribute was introduced in CFEngine version 3.0.5 (2010)

<p class="noindent"><b>Default value</b>:<br>

   <p><code>exact_match</code> (so unless you use this new attribute, your
<code>insert_line</code> promises should behave as before.

<div class="node">
<a name="field_edits-in-edit_line-promises"></a>
<a name="field_005fedits-in-edit_005fline-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#replace_005fpatterns-in-edit_005fline-promises">replace_patterns in edit_line promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#insert_005flines-in-edit_005fline-promises">insert_lines in edit_line promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-agent">Bundles for agent</a>

</div>

<h3 class="section">7.8 <code>field_edits</code> promises in &lsquo;<samp><span class="samp">edit_line</span></samp>&rsquo;</h3>

<p><br>

   <p>Certain types of text file (e.g. the <samp><span class="file">passwd</span></samp> and <samp><span class="file">group</span></samp>
files in Unix) are tabular in nature, with field separators
(e.g. &lsquo;<samp><span class="samp">:</span></samp>&rsquo; or &lsquo;<samp><span class="samp">,</span></samp>&rsquo;). This promise assumes a parameterizable model
for editing the fields of such files, using a regular expression to
separate major fields and a character to separate sub-fields. First
you match the line with a regular expression.  The regular
expression must match the entire line (that is, it is anchored,
see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>).  Then a
<code>field_edits</code> body describes the separators for fields and one
level of sub-fields, along with policies for editing these fields, ordering
the items within them etc.

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
     field_edits:
     
         "<var>regex matching line</var>"
     
                   edit_field =&gt; <var>body</var>;
     
</pre>
   </td></tr></table>

   <p><br>

<pre class="verbatim">
bundle agent example

{
vars:

 "userset" slist => { "one-x", "two-x", "three-x" };

files:

  "/tmp/passwd"

       create    => "true",
       edit_line => SetUserParam("mark","6","/set/this/shell");

  "/tmp/group"

       create    => "true",
       edit_line => AppendUserParam("root","4","@(userset)");
}

########################################################

bundle edit_line SetUserParam(user,field,val)
  {
  field_edits:

   "$(user):.*"

      # Set field of the file to parameter

      edit_field => col(":","$(field)","$(val)","set");
  }

########################################################

bundle edit_line AppendUserParam(user,field,allusers)
  {
  vars:

    "val" slist => { @(allusers) };

  field_edits:

   "$(user):.*"

      # Set field of the file to parameter

      edit_field => col(":","$(field)","$(val)","alphanum");

  }

########################################
# Bodies
########################################

body edit_field col(split,col,newval,method)

{
field_separator => "$(split)";
select_field    => "$(col)";
value_separator  => ",";
field_value     => "$(newval)";
field_operation => "$(method)";
extend_fields => "true";
}

</pre>

   <p><br>

   <p>Field editing allows us to edit tabular files in a unique way, adding
and removing data from addressable fields. The <samp><span class="file">passwd</span></samp> and
<samp><span class="file">group</span></samp> files are classic examples of tabular files, but there
are many ways to use this feature, e.g. edit a string

<pre class="verbatim">
VARIABLE="one two three"

</pre>

<p class="noindent">View this line as a tabular line separated by &lsquo;<samp><span class="samp">"</span></samp>&rsquo; and
with sub-separator given by the space.

<ul class="menu">
<li><a accesskey="1" href="#edit_005ffield-in-field_005fedits">edit_field in field_edits</a>
</ul>

<div class="node">
<a name="edit_field-in-field_edits"></a>
<a name="edit_005ffield-in-field_005fedits"></a>
<p><hr>
Up:&nbsp;<a rel="up" accesskey="u" href="#field_005fedits-in-edit_005fline-promises">field_edits in edit_line promises</a>

</div>

<h4 class="subsection">7.8.1 <code>edit_field</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>allow_blank_fields</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false allow blank fields in a line (do not purge)

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body edit_field example
     {
     # ...
     allow_blank_fields => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>When editing a file using the field or column model, blank fields, especially
at the start and end are generally discarded. If this is set to true, CFEngine
will retain the blank fields and print the appropriate number of field separators.

     <br><dt>&lsquo;<samp><code>extend_fields</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false add new fields at end of line if necessary to complete edit

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body edit_field example
     {
     extend_fields => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>If a user specifies a field that does not exist, because there are not
so many fields, this allows the number of fields to be extended. 
Without this setting, CFEngine will issue an error if a non-existent field
is referenced. 
Blank fields in a tabular file can be eliminated or kept depending
in this setting. If in doubt, set this to true.

     <br><dt>&lsquo;<samp><code>field_operation</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>prepend</code>
                    <code>append</code>
                    <code>alphanum</code>
                    <code>delete</code>
                    <code>set</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Menu option policy for editing subfields

     <p class="noindent"><b>Default value:</b> none

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body edit_field example
     {
     field_operation => "append";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The method by which to edit a field in multi-field/column editing
of tabular files.  The methods mean:

     <p>&lsquo;<samp><span class="samp">append</span></samp>&rsquo; - append the specified value to the end of the field/column, separating
    (potentially) multiple values with &lsquo;<samp><span class="samp">value_separator</span></samp>&rsquo;

     <p>&lsquo;<samp><span class="samp">prepend</span></samp>&rsquo; - prepend the specified value at the beginning of the field/column,
    separating (potentially) multiple values with &lsquo;<samp><span class="samp">value_separator</span></samp>&rsquo;

     <p>&lsquo;<samp><span class="samp">alphanum</span></samp>&rsquo; - insert the specified value into the field/column, keeping all the
    values (separated by &lsquo;<samp><span class="samp">value_separator</span></samp>&rsquo;) in alphanumerically sorted order)

     <p>&lsquo;<samp><span class="samp">set</span></samp>&rsquo; - replace the entire field/column with the specified value

     <p>&lsquo;<samp><span class="samp">delete</span></samp>&rsquo; - delete the specified value (if present) in the specified field/column

     <p class="noindent"><b>Default value</b>:<br>

     <p>append

     <br><dt>&lsquo;<samp><code>field_separator</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>.*</code>

     <p class="noindent"><b>Synopsis</b>: The regular expression used to separate fields in a line

     <p class="noindent"><b>Default value:</b> none

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body edit_field example
     {
     field_separator => ":";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Most tabular files are separated by simple characters, but by allowing
a general regular expression one can make creative use of this model to
edit all kinds of line-based text files.

     <br><dt>&lsquo;<samp><code>field_value</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>.*</code>

     <p class="noindent"><b>Synopsis</b>: Set field value to a fixed value

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body edit_field example(s)
     {
     field_value => "$(s)";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Set a field to a constant value, e.g. reset the value to a constant
default, empty the field, or set it fixed list.

     <br><dt>&lsquo;<samp><code>select_field</code></samp>&rsquo;<dd><b>Type</b>: int

     <p class="noindent"><b>Allowed input range</b>: <code>0,99999999</code>

     <p class="noindent"><b>Synopsis</b>: Integer index of the field required 0..n (default starts from 1)

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body field_edits example
     {
     select_field => "5";
     }
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Numbering starts from 1 (not from 0).

     <br><dt>&lsquo;<samp><code>start_fields_from_zero</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: If set, the default field numbering starts from 0

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body edit_field col(split,col,newval,method)
     
     {
     field_separator    => "$(split)";
     select_field       => "$(col)";
     value_separator    => ",";
     field_value        => "$(newval)";
     field_operation    => "$(method)";
     extend_fields      => "true";
     allow_blank_fields => "true";
     start_fields_from_zero => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p><i>History</i>: Was introduced in version 3.1.0b1,Nova 2.0.0b1 (2010)

     <p>The numbering of fields is a matter for consistency and convention. 
Arrays are usually thought to start with first index equal to zero (0),
but the first column in a file would normally be 1. By setting this option,
you can tell CFEngine that the first column should be understood as number 0
instead, for consistency with other array functions.

     <br><dt>&lsquo;<samp><code>value_separator</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>^.$</code>

     <p class="noindent"><b>Synopsis</b>: Character separator for subfields inside the selected field

     <p class="noindent"><b>Default value:</b> none

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body field_edit example
     {
     value_separator => ",";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>For example, elements in the group file are separated by &lsquo;<samp><span class="samp">:</span></samp>&rsquo;,
but the lists of users in these fields are separated by &lsquo;<samp><span class="samp">,</span></samp>&rsquo;.

   </dl>

<div class="node">
<a name="replace_patterns-in-edit_line-promises"></a>
<a name="replace_005fpatterns-in-edit_005fline-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Miscellaneous-in-edit_005fxml-promises">Miscellaneous in edit_xml promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#field_005fedits-in-edit_005fline-promises">field_edits in edit_line promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-agent">Bundles for agent</a>

</div>

<h3 class="section">7.9 <code>replace_patterns</code> promises in &lsquo;<samp><span class="samp">edit_line</span></samp>&rsquo;</h3>

<p><br>

   <p>This promise refers to arbitrary text patterns in a file.  The pattern
is expressed as a PCRE regular expression.

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
       replace_patterns:
     
        "<var>search pattern</var>"
     
           replace_with =&gt; <var>replace_body</var>,
           ...;
     
</pre>
   </td></tr></table>

   <p><br>

<pre class="verbatim">
bundle edit_line upgrade_cfexecd
{
  replace_patterns:

    "cfexecd" replace_with => value("cf-execd");
}

########################################

body replace_with value(x)	# defined in cfengine_stdlib.cf
{
replace_value => "$(x)";
occurrences => "all";
}

</pre>

   <p><br>

   <p>This is a straightforward search and replace function. 
Only the portion of the line that matches the pattern in the promise will be
replaced - the remainder of the line will not be affected.  You can also use
PCRE lookbehind and lookahead patterns to restrict the lines upon which the
pattern will match.

   <p><b>NOTE:</b> In <code>replace_patterns</code> promises, the regular expression may
match a line fragment, that is, it is unanchored,
See <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>.

<ul class="menu">
<li><a accesskey="1" href="#replace_005fwith-in-replace_005fpatterns">replace_with in replace_patterns</a>
</ul>

<div class="node">
<a name="replace_with-in-replace_patterns"></a>
<a name="replace_005fwith-in-replace_005fpatterns"></a>
<p><hr>
Up:&nbsp;<a rel="up" accesskey="u" href="#replace_005fpatterns-in-edit_005fline-promises">replace_patterns in edit_line promises</a>

</div>

<h4 class="subsection">7.9.1 <code>replace_with</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>occurrences</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>all</code>
                    <code>first</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Menu option to replace all occurrences or just first (NB the latter is non-convergent)

     <p class="noindent"><b>Default value:</b> all

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body replace_with example
     {
     occurrences => "first";		# Warning! Using "first" is non-convergent
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>A policy for string replacement.

     <p class="noindent"><b>Default value</b>:<br>
The default value is "all".  Using "first" is generally unwise, as it is
possibly non-convergent (it will change a different matching string each time
the promise is executed, and may not "catch up" with whatever external action
is altering the text the promise applies to).

     <br><dt>&lsquo;<samp><code>replace_value</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>.*</code>

     <p class="noindent"><b>Synopsis</b>: Value used to replace regular expression matches in search

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body replace_with example(s)
     {
     replace_value => "$(s)";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

   </dl>

<div class="node">
<a name="Miscellaneous-in-edit_xml-promises"></a>
<a name="Miscellaneous-in-edit_005fxml-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#build_005fxpath-in-edit_005fxml-promises">build_xpath in edit_xml promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#replace_005fpatterns-in-edit_005fline-promises">replace_patterns in edit_line promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-agent">Bundles for agent</a>

</div>

<h3 class="section">7.10 Miscelleneous in <code>edit_xml</code> promises</h3>

<p><br>

   <p>The use of XML documents in systems configuration is widespread. XML documents
represent data that is complex and can be structured in various ways. The XML
based editing offers a powerful environment for editing hierarchical and
structured XML datasets.

<ul class="menu">
<li><a accesskey="1" href="#build_005fxpath-in-_002a">build_xpath in *</a>
<li><a accesskey="2" href="#select_005fxpath-in-_002a">select_xpath in *</a>
</ul>

<div class="node">
<a name="build_xpath-in-*"></a>
<a name="build_005fxpath-in-_002a"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#select_005fxpath-in-_002a">select_xpath in *</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Miscellaneous-in-edit_005fxml-promises">Miscellaneous in edit_xml promises</a>

</div>

<h4 class="subsection">7.10.1 <code>build_xpath</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Build an XPath within the XML file

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body build_xpath example(s)
  {
  build_xpath => "$(s)";
  }

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Please note that when <code>build_xpath</code> is defined as an attribute, within
an <code>edit_xml</code> promise body, the tree described by the specified XPath will
be verified and built BEFORE other <code>edit_xml</code> promises within same promise
body. Therefore, the file will not be empty during the execution of such promises.

<div class="node">
<a name="select_xpath-in-*"></a>
<a name="select_005fxpath-in-_002a"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#build_005fxpath-in-_002a">build_xpath in *</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Miscellaneous-in-edit_005fxml-promises">Miscellaneous in edit_xml promises</a>

</div>

<h4 class="subsection">7.10.2 <code>select_xpath</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Select the XPath node in the XML file to edit

<p class="noindent"><b>Example</b>:<br>
<br>
<pre class="verbatim">body select_xpath example(s)
{
select_xpath => "$(s)";
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>
Edits to the XML document take place within the selected node. 
Please note that this attribute is not used when inserting XML
content into an empty file.

<div class="node">
<a name="build_xpath-in-edit_xml-promises"></a>
<a name="build_005fxpath-in-edit_005fxml-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#delete_005ftree-in-edit_005fxml-promises">delete_tree in edit_xml promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Miscellaneous-in-edit_005fxml-promises">Miscellaneous in edit_xml promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-agent">Bundles for agent</a>

</div>

<h3 class="section">7.11 <code>build_xpath</code> promises in &lsquo;<samp><span class="samp">edit_xml</span></samp>&rsquo;</h3>

<p><br>

   <p>This promise is part of the XML-editing model. It assures that a
balanced XML tree, described by the given XPath, will be present
within the XML file. If the document is empty, the default promise is to
build the XML tree within the document. If the document is not empty, the
default promise is to verify the given XPath, and if necessary, locate an
insertion node and build the necessary portion of xlm tree within
selected node. The insertion node is selected as the last unique node
that is described by the XPath and also found within the document. The
promise object referred to is a literal string representation of an XPath.

   <p><br>

<pre class="verbatim">
bundle edit_xml example
  {
  build_xpath:
    "/Server/Service/Engine/Host[ @name=\"cfe_host\" | Alias = cfe_alias ]";
  }

</pre>

   <p><br>

   <p>Note that typically, only a single XPath is built in each <code>build_xpath</code>
promise (you may of course have multiple promises that each build an XPath). 
Also, please note that the supported syntax used in building an XPath is
currently limited to a simple and compact format, as shown in the above
example. The XPath must begin with '/', as it is verified and built using
an absolute path, from the root node of the document.

<div class="node">
<a name="delete_tree-in-edit_xml-promises"></a>
<a name="delete_005ftree-in-edit_005fxml-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#insert_005ftree-in-edit_005fxml-promises">insert_tree in edit_xml promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#build_005fxpath-in-edit_005fxml-promises">build_xpath in edit_xml promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-agent">Bundles for agent</a>

</div>

<h3 class="section">7.12 <code>delete_tree</code> promises in &lsquo;<samp><span class="samp">edit_xml</span></samp>&rsquo;</h3>

<p><br>

   <p>This promise is part of the XML-editing model. It assures that a
balanced XML tree, containing the matching subtree, will not be
present in the specified node within the XML file. If the subtree
is found, the default promise is to remove the containing tree from
within the specified node. The specified node is determined by
body-attributes. The promise object referred to is a literal string
representation of a balanced XML subtree.

   <p><br>

<pre class="verbatim">
bundle edit_xml example
  {
  delete_tree:
    "&lt;Host name=\"cfe_host\">&lt;/Host>"

    select_xpath => "/Server/Service/Engine";
  }

</pre>

   <p><br>

   <p>Note that typically, only a single tree, within a single specified node,
is deleted in each <code>delete_tree</code> promise (you may of course have
multiple promises that each delete a tree).

<div class="node">
<a name="insert_tree-in-edit_xml-promises"></a>
<a name="insert_005ftree-in-edit_005fxml-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#delete_005fattribute-in-edit_005fxml-promises">delete_attribute in edit_xml promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#delete_005ftree-in-edit_005fxml-promises">delete_tree in edit_xml promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-agent">Bundles for agent</a>

</div>

<h3 class="section">7.13 <code>insert_tree</code> promises in &lsquo;<samp><span class="samp">edit_xml</span></samp>&rsquo;</h3>

<p><br>

   <p>This promise is part of the XML-editing model. It assures that a
balanced XML tree, containing the matching subtree, will be present
in the specified node within the XML file. If the subtree is not
found, the default promise is to insert the tree into the specified
node. The specified node is determined by body-attributes. The
promise object referred to is a literal string representation of a
balanced XML tree.

   <p><br>

<pre class="verbatim">
bundle edit_xml example
  {
  insert_tree:
    "&lt;Host name=\"cfe_host\">&lt;Alias>cfe_alias&lt;/Alias>&lt;/Host>"

    select_xpath => "/Server/Service/Engine";
  }

</pre>

   <p><br>

   <p>Note that typically, only a single tree, within a single specified node,
is inserted in each <code>insert_tree</code> promise (you may of course have
multiple promises that each insert a tree).

<div class="node">
<a name="delete_attribute-in-edit_xml-promises"></a>
<a name="delete_005fattribute-in-edit_005fxml-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#set_005fattribute-in-edit_005fxml-promises">set_attribute in edit_xml promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#insert_005ftree-in-edit_005fxml-promises">insert_tree in edit_xml promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-agent">Bundles for agent</a>

</div>

<h3 class="section">7.14 <code>delete_attribute</code> promises in &lsquo;<samp><span class="samp">edit_xml</span></samp>&rsquo;</h3>

<p><br>

   <p>This promise is part of the XML-editing model. It assures that
an attribute, with the given name, will not be present in the
specified node within the XML file. If the attribute is found,
the default promise is to remove the attribute, from within the
specified node. The specified node is determined by
body-attributes. The promise object referred to is a literal
string representation of the name of the attribute to be deleted.

   <p><br>

<pre class="verbatim">
bundle edit_xml example
  {
  delete_attribute:
    "name"

    select_xpath => "/Server/Service/Engine/Host";
  }

</pre>

   <p><br>

   <p>Note that typically, only a single attribute, within a single specified node,
is deleted in each <code>delete_attribute</code> promise (you may of course
have multiple promises that each delete an attribute).

<div class="node">
<a name="set_attribute-in-edit_xml-promises"></a>
<a name="set_005fattribute-in-edit_005fxml-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#delete_005ftext-in-edit_005fxml-promises">delete_text in edit_xml promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#delete_005fattribute-in-edit_005fxml-promises">delete_attribute in edit_xml promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-agent">Bundles for agent</a>

</div>

<h3 class="section">7.15 <code>set_attribute</code> promises in &lsquo;<samp><span class="samp">edit_xml</span></samp>&rsquo;</h3>

<p><br>

   <p>This promise is part of the XML-editing model. It assures that
an attribute, with the given name and value, will be present
in the specified node within the XML file. If the attribute
is not found, the default promise is to insert the attribute,
into the specified node. If the attribute is already present,
the default promise is to insure that the attribute value is
set to the given value. The specified node and attribute value
are each determined by body-attributes. The promise object
referred to is a literal string representation of the name of
the attribute to be set.

   <p><br>

<pre class="verbatim">
bundle edit_xml example
  {
  set_attribute:
    "name"

    attribute_value => "cfe_host",
    select_xpath => "/Server/Service/Engine/Host";
  }

</pre>

   <p><br>

   <p>Note that typically, only a single attribute, within a single selected
node is set in each <code>set_attribute</code> promise (you may of course
have multiple promises that each set an attribute).

<ul class="menu">
<li><a accesskey="1" href="#attribute_005fvalue-in-set_005fattribute">attribute_value in set_attribute</a>
</ul>

<div class="node">
<a name="attribute_value-in-set_attribute"></a>
<a name="attribute_005fvalue-in-set_005fattribute"></a>
<p><hr>
Up:&nbsp;<a rel="up" accesskey="u" href="#set_005fattribute-in-edit_005fxml-promises">set_attribute in edit_xml promises</a>

</div>

<h4 class="subsection">7.15.1 <code>attribute_value</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Value of the attribute to be inserted into the XPath node of the XML file

<p class="noindent"><b>Example</b>:<br>
<br>
<pre class="verbatim">
body attribute_value example(s)
{
attribute_value => "$(s)";
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

<div class="node">
<a name="delete_text-in-edit_xml-promises"></a>
<a name="delete_005ftext-in-edit_005fxml-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#set_005ftext-in-edit_005fxml-promises">set_text in edit_xml promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#set_005fattribute-in-edit_005fxml-promises">set_attribute in edit_xml promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-agent">Bundles for agent</a>

</div>

<h3 class="section">7.16 <code>delete_text</code> promises in &lsquo;<samp><span class="samp">edit_xml</span></samp>&rsquo;</h3>

<p><br>

   <p>This promise is part of the XML-editing model. It assures that a
value string, containing the matching substring, will not be present
in the specified node within the XML file. If the substring is
found, the default promise is to remove the existing value string,
from within the specified node. The specified node is determined
by body-attributes. The promise object referred to is a literal
string of text.

   <p><br>

<pre class="verbatim">
bundle edit_xml example
  {
  delete_text:
    "text content to match, as a substring, of text to be deleted from specified node"

    select_xpath => "/Server/Service/Engine/Host/Alias";
  }

</pre>

   <p><br>

   <p>Note that typically, only a single value string, within a single specified
node, is deleted in each <code>delete_text</code> promise (you may of course
have multiple promises that each delete a value string).

<div class="node">
<a name="set_text-in-edit_xml-promises"></a>
<a name="set_005ftext-in-edit_005fxml-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#insert_005ftext-in-edit_005fxml-promises">insert_text in edit_xml promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#delete_005ftext-in-edit_005fxml-promises">delete_text in edit_xml promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-agent">Bundles for agent</a>

</div>

<h3 class="section">7.17 <code>set_text</code> promises in &lsquo;<samp><span class="samp">edit_xml</span></samp>&rsquo;</h3>

<p><br>

   <p>This promise is part of the XML-editing model. It assures
that a matching value string will be present in the specified
node within the XML file. If the existing value string does
not exactly match, the default promise is to replace the
existing value string, within the specified node. The
specified node is determined by body-attributes. The promise
object referred to is a literal string of text.

   <p><br>

<pre class="verbatim">
bundle edit_xml example
  {
  set_text:
    "text content to replace existing text, including whitespace, within selected node"

    select_xpath => "/Server/Service/Engine/Host/Alias";
  }

</pre>

   <p><br>

   <p>Note that typically, only a single value string, within a single selected
node, is set in each <code>set_text</code> promise (you may of course
have multiple promises that each set a value string).

<div class="node">
<a name="insert_text-in-edit_xml-promises"></a>
<a name="insert_005ftext-in-edit_005fxml-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#interfaces-in-agent-promises">interfaces in agent promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#set_005ftext-in-edit_005fxml-promises">set_text in edit_xml promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-agent">Bundles for agent</a>

</div>

<h3 class="section">7.18 <code>insert_text</code> promises in &lsquo;<samp><span class="samp">edit_xml</span></samp>&rsquo;</h3>

<p><br>

   <p>This promise is part of the XML-editing model. It assures that a
value string, containing the matching substring, will be present
in the specified node within the XML file. If the substring is not
found, the default promise is to append the substring at the end of
the existing value string, within the specified node. The specified
node is determined by body-attributes. The promise object referred
to is a literal string of text.

   <p><br>

<pre class="verbatim">
bundle edit_xml example
  {
  insert_text:
    "text content to be appended to existing text, including whitespace, within specified node"

    select_xpath => "/Server/Service/Engine/Host/Alias";
  }

</pre>

   <p><br>

   <p>Note that typically, only a single value string, within a single specified
node, is inserted in each <code>insert_text</code> promise (you may of course
have multiple promises that each insert a value string).

<div class="node">
<a name="interfaces-in-agent-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#methods-in-agent-promises">methods in agent promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#insert_005ftext-in-edit_005fxml-promises">insert_text in edit_xml promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-agent">Bundles for agent</a>

</div>

<h3 class="section">7.19 <code>interfaces</code> promises in &lsquo;<samp><span class="samp">agent</span></samp>&rsquo;</h3>

<p><br>

   <p>Interfaces promises describe the configurable aspects relating to
network interfaces. Most workstations and servers have only a single
network interface, but routers and multi-homed hosts often have
multiple interfaces. Interface promises include attributes such as the
IP address identity, assumed netmask and routing policy in the case of
multi-homed hosts. For virtual machines and hosts, the list of
interfaces can be quite large.

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
      interfaces:
     
        "<var>interface name</var>"
     
          tcp_ip =&gt; <var>tcp_ip_body</var>,
          ...;
     
</pre>
   </td></tr></table>

   <p><br>

   <p>For future use.

   <p><br>

   <p>For future use.

<ul class="menu">
<li><a accesskey="1" href="#tcp_005fip-in-interfaces">tcp_ip in interfaces</a>
</ul>

<div class="node">
<a name="tcp_ip-in-interfaces"></a>
<a name="tcp_005fip-in-interfaces"></a>
<p><hr>
Up:&nbsp;<a rel="up" accesskey="u" href="#interfaces-in-agent-promises">interfaces in agent promises</a>

</div>

<h4 class="subsection">7.19.1 <code>tcp_ip</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>ipv4_address</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>[0-9.]+/[0-4]+</code>

     <p class="noindent"><b>Synopsis</b>: IPv4 address for the interface

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body tcp_ip example
     {
     ipv4_address => "123.456.789.001";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The address will be checked and if necessary set. Today few hosts will
be managed in this way: address management will be handled by other services
like DHCP.

     <br><dt>&lsquo;<samp><code>ipv4_netmask</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>[0-9.]+/[0-4]+</code>

     <p class="noindent"><b>Synopsis</b>: Netmask for the interface

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body tcp_ip example
     {
     ipv4_netmask => "255.255.254.0";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>In many cases the CIDR form of address will show the netmask as &lsquo;<samp><span class="samp">/23</span></samp>&rsquo;, but
this offers and `old style' alternative.

     <br><dt>&lsquo;<samp><code>ipv6_address</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>[0-9a-fA-F:]+/[0-9]+</code>

     <p class="noindent"><b>Synopsis</b>: IPv6 address for the interface

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
       "eth0"
     
          ipv6_address => "2001:700:700:3:211:63ff:feeb:5d18/64";
     
</pre>

     <p><b>Notes</b>:<br>
<br>

   </dl>

<div class="node">
<a name="methods-in-agent-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#outputs-in-agent-promises">outputs in agent promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#interfaces-in-agent-promises">interfaces in agent promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-agent">Bundles for agent</a>

</div>

<h3 class="section">7.20 <code>methods</code> promises in &lsquo;<samp><span class="samp">agent</span></samp>&rsquo;</h3>

<p><br>

   <p>Methods are compound promises that refer to whole bundles of promises. 
Methods may be parameterized. Methods promises are written in a form
that is ready for future development. The promiser object is an
abstract identifier that refers to a collection (or pattern) of lower
level objects that are affected by the promise-bundle. Since the use
of these identifiers is for the future, you can simply use any string
here for the time being.

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
      methods:
     
        "any"
     
           usebundle =&gt; <var>method_id</var>("parameter",...);
     
</pre>
   </td></tr></table>

   <p>Methods are useful for encapsulating repeatedly used configuration
issues and iterating over parameters.

   <p>In CFEngine 2 methods referred to separate sub-programs executed
as separate processes. Methods are now implemented as bundles
that are run inline.

   <p><br>

<pre class="verbatim">

bundle agent example
{
vars:

 "userlist" slist => { "mark", "jeang", "jonhenrik", "thomas", "eben" };

methods:

 "any" usebundle => subtest("$(userlist)");

}

###########################################

bundle agent subtest(user)

{
commands:

 "/bin/echo Fix $(user)";

reports:

 linux::

  "Finished doing stuff for $(user)";
}


</pre>

   <p><br>

   <p>Methods offer powerful ways to encapsulate multiple issues pertaining
to a set of parameters.

   <p>Because a method is just an encapsulation, there is a subtlety about
how to interpret a successful method invocation. Before version 3.1.0,
a method was considered repaired if executed (like <code>commands</code>),
however this led to unnecessary logging of executions, even if not
actual encapsulated promise was kept.  In version 3.1.0 this has been
changed so that a method promise is considered kept if the method
is expanded. A method promise is thus never considered repaired.

   <p>Starting from version 3.1.0, methods may be specified using variables. 
Care should be exercised when using this approach. In order to make
the function call uniquely classified, CFEngine requires the promiser
to contain the variable name of the method if the variable is a list.

<pre class="verbatim">bundle agent default
{
vars:
    "m" slist  => { "x", "y" };
    "p" string => "myfunction";

methods:
    "set of $(m)" usebundle => $(m) ("one");
    "any"         usebundle => $(p)("two");
    
}
</pre>

<ul class="menu">
<li><a accesskey="1" href="#inherit-in-methods">inherit in methods</a>
<li><a accesskey="2" href="#usebundle-in-methods">usebundle in methods</a>
<li><a accesskey="3" href="#useresult-in-methods">useresult in methods</a>
</ul>

<div class="node">
<a name="inherit-in-methods"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#usebundle-in-methods">usebundle in methods</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#methods-in-agent-promises">methods in agent promises</a>

</div>

<h4 class="subsection">7.20.1 <code>inherit</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Synopsis</b>: If true this causes the sub-bundle to inherit the private classes of its parent

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">bundle agent name
{
methods:

  "group name" usebundle => my_method,
                 inherit => "true";
}


body edit_defaults example
{
inherit => "true";
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in 3.4.0, Enterprise 3.0.0 (2012)

<p class="noindent"><b>Default value</b>: false

   <p>The <code>inherit</code> constraint can be added to the CFEngine code in two
places: for <code>edit_defaults</code> and in <code>methods</code> promises.  If
set to true, it causes the child-bundle named in the promise to
inherit (only) the classes of the parent bundle. Inheriting the
variables is unnecessary as the child can always access the parent's
variables by a qualified reference using its bundle name,
e.g. &lsquo;<samp><span class="samp">$(bundle.variable)</span></samp>&rsquo;.

<div class="node">
<a name="usebundle-in-methods"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#useresult-in-methods">useresult in methods</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#inherit-in-methods">inherit in methods</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#methods-in-agent-promises">methods in agent promises</a>

</div>

<h4 class="subsection">7.20.2 <code>usebundle</code></h4>

<p><b>Type</b>: (ext bundle) (Separate Bundle)

<div class="node">
<a name="useresult-in-methods"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#usebundle-in-methods">usebundle in methods</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#methods-in-agent-promises">methods in agent promises</a>

</div>

<h4 class="subsection">7.20.3 <code>useresult</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>[a-zA-Z0-9_$(){}\[\].:]+</code>

<p class="noindent"><b>Synopsis</b>: Specify the name of a local variable to contain any result/return value from the child

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control
{
bundlesequence => { "test" };
}


bundle agent test
{
methods:

   "any" usebundle => child,
    useresult => "my_return_var";


reports:

  cfengine_3::

    "My return was: \"$(my_return_var[1])\" and \"$(my_return_var[2])\""; 
    
}

bundle agent child
{
reports:

 cfengine_3::

   # Map these indices into the useresult namespace

   "this is a return value"  
      bundle_return_value_index => "1";

   "this is another return value"  
      bundle_return_value_index => "2";

}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in 3.4.0 (2012)

   <p>It is currently believed that only scalar return values make sense, hence
return values are limited to scalars.

<div class="node">
<a name="outputs-in-agent-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#packages-in-agent-promises">packages in agent promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#methods-in-agent-promises">methods in agent promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-agent">Bundles for agent</a>

</div>

<h3 class="section">7.21 <code>outputs</code> promises in &lsquo;<samp><span class="samp">agent</span></samp>&rsquo;</h3>

<p><br>

   <p>Outputs promises allow promises to make meta-promises about their output
levels. More simply, you can switch on &lsquo;<samp><span class="samp">verbose</span></samp>&rsquo; or &lsquo;<samp><span class="samp">inform</span></samp>&rsquo;
level output to named promises, or whole bundles for debugging
purposes.

   <p>If you use the &lsquo;<samp><span class="samp">-I</span></samp>&rsquo; or &lsquo;<samp><span class="samp">-v</span></samp>&rsquo; command line options, then CFEngine
will generate informative or verbose output for all the promises it is
processing.  This can be a daunting collection of data when dealing with even
a medium-sized set of promises.

   <p>Output promises enable you to selectively debug individually named promises
(or bundles), thus eliminating the need for scanning unrelated CFEngine
output.

   <p><br>

<pre class="verbatim">
outputs:

  "run_agent";		# Promise handle, verbose (default) output

  "web_server"		# Bundle handle, inform output
     output_level => "inform",
     promiser_type => "bundle";

</pre>

   <p>A very handy paradigm is to include outputs promises in every bundle, and
guard them with classes.  For example:

<pre class="verbatim">
bundle agent some_function
{
vars:
    ...
classes:
    ...
outputs:
  debug_some_function::
      "some_function"
	 output_level => "verbose",
	 promiser_type => "bundle";
files:
    ...
}

</pre>

   <p>You can then execute your promises normally with no extra output, but should
you wish to temporarily enable debugging, you can simply do so from the
command line by specifying &lsquo;<samp><span class="samp">-D debug_some_function</span></samp>&rsquo;.  You can also supply
multiple arguments to &lsquo;<samp><span class="samp">-D</span></samp>&rsquo; to debug multiple bundles.  Of course, you can
also provide much finer-grained control by creating outputs promises on
specific promise handles.

   <p><br>

   <p>The default behaviour is to print verbose output for listed promise
handles, See <a href="#handle-in-_002a">handle in *</a>, for bundle names.

   <p><b>History</b> This was introduced in Nova version 1.1.3 (2010), Community version 3.4.0 (2012)

<ul class="menu">
<li><a accesskey="1" href="#output_005flevel-in-outputs">output_level in outputs</a>
<li><a accesskey="2" href="#promiser_005ftype-in-outputs">promiser_type in outputs</a>
</ul>

<div class="node">
<a name="output_level-in-outputs"></a>
<a name="output_005flevel-in-outputs"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#promiser_005ftype-in-outputs">promiser_type in outputs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#outputs-in-agent-promises">outputs in agent promises</a>

</div>

<h4 class="subsection">7.21.1 <code>output_level</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>verbose</code>
               <code>debug</code>
               <code>inform</code>
</pre>
   <p class="noindent"><b>Default value:</b> verbose

<p class="noindent"><b>Synopsis</b>: Output level to observe for the named promise or bundle (meta-promise)

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
commands:

  "/etc/init.d/agent start"

    handle => "run_agent",
    ifvarclass => "need_to_run_agent";

outputs:

  "run_agent"

    output_level => "inform"; 

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>With no attribute, <code>verbose</code> output is assumed.

<div class="node">
<a name="promiser_type-in-outputs"></a>
<a name="promiser_005ftype-in-outputs"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#output_005flevel-in-outputs">output_level in outputs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#outputs-in-agent-promises">outputs in agent promises</a>

</div>

<h4 class="subsection">7.21.2 <code>promiser_type</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>promise</code>
               <code>bundle</code>
</pre>
   <p class="noindent"><b>Default value:</b> promise

<p class="noindent"><b>Synopsis</b>: Output level to observe for the named promise or bundle (meta-promise)

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
outputs:

  "web_server"

     promiser_type => "bundle";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Without this attribute, CFEngine assumes a list of promises to report on
(because there may be a promise for a thing that has the same name as a bundle,
you must explicitly specify when you want to report on a bundle of promises).

<div class="node">
<a name="packages-in-agent-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#processes-in-agent-promises">processes in agent promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#outputs-in-agent-promises">outputs in agent promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-agent">Bundles for agent</a>

</div>

<h3 class="section">7.22 <code>packages</code> promises in &lsquo;<samp><span class="samp">agent</span></samp>&rsquo;</h3>

<p><br>

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="verbatim">
 vars:

  "match_package" slist => { 
                           "apache2", 
                           "apache2-mod_php5",
                           "apache2-prefork",
                           "php5" 
                           };
 packages:

    "$(match_package)"

         package_policy => "add",
         package_method => yum;

</pre>
</td></tr></table>

   <p>Software packaging is a core paradigm in operating system release
management today, and CFEngine supports a generic approach to
integration with native operating support for packaging.  Package
promises allow CFEngine to make promises the state of software
packages <i>conditionally</i>, given the assumption that a native package
manager will perform the actual manipulations. Since no agent can make
unconditional promises about another, this is the best that can be
achieved.

   <p>Packages are treated as black-boxes with three labels:

     <ul>
<li>A package name. 
<li>A version string. 
<li>An architecture name. 
</ul>

   <p>Package managers are treated as black boxes that may support some or all of the
following promise types:

     <ul>
<li>List installed packages
<li>Add packages
<li>Delete packages
<li>Reinstall (repair) packages
<li>Update packages
<li>Patch packages
<li>Verify packages
</ul>

   <p>If these services are promised by a package manager, <code>cf-agent</code>
promises to use the service and encapsulate it within the overall
CFEngine framework. It is possible to set classes based on the return
code of a package-manager command in a very flexible way. See the
<code>kept_returncodes</code>, <code>repaired_returncodes</code> and
<code>failed_returncodes</code> attributes.

   <p><b>Domain knowledge</b>

   <p>CFEngine does not maintain operating system specific expert knowledge
internally, rather it uses a generic model for dealing with promises about
packages (which depend on the behaviour of an external package manager). 
The approach is to define package system details in body-constraints that
can be written once and for all, for each package system.

   <p>Package promises are like <code>commands</code> promises in the sense that
CFEngine promises nothing about the outcome of executing a
command. All it can promise is to interface with it, starting it and
using the results in good faith. Packages are basically `outsourced',
to invoke IT parlance.

   <p>The possibility of a CFEngine package format that enables more guaranteeable
behaviour for special purposes has not been excluded for the future,
but in any case <code>cf-agent</code> must support native package formats
used by operating system maintainers as these are a core part of modern
operating systems.

   <p><b>Behaviour</b>

   <p>A package promise consists of a name, a version and an architecture, <i>(n,v,a)</i>,
and behaviour to be promised about packages that match criteria based on these. 
The components <i>(n,v,a)</i> can be determined in one of two different ways:

     <ul>
<li>They may be specified independently, e.g.

     <pre class="verbatim">     packages:
     
       "mypackage"
     
          package_policy => "add",
          package_method => rpm,
          package_select => ">=",
          package_architectures => { "x86_64", "i586" },
          package_version => "1.2.3";
     
</pre>

     <li>They may be extracted from a package identifier (promiser) or
filename, using pattern matching. For example, a promiser
&ldquo;7-Zip-4.50-x86_64.msi&rdquo; and a package_method containing the following.

     <pre class="verbatim">      package_name_regex => "^(\S+)-(\d+\.?)+";
      package_version_regex => "^\S+-((\d+\.?)+)";
      package_arch_regex => "^\S+-[\d\.]+-(.*).msi";
</pre>

   </ul>

   <p>When scanning a list of installed packages different managers present the information
<i>(n,v,a)</i> in quite different forms and pattern extraction is necessary. When making a
promise about a specific package, the CFEngine user may choose one or the other model.

   <p><b>Smart and dumb package systems</b>

   <p>Package managers vary enormously in their capabilities and in the
kinds of promises they make. There are broadly two types

     <ul>
<li>Smart package systems tha resolve dependencies and require only a symbolic package name. 
<li>Dumb package managers that do not resolve dependencies and need filename input. 
</ul>

   <p>Normal ordering for packages is the following:

     <ul>
<li>Delete
<li>Add
<li>Update
<li>Patch
</ul>

   <p><b>Promise repair logic</b>

   <p>We can discuss package promise repair in the following table.

   <p>Identified package matches version constraints
   <p><table summary=""><tr align="left"><td valign="top" width="20%">  add
  </td><td valign="top" width="80%">
  never
<br></td></tr><tr align="left"><td valign="top" width="20%">  delete
  </td><td valign="top" width="80%">
  =,&gt;=,&lt;=
<br></td></tr><tr align="left"><td valign="top" width="20%">  reinstall
  </td><td valign="top" width="80%">
  =,&gt;=,&lt;=
<br></td></tr><tr align="left"><td valign="top" width="20%">  upgrade
  </td><td valign="top" width="80%">
  =,&gt;=,&lt;=
<br></td></tr><tr align="left"><td valign="top" width="20%">  patch
  </td><td valign="top" width="80%">
  =,&gt;=,&lt;=
   <br></td></tr></table>

   <p>Identified package matched by name, but not version
   <p><table summary=""><tr align="left"><th valign="top" width="20%">  Command
  </th><th valign="top" width="40%">
  Dumb manager
  </th><th valign="top" width="40%">
  Smart manager
<br></th></tr><tr align="left"><td valign="top" width="20%">  add
  </td><td valign="top" width="40%">
  unable
  </td><td valign="top" width="40%">
  Never
<br></td></tr><tr align="left"><td valign="top" width="20%">  delete
  </td><td valign="top" width="40%">
  unable
  </td><td valign="top" width="40%">
  Attempt deletion
<br></td></tr><tr align="left"><td valign="top" width="20%">  reinstall
  </td><td valign="top" width="40%">
  unable
  </td><td valign="top" width="40%">
  Attempt delete/add
<br></td></tr><tr align="left"><td valign="top" width="20%">  upgrade
  </td><td valign="top" width="40%">
  unable
  </td><td valign="top" width="40%">
  Upgrade if capable
<br></td></tr><tr align="left"><td valign="top" width="20%">  patch
  </td><td valign="top" width="40%">
  unable
  </td><td valign="top" width="40%">
  Patch if capable
   <br></td></tr></table>

   <p>Package not installed
   <p><table summary=""><tr align="left"><th valign="top" width="20%">  Command
  </th><th valign="top" width="40%">
  Dumb manager
  </th><th valign="top" width="40%">
  Smart manager
<br></th></tr><tr align="left"><td valign="top" width="20%">  add
  </td><td valign="top" width="40%">
  Attempt to install named
  </td><td valign="top" width="40%">
  Install any version
<br></td></tr><tr align="left"><td valign="top" width="20%">  delete
  </td><td valign="top" width="40%">
  unable
  </td><td valign="top" width="40%">
  unable
<br></td></tr><tr align="left"><td valign="top" width="20%">  reinstall
  </td><td valign="top" width="40%">
  Attempt to install named
  </td><td valign="top" width="40%">
  unable
<br></td></tr><tr align="left"><td valign="top" width="20%">  upgrade
  </td><td valign="top" width="40%">
  unable
  </td><td valign="top" width="40%">
  unable
<br></td></tr><tr align="left"><td valign="top" width="20%">  patch
  </td><td valign="top" width="40%">
  unable
  </td><td valign="top" width="40%">
  unable
   <br></td></tr></table>

   <p><br>

<pre class="verbatim">
bundle agent packages
{
vars:

 # Test the simplest case -- leave everything to the yum smart manager

 "match_package" slist => { 
                          "apache2", 
                          "apache2-mod_php5",
                          "apache2-prefork",
                          "php5" 
                          };
packages:

  "$(match_package)"

     package_policy => "add",
     package_method => yum;

}

</pre>

   <p><br>

   <p>Packages promises can be very simple if the package manager is of the
smart variety that handles details for you. If you need to specify
architecture and version numbers of packages, this adds some
complexity, but the options are flexible and designed for maximal
adaptability.

<p class="noindent"><b>Patching</b>

   <p>Some package systems also support the idea of `patches'. These might
be formally different objects to packages. A patch might contain
material for several packages and be numbered differently. 
When you select patching-policy the package name (promiser) can be
a regular expression that will match possible patch names, otherwise
identifying specific patches can be cumbersome.

   <p>Note that patching is a subtle business. There is no simple way using
the patch settings to install `all new system patches'. Here's why:

   <p>If we specify the name of a patch, then CFEngine will try to see if it
exists and/or is installed. If it exists in the pending list, it will
be installed.  If it exists in the installed list it will not be
installed. Now consider the pattern &lsquo;<samp><span class="samp">.*</span></samp>&rsquo;. This will match any
installed package, so CFEngine will assume the relevant patch has been
installed already.  On the other hand, the pattern &lsquo;<samp><span class="samp">no match</span></samp>&rsquo;
will not match an installed patch, but it will not match a named patch
either.

   <p>Some systems provide a command to do this, which can be specified
without specific patch arguments. If so, that command can be called
periodically under <code>commands</code>. The main purposes of patching
body items are:

     <ul>
<li>To install specific named patches in a controlled manner. 
<li>To generate reports of available and installed patches during
system reporting. 
</ul>

<p class="noindent"><b>Installers without package/patch arguments</b>

   <p>CFEngine supports the syntax &lsquo;<samp><span class="samp">$</span></samp>&rsquo; at the end of a command to mean
that no package name arguments should be used or appended after the
dollar.  This is because some commands require a list of packages,
while others require an empty list. The default behaviour is to try to
append the name of one or more packages to the command, depending on
whether the policy is for individual or bulk installation.

<p class="noindent"><b>Default package method</b>

   <p>As of core 3.3.0, if no <code>package_method</code> is defined, CFEngine will
look for a method called &lsquo;<samp><span class="samp">generic</span></samp>&rsquo;. Such a method is defined in
the standard library for supported operating systems.

<ul class="menu">
<li><a accesskey="1" href="#package_005farchitectures-in-packages">package_architectures in packages</a>
<li><a accesskey="2" href="#package_005fmethod-in-packages">package_method in packages</a>
<li><a accesskey="3" href="#package_005fpolicy-in-packages">package_policy in packages</a>
<li><a accesskey="4" href="#package_005fselect-in-packages">package_select in packages</a>
<li><a accesskey="5" href="#package_005fversion-in-packages">package_version in packages</a>
</ul>

<div class="node">
<a name="package_architectures-in-packages"></a>
<a name="package_005farchitectures-in-packages"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#package_005fmethod-in-packages">package_method in packages</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#packages-in-agent-promises">packages in agent promises</a>

</div>

<h4 class="subsection">7.22.1 <code>package_architectures</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Select the architecture for package selection

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">packages:

  "$(exact_package)"

     package_policy => "add",
     package_method => rpm,
     package_architectures => { "x86_64" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>It is possible to specify a list of packages of different architectures if it is desirable to
install multiple architectures on the host. If no value is specified, CFEngine makes no promise
about the result; the package manager's behaviour prevails.

<div class="node">
<a name="package_method-in-packages"></a>
<a name="package_005fmethod-in-packages"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#package_005fpolicy-in-packages">package_policy in packages</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#package_005farchitectures-in-packages">package_architectures in packages</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#packages-in-agent-promises">packages in agent promises</a>

</div>

<h4 class="subsection">7.22.2 <code>package_method</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>package_add_command</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>.+</code>

     <p class="noindent"><b>Synopsis</b>: Command to install a package to the system

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body package_method rpm
     {
     package_add_command => "/bin/rpm -i ";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This command should install a package when appended with the package
reference id, formed using the <code>package_name_convention</code>, using
the model of (name,version,architecture).  If
<code>package_file_repositories</code> is specified, the package reference
id will include the full path to a repoistory containing the package.

     <p>Package managers generally expect the name of a package to be passed
as a parameter. However, in some cases we do not need to pass the name
of a particular package to the command. Ending the command string with
&lsquo;<samp><span class="samp">$</span></samp>&rsquo; prevents CFEngine from appending the package name to the
string.

     <br><dt>&lsquo;<samp><code>package_arch_regex</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: Regular expression with one backreference to extract package architecture string

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body package_method rpm
     
     {
     package_list_arch_regex    => "[^.]+\.([^.]+)";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This is for use when extracting architecture from the name of the
promiser, i.e. when the architecture is not specified using the
<code>package_architectures</code> list.  It is a regular expression that
contains exactly one parenthesized back reference which marks the
location in the <i>promiser</i> at which the architecture is specified. 
The regex may match a portion of the string (i.e., it is unanchored,
see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>). 
If no architecture is specified for the given package manager, then
do not define this.

     <br><dt>&lsquo;<samp><code>package_changes</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>individual</code>
                    <code>bulk</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Menu option - whether to group packages into a single aggregate command

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body package_method rpm
     
     {
     package_changes => "bulk";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>
This indicate whether the package manager is capable of handling
package operations in bulk, i.e. with by given multiple arguments. If
this is set to &lsquo;<samp><span class="samp">bulk</span></samp>&rsquo; then multiple arguments will be passed to
the package commands. If set to &lsquo;<samp><span class="samp">individual</span></samp>&rsquo; packages will be
handled one by one. This might add a significant overhead to the
operations, and also affect the ability of the operating system's
package manager to handle dependencies.

     <br><dt>&lsquo;<samp><code>package_delete_command</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>.+</code>

     <p class="noindent"><b>Synopsis</b>: Command to remove a package from the system

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body package_method rpm
     
     {
     package_delete_command => "/bin/rpm -e --nodeps";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The command that deletes a package from the system when appended with
the package reference identifier specified by
<code>package_name_convention</code>.

     <p>Package managers generally expect the name of a package to be passed
as a parameter. However, in some cases we do not need to pass the name
of a particular package to the command. Ending the command string with
&lsquo;<samp><span class="samp">$</span></samp>&rsquo; prevents CFEngine from appending the package name to the
string.

     <br><dt>&lsquo;<samp><code>package_delete_convention</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: This is how the package manager expects the package to be referred to in the deletion part of a package update, e.g. $(name)

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     body package_method freebsd
     
     {
     package_file_repositories => { "/path/to/packages" };
     package_name_convention => "$(name)-$(version).tbz";
     package_delete_convention => "$(name)-$(version)";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This attribute is used when <code>package_policy</code> is &lsquo;<samp><span class="samp">delete</span></samp>&rsquo;, or
<code>package_policy</code> is &lsquo;<samp><span class="samp">update</span></samp>&rsquo; and <code>package_file_repositories</code> is set and
<code>package_update_command</code> is not set.  It is then used to
set the pattern for naming the package in the way expected by the
package manager during the deletion of existing packages.

     <p>Three special variables are defined from the extracted data, in a
private context for use: &lsquo;<samp><span class="samp">$(name)</span></samp>&rsquo;, &lsquo;<samp><span class="samp">$(version)</span></samp>&rsquo; and
&lsquo;<samp><span class="samp">$(arch)</span></samp>&rsquo;. &lsquo;<samp><span class="samp">version</span></samp>&rsquo; and &lsquo;<samp><span class="samp">arch</span></samp>&rsquo; is the version and arch
(if <code>package_list_arch_regex</code> is given) of the already installed
package. Additionally, if <code>package_file_repositories</code> is defined,
&lsquo;<samp><span class="samp">$(firstrepo)</span></samp>&rsquo; can be prepended to expand the first repository
containing the package, e.g. &lsquo;<samp><span class="samp">$(firstrepo)$(name)-$(version)-$(arch).msi</span></samp>&rsquo;.

     <p>If this is not defined, it defaults to the value of
<code>package_name_convention</code>.

     <br><dt>&lsquo;<samp><code>package_file_repositories</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: A list of machine-local directories to search for packages

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body package_method filebased
     {
     package_file_repositories => { "/package/repos1", "/packages/repos2" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>If specified, CFEngine will assume that the package installation occurs by filename and will
search the named paths for a package matching the pattern <code>package_name_convention</code>. 
If found the name will be prefixed to the package name in the package commands.

     <br><dt>&lsquo;<samp><code>package_installed_regex</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: Regular expression which matches packages that are already installed

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body package_method yum
     {
     package_installed_regex => ".*installed.*";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This regular expression must match complete lines in the output
of the list command that are actually installed packages (that is,
the regex is anchored, see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>). 
If all the lines match then the regex can be set of &lsquo;<samp><span class="samp">.*</span></samp>&rsquo;, however
most package systems output prefix lines and a variety of human
padding that needs to be ignored.

     <br><dt>&lsquo;<samp><code>package_default_arch_command</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>"?(/.*)</code>

     <p class="noindent"><b>Synopsis</b>: Command to detect the default packages' architecture

     <p><b>Example</b>:<br>
<br>
<pre class="verbatim">     body package_method dpkg
     {
       package_default_arch_command => "/usr/bin/dpkg --print-architecture";
     
       # ...
     }
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p><i>History</i>: Was introduced in 3.4.0, Enterprise 3.0.0 (2012)

     <p>This command allows CFEngine to detect default architecture of
packages managed by package manager. As an example, multiarch-enabled
dpkg only lists architectures explicitly for multiarch-enabled
packages.

     <p>In case this command is not provided, CFEngine treats all packages
without explicit architecture set as belonging to implicit &ldquo;default&rdquo;
architecture.

     <br><dt>&lsquo;<samp><code>package_list_arch_regex</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: Regular expression with one backreference to extract package architecture string

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body package_method rpm
     {
     package_list_arch_regex    => "[^|]+\|[^|]+\|[^|]+\|[^|]+\|\s+([^\s]+).*";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>A regular expression that contains exactly one parenthesized back
reference which marks the location in the listed package at which
the architecture is specified. The regular expression may match a
portion of the string (that is, it is unanchored,
see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>). If no architecture
is specified for the given package manager, then do not define this
regex.

     <br><dt>&lsquo;<samp><code>package_list_command</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>.+</code>

     <p class="noindent"><b>Synopsis</b>: Command to obtain a list of available packages

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body package_method rpm
     
     {
     package_list_command => "/bin/rpm -qa --queryformat \"%{name} %{version}-%{release}\n\"";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This command should provide a complete list of the packages installed
on the system.  It might also list packages that are not
installed. Those should be filtered out using the
<code>package_installed_regex</code>.

     <p>Package managers generally expect the name of a package to be passed as a parameter. However, in some cases
we do not need to pass the name of a particular package to the command. Ending the command string with &lsquo;<samp><span class="samp">$</span></samp>&rsquo;
prevents CFEngine from appending the package name to the string.

     <br><dt>&lsquo;<samp><code>package_list_name_regex</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: Regular expression with one backreference to extract package name string

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body package_method rpm
     
     {
     package_list_name_regex    => "([^\s]+).*";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>A regular expression that contains exactly one parenthesized back
reference which marks the name of the package from the package
listing.  The regular expression may match a portion of the string
(that is, it is unanchored, see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>).

     <br><dt>&lsquo;<samp><code>package_list_update_command</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: Command to update the list of available packages (if any)

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     body package_method xyz
     {
     debian|ubuntu::
     
     package_list_update_command => "/usr/bin/apt-get update";
     package_list_update_ifelapsed => "240";		# 4 hours
     }
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Not all package managers update their list information from source
automatically. This command allows a separate update command to be executed at
intervals determined by <code>package_list_update_ifelapsed</code>.

     <br><dt>&lsquo;<samp><code>package_list_update_ifelapsed</code></samp>&rsquo;<dd><b>Type</b>: int

     <p class="noindent"><b>Allowed input range</b>: <code>-99999999999,9999999999</code>

     <p class="noindent"><b>Synopsis</b>: The ifelapsed locking time in between updates of the package list

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     body package_method xyz
     {
     debian|ubuntu::
     
     package_list_update_command => "/usr/bin/apt-get update";
     package_list_update_ifelapsed => "240";		# 4 hours
     }
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Not all package managers update their list information from source
automatically. This command allows a separate update command to be executed at
intervals determined by <code>package_list_update_ifelapsed</code>.

     <br><dt>&lsquo;<samp><code>package_list_version_regex</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: Regular expression with one backreference to extract package version string

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     body package_method rpm
     
     {
     package_list_version_regex => "[^\s]+ ([^.]+).*";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This regular expression should containe exactly one parenthesized
back-reference that marks the version string of packages listed as
installed.  The regular expression may match a portion of the string
(that is, it is unanchored, see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>)

     <br><dt>&lsquo;<samp><code>package_name_convention</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: This is how the package manager expects the package to be referred to, e.g. $(name).$(arch)

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     body package_method rpm
     
     {
     package_name_convention => "$(name).$(arch).rpm";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This sets the pattern for naming the package in the way expected by
the package manager. Three special variables are defined from the
extracted data, in a private context for use: &lsquo;<samp><span class="samp">$(name)</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">$(version)</span></samp>&rsquo; and &lsquo;<samp><span class="samp">$(arch)</span></samp>&rsquo;. 
Additionally, if <code>package_file_repositories</code> is defined,
&lsquo;<samp><span class="samp">$(firstrepo)</span></samp>&rsquo; can be prepended to expand the first repository
containing the package, e.g. &lsquo;<samp><span class="samp">$(firstrepo)$(name)-$(version)-$(arch).msi</span></samp>&rsquo;.

     <p>When <code>package_policy</code> is &lsquo;<samp><span class="samp">update</span></samp>&rsquo;, and
<code>package_file_repositories</code> is specified,
<code>package_delete_convention</code> may be used to specify a different
convention for the delete command.

     <p>If this is not defined, it defaults to the value  &lsquo;<samp><span class="samp">$(name)</span></samp>&rsquo;.

     <br><dt>&lsquo;<samp><code>package_name_regex</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: Regular expression with one backreference to extract package name string

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body package_method rpm
     {
     package_name_regex => "([^\s]).*";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This regular expression is only used when the <i>promiser</i> contains
not only the name of the package, but its version and archiecture
also. In that case, this expression should contain a single parenthesized
back-reference to extract the name of the package from the string.  The
regex may match a portion of the string (that is, it is unanchored,
see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>)

     <br><dt>&lsquo;<samp><code>package_noverify_regex</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: Regular expression to match verification failure output

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     body package_method xyz
     
     {
     package_noverify_regex => "Package .* is not installed.*";
     package_verify_command => "/usr/bin/dpkg -s";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>A regular expression to match output from a package verification command. If the
output string matches this expression, the package is deemed broken.  The regex
must match the entire line (that is, it is anchored,
see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>)

     <br><dt>&lsquo;<samp><code>package_noverify_returncode</code></samp>&rsquo;<dd><b>Type</b>: int

     <p class="noindent"><b>Allowed input range</b>: <code>-99999999999,9999999999</code>

     <p class="noindent"><b>Synopsis</b>: Integer return code indicating package verification failure

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     body package_method xyz
     {
     package_noverify_returncode => "-1";
     package_verify_command => "/bin/rpm -V";
     }
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>For use if a package verification command uses the return code as the signal
for a failed package verification.

     <br><dt>&lsquo;<samp><code>package_patch_arch_regex</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: Regular expression with one backreference to extract update architecture string

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body package_method zypper
     {
     package_patch_arch_regex => "";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>A few package managers keep a separate notion of patches, as opposed to package updates. 
OpenSuSE, for example, is one of these. This provide an analogous command struct to the
packages for patch updates.  The regular expression must match the entire line (that is,
it is anchored, see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>).

     <br><dt>&lsquo;<samp><code>package_patch_command</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>.+</code>

     <p class="noindent"><b>Synopsis</b>: Command to update to the latest patch release of an installed package

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     body package_method zypper
     
     {
     package_patch_command => "/usr/bin/zypper -non-interactive patch";
     }
</pre>

     <p><b>Notes</b>:<br>
<br>
If the package manager supports patching, this command should patch
a named package. If only patching of all packages is supported then
consider running that as a batch operation in
<code>commands</code>. Alternatively one can end the command string with a
&lsquo;<samp><span class="samp">$</span></samp>&rsquo; symbol, which CFEngine will interpret as an instruction to
not append package names.

     <p>Package managers generally expect the name of a package to be passed
as a parameter. However, in some cases we do not need to pass the name
of a particular package to the command. Ending the command string with
&lsquo;<samp><span class="samp">$</span></samp>&rsquo; prevents CFEngine from appending the package name to the
string.

     <br><dt>&lsquo;<samp><code>package_patch_installed_regex</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: Regular expression which matches packages that are already installed

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body package_method zypper
     {
     package_patch_installed_regex => ".*(Installed|Not Applicable).*";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>A few package managers keep a separate notion of patches, as opposed to package updates. 
OpenSuSE, for example, is one of these. This provide an analogous command struct to the
packages for patch updates. The regular expression must match the entire string (that is,
it is anchored, see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>).

     <br><dt>&lsquo;<samp><code>package_patch_list_command</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>.+</code>

     <p class="noindent"><b>Synopsis</b>: Command to obtain a list of available patches or updates

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
      package_patch_list_command => "/usr/bin/zypper patches";
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This command, if it exists at all, is presumed to generate a list of
available patches in a format analogous to (but not necessarily the
same as) the package-list command, of patches that are available
on the system. Patches might formally be available in the packagae
manager's view, but if they have already been installed, CFEngine will
ignore them.

     <p>Package managers generally expect the name of a package to be passed
as a parameter. However, in some cases we do not need to pass the name
of a particular package to the command. Ending the command string with
&lsquo;<samp><span class="samp">$</span></samp>&rsquo; prevents CFEngine from appending the package name to the
string.

     <br><dt>&lsquo;<samp><code>package_patch_name_regex</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: Regular expression with one backreference to extract update name string

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body package_method zypper
     {
     package_patch_name_regex    => "[^|]+\|\s+([^\s]+).*";
     }
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>A few package managers keep a separate notion of patches, as opposed to package updates. 
OpenSuSE, for example, is one of these. This provide an analogous command struct to the
packages for patch updates. The regular expression may match a partial string (that is,
it is unanchored, see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>).

     <br><dt>&lsquo;<samp><code>package_patch_version_regex</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: Regular expression with one backreference to extract update version string

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body package_method zypper
     {
     package_patch_version_regex => "[^|]+\|[^|]+\|\s+([^\s]+).*";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>A few package managers keep a separate notion of patches, as opposed to package updates. 
OpenSuSE, for example, is one of these. This provide an analogous command struct to the
packages for patch updates. The regular expression may match a partial string (that is,
it is unanchored, see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>).

     <br><dt>&lsquo;<samp><code>package_update_command</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>.+</code>

     <p class="noindent"><b>Synopsis</b>: Command to update to the latest version a currently installed package

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body package_method zypper
     {
     package_update_command => "/usr/bin/zypper -non-interactive update";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>If supported this should be a command that updates the version of a
single currently installed package. If only bulk updates are
supported, consider running this as a single command under
<code>commands</code>. The package reference id is appended, with the
pattern of <code>package_name_convention</code>.

     <p>When <code>package_file_repositories</code> is specified, the package
reference id will include the full path to a repoistory containing the
package. If <code>package_policy</code> is &lsquo;<samp><span class="samp">update</span></samp>&rsquo;, and this command
is not specified, the <code>package_delete_command</code> and
<code>package_add_command</code> will be executed to carry out the update.

     <br><dt>&lsquo;<samp><code>package_verify_command</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>.+</code>

     <p class="noindent"><b>Synopsis</b>: Command to verify the correctness of an installed package

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     body package_method rpm
     
     {
     package_verify_command => "/bin/rpm -V";
     package_noverify_returncode => "-1";
     }
     
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>If available, this is a command to verify an already installed
package. It is required only when <code>package_policy</code> is
&lsquo;<samp><span class="samp">verify</span></samp>&rsquo;.

     <p>The outcome of the command is compared with
<code>package_noverify_returncode</code> or <code>package_noverify_regex</code>,
one of which has to be set when using this command. If the package is
not installed, the command will not be run &mdash; the promise gets
flagged as not kept before the verify command executes.

     <p>In order for the promise to be considered kept, the package must be
installed, and the verify command must be successful according to
<code>package_noverify_returncode</code> xor <code>package_noverify_regex</code>.

     <p>Package managers generally expect the name of a package to be passed
as a parameter. However, in some cases we do not need to pass the name
of a particular package to the command. Ending the command string with
&lsquo;<samp><span class="samp">$</span></samp>&rsquo; prevents CFEngine from appending the package name to the
string.

     <br><dt>&lsquo;<samp><code>package_version_regex</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: Regular expression with one backreference to extract package version string

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body package_method rpm
     {
     package_version_regex => "[^\s]+ ([^.]+).*";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>If the version of a package is not specified separately using
<code>package_version</code>, then this should be a regular expression that
contains exactly one parenthesized back-reference that matches the version
string in the promiser.  The regular expression may match a partial string
(that is, it is unanchored, see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>).

     <br><dt>&lsquo;<samp><code>package_multiline_start</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: Regular expression which matches the start of a new package in multiline output

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body package_method solaris (pkgname, spoolfile, adminfile)
     {
     package_changes => "individual";
     package_list_command => "/usr/bin/pkginfo -l";
     package_multiline_start    =>  "\s*PKGINST:\s+[^\s]+";
     ...
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This pattern is used in determining when a new package record
begins. It is used when package managers (like the solaris package
manager) use multi-line output formats. 
This pattern matches the first line of a new record.

     <br><dt>&lsquo;<samp><code>package_commands_useshell</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Whether to use shell for commands in this body

     <p class="noindent"><b>Default value:</b> true

     <p><b>Example</b>:<br>
<br>

     <p><i>History</i>: Was introduced in 3.4.0b1.70bd7ea, Nova 2.3.0.a1.3167b00 (2012)

     <pre class="verbatim">     
     Fill me in (./bodyparts/package_commands_useshell_example.texinfo)
     ""
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p><i>History</i>: Was introduced in 3.4.0b1.70bd7ea, Nova 2.3.0.a1.3167b00 (2012)

     <pre class="verbatim">     
     Fill me in (./bodyparts/package_commands_useshell_notes.texinfo)
     ""
</pre>

     <br><dt>&lsquo;<samp><code>package_version_less_command</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>.+</code>

     <p class="noindent"><b>Synopsis</b>: Command to check whether first supplied package version is less than second one

     <p><b>Example</b>:<br>
<br>
<pre class="verbatim">     body package_method deb
     {
     ...
     package_version_less_command => "dpkg --compare-versions ${v1} lt ${v2}";
     }
</pre>

     <p><b>Notes</b>:<br>
<br>
<i>History</i>: Was introduced in 3.4.0 (2012)

     <p>This attribute allows to override built-in CFEngine algorithm for
version comparison by calling an external command to check whether the first passed version is less than another.

     <p>Built-in algorithm does a good approximation of version comparison,
but different packaging systems differ in corner cases (e.g Debian
treats symbol ~ less than any other symbol and even less than empty
string), so some sort of override is necessary.

     <p>Variables <code>v1</code> and <code>v2</code> are substituted with the first and
second version to be compared. Command should return code 0 if v1 is
less than v2 and non-zero otherwise.

     <p>Note that if package_version_equal_command is not specified, but
package_version_less_command is, then equality will be tested by
issuing less comparison twice (v1 equals to v2 if v1 is not less than
v2, and v2 is not less than v1).

     <br><dt>&lsquo;<samp><code>package_version_equal_command</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>.+</code>

     <p class="noindent"><b>Synopsis</b>: Command to check whether first supplied package version is equal to second one

     <p><b>Example</b>:<br>
<br>
<pre class="verbatim">     body package_method deb
     {
     ...
     package_version_equal_command => "dpkg --compare-versions ${v1} eq ${v2}";
     }
</pre>

     <p><b>Notes</b>:<br>
<br>
<i>History</i>: Was introduced in 3.4.0 (2012)

     <p>This attribute allows to override built-in CFEngine algorithm for
version comparison by calling an external command to check whether the
passed versions are the same. Some package managers consider textually
different versions to be the same (e.g. optional epoch component, so
0:1.0-1 and 1.0-1 versions are the same), and rules for comparing vary
from package manager to package manager, so override is necessary.

     <p>Variables <code>v1</code> and <code>v2</code> are substituted with the versions to
be compared. Command should return code 0 if versions are equal and
non-zero otherwise.

     <p>Note that if package_version_equal_command is not specified, but
package_version_less_command is, then equality will be tested by
issuing less comparison twice (v1 equals to v2 if v1 is not less than
v2, and v2 is not less than v1).

   </dl>

<div class="node">
<a name="package_policy-in-packages"></a>
<a name="package_005fpolicy-in-packages"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#package_005fselect-in-packages">package_select in packages</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#package_005fmethod-in-packages">package_method in packages</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#packages-in-agent-promises">packages in agent promises</a>

</div>

<h4 class="subsection">7.22.3 <code>package_policy</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>add</code>
               <code>delete</code>
               <code>reinstall</code>
               <code>update</code>
               <code>addupdate</code>
               <code>patch</code>
               <code>verify</code>
</pre>
   <p class="noindent"><b>Default value:</b> verify

<p class="noindent"><b>Synopsis</b>: Criteria for package installation/upgrade on the current system

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">packages:

  "$(match_package)"

     package_policy => "add",
     package_method => xyz;

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This decides what fate is intended for the named package.

     <dl>
<dt>&bull;add<dd>Ensure that a package is present (this is the default setting from 3.3.0). 
<br><dt>&bull;delete<dd>Ensure that a package is not present. 
<br><dt>&bull;reinstall<dd>Delete then add package (warning, non-convergent). 
<br><dt>&bull;update<dd>Update the package if an update is available (manager dependent). 
<br><dt>&bull;addupdate<dd>Equivalent to &lsquo;<samp><span class="samp">add</span></samp>&rsquo; if the package is not installed, and
&lsquo;<samp><span class="samp">update</span></samp>&rsquo; if it is installed. 
<br><dt>&bull;patch<dd>Install one or more patches if available (manager dependent). 
<br><dt>&bull;verify<dd>Verify the correctness of the package (manager dependent). The promise
is kept if the package is installed correctly, not kept
otherwise. Requires setting <code>package_verify_command</code>. 
</dl>

<div class="node">
<a name="package_select-in-packages"></a>
<a name="package_005fselect-in-packages"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#package_005fversion-in-packages">package_version in packages</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#package_005fpolicy-in-packages">package_policy in packages</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#packages-in-agent-promises">packages in agent promises</a>

</div>

<h4 class="subsection">7.22.4 <code>package_select</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>&gt;</code>
               <code>&lt;</code>
               <code>==</code>
               <code>!=</code>
               <code>&gt;=</code>
               <code>&lt;=</code>
</pre>
   <p class="noindent"><b>Synopsis</b>: A criterion for first acceptable match relative to "package_version"

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">packages:

  "$(exact_package)"

     package_policy => "add",
     package_method => xyz,
     package_select => ">=",
     package_architectures => { "x86_64" },
     package_version => "1.2.3-456";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This selects the operator that compares the promiser to the state of the system
packages currently installed. If the criterion matches, the policy action is
scheduled for promise-keeping.

<div class="node">
<a name="package_version-in-packages"></a>
<a name="package_005fversion-in-packages"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#package_005fselect-in-packages">package_select in packages</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#packages-in-agent-promises">packages in agent promises</a>

</div>

<h4 class="subsection">7.22.5 <code>package_version</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Version reference point for determining promised version

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">packages:

  "mypackage"

     package_policy => "add",
     package_method => rpm,
     package_select => "==",
     package_version => "1.2.3";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Used for specifying the targeted package version when the version is written
separately from the name of the command.

<div class="node">
<a name="processes-in-agent-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#services-in-agent-promises">services in agent promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#packages-in-agent-promises">packages in agent promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-agent">Bundles for agent</a>

</div>

<h3 class="section">7.23 <code>processes</code> promises in &lsquo;<samp><span class="samp">agent</span></samp>&rsquo;</h3>

<p><br>

   <p>Process promises refer to items in the system process table. Note that
this is not the same as commands (which are instructions that CFEngine will
execute). A process
is a command in some state of execution (with a Process Control
Block).  Promiser objects here are patterns that match line fragments
in the system process table (that is, the patterns are unanchored,
see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>). 
<i>Take care to note that process table formats differ between operating
systems, and the use of simple patterns such as program-names is recommended. 
For more sophisticated matches, users should use the </i><code>process_select</code><i>
feature.</i>  For example, on many systems, the process pattern <code>"^cp"</code>
may not match any processes, even though <code>"cp"</code> is running!  This is
because the process table entry may list <code>"/bin/cp"</code>.  However, the
process pattern <code>"cp"</code> will also match a process containing <code>"scp"</code>,
so take care not to oversimplify your patterns (the PCRE pattern anchors
<code>"\b"</code> and <code>"\B"</code> may prove very useful to you).

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
      processes:
     
        "<var>regex contained in process line</var>"
     
            process_select =&gt; <var>process_filter_body</var>,
            restart_class =&gt; "activation class for process",
            ..;
     
</pre>
   </td></tr></table>

   <p>In CFEngine 2 there was a restart clause for directly executing a
command to restart a process. In CFEngine 3 there is instead
a class to activate. You must then desribe a <code>command</code> in that
class to restart the process.

<pre class="verbatim">
commands:

  restart_me::

   "/path/executable" ... ;

</pre>
This rationalizes complex restart-commands and avoids unnecessary overlap
between <code>processes</code> and <code>commands</code>.

   <p>The <code>process_stop</code> is also arguably a command, but it should be
an ephemeral command that does not lead to a persistent process. It is
intended only for commands of the form &lsquo;<samp><span class="samp">/etc/inetd service stop</span></samp>&rsquo;, not
for processes that persist. Processes are restarted at the end of a bundle's
execution, but stop commands are executed immediately.

   <p>Note: <code>process_select</code> was previously called process <code>filters</code> in
CFEngine 2 and earlier.

   <p><br>

<pre class="verbatim">
bundle agent example
{
processes:

 ".*"

    process_count   => anyprocs,
    process_select  => proc_finder;

reports:

 any_procs::

   "Found processes out of range";
}

########################################################

body process_select proc_finder

{
# Processes started between 5.5 hours and 20 minutes ago
stime_range => irange(ago(0,0,0,5,30,0),ago(0,0,0,0,20,0));
process_result => "stime";
}

########################################################

body process_count anyprocs

{
match_range => "0,0";
out_of_range_define => { "any_procs" };
}

</pre>

   <p><br>

   <p>In CFEngine 3 we have

<pre class="smallexample">      processes
      commands
</pre>
   <p class="noindent">so that there is a clean separation between detection (promises
about the process table) and certain repairs (promises to execute
commands that start processes). Let's see why.

   <p>Executions are about jobs, services, scripts etc. They are properties
of an executable file. The referring `promiser' is a file
object. On the other hand a process is a property of a "process
identifier" which is a kernel instantiation, a quite different object
altogether. So it makes sense to say that

     <ul>
<li>A "PID" (which is not an executable) promises to be reminded of a signal, e.g.
     <pre class="smallexample">              kill signal pid
</pre>
     <li>An "command" promises to start or stop itself with a parameterized specification.
     <pre class="smallexample">              exec command argument1 argument2 ...
</pre>
     </ul>

   <p>Neither the file nor the pid necessarily promise to respond to these activations, but they
are nonetheless physically meaningful phenomena or attributes associated with these objects.

     <ul>
<li>Executable files do not listen for signals as they have no active state. 
<li>PIDs do not run themselves or stop themselves with new arguments, but they can use signals as they are running. 
</ul>

   <p>Executions lead to processes for the duration of their lifetime, so these two issues
are related, although the promises themselves are not.

   <p><br>
<b>Services verus processes</b>:
<br>

   <p>A service is an abstraction that requires processes to run and files
to be configured. It makes a lot of sense to wrap services in modular
bundles. Starting and stopping a service can be handled in at least two ways. 
Take the web service as an example.

   <p>We can start the service by promising an execution of a daemon (e.g. <code>httpd</code>). 
Normally this execution does not terminate without intervention. We can
terminate it in one of two ways:

     <ul>
<li>Using a process signal, by promising a signal to processes matching a certain pid search
<li>Using an execution of a termination command, e.g. &lsquo;<samp><span class="samp">/etc/init.d/apache stop</span></samp>&rsquo;. 
</ul>

   <p>The first case makes sense if we need to qualify the termination by
searching for the processes. The processes section of a CFEngine 3
policy includes a control promise to search for matching processes. 
If matches are found, signals can be sent to precisely each specific process.

   <p>Classes can also be defined, in principle triggering an execution of
the stop script, but then the class refers only to the presence of
matching pids, not to the individual pids concerned.  So it becomes
the responsibility of the execution to locate and interact with the
pids necessary.

   <p><br>
<b>Want it running?</b>:
<br>

   <p>How do we say simply that we want a service running? 
In the agent control promises, we could check each service
individually.
<pre class="verbatim">bundlesequence => { Update, Service("apache"), Service("nfsd") };
</pre>
or
<pre class="verbatim">bundlesequence => { Update, @(globals.all_services)  };
</pre>

   <p>The bundle for this can look like this:
<pre class="verbatim">bundle agent Service(service")
{
processes:

  "$(service)" 

      process_count => up("$(service)");

commands:

   "$daemons[$(service)]"  

      ifvarclass => "$(service)_up",
      args       => "$args[$(service)]";

}
</pre>

   <p>An alternative would be self-contained:

<pre class="verbatim">bundle agent Service
{
vars:

  "service" slist => { "apache", "nfsd", "bind" };

processes:

  "$(service)" 

      process_count => up("$(service)");

commands:

   "$daemons[$(service)]"  

      ifvarclass => "$(service)_up",
      args       => "$args[$(service)]";

}

######################
# Parameterized body
######################

body process_count up("$(s)")

{
match_range => "[0,10]";
out_of_range_define => "$(s)_up";
}

</pre>

<ul class="menu">
<li><a accesskey="1" href="#process_005fcount-in-processes">process_count in processes</a>
<li><a accesskey="2" href="#process_005fselect-in-processes">process_select in processes</a>
<li><a accesskey="3" href="#process_005fstop-in-processes">process_stop in processes</a>
<li><a accesskey="4" href="#restart_005fclass-in-processes">restart_class in processes</a>
<li><a accesskey="5" href="#signals-in-processes">signals in processes</a>
</ul>

<div class="node">
<a name="process_count-in-processes"></a>
<a name="process_005fcount-in-processes"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#process_005fselect-in-processes">process_select in processes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#processes-in-agent-promises">processes in agent promises</a>

</div>

<h4 class="subsection">7.23.1 <code>process_count</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>in_range_define</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: List of classes to define if the matches are in range

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body process_count example
     {
     in_range_define => { "class1", "class2" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Classes are defined if the processes that are found in the process table satisfy the
promised process count, i.e. if the promise about the number of processes matching
the other criteria is kept.

     <br><dt>&lsquo;<samp><code>match_range</code></samp>&rsquo;<dd><b>Type</b>: irange [int,int]

     <p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

     <p class="noindent"><b>Synopsis</b>: Integer range for acceptable number of matches for this process

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body process_count example
     {
     match_range => irange("10","50");
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This is a numerical range for the number of occurrences of the
process in the process table. As long as it falls within the specified
limits, the promise is considered kept.

     <br><dt>&lsquo;<samp><code>out_of_range_define</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: List of classes to define if the matches are out of range

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body process_count example(s)
     {
     out_of_range_define => { "process_anomaly", "anomaly_$(s)"};
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Classes to activate remedial promises conditional on this promise failure
to be kept.

   </dl>

<div class="node">
<a name="process_select-in-processes"></a>
<a name="process_005fselect-in-processes"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#process_005fstop-in-processes">process_stop in processes</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#process_005fcount-in-processes">process_count in processes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#processes-in-agent-promises">processes in agent promises</a>

</div>

<h4 class="subsection">7.23.2 <code>process_select</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>command</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: Regular expression matching the command/cmd field of a process

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body process_select example
     
     {
     command => "cf-.*";
     
     process_result => "command";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This expression should match the entire <code>COMMAND</code> field of the
process table (not just a fragment). This field is usually the last
field on the line and thus starts with the first non-space character
and ends with the end of line.

     <br><dt>&lsquo;<samp><code>pid</code></samp>&rsquo;<dd><b>Type</b>: irange [int,int]

     <p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

     <p class="noindent"><b>Synopsis</b>: Range of integers matching the process id of a process

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body process_select example
     {
     pid => irange("1","10");
     process_result => "pid";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <br><dt>&lsquo;<samp><code>pgid</code></samp>&rsquo;<dd><b>Type</b>: irange [int,int]

     <p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

     <p class="noindent"><b>Synopsis</b>: Range of integers matching the parent group id of a process

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body process_select example
     {
     pgid => irange("1","10");
     process_result => "pgid";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <br><dt>&lsquo;<samp><code>ppid</code></samp>&rsquo;<dd><b>Type</b>: irange [int,int]

     <p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

     <p class="noindent"><b>Synopsis</b>: Range of integers matching the parent process id of a process

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body process_select example
     {
     ppid => irange("407","511");
     process_result => "ppid";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <br><dt>&lsquo;<samp><code>priority</code></samp>&rsquo;<dd><b>Type</b>: irange [int,int]

     <p class="noindent"><b>Allowed input range</b>: <code>-20,+20</code>

     <p class="noindent"><b>Synopsis</b>: Range of integers matching the priority field (PRI/NI) of a process

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body process_select example
     {
     priority => irange("-5","0");
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <br><dt>&lsquo;<samp><code>process_owner</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: List of regexes matching the user of a process

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body process_select example
     {
     process_owner => { "wwwrun", "nobody" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Regular expression should match a legal user name on the system.  The regex
must match the entire name (that is, it is anchored,
see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>).

     <br><dt>&lsquo;<samp><code>process_result</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>[(process_owner|pid|ppid||pgid|rsize|vsize|status|command|ttime|stime|tty|priority|threads)[|&amp;!.]*]*</code>

     <p class="noindent"><b>Synopsis</b>: Boolean class expression returning the logical combination of classes set by a process selection test

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body process_select proc_finder(p)
     
     {
     process_owner  => { "avahi", "bin" };
     command        => "$(p)";
     pid            => irange("100","199");
     vsize          => irange("0","1000");
     process_result => "command.(process_owner|vsize).!pid";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>A logical combination of the process selection classifiers. The syntax
is the same as that for class expressions. There should be no spaces
in the expressions.

     <br><dt>&lsquo;<samp><code>rsize</code></samp>&rsquo;<dd><b>Type</b>: irange [int,int]

     <p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

     <p class="noindent"><b>Synopsis</b>: Range of integers matching the resident memory size of a process, in kilobytes

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body process_select
     {
     rsize => irange("4000","8000");
     }
     
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <br><dt>&lsquo;<samp><code>status</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: Regular expression matching the status field of a process

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body process_select example
     {
     status => "Z";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>For instance, characters in the set &lsquo;<samp><span class="samp">NRS&lt;sl+..</span></samp>&rsquo;. Windows
processes do not have status fields.

     <br><dt>&lsquo;<samp><code>stime_range</code></samp>&rsquo;<dd><b>Type</b>: irange [int,int]

     <p class="noindent"><b>Allowed input range</b>: <code>0,2147483647</code>

     <p class="noindent"><b>Synopsis</b>: Range of integers matching the start time of a process

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body process_select example
     {
     stime_range => irange(ago(0,0,0,1,0,0),now);
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The calculation of time from process table entries is sensitive to
Daylight Savings Time (Summer/Winter Time) so calculations could be a
hour off. This is for now a bug to be fixed.

     <br><dt>&lsquo;<samp><code>ttime_range</code></samp>&rsquo;<dd><b>Type</b>: irange [int,int]

     <p class="noindent"><b>Allowed input range</b>: <code>0,2147483647</code>

     <p class="noindent"><b>Synopsis</b>: Range of integers matching the total elapsed time of a process

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body process_select example
     {
     ttime_range => irange(0,accumulated(0,1,0,0,0,0));
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This is total accumulated time for a process.

     <br><dt>&lsquo;<samp><code>tty</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: Regular expression matching the tty field of a process

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body process_select example
     {
     tty => "pts/[0-9]+";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Windows processes are not regarded as attached to any terminal, so
they all have tty '?'.

     <br><dt>&lsquo;<samp><code>threads</code></samp>&rsquo;<dd><b>Type</b>: irange [int,int]

     <p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

     <p class="noindent"><b>Synopsis</b>: Range of integers matching the threads (NLWP) field of a process

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body process_select example
     {
     threads => irange(1,5);
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <br><dt>&lsquo;<samp><code>vsize</code></samp>&rsquo;<dd><b>Type</b>: irange [int,int]

     <p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

     <p class="noindent"><b>Synopsis</b>: Range of integers matching the virtual memory size of a process, in kilobytes

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body process_select example
     {
     vsize => irange("4000","9000");
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>On Windows, the virtual memory size is the amount of memory that
cannot be shared with other processes. In Task Manager, this is
called Commit Size (Windows 2008), or VM Size (Windows XP).

   </dl>

<div class="node">
<a name="process_stop-in-processes"></a>
<a name="process_005fstop-in-processes"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#restart_005fclass-in-processes">restart_class in processes</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#process_005fselect-in-processes">process_select in processes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#processes-in-agent-promises">processes in agent promises</a>

</div>

<h4 class="subsection">7.23.3 <code>process_stop</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>"?(/.*)</code>

<p class="noindent"><b>Synopsis</b>: A command used to stop a running process

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
processes:

 "snmpd"

        process_stop => "/etc/init.d/snmp stop";


</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>As an alternative to sending a termination or kill signal to a process,
one may call a `stop script' to perform a graceful shutdown.

<div class="node">
<a name="restart_class-in-processes"></a>
<a name="restart_005fclass-in-processes"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#signals-in-processes">signals in processes</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#process_005fstop-in-processes">process_stop in processes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#processes-in-agent-promises">processes in agent promises</a>

</div>

<h4 class="subsection">7.23.4 <code>restart_class</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: <code>[a-zA-Z0-9_$(){}\[\].:]+</code>

<p class="noindent"><b>Synopsis</b>: A class to be defined globally if the process is not running, so that a command: rule can be referred to restart the process

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
processes:

   "cf-serverd"

     restart_class => "start_cfserverd";

commands:

  start_cfserverd::

    "/var/cfengine/bin/cf-serverd";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This is a signal to restart a process that should be running, if it is
not running.  Processes are signalled first and then restarted later,
at the end of bundle execution, after all possible corrective actions have
been made that could influence their execution.

   <p>Windows does not support that processes start themselves in the
background, like Unix daemons usually do (i.e. fork off a child
process). Therefore, it may be useful to specify an action bodypart
that sets background to true in a commands promise that is invoked by
the class set by restart_class. See the commands promise type for more
information.

<div class="node">
<a name="signals-in-processes"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#restart_005fclass-in-processes">restart_class in processes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#processes-in-agent-promises">processes in agent promises</a>

</div>

<h4 class="subsection">7.23.5 <code>signals</code></h4>

<p class="noindent"><b>Type</b>: (option list)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>hup</code>
               <code>int</code>
               <code>trap</code>
               <code>kill</code>
               <code>pipe</code>
               <code>cont</code>
               <code>abrt</code>
               <code>stop</code>
               <code>quit</code>
               <code>term</code>
               <code>child</code>
               <code>usr1</code>
               <code>usr2</code>
               <code>bus</code>
               <code>segv</code>
</pre>
   <p class="noindent"><b>Synopsis</b>: A list of menu options representing signals to be sent to a process

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
processes:

 cfservd_out_of_control::

   "cfservd"

        signals         => { "stop" , "term" },
        restart_class   => "start_cfserv";

 any::

   "snmpd"

        signals         => { "term" , "kill" };
   
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Signals are presented as an ordered list to the process. On windows,
only the kill signal is supported, which terminates the process.

<div class="node">
<a name="services-in-agent-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#storage-in-agent-promises">storage in agent promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#processes-in-agent-promises">processes in agent promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-agent">Bundles for agent</a>

</div>

<h3 class="section">7.24 <code>services</code> promises in &lsquo;<samp><span class="samp">agent</span></samp>&rsquo;</h3>

<p><br>
A service is a set of zero or more processes. It can be zero if the
service is not currently running. Services run in the background, and
do not require user intervention.

   <p>Service promises may be viewed as an abstraction of process and
commands promises. An important distinguiser is however that a single
service may consist of multiple processes. Additionally, services are
registered in the operating system in some way, and gets a unique
name. Unlike processes and commands promises, this makes it possible
to use the same name both when it is running and not.

   <p>Some operating systems are bundled with a lot of unused services that
are running as default. At the same time, faulty or inherently
insecure services are often the cause of security issues.  With
CFEngine, one can create promises stating services that should be
stopped and disabled.

   <p>The operating system may start a service at boot time, or it can be
started by CFEngine. Either way, CFEngine will ensure that the service
maintains the correct state (started, stopped, or disabled). On some
operating systems, CFEngine also allows services to be started on
demand, i.e. when they are needed. This is implemented though the
<code>inetd</code> or <code>xinetd</code> daemon on Unix. Windows does not support
this.

   <p>CFEngine also allows for the concept of dependencies between
services, and can automatically start or stop these, if
desired. Parameters can be passed to services that are started by
CFEngine.

   <p><br>

<pre class="verbatim">
bundle agent example
{
services:

  "Dhcp"
    service_policy => "start",
    service_dependencies => { "Alerter", "W32Time" },
    service_method => winmethod;
}
 
########################################################

body service_method winmethod
{
  service_type => "windows";
  service_args => "--netmask=255.255.0.0";
  service_autostart_policy => "none";
  service_dependence_chain => "start_parent_services";
}

</pre>

   <p><br>

   <p>Services promises for Windows are only available in CFEngine Nova and
above. 
Windows Vista/Server 2008 and later introduced new complications to
the service security policy. Therefore, when testing <code>services</code>
promises from the command line, CFEngine may not be given proper
access rights, which gives errors like "Access is denied". However,
when running through the CFEngine Nova Executor service, typical for
on production machines, CFEngine has sufficent rights.

   <p>Services of type &lsquo;<samp><span class="samp">generic</span></samp>&rsquo; promises are implemented for all
operating systems and are merely as a convenient front-end to
<code>processes</code> and <code>commands</code>.  If nothing else is specified,
CFEngine looks for an special reserved agent bundle called

<pre class="verbatim">bundle agent standard_services(service,state)
{
...
}
</pre>

   <p>This bundle is called with two parameters: the name if the service and
a start/stop state variable. The CFEngine standard library defines
many common services for standard operating systems for convenience. 
If no <code>service_bundle</code> is defined in a <code>service_method</code>
body, then CFEngine assumes the &lsquo;<samp><span class="samp">standard_services</span></samp>&rsquo; bundle to be
the default source of action for the services. This is executed just
like a <code>methods</code> promise on the service bundle, so this is merely
a front-end.

   <p>The standard bundle can be replaced with another, as follows, e.g. for
testing purposes:

<pre class="verbatim">body common control
{
bundlesequence => { "test" };
}

#

bundle agent test
{
vars:

 "mail" slist => { "spamassassin", "postfix" };


services:

  "www" service_policy => "start",
        service_method => service_test;


  "$(mail)" service_policy => "stop",
        service_method => service_test;
}

#

body service_method service_test
{
service_bundle => non_standard_services("$(this.promiser)","$(this.service_policy)");
}

#

bundle agent non_standard_services(service,state)
{
reports:

  !done::

    "Test service promise for \"$(service)\" -> $(state)";
}
</pre>

   <p>Note that the special variables <code>$(this.promiser)</code> and
<code>$(this.service_policy)</code> may be used to fill in the service and
state parameters from the promise definition. The <code>$(this.service_policy)</code>
variable is only defined for services promises.

<ul class="menu">
<li><a accesskey="1" href="#service_005fpolicy-in-services">service_policy in services</a>
<li><a accesskey="2" href="#service_005fdependencies-in-services">service_dependencies in services</a>
<li><a accesskey="3" href="#service_005fmethod-in-services">service_method in services</a>
</ul>

<div class="node">
<a name="service_policy-in-services"></a>
<a name="service_005fpolicy-in-services"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#service_005fdependencies-in-services">service_dependencies in services</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#services-in-agent-promises">services in agent promises</a>

</div>

<h4 class="subsection">7.24.1 <code>service_policy</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>start</code>
               <code>stop</code>
               <code>disable</code>
               <code>restart</code>
               <code>reload</code>
</pre>
   <p class="noindent"><b>Synopsis</b>: Policy for cfengine service status

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
services:
  
  "Telnet"
     service_policy => "disable";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>If set to <code>start</code>, CFEngine Nova will keep the service in a running state,
while <code>stop</code> means that the service is kept in a stopped state. 
<code>disable</code> implies <code>stop</code>, and ensures that the service can not be
started directly, but needs to be enabled somehow first (e.g. by changing
file permissions).

<div class="node">
<a name="service_dependencies-in-services"></a>
<a name="service_005fdependencies-in-services"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#service_005fmethod-in-services">service_method in services</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#service_005fpolicy-in-services">service_policy in services</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#services-in-agent-promises">services in agent promises</a>

</div>

<h4 class="subsection">7.24.2 <code>service_dependencies</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: <code>[a-zA-Z0-9_$(){}\[\].:]+</code>

<p class="noindent"><b>Synopsis</b>: A list of services on which the named service abstraction depends

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
services:
  
  "ftp"
    service_policy => "start",
    service_dependencies => { "network", "logging" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>A list of services that must be running before the service can be started. 
These dependencies can be started automatically by CFEngine Nova if they
are not running &mdash; see <code>service_dependence_chain</code>. However, the
dependencies will never be implicitly stopped by CFEngine Nova. Specifying
dependencies is optional.

   <p>Note that the operating system may keep an additional list of dependencies
for a given service, defined during installation of the service. CFEngine
Nova requires these dependencies to be running as well before starting
the service. The complete list of dependencies is thus the union of
<code>service_dependencies</code> and the internal operating system list.

<div class="node">
<a name="service_method-in-services"></a>
<a name="service_005fmethod-in-services"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#service_005fdependencies-in-services">service_dependencies in services</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#services-in-agent-promises">services in agent promises</a>

</div>

<h4 class="subsection">7.24.3 <code>service_method</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>service_args</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: Parameters for starting the service as command

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body service_method example
     {
       service_args => "-f filename.conf --some-argument";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>These arguments will only be passed if CFEngine Nova starts the
service. Thus, set <code>service_autostart_policy</code> to <code>none</code>
to ensure that the arguments are always passed.

     <p>Escaped quoutes can be used to pass an argument contianing spaces
as a single argument, e.g. "-f \"file name.conf\"". Passing arguments
is optional.

     <br><dt>&lsquo;<samp><code>service_autostart_policy</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>none</code>
                    <code>boot_time</code>
                    <code>on_demand</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Should the service be started automatically by the OS

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body service_method example
     {
       service_autostart_policy => "boot_time";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Defaults to <code>none</code>, which means that the service is not
registered for automatic startup by the operating system in any
way. It must be <code>none</code> if <code>service_policy</code> is not
<code>start</code>. <code>boot_time</code> means the service is started at boot
time, while <code>on_demand</code> means that the service is dispatched once
it is being used.

     <p><code>on_demand</code> is not supported by Windows, and is implemented
through inetd or xinetd on Unix.

     <br><dt>&lsquo;<samp><code>service_bundle</code></samp>&rsquo;<dd><b>Type</b>: (ext bundle)
 (Separate Bundle)

     <br><dt>&lsquo;<samp><code>service_dependence_chain</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>ignore</code>
                    <code>start_parent_services</code>
                    <code>stop_child_services</code>
                    <code>all_related</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: How to handle dependencies and dependent services

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body service_method example
     {
       service_dependence_chain => "start_parent_services";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The service dependencies include both the dependencies defined by the
operating system and in <code>service_dependencies</code>, as described
there.

     <p>Defaults to <code>ignore</code>, which means that CFEngine Nova will never
start or stop dependencies or dependent services, but fail if
dependencies are not satisfied. <code>start_parent_services</code> means
that all dependencies of the service will be started if they are not
already running. When stopping a service, <code>stop_child_services</code>
means that other services that depend on this service will be stopped
also. <code>all_related</code> means both <code>start_parent_services</code> and
<code>stop_child_services</code>.

     <p>Note that this setting also affects dependencies of dependencies and
so on.

     <p>For example, consider the case where service A depends on B, which
depends on C. If we want to start B, we must first make sure A is
running. If <code>start_parent_services</code> or <code>all_related</code> is set,
CFEngine Nova will start A, if it is not running. On the other hand,
if we want to stop B, C needs to be stopped
first. <code>stop_child_services</code> or <code>all_related</code> means that
CFEngine Nova will stop C, if it is running.

     <br><dt>&lsquo;<samp><code>service_type</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>windows</code>
                    <code>generic</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Service abstraction type

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body service_method example
     {
       type => "windows";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>On Windows this defaults to, and must be <code>windows</code>. 
Unix systems can however have multiple means of registering
services, but the choice must be available on the given system.

   </dl>

<div class="node">
<a name="storage-in-agent-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#access-in-server-promises">access in server promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#services-in-agent-promises">services in agent promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-agent">Bundles for agent</a>

</div>

<h3 class="section">7.25 <code>storage</code> promises in &lsquo;<samp><span class="samp">agent</span></samp>&rsquo;</h3>

<p><br>

   <p>Storage promises refer to disks and filesystem properties.

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
      storage:
     
         "/<var>disk volume or mountpoint</var>"
     
           volume =&gt; <var>volume_body</var>,
           ...;
     
</pre>
   </td></tr></table>

   <p>In CFEngine 2, storage promises were divided into <code>disks</code> or
<code>required</code>, and <code>misc_mounts</code> types. The old mount-models
for binary and home servers has been deprecated and removed from
CFEngine 3. Users who use these models can reconstruct them from the
low-level tools.

   <p><br>

<pre class="verbatim">
bundle agent storage

{
storage:

  "/usr" volume  => mycheck("10%");
  "/mnt" mount   => nfs("nfsserv.example.org","/home");

}

#######################################################

body volume mycheck(free)   # reusable template

{
check_foreign  => "false";
freespace      => "$(free)";
sensible_size  => "10000";
sensible_count => "2";
}

body mount nfs(server,source)

{
mount_type => "nfs";
mount_source => "$(source)";
mount_server => "$(server)";
edit_fstab => "true";
}
</pre>

   <p><br>

<ul class="menu">
<li><a accesskey="1" href="#mount-in-storage">mount in storage</a>
<li><a accesskey="2" href="#volume-in-storage">volume in storage</a>
</ul>

<div class="node">
<a name="mount-in-storage"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#volume-in-storage">volume in storage</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#storage-in-agent-promises">storage in agent promises</a>

</div>

<h4 class="subsection">7.25.1 <code>mount</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>edit_fstab</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false add or remove entries to the file system table ("fstab")

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body mount example
     {
     edit_fstab => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The default behaviour is to not place edits in the file system table.

     <br><dt>&lsquo;<samp><code>mount_type</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>nfs</code>
                    <code>nfs2</code>
                    <code>nfs3</code>
                    <code>nfs4</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Protocol type of remote file system

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body mount example
     {
     mount_type => "nfs3";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This field is mainly for future extensions.

     <br><dt>&lsquo;<samp><code>mount_source</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>"?(/.*)</code>

     <p class="noindent"><b>Synopsis</b>: Path of remote file system to mount

     <p><b>Example</b>:<br>
<br>
<pre class="verbatim">     
     body mount example
     {
     mount_source "/location/disk/directory";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This is the location on the remote device, server, SAN etc.

     <br><dt>&lsquo;<samp><code>mount_server</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: Hostname or IP or remote file system server

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body mount example
     {
     mount_server => "nfs_host.example.org";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Hostname or IP address, this could be on a SAN.

     <br><dt>&lsquo;<samp><code>mount_options</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: List of option strings to add to the file system table ("fstab")

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     body mount example
     {
     mount_options => { "rw", "acls" };
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This list is concatenated in a form appropriate for the filesystem. The options must be
legal options for the system mount commands.

     <br><dt>&lsquo;<samp><code>unmount</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false unmount a previously mounted filesystem

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body mount example
     {
     unmount => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

   </dl>

<div class="node">
<a name="volume-in-storage"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#mount-in-storage">mount in storage</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#storage-in-agent-promises">storage in agent promises</a>

</div>

<h4 class="subsection">7.25.2 <code>volume</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>check_foreign</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false verify storage that is mounted from a foreign system on this host

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body volume example
     
     {
     #..
     check_foreign  => "false";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>CFEngine will not normally perform sanity checks on filesystems which
are not local to the host. If <code>true</code> it will ignore a partition's
network location and ask the current host to verify storage located
physically on other systems.

     <br><dt>&lsquo;<samp><code>freespace</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>[0-9]+[MBkKgGmb%]</code>

     <p class="noindent"><b>Synopsis</b>: Absolute or percentage minimum disk space that should be available before warning

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body volume example1
     {
     freespace => "10%";
     }
     
     body volume example2
     {
     freespace => "50M";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The amount of freespace that is promised on a storage device. Once
this promise is found not to be kept (that is, if the free space falls below
the promised value), warnings are generated.  You may also
want to use the results of this promise to control other promises,
See <a href="#classes-in-_002a">classes in *</a>.

     <br><dt>&lsquo;<samp><code>sensible_size</code></samp>&rsquo;<dd><b>Type</b>: int

     <p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

     <p class="noindent"><b>Synopsis</b>: Minimum size in bytes that should be used on a sensible-looking storage device

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body volume example
     {
     sensible_size => "20K";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <pre class="verbatim">     
     body volume control
     {
     sensible_size => "20K";
     }
     
</pre>

     <br><dt>&lsquo;<samp><code>sensible_count</code></samp>&rsquo;<dd><b>Type</b>: int

     <p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

     <p class="noindent"><b>Synopsis</b>: Minimum number of files that should be defined on a sensible-looking storage device

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body volume example
     {
     sensible_count => "20";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Files must be readable by the agent, i.e. it is assumed that the agent has privileges
on volumes being checked.

     <br><dt>&lsquo;<samp><code>scan_arrivals</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: true/false generate pseudo-periodic disk change arrival distribution

     <p class="noindent"><b>Default value:</b> false

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body volume example
     {
     scan_arrivals => "true";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This operation should not be left `on' for more than a single run
(maximum once per week).  It causes CFEngine to perform an extensive
disk scan noting the schedule of changes between files. This can be
used for a number of analyses including optimum backup schedule computation.

   </dl>
   <!-- ***************************************************** -->
<!-- * CHAPTER -->
<!-- ***************************************************** -->
<div class="node">
<a name="Bundles-for-server"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Bundles-for-knowledge">Bundles for knowledge</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Bundles-for-agent">Bundles for agent</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">8 Bundles of <code>server</code></h2>

<p><br>

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
     bundle server access_rules()
     
     {
     access:
     
       "/home/mark/PrivateFiles"
     
         admit   =&gt; { ".*\.example\.org" };
     
       "/home/mark/\.cfagent/bin/cf-agent"
     
         admit   =&gt; { ".*\.example\.org" };
     
     roles:
     
       ".*"  authorize =&gt; { "mark" };
     }
     
     
</pre>
   </td></tr></table>

   <p><br>

   <p>Bundles in the server describe access promises on specific file and class
objects supplied by the server to clients.

<ul class="menu">
<li><a accesskey="1" href="#classes-in-common-promises">classes in common promises</a>: <li><a accesskey="2" href="#defaults-in-common-promises">defaults in common promises</a>: <li><a accesskey="3" href="#meta-in-common-promises">meta in common promises</a>: <li><a accesskey="4" href="#reports-in-common-promises">reports in common promises</a>: <li><a accesskey="5" href="#vars-in-common-promises">vars in common promises</a>: <li><a accesskey="6" href="#Miscellaneous-in-common-promises">* in common promises</a>: <li><a accesskey="7" href="#commands-in-agent-promises">commands in agent promises</a>: <li><a accesskey="8" href="#databases-in-agent-promises">databases in agent promises</a>: <li><a accesskey="9" href="#guest_005fenvironments-in-agent-promises">guest_environments in agent promises</a>: <li><a href="#files-in-agent-promises">files in agent promises</a>: <li><a href="#Miscellaneous-in-edit_005fline-promises">* in edit_line promises</a>: <li><a href="#delete_005flines-in-edit_005fline-promises">delete_lines in edit_line promises</a>: <li><a href="#insert_005flines-in-edit_005fline-promises">insert_lines in edit_line promises</a>: <li><a href="#field_005fedits-in-edit_005fline-promises">field_edits in edit_line promises</a>: <li><a href="#replace_005fpatterns-in-edit_005fline-promises">replace_patterns in edit_line promises</a>: <li><a href="#Miscellaneous-in-edit_005fxml-promises">* in edit_xml promises</a>: <li><a href="#build_005fxpath-in-edit_005fxml-promises">build_xpath in edit_xml promises</a>: <li><a href="#delete_005ftree-in-edit_005fxml-promises">delete_tree in edit_xml promises</a>: <li><a href="#insert_005ftree-in-edit_005fxml-promises">insert_tree in edit_xml promises</a>: <li><a href="#delete_005fattribute-in-edit_005fxml-promises">delete_attribute in edit_xml promises</a>: <li><a href="#set_005fattribute-in-edit_005fxml-promises">set_attribute in edit_xml promises</a>: <li><a href="#delete_005ftext-in-edit_005fxml-promises">delete_text in edit_xml promises</a>: <li><a href="#set_005ftext-in-edit_005fxml-promises">set_text in edit_xml promises</a>: <li><a href="#insert_005ftext-in-edit_005fxml-promises">insert_text in edit_xml promises</a>: <li><a href="#interfaces-in-agent-promises">interfaces in agent promises</a>: <li><a href="#methods-in-agent-promises">methods in agent promises</a>: <li><a href="#outputs-in-agent-promises">outputs in agent promises</a>: <li><a href="#packages-in-agent-promises">packages in agent promises</a>: <li><a href="#processes-in-agent-promises">processes in agent promises</a>: <li><a href="#services-in-agent-promises">services in agent promises</a>: <li><a href="#storage-in-agent-promises">storage in agent promises</a>: <li><a href="#access-in-server-promises">access in server promises</a>: <li><a href="#roles-in-server-promises">roles in server promises</a>: <li><a href="#inferences-in-knowledge-promises">inferences in knowledge promises</a>: <li><a href="#things-in-knowledge-promises">things in knowledge promises</a>: <li><a href="#topics-in-knowledge-promises">topics in knowledge promises</a>: <li><a href="#occurrences-in-knowledge-promises">occurrences in knowledge promises</a>: <li><a href="#measurements-in-monitor-promises">measurements in monitor promises</a>: </ul>

<div class="node">
<a name="access-in-server-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#roles-in-server-promises">roles in server promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#storage-in-agent-promises">storage in agent promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-server">Bundles for server</a>

</div>

<h3 class="section">8.1 <code>access</code> promises in &lsquo;<samp><span class="samp">server</span></samp>&rsquo;</h3>

<p><br>

   <p>Access promises are conditional promises made by the server about file
objects. The promise has two consequences. For file copy requests, the
file becomes transferrable to the remote client according to the
conditions specified in the server promse (i.e. if the connection
encryption requirements are met, and if the client has been granted
appropriate privileges with <code>maproot</code> (like its NFS counterpart)
to be able to see file objects not owned by the server process owner).

   <p>The promise has two mutally exclusive attributes &lsquo;<samp><span class="samp">admit</span></samp>&rsquo; and
&lsquo;<samp><span class="samp">deny</span></samp>&rsquo;. Use of &lsquo;<samp><span class="samp">admit</span></samp>&rsquo; is preferred as mistakes and
omissions can easily be made when excluding from a group.

   <p>When access is granted to a directory, the promise is automatically
given about all of its contents and sub-directories. 
The access promise allows overlapping promises to be made, and these
are kept in a first-come-first-served fashion. Thus file
objects (promisers) should be listed in order of most-specific file
first. In this way, specific promises will override less specific ones.

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
      access:
     
         <var>"/path/file_object"</var>
     
           admit   =&gt; { <var>"hostname"</var>, <var>"ipv4_address"</var>, <var>"ipv6_address"</var>  };
     
     
</pre>
   </td></tr></table>

   <p><br>

   <p>Example:

<pre class="verbatim">
#########################################################
# Server config
#########################################################

body server control 

{
allowconnects         => { "127.0.0.1" , "::1" };
allowallconnects      => { "127.0.0.1" , "::1" };
trustkeysfrom         => { "127.0.0.1" , "::1" };
}

#########################################################

bundle server access_rules()

{
access:

  "/source/directory"
          comment => "Access to file transfer",
          admit   => { "127.0.0.1" };

  # Grant orchestration communication

  "did.*"
          comment => "Access to class context (enterprise)",
    resource_type => "context",
            admit => { "127.0.0.1" };


  "value of my test_scalar, can expand variables here - $(sys.host)"
          comment => "Grant access to the string in quotes, by name test_scalar",
           handle => "test_scalar",
    resource_type => "literal",
            admit => { "127.0.0.1" };

  "XYZ"
          comment => "Grant access to contents of persistent scalar variable XYZ",
    resource_type => "variable",
            admit => { "127.0.0.1" };

  # Client grants access to CFEngine hub access

  "delta"
    comment => "Grant access to cfengine hub to collect report deltas",
    resource_type => "query",
          admit   => { "127.0.0.1"  };
  "full"
          comment => "Grant access to cfengine hub to collect full report dump",
    resource_type => "query",
          admit   => { "127.0.0.1"  };

  policy_hub::

  "collect call"
          comment => "Grant access to cfengine client to request the collection of its reports",
    resource_type => "query",
          admit   => { "10.1.2.*" };


}

</pre>

   <p><br>

   <p>Entries may be literal addresses of IPv4 or IPv6, or any name registered
in the POSIX <code>gethostbyname</code> service.

<ul class="menu">
<li><a accesskey="1" href="#admit-in-access">admit in access</a>
<li><a accesskey="2" href="#deny-in-access">deny in access</a>
<li><a accesskey="3" href="#maproot-in-access">maproot in access</a>
<li><a accesskey="4" href="#ifencrypted-in-access">ifencrypted in access</a>
<li><a accesskey="5" href="#resource_005ftype-in-access">resource_type in access</a>
</ul>

<div class="node">
<a name="admit-in-access"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#deny-in-access">deny in access</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#access-in-server-promises">access in server promises</a>

</div>

<h4 class="subsection">8.1.1 <code>admit</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: List of host names or IP addresses to grant access to file objects

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">access:

  "/home/mark/LapTop"

    admit   => { "127.0.0.1", "192.168.0.1/24", ".*\.domain\.tld"  };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Admit promises grant access to file objects on the server. Arguments
may be IP addresses or hostnames, provided DNS name resolution is
active. In order to reach this stage, a client must first have passed
all of the standard connection tests in the control body.

   <p>The lists may contain network addresses in CIDR notation or regular
expressions to match the IP address or name of the connecting host.

<div class="node">
<a name="deny-in-access"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#maproot-in-access">maproot in access</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#admit-in-access">admit in access</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#access-in-server-promises">access in server promises</a>

</div>

<h4 class="subsection">8.1.2 <code>deny</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: List of host names or IP addresses to deny access to file objects

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle server access_rules()

{
access:

  "/path"

    admit   => { ".*\.example\.org" },
    deny    => { "badhost_1\.example\.org", "badhost_1\.example\.org" };
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Denial is for special exceptions. A better strategy is always to grant
on a need to know basis. A security policy based on exceptions is a
weak one.

   <p>Note that only regular expressions or exact matches are allowed in this
list, as non-specific matches are too greedy for denial.

<div class="node">
<a name="maproot-in-access"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#ifencrypted-in-access">ifencrypted in access</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#deny-in-access">deny in access</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#access-in-server-promises">access in server promises</a>

</div>

<h4 class="subsection">8.1.3 <code>maproot</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: List of host names or IP addresses to grant full read-privilege on the server

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
access:

 "/home"

       admit => { "backup_host.example.org" },
 ifencrypted => "true",

     # Backup needs to have access to all users

     maproot => { "backup_host.example.org" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Normally users authenticated by the server are granted access only to
files owned by them and no-one else. 
Even if the <code>cf-serverd</code> process runs with root privileges on the
server side of a client-server connection, the client is not automatically
granted access to download files owned by non-privileged users. If <code>maproot</code>
is true then remote <code>root</code> users are granted access to all files.

   <p>A typical case where mapping is important is in making backups of many
user files. On the Windows <code>cf-serverd</code>, <code>maproot</code> is
required to read files if the connecting user does not own the file on
the server.

<div class="node">
<a name="ifencrypted-in-access"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#resource_005ftype-in-access">resource_type in access</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#maproot-in-access">maproot in access</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#access-in-server-promises">access in server promises</a>

</div>

<h4 class="subsection">8.1.4 <code>ifencrypted</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>true</code>
               <code>false</code>
               <code>yes</code>
               <code>no</code>
               <code>on</code>
               <code>off</code>
</pre>
   <p class="noindent"><b>Default value:</b> false

<p class="noindent"><b>Synopsis</b>: true/false whether the current file access promise is conditional on the connection from the client being encrypted

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
access:

   "/path/file"

    admit     => { ".*\.example\.org" },
    ifencrypted => "true";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>If this flag is true a client cannot access the file object unless
its connection is encrypted.

<div class="node">
<a name="resource_type-in-access"></a>
<a name="resource_005ftype-in-access"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#ifencrypted-in-access">ifencrypted in access</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#access-in-server-promises">access in server promises</a>

</div>

<h4 class="subsection">8.1.5 <code>resource_type</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>path</code>
               <code>literal</code>
               <code>context</code>
               <code>query</code>
               <code>variable</code>
</pre>
   <p class="noindent"><b>Synopsis</b>: The type of object being granted access (the default grants access to files)

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">

bundle server access_rules()

{
access:

  "value of my test_scalar, can expand variables here - $(sys.host)"
    handle => "test_scalar",
    comment => "Grant access to contents of test_scalar VAR",
    resource_type => "literal",
    admit => { "127.0.0.1" };

  "XYZ"
    resource_type => "variable",
    handle => "XYZ",
    admit => { "127.0.0.1" };


  # On the policy hub

  "collect_calls"
     resource_type => "query",
           admit   => { "127.0.0.1" };

  # On the isolated client in the field


 "delta"
    comment => "Grant access to cfengine hub to collect report deltas",
    resource_type => "query",
          admit   => { "127.0.0.1"  };
  "full"
          comment => "Grant access to cfengine hub to collect full report dump",
    resource_type => "query",
          admit   => { "127.0.0.1"  };


}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>By default, access to resources granted by the server are
files. However, sometimes it is useful to cache <code>literal</code>
strings, hints and data in the server, e.g. the contents of variables,
hashed passwords etc for easy access. In the case of literal data, the
promise handle serves as the reference identifier for queries. Queries
are instigated by function calls by any agent.

   <p>If the resource type is <code>literal</code>, CFEngine will grant access to a
literal datastring. This string is defined either by the promiser
itself, but the name of the variable is the identifier given by the promise
handle of the access promise, since the promiser string might be complex.

   <p>If the resource type is <code>variable</code> then the promiser is the name
of a persistent scalar variable defined on the server-host.  Currently
persistent scalars are only used internally by Enterprise CFEngine to
hold enumerated classes for orchestration purposes.

   <p>If you want to send the value of a policy defined variable in the
server host (which for some reason is not available directly through
policy on the client, e.g. because they have differnet policies), then
you could use the construction

<pre class="verbatim">access:

  "$(variable_name)"

         handle => "variable_name",
  resource_type => "literal";
</pre>

   <p>If the resource type is <code>context</code>, the promiser is treated as a
regular expression to match persistent classes defined on the server
host. If these are matched by the request from the client, they will
be transmitted, See <a href="#Function-remoteclassesmatching">Function remoteclassesmatching</a>.

   <p>The term <code>query</code> may also be used in commercial versions of
CFEngine to query the server for data from embedded databases. This is
currently for internal use only, and is used to grant access to report
`menus'. If the promiser of a query request is called &lsquo;<samp><span class="samp">collect_calls</span></samp>&rsquo;,
this grants access to server peering collect-call tunneling, See <a href="#call_005fcollect_005finterval-in-server">call_collect_interval in server</a>.

<div class="node">
<a name="roles-in-server-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#inferences-in-knowledge-promises">inferences in knowledge promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#access-in-server-promises">access in server promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-server">Bundles for server</a>

</div>

<h3 class="section">8.2 <code>roles</code> promises in &lsquo;<samp><span class="samp">server</span></samp>&rsquo;</h3>

<p><br>

   <p>Roles promises are server-side decisions about which users are allowed
to define soft-classes on the server's system during remote invocation
of <code>cf-agent</code>. This implements a form of Role Based Access
Control (RBAC) for pre-assigned class-promise bindings. The user names
cited must be attached to trusted public keys in order to be accepted. 
The regular expression must match the entire name (that is, they are
anchored, see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>).

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
      roles:
     
        "<var>regex</var>"
     
           authorize =&gt; { "<var>usernames</var>", ... };
     
</pre>
   </td></tr></table>

   <p><i>It is worth re-iterating here that it is not possible to send
commands or modify promise definitions by remote access. At best users
may try to send classes when using </i><code>cf-runagent</code><i> in order to
activate sleeping promises. This mechanism limits their ability to
do this</i>.

   <p><br>

<pre class="verbatim">
bundle server access_rules()

{
roles:

  # Allow mark

  "Myclass_.*"  authorize => { "mark" };
}

</pre>

   <p><br>

   <p>In this example user &lsquo;<samp><span class="samp">mark</span></samp>&rsquo; is granted permission to remotely
activate classes matching the regular expression when &lsquo;<samp><span class="samp">Mark_.*</span></samp>&rsquo; using the
<code>cf-runagent</code> to activate CFEngine. In this way one can
implement a form of Role Based Access Control (RBAC), provided
users do not have privileged access on the host directly.

<ul class="menu">
<li><a accesskey="1" href="#authorize-in-roles">authorize in roles</a>
</ul>

<div class="node">
<a name="authorize-in-roles"></a>
<p><hr>
Up:&nbsp;<a rel="up" accesskey="u" href="#roles-in-server-promises">roles in server promises</a>

</div>

<h4 class="subsection">8.2.1 <code>authorize</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: List of public-key user names that are allowed to activate the promised class during remote agent activation

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
roles:

  ".*"  authorize => { "mark", "marks_friend" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Part of Role Based Access Control (RBAC) in CFEngine. The users listed
in this section are granted access to set certain classes by using the
remote <code>cf-runagent</code>. The user-names will refer to public key
identities already trusted on the system.

<!-- ***************************************************** -->
<!-- * CHAPTER -->
<!-- ***************************************************** -->
<div class="node">
<a name="Bundles-for-knowledge"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Bundles-for-monitor">Bundles for monitor</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Bundles-for-server">Bundles for server</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">9 Bundles of <code>knowledge</code></h2>

<p><br>

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
     bundle knowledge system
     
     {
     topics:
     
      Troubleshooting::
     
       "Segmentation fault"
            association =&gt; a("is caused by","Bad memory reference","can cause");
     
       "Remote connection problem";
       "Web server not running";
       "Print server not running";
       "Bad memory reference";
     }
     
</pre>
   </td></tr></table>

   <p><br>

   <p>Knowledge bundles describe topic maps, i.e. Topics, Associations and
Occurrences (of topics in documents). This is for knowledge modelling
and has no functional effect on a system.

<ul class="menu">
<li><a accesskey="1" href="#classes-in-common-promises">classes in common promises</a>: <li><a accesskey="2" href="#defaults-in-common-promises">defaults in common promises</a>: <li><a accesskey="3" href="#meta-in-common-promises">meta in common promises</a>: <li><a accesskey="4" href="#reports-in-common-promises">reports in common promises</a>: <li><a accesskey="5" href="#vars-in-common-promises">vars in common promises</a>: <li><a accesskey="6" href="#Miscellaneous-in-common-promises">* in common promises</a>: <li><a accesskey="7" href="#commands-in-agent-promises">commands in agent promises</a>: <li><a accesskey="8" href="#databases-in-agent-promises">databases in agent promises</a>: <li><a accesskey="9" href="#guest_005fenvironments-in-agent-promises">guest_environments in agent promises</a>: <li><a href="#files-in-agent-promises">files in agent promises</a>: <li><a href="#Miscellaneous-in-edit_005fline-promises">* in edit_line promises</a>: <li><a href="#delete_005flines-in-edit_005fline-promises">delete_lines in edit_line promises</a>: <li><a href="#insert_005flines-in-edit_005fline-promises">insert_lines in edit_line promises</a>: <li><a href="#field_005fedits-in-edit_005fline-promises">field_edits in edit_line promises</a>: <li><a href="#replace_005fpatterns-in-edit_005fline-promises">replace_patterns in edit_line promises</a>: <li><a href="#Miscellaneous-in-edit_005fxml-promises">* in edit_xml promises</a>: <li><a href="#build_005fxpath-in-edit_005fxml-promises">build_xpath in edit_xml promises</a>: <li><a href="#delete_005ftree-in-edit_005fxml-promises">delete_tree in edit_xml promises</a>: <li><a href="#insert_005ftree-in-edit_005fxml-promises">insert_tree in edit_xml promises</a>: <li><a href="#delete_005fattribute-in-edit_005fxml-promises">delete_attribute in edit_xml promises</a>: <li><a href="#set_005fattribute-in-edit_005fxml-promises">set_attribute in edit_xml promises</a>: <li><a href="#delete_005ftext-in-edit_005fxml-promises">delete_text in edit_xml promises</a>: <li><a href="#set_005ftext-in-edit_005fxml-promises">set_text in edit_xml promises</a>: <li><a href="#insert_005ftext-in-edit_005fxml-promises">insert_text in edit_xml promises</a>: <li><a href="#interfaces-in-agent-promises">interfaces in agent promises</a>: <li><a href="#methods-in-agent-promises">methods in agent promises</a>: <li><a href="#outputs-in-agent-promises">outputs in agent promises</a>: <li><a href="#packages-in-agent-promises">packages in agent promises</a>: <li><a href="#processes-in-agent-promises">processes in agent promises</a>: <li><a href="#services-in-agent-promises">services in agent promises</a>: <li><a href="#storage-in-agent-promises">storage in agent promises</a>: <li><a href="#access-in-server-promises">access in server promises</a>: <li><a href="#roles-in-server-promises">roles in server promises</a>: <li><a href="#inferences-in-knowledge-promises">inferences in knowledge promises</a>: <li><a href="#things-in-knowledge-promises">things in knowledge promises</a>: <li><a href="#topics-in-knowledge-promises">topics in knowledge promises</a>: <li><a href="#occurrences-in-knowledge-promises">occurrences in knowledge promises</a>: <li><a href="#measurements-in-monitor-promises">measurements in monitor promises</a>: </ul>

<div class="node">
<a name="inferences-in-knowledge-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#things-in-knowledge-promises">things in knowledge promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#roles-in-server-promises">roles in server promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-knowledge">Bundles for knowledge</a>

</div>

<h3 class="section">9.1 <code>inferences</code> promises in &lsquo;<samp><span class="samp">knowledge</span></samp>&rsquo;</h3>

<p><br>

   <p><br>

<pre class="verbatim">inferences:

  "is close to" 
           comment => "Cluster property",
         precedent => { "is close to" },
         qualifier => { "is close to" };

  "is far from" 
           comment => "Remote cluster property",
         precedent => { "is far from" },
         qualifier => { "is close to" };

</pre>

   <p><br>

   <p><i>History</i>: Was introduced in version 3.1.0

   <p>Inference promises are used to perform simple contextual reasoning in
the knowledge map.  This feature is currently only supported in
commercial versions of CFEngine as it is developed.

   <p>The promiser of an inference promise is the <i>result</i> of the
inference, i.e. the conclusion to be drawn from combining two
knowledge assertions. The body specifies what existing associations
must be in place between topics in order to draw the conclusion
between the start and the end.

<pre class="smallexample">     
                 precedent                 qualifier
       TOPIC 1 --------------&gt; TOPIC 2 ---------------&gt; TOPIC 3
     
                         promised inference
       TOPIC 1 ---------------------------------------&gt; TOPIC 3
     
</pre>
   <p>For example,
<pre class="smallexample">     
              is mother to          is married to
       ALICE --------------&gt; BOB -----------------&gt; CAROL
     
                     is mother in law to
       ALICE ---------------------------------------&gt; CAROL
     
</pre>
   <p>Note that, like all promises, they are expected to be unique. Multiple promisers
promising different bodies is potentially inconsistent. However, inference is inherently
ambiguous and we need to accomodate multiple patterns. To this end, lists of regular expressions
may be used to match multiple instances.

<ul class="menu">
<li><a accesskey="1" href="#precedents-in-inferences">precedents in inferences</a>
<li><a accesskey="2" href="#qualifiers-in-inferences">qualifiers in inferences</a>
</ul>

<div class="node">
<a name="precedents-in-inferences"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#qualifiers-in-inferences">qualifiers in inferences</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#inferences-in-knowledge-promises">inferences in knowledge promises</a>

</div>

<h4 class="subsection">9.1.1 <code>precedents</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: The foundational vector for a trinary inference

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">inferences:

  "is far from" 
           comment => "Remote cluster property",
         precedent => { "is far from"},
         qualifier => { "is close to", "is far from" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.1.0b3,Nova 2.0.0b1 (2010)

   <p>A general regular expression may be used to match suitable alternatives, so as to make the
promise unique.

<div class="node">
<a name="qualifiers-in-inferences"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#precedents-in-inferences">precedents in inferences</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#inferences-in-knowledge-promises">inferences in knowledge promises</a>

</div>

<h4 class="subsection">9.1.2 <code>qualifiers</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: The second vector in a trinary inference

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">inferences:

  "is far from" 
           comment => "Remote cluster property",
         precedent => { "is far from" },
         qualifier => { "is close to|is far from" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.1.0 (2010)

   <p>A general regular expression may be used to match suitable alternatives, so as to make the
promise unique.

<div class="node">
<a name="things-in-knowledge-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#topics-in-knowledge-promises">topics in knowledge promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#inferences-in-knowledge-promises">inferences in knowledge promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-knowledge">Bundles for knowledge</a>

</div>

<h3 class="section">9.2 <code>things</code> promises in &lsquo;<samp><span class="samp">knowledge</span></samp>&rsquo;</h3>

<p><br>

   <p><i>History</i>: Was introduced in version 3.2, Nova 2.1 (2011)

   <p>Things are a special subset of topics that behave like objects in the
world.  We have separated out things from more abstract topics to make
it easier to talk about the. Things are typically objects we make
inventories of, that influence one another and might be connected. We interact
with things in IT management much more concretely than we do with abstract
topics.

   <p>To make it simpler to talk about things, we there introduce <code>things</code> promises.

   <p><br>

<pre class="verbatim">
body knowledge TheRealWorld
{
things:

  networks::

     "10.20.30.40"  is_connected_to => { "router 46", "computers::computer 23" };

  computers::

     "computer 23" belongs_to => { "Phileas Phogg", "ACME punchcard agency" };

}
</pre>

   <p><br>

   <p>Things promises are in every way equivalent to the more general topics
promises. Things can be extended as topics. The contexts are
interchangeable between things and topics.  The only purpose of things
is to make plainer a description of the `physical' configurations of
regular worldly things.

<ul class="menu">
<li><a accesskey="1" href="#synonyms-in-things">synonyms in things</a>
<li><a accesskey="2" href="#affects-in-things">affects in things</a>
<li><a accesskey="3" href="#belongs_005fto-in-things">belongs_to in things</a>
<li><a accesskey="4" href="#causes-in-things">causes in things</a>
<li><a accesskey="5" href="#certainty-in-things">certainty in things</a>
<li><a accesskey="6" href="#determines-in-things">determines in things</a>
<li><a accesskey="7" href="#generalizations-in-things">generalizations in things</a>
<li><a accesskey="8" href="#implements-in-things">implements in things</a>
<li><a accesskey="9" href="#involves-in-things">involves in things</a>
<li><a href="#is_005fcaused_005fby-in-things">is_caused_by in things</a>
<li><a href="#is_005fconnected_005fto-in-things">is_connected_to in things</a>
<li><a href="#is_005fdetermined_005fby-in-things">is_determined_by in things</a>
<li><a href="#is_005ffollowed_005fby-in-things">is_followed_by in things</a>
<li><a href="#is_005fimplemented_005fby-in-things">is_implemented_by in things</a>
<li><a href="#is_005flocated_005fin-in-things">is_located_in in things</a>
<li><a href="#is_005fmeasured_005fby-in-things">is_measured_by in things</a>
<li><a href="#is_005fpart_005fof-in-things">is_part_of in things</a>
<li><a href="#is_005fpreceded_005fby-in-things">is_preceded_by in things</a>
<li><a href="#measures-in-things">measures in things</a>
<li><a href="#needs-in-things">needs in things</a>
<li><a href="#provides-in-things">provides in things</a>
<li><a href="#uses-in-things">uses in things</a>
</ul>

<div class="node">
<a name="synonyms-in-things"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#affects-in-things">affects in things</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#things-in-knowledge-promises">things in knowledge promises</a>

</div>

<h4 class="subsection">9.2.1 <code>synonyms</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: A list of words to be treated as equivalents in the defined context

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
 mathematics::

   "tree" synonyms => { "DAG", "directed acyclic graph" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.1.3a1,Nova 2.0.2a1 (2010)

   <p>This may be used to simplify the identification of synonyms during topic searches.

<div class="node">
<a name="affects-in-things"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#belongs_005fto-in-things">belongs_to in things</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#synonyms-in-things">synonyms in things</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#things-in-knowledge-promises">things in knowledge promises</a>

</div>

<h4 class="subsection">9.2.2 <code>affects</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Special fixed relation for describing topics that are things

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">things:

   "The Moon"   affects => {  "surf", "tides" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>
<i>History</i>: Was introduced in version 3.2, Nova 2.1 (2011)

<div class="node">
<a name="belongs_to-in-things"></a>
<a name="belongs_005fto-in-things"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#causes-in-things">causes in things</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#affects-in-things">affects in things</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#things-in-knowledge-promises">things in knowledge promises</a>

</div>

<h4 class="subsection">9.2.3 <code>belongs_to</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Special fixed relation for describing topics that are things

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
things:

  "router-123" 

           comment => "Located at 23 Marlborough Street",
        belongs_to => { "company::cfengine" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.2, Nova 2.1 (2011)

<div class="node">
<a name="causes-in-things"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#certainty-in-things">certainty in things</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#belongs_005fto-in-things">belongs_to in things</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#things-in-knowledge-promises">things in knowledge promises</a>

</div>

<h4 class="subsection">9.2.4 <code>causes</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Special fixed relation for describing topics that are things

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">bundle knowledge test
{
things:

  "program crash" causes => { "rootprocs_low_anomaly" },
                     certainty => "possible";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.2.0, Nova 2.1.0 (2011)

   <p>The complement of `is_caused_by' for convenience.

<div class="node">
<a name="certainty-in-things"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#determines-in-things">determines in things</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#causes-in-things">causes in things</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#things-in-knowledge-promises">things in knowledge promises</a>

</div>

<h4 class="subsection">9.2.5 <code>certainty</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>certain</code>
               <code>uncertain</code>
               <code>possible</code>
</pre>
   <p class="noindent"><b>Synopsis</b>: Selects the level of certainty for the proposed knowledge, for use in inferential reasoning

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">bundle knowledge test
{
things:

  "router one" is_connected_to => { "computer one" },
                     certainty => "uncertain";

  "router"             affects => { "network services" },
                     certainty => "possible";
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.1.5, Nova 2.1 (2011)

   <p>Certainty is used in automated reasoning about knowledge. It modifies
the relationships between things. For example, the certain
relationship `is affected by' would become `can be affected by'
(possible) or `might be affected by' (uncertain).

<div class="node">
<a name="determines-in-things"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#generalizations-in-things">generalizations in things</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#certainty-in-things">certainty in things</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#things-in-knowledge-promises">things in knowledge promises</a>

</div>

<h4 class="subsection">9.2.6 <code>determines</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Special fixed relation for describing topics that are things

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">things:

  "router one" determines => { "network connectivity" },
                certainty => "uncertain";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.1.5, Nova 2.1 (2011)

<div class="node">
<a name="generalizations-in-things"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#implements-in-things">implements in things</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#determines-in-things">determines in things</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#things-in-knowledge-promises">things in knowledge promises</a>

</div>

<h4 class="subsection">9.2.7 <code>generalizations</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: A list of words to be treated as super-sets for the current topic, used when reasoning

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
 topics:

  persons::

     "mark"  generalizations => { "person", "staff", "human being" };

  any::

     "10.10.10.10/24" generalizations => { "network", "CIDR format" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.2, Nova 2.1 (2011)

   <p>Generalizations are ways of thinking about topics in more general terms. They are somewhat like
container `types' or `classes' in hierarchical modelling, but they need not be mutually
exclusive categories.

   <p>Generalizations may be used in topic-lifting, a kind of brain-storming
about issues, when searching for diagnostic explanations.

<div class="node">
<a name="implements-in-things"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#involves-in-things">involves in things</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#generalizations-in-things">generalizations in things</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#things-in-knowledge-promises">things in knowledge promises</a>

</div>

<h4 class="subsection">9.2.8 <code>implements</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Special fixed relation for describing topics that are things

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">things:

   "my promise"  
              implements => { "my goal" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in 3.4.0

<div class="node">
<a name="involves-in-things"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#is_005fcaused_005fby-in-things">is_caused_by in things</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#implements-in-things">implements in things</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#things-in-knowledge-promises">things in knowledge promises</a>

</div>

<h4 class="subsection">9.2.9 <code>involves</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Special fixed relation for describing topics that are things

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">things:

   "desired state"

      involves => { 
                  "business goals", 
                  "knowing what state to configure", 
                  "knowing what objects to maintain" 
                  };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in 3.3.0, Nova 2.2.0 (2012)

<div class="node">
<a name="is_caused_by-in-things"></a>
<a name="is_005fcaused_005fby-in-things"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#is_005fconnected_005fto-in-things">is_connected_to in things</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#involves-in-things">involves in things</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#things-in-knowledge-promises">things in knowledge promises</a>

</div>

<h4 class="subsection">9.2.10 <code>is_caused_by</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Special fixed relation for describing topics that are things

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">bundle knowledge test
{
things:

  "core dump" is_caused_by => { "memory fault" },
                     certainty => "certain";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.2.0, Nova 2.1.0 (2011)

   <p>The complement of `causes' for convenience of expression.

<div class="node">
<a name="is_connected_to-in-things"></a>
<a name="is_005fconnected_005fto-in-things"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#is_005fdetermined_005fby-in-things">is_determined_by in things</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#is_005fcaused_005fby-in-things">is_caused_by in things</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#things-in-knowledge-promises">things in knowledge promises</a>

</div>

<h4 class="subsection">9.2.11 <code>is_connected_to</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Special fixed relation for describing topics that are things

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">things:

 networks::

  "192.23.45.0/24"         comment => "Secure network, zone 0. Single octet for corporate offices",
                   is_connected_to => { "oslo-hub-123" };

  "192.12.74.0/23"         comment => "Zone 1, double octet for the London office developer network",
                   is_connected_to => { "oslo-hub-123" };

  "192.12.74.0/23"         comment => "Secure, single octet for the NYC office",
                   is_connected_to => { "nyc-hub-456" };


</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.1.5, Nova 2.1.0 (2011)

<div class="node">
<a name="is_determined_by-in-things"></a>
<a name="is_005fdetermined_005fby-in-things"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#is_005ffollowed_005fby-in-things">is_followed_by in things</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#is_005fconnected_005fto-in-things">is_connected_to in things</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#things-in-knowledge-promises">things in knowledge promises</a>

</div>

<h4 class="subsection">9.2.12 <code>is_determined_by</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Special fixed relation for describing topics that are things

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
things:

  "why" is_determined_by => { "bodyparts::comment", "Semantic commentary" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in 3.3.0, Nova 2.2.0 (2012)

   <p>This is the inverse of <code>determines</code>.

<div class="node">
<a name="is_followed_by-in-things"></a>
<a name="is_005ffollowed_005fby-in-things"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#is_005fimplemented_005fby-in-things">is_implemented_by in things</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#is_005fdetermined_005fby-in-things">is_determined_by in things</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#things-in-knowledge-promises">things in knowledge promises</a>

</div>

<h4 class="subsection">9.2.13 <code>is_followed_by</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Special fixed relation for describing topics that are things

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">things:

  "Installing CFEngine"

    is_followed_by => { "bootstrapping", "policy editing" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in 3.3.0, Nova 2.2.0 (2012)

<div class="node">
<a name="is_implemented_by-in-things"></a>
<a name="is_005fimplemented_005fby-in-things"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#is_005flocated_005fin-in-things">is_located_in in things</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#is_005ffollowed_005fby-in-things">is_followed_by in things</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#things-in-knowledge-promises">things in knowledge promises</a>

</div>

<h4 class="subsection">9.2.14 <code>is_implemented_by</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Special fixed relation for describing topics that are things

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">things:

   "my goal"  
              is_implemented_by => { "my promise" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in 3.4.0

<div class="node">
<a name="is_located_in-in-things"></a>
<a name="is_005flocated_005fin-in-things"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#is_005fmeasured_005fby-in-things">is_measured_by in things</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#is_005fimplemented_005fby-in-things">is_implemented_by in things</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#things-in-knowledge-promises">things in knowledge promises</a>

</div>

<h4 class="subsection">9.2.15 <code>is_located_in</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Special fixed relation for describing topics that are things

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">things:

 countries::

   "UK"                 synonyms => { "Great Britain" },
                   is_located_in => { "EMEA", "Europe" };

   "Singapore"     is_located_in => { "APAC", "Asia" };


</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.2, Nova 2.1 (2011)

<div class="node">
<a name="is_measured_by-in-things"></a>
<a name="is_005fmeasured_005fby-in-things"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#is_005fpart_005fof-in-things">is_part_of in things</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#is_005flocated_005fin-in-things">is_located_in in things</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#things-in-knowledge-promises">things in knowledge promises</a>

</div>

<h4 class="subsection">9.2.16 <code>is_measured_by</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Special fixed relation for describing topics that are things

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">things:

 service_measurements::

  "login services" is_measured_by => { "ssh_in" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>
<i>History</i>: Was introduced in 3.4.0, Enterprise 3.0

<div class="node">
<a name="is_part_of-in-things"></a>
<a name="is_005fpart_005fof-in-things"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#is_005fpreceded_005fby-in-things">is_preceded_by in things</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#is_005fmeasured_005fby-in-things">is_measured_by in things</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#things-in-knowledge-promises">things in knowledge promises</a>

</div>

<h4 class="subsection">9.2.17 <code>is_part_of</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Special fixed relation for describing topics that are things

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">things:

  "host 1" is_part_of => { "123.456.789.0/24" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.1.5, Nova 2.1 (2011)

<div class="node">
<a name="is_preceded_by-in-things"></a>
<a name="is_005fpreceded_005fby-in-things"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#measures-in-things">measures in things</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#is_005fpart_005fof-in-things">is_part_of in things</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#things-in-knowledge-promises">things in knowledge promises</a>

</div>

<h4 class="subsection">9.2.18 <code>is_preceded_by</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Special fixed relation for describing topics that are things

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
things:

  "disk failure"

    is_preceded_by => { "write errors", "read errors" },
         certainty => "possible";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in 3.3.0, Nova 2.2.0 (2012)

<div class="node">
<a name="measures-in-things"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#needs-in-things">needs in things</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#is_005fpreceded_005fby-in-things">is_preceded_by in things</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#things-in-knowledge-promises">things in knowledge promises</a>

</div>

<h4 class="subsection">9.2.19 <code>measures</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Special fixed relation for describing topics that are things

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">things:

 service_measurements::

  "ssh_in"     measures => { "services::login services" },
               measures => { "ssh" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in 3.4.0, Enterprise 3.0

<div class="node">
<a name="needs-in-things"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#provides-in-things">provides in things</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#measures-in-things">measures in things</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#things-in-knowledge-promises">things in knowledge promises</a>

</div>

<h4 class="subsection">9.2.20 <code>needs</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Special fixed relation for describing topics that are things

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">things:

  "rack 123"     needs => { "power", "cooling" };

  "computer"     needs => { "cleaning", "monitoring" },
             certainty => "possible";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.1.5, Nova 2.1 (2011)

<div class="node">
<a name="provides-in-things"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#uses-in-things">uses in things</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#needs-in-things">needs in things</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#things-in-knowledge-promises">things in knowledge promises</a>

</div>

<h4 class="subsection">9.2.21 <code>provides</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Special fixed relation for describing topics that are things

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
things:

   "host 23" provides => { "www", "email" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.2, Nova 2.1 (2011)

<div class="node">
<a name="uses-in-things"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#provides-in-things">provides in things</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#things-in-knowledge-promises">things in knowledge promises</a>

</div>

<h4 class="subsection">9.2.22 <code>uses</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: Special fixed relation for describing topics that are things

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
things:

  "apache 2.3" uses => { "mysql 4.5" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.2, Nova 2.1 (2011)

<div class="node">
<a name="topics-in-knowledge-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#occurrences-in-knowledge-promises">occurrences in knowledge promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#things-in-knowledge-promises">things in knowledge promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-knowledge">Bundles for knowledge</a>

</div>

<h3 class="section">9.3 <code>topics</code> promises in &lsquo;<samp><span class="samp">knowledge</span></samp>&rsquo;</h3>

<p><br>

   <p>Topic promises are part of the knowledge management engine. A topic is
any string that refers to a concept or subject that we wish to include
in a knowledge base. If a topic has a very long name, it is best to made the
promiser object a short name and use the <code>comment</code> field
to add the long explanation (e.g. unique acronym and full text).

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
      topics:
     
       "<var>topic string</var>"
     
        comment =&gt; "<var>long name..</var>",
        ...;
     
</pre>
   </td></tr></table>

   <p>Topics form associative structures based entirely on an abstract space
of natural language. Actually, this is only slightly more abstract
than files, processes and commands etc. The main difference in
knowledge management is that there are no corrective or maintenance
operations associated with knowledge promises.

   <p>Class membership in knowledge management is subtly different from
other parts of CFEngine. If a topic lies in a certain class context,
the topic uses it as a type-label. This is used for disambiguation of
subject-area in searches rather than for disambiguation of rules between
physical environments.

   <p><br>

<pre class="verbatim">
bundle knowledge example
{
topics:

   "Distro"
      comment     => "Distribution of linux",              
      association => a("is a packaging of","Linux","is packaged as a");
}

</pre>

   <p><br>

   <p>Topics are basically identifiers, where the comment field here is a
long form of the subject string. Associations form semantic links
between topics. Topics can appear multiple times in order to form
multiple associations.

<ul class="menu">
<li><a accesskey="1" href="#association-in-topics">association in topics</a>
<li><a accesskey="2" href="#synonyms-in-topics">synonyms in topics</a>
<li><a accesskey="3" href="#generalizations-in-topics">generalizations in topics</a>
</ul>

<div class="node">
<a name="association-in-topics"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#synonyms-in-topics">synonyms in topics</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#topics-in-knowledge-promises">topics in knowledge promises</a>

</div>

<h4 class="subsection">9.3.1 <code>association</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>forward_relationship</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: Name of forward association between promiser topic and associates

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body association example
     {
     forward_relation => "is bigger than";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <br><dt>&lsquo;<samp><code>backward_relationship</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: Name of backward/inverse association from associates to promiser topic

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     body association example
     {
     # ..
     backward_relationship => "is less than";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>Denotes the inverse name which is used to `moralizing' the association graph.

     <br><dt>&lsquo;<samp><code>associates</code></samp>&rsquo;<dd><b>Type</b>: slist

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: List of associated topics by this forward relationship

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body association example(literal,scalar,list)
     
     {
     #...
     associates => { "literal", $(scalar),  @(list)};
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>An element of an association which is a list of topics to which the
current topic is associated.

   </dl>

<div class="node">
<a name="synonyms-in-topics"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#generalizations-in-topics">generalizations in topics</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#association-in-topics">association in topics</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#topics-in-knowledge-promises">topics in knowledge promises</a>

</div>

<h4 class="subsection">9.3.2 <code>synonyms</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: A list of words to be treated as equivalents in the defined context

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
 mathematics::

   "tree" synonyms => { "DAG", "directed acyclic graph" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.1.3a1,Nova 2.0.2a1 (2010)

   <p>This may be used to simplify the identification of synonyms during topic searches.

<div class="node">
<a name="generalizations-in-topics"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#synonyms-in-topics">synonyms in topics</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#topics-in-knowledge-promises">topics in knowledge promises</a>

</div>

<h4 class="subsection">9.3.3 <code>generalizations</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: A list of words to be treated as super-sets for the current topic, used when reasoning

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
 topics:

  persons::

     "mark"  generalizations => { "person", "staff", "human being" };

  any::

     "10.10.10.10/24" generalizations => { "network", "CIDR format" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.2, Nova 2.1 (2011)

   <p>Generalizations are ways of thinking about topics in more general terms. They are somewhat like
container `types' or `classes' in hierarchical modelling, but they need not be mutually
exclusive categories.

   <p>Generalizations may be used in topic-lifting, a kind of brain-storming
about issues, when searching for diagnostic explanations.

<div class="node">
<a name="occurrences-in-knowledge-promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#measurements-in-monitor-promises">measurements in monitor promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#topics-in-knowledge-promises">topics in knowledge promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-knowledge">Bundles for knowledge</a>

</div>

<h3 class="section">9.4 <code>occurrences</code> promises in &lsquo;<samp><span class="samp">knowledge</span></samp>&rsquo;</h3>

<p><br>

   <p>Occurrences are documents or information resources that discuss
topics. An occurrence promise asserts that a particular document of
text resource in fact represents information about one or more topics. 
This is used to construct references to actual information in a topic
map.

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     
      occurrences:
     
        <var>topic_name</var>::
     
          "<var>URL reference or literal string</var>"
     
              represents =&gt; { "<var>sub-topic disambiguator</var>", ... },
              representation =&gt; "<var>literal or url</var>";
     
</pre>
   </td></tr></table>

   <p><br>

<pre class="verbatim">
 Mark_Burgess::

     "http://www.iu.hio.no/~mark"
            represents => { "Home Page" };

 lvalue::

     "A variable identifier, i.e. the left hand side of an '=' association. The promiser in a variable promise."
            represents => { "Definitions" },
            representation => "literal";

 Editing_Files::

 "http://www.cfengine.org/confdir/customizepasswd.html" 
   represents => { "Setting up users" };


</pre>

   <p><br>

   <p>Occurrences are pointers to information about topics. This
might be a literal text string or a URL reference to an external
document.

<ul class="menu">
<li><a accesskey="1" href="#about_005ftopics-in-occurrences">about_topics in occurrences</a>
<li><a accesskey="2" href="#represents-in-occurrences">represents in occurrences</a>
<li><a accesskey="3" href="#representation-in-occurrences">representation in occurrences</a>
</ul>

<div class="node">
<a name="about_topics-in-occurrences"></a>
<a name="about_005ftopics-in-occurrences"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#represents-in-occurrences">represents in occurrences</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#occurrences-in-knowledge-promises">occurrences in knowledge promises</a>

</div>

<h4 class="subsection">9.4.1 <code>about_topics</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: List of topics that the document or resource addresses

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
 "/docs/SpecialTopic_RBAC.html#tag"

     represents => { "Text section" }, 
   about_topics => { "defining roles" };

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in 3.3.0, Nova 2.2.0 (2012)

   <p>As of CFEngine 3.3.0, this represents a list of topics on which
the named occurrence provides information.

   <p>History: Previously the context class had been used for this purpose,
but this led to confusion between usage or context and the subjects
covered by a document.

<div class="node">
<a name="represents-in-occurrences"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#representation-in-occurrences">representation in occurrences</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#about_005ftopics-in-occurrences">about_topics in occurrences</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#occurrences-in-knowledge-promises">occurrences in knowledge promises</a>

</div>

<h4 class="subsection">9.4.2 <code>represents</code></h4>

<p class="noindent"><b>Type</b>: slist

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: List of explanations for what relationship this document has to the topics it is about

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
occurrences:

  Promise_Theory::

    "A theory of autonomous actors that offer certainty through promises"

      represents     => { "Definitions" },
      representation => "literal";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The sub-topic or occurrence-type represented by the document reference
in a knowledge base. This string is intended as an annotation to the
reader about the nature of the inforation located in the occurrence
document. It should be used `creatively'.

   <p>If the document type is an image and one of the items in this list is
a url, beginning with either &lsquo;<samp><span class="samp">/</span></samp>&rsquo; or &lsquo;<samp><span class="samp">http</span></samp>&rsquo;, then
<code>cf-know</code> treats the reference as a url to be reached when the
image is clicked on.

<div class="node">
<a name="representation-in-occurrences"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#represents-in-occurrences">represents in occurrences</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#occurrences-in-knowledge-promises">occurrences in knowledge promises</a>

</div>

<h4 class="subsection">9.4.3 <code>representation</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>literal</code>
               <code>url</code>
               <code>db</code>
               <code>file</code>
               <code>web</code>
               <code>image</code>
               <code>portal</code>
</pre>
   <p class="noindent"><b>Synopsis</b>: How to interpret the promiser string e.g. actual data or reference to data

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">occurrences:

  Promise_Theory::

    "A theory of autonomous actors that offer certainty through promises"

      represents     => { "Definitions" },
      representation => "literal";


</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The form of knowledge representation in a topic map occurrence reference. 
If the type <code>portal</code> is used it assumes that a new website should open in a new
target window.

<!-- ***************************************************** -->
<!-- * CHAPTER -->
<!-- ***************************************************** -->
<div class="node">
<a name="Bundles-for-monitor"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Special-functions">Special functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Bundles-for-knowledge">Bundles for knowledge</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">10 Bundles of <code>monitor</code></h2>

<p><br>

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>

<pre class="smallexample">     
     bundle monitor example
     {
     measurements:
     
          # Discover disk device information
     
       "/bin/df"
     
           handle =&gt; "free_diskspace_watch",
           stream_type =&gt; "pipe",
           data_type =&gt; "slist",
           history_type =&gt; "static",
           units =&gt; "device",
           match_value =&gt; file_systems;
     
     
     }
     
</pre>
   </td></tr></table>

   <p>Monitor bundles contain user defined promises for system discovery and monitoring.

   <p><br>

<ul class="menu">
<li><a accesskey="1" href="#classes-in-common-promises">classes in common promises</a>: <li><a accesskey="2" href="#defaults-in-common-promises">defaults in common promises</a>: <li><a accesskey="3" href="#meta-in-common-promises">meta in common promises</a>: <li><a accesskey="4" href="#reports-in-common-promises">reports in common promises</a>: <li><a accesskey="5" href="#vars-in-common-promises">vars in common promises</a>: <li><a accesskey="6" href="#Miscellaneous-in-common-promises">* in common promises</a>: <li><a accesskey="7" href="#commands-in-agent-promises">commands in agent promises</a>: <li><a accesskey="8" href="#databases-in-agent-promises">databases in agent promises</a>: <li><a accesskey="9" href="#guest_005fenvironments-in-agent-promises">guest_environments in agent promises</a>: <li><a href="#files-in-agent-promises">files in agent promises</a>: <li><a href="#Miscellaneous-in-edit_005fline-promises">* in edit_line promises</a>: <li><a href="#delete_005flines-in-edit_005fline-promises">delete_lines in edit_line promises</a>: <li><a href="#insert_005flines-in-edit_005fline-promises">insert_lines in edit_line promises</a>: <li><a href="#field_005fedits-in-edit_005fline-promises">field_edits in edit_line promises</a>: <li><a href="#replace_005fpatterns-in-edit_005fline-promises">replace_patterns in edit_line promises</a>: <li><a href="#Miscellaneous-in-edit_005fxml-promises">* in edit_xml promises</a>: <li><a href="#build_005fxpath-in-edit_005fxml-promises">build_xpath in edit_xml promises</a>: <li><a href="#delete_005ftree-in-edit_005fxml-promises">delete_tree in edit_xml promises</a>: <li><a href="#insert_005ftree-in-edit_005fxml-promises">insert_tree in edit_xml promises</a>: <li><a href="#delete_005fattribute-in-edit_005fxml-promises">delete_attribute in edit_xml promises</a>: <li><a href="#set_005fattribute-in-edit_005fxml-promises">set_attribute in edit_xml promises</a>: <li><a href="#delete_005ftext-in-edit_005fxml-promises">delete_text in edit_xml promises</a>: <li><a href="#set_005ftext-in-edit_005fxml-promises">set_text in edit_xml promises</a>: <li><a href="#insert_005ftext-in-edit_005fxml-promises">insert_text in edit_xml promises</a>: <li><a href="#interfaces-in-agent-promises">interfaces in agent promises</a>: <li><a href="#methods-in-agent-promises">methods in agent promises</a>: <li><a href="#outputs-in-agent-promises">outputs in agent promises</a>: <li><a href="#packages-in-agent-promises">packages in agent promises</a>: <li><a href="#processes-in-agent-promises">processes in agent promises</a>: <li><a href="#services-in-agent-promises">services in agent promises</a>: <li><a href="#storage-in-agent-promises">storage in agent promises</a>: <li><a href="#access-in-server-promises">access in server promises</a>: <li><a href="#roles-in-server-promises">roles in server promises</a>: <li><a href="#inferences-in-knowledge-promises">inferences in knowledge promises</a>: <li><a href="#things-in-knowledge-promises">things in knowledge promises</a>: <li><a href="#topics-in-knowledge-promises">topics in knowledge promises</a>: <li><a href="#occurrences-in-knowledge-promises">occurrences in knowledge promises</a>: <li><a href="#measurements-in-monitor-promises">measurements in monitor promises</a>: </ul>

<div class="node">
<a name="measurements-in-monitor-promises"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#occurrences-in-knowledge-promises">occurrences in knowledge promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Bundles-for-monitor">Bundles for monitor</a>

</div>

<h3 class="section">10.1 <code>measurements</code> promises in &lsquo;<samp><span class="samp">monitor</span></samp>&rsquo;</h3>

<p><br>

   <p><i>These features are available only in Enterprise versions of CFEngine.</i>

   <p>CFEngine's monitoring component <code>cf-monitord</code> records a number
of performance data about the system by default. These include
process counts, service traffic, load average and cpu utilization and
temperature when available.

   <p>CFEngine Nova extends this in two ways. First it adds a three year
trend summary based any `shift'-averages. Second, it adds customizable
promises to monitor or log very specific user data through a
generic interface. The end result is to either generate a periodic
time series, like the above mentioned values, or to log the results to
custom-defined reports.

   <p>CFEngine Nova adds a new promise type in bundles for the monitoring
agent. These are written just like all other promises within a bundle
destined for the agent concerned (however, you do not need to add them
to the <code>bundlesequence</code> &ndash; they are executed by <code>cf-monitord</code>
because they are bundles of type <code>monitor</code>). In this case:

<pre class="verbatim">bundle monitor watch

{
measurements:

  # promises ...

}

</pre>

   <p>It is important to specificy a promise <code>handle</code> for measurement
promises, as the names defined in the handle are used to determine the
name of the log file or variable to which data will be reported. Log
files are created under <samp><span class="file">WORKDIR/state</span></samp>. Data that have no history
type are stored in a special variable context called &lsquo;<samp><span class="samp">mon</span></samp>&rsquo;, analogous
to the system variables in &lsquo;<samp><span class="samp">sys</span></samp>&rsquo;. Thus the values may be used
in other promises in the form <code>$(mon.handle)</code>.

   <p><br>

<pre class="verbatim">
  # Follow a special process over time
  # using CFEngine's process cache to avoid resampling

   "/var/cfengine/state/cf_rootprocs"

      handle => "monitor_self_watch",
      stream_type => "file",
      data_type => "int",
      history_type => "weekly",
      units => "kB",
      match_value => proc_value(".*cf-monitord.*",
         "root\s+[0-9.]+\s+[0-9.]+\s+[0-9.]+\s+[0-9.]+\s+([0-9]+).*");


  # Discover disk device information

  "/bin/df"

      handle => "free_diskspace_watch",
      stream_type => "pipe",
      data_type => "slist",
      history_type => "static",
      units => "device",
      match_value => file_systems;
      # Update this as often as possible

}

##########################################################

body match_value proc_value(x,y)
{
select_line_matching => "$(x)";
extraction_regex => "$(y)";
}

body match_value file_systems
{
select_line_matching => "/.*";
extraction_regex => "(.*)";
}


</pre>

   <p><br>

<p class="noindent"><b>Notes:</b>

   <p>The general pattern of these promises is to decide the source of the
information either file or pipe, determine the data type (integer,
string etc.), specify a pattern to match the result in the file stream
and then specify what to do with the result afterwards.

<p class="noindent"><b>Standard measurements:</b>

   <p>The <code>cf-monitord</code> service monitors a number of variables as
standard on Unix and Windows systems. Windows is fundamentally different
from Unix and currently has less support for out-of-the-box probes.

     <ol type=1 start=1>
<li>users:
Users logged in
<li>rootprocs:
Privileged system processes
<li>otherprocs:
Non-privileged process
<li>diskfree:
Free disk on / partition
<li>loadavg:
% kernel load utilization
<li>netbiosns_in:
netbios name lookups (in)
<li>netbiosns_out:
netbios name lookups (out)
<li>netbiosdgm_in:
netbios name datagrams (in)
<li>netbiosdgm_out:
netbios name datagrams (out)
<li>netbiosssn_in:
netbios name sessions (in)
<li>netbiosssn_out:
netbios name sessions (out)
<li>irc_in:
IRC connections (in)
<li>irc_out:
IRC connections (out)
<li>cfengine_in:
CFEngine connections (in)
<li>cfengine_out:
CFEngine connections (out)
<li>nfsd_in:
nfs connections (in)
<li>nfsd_out:
nfs connections (out)
<li>smtp_in:
smtp connections (in)
<li>smtp_out:
smtp connections (out)
<li>www_in:
www connections (in)
<li>www_out:
www connections (out)
<li>ftp_in:
ftp connections (in)
<li>ftp_out:
ftp connections (out)
<li>ssh_in:
ssh connections (in)
<li>ssh_out:
ssh connections (out)
<li>wwws_in:
wwws connections (in)
<li>wwws_out:
wwws connections (out)
<li>icmp_in:
ICMP packets (in)
<li>icmp_out:
ICMP packets (out)
<li>udp_in:
UDP dgrams (in)
<li>udp_out:
UDP dgrams (out)
<li>dns_in:
DNS requests (in)
<li>dns_out:
DNS requests (out)
<li>tcpsyn_in:
TCP sessions (in)
<li>tcpsyn_out:
TCP sessions (out)
<li>tcpack_in:
TCP acks (in)
<li>tcpack_out:
TCP acks (out)
<li>tcpfin_in:
TCP finish (in)
<li>tcpfin_out:
TCP finish (out)
<li>tcpmisc_in:
TCP misc (in)
<li>tcpmisc_out:
TCP misc (out)
<li>webaccess:
Webserver hits
<li>weberrors:
Webserver errors
<li>syslog:
New log entries (Syslog)
<li>messages:
New log entries (messages)
<li>temp0:
CPU Temperature core 0
<li>temp1:
CPU Temperature core 1
<li>temp2:
CPU Temperature core 2
<li>temp3:
CPU Temperature core 3
<li>cpu:
%CPU utilization (all)
<li>cpu0:
%CPU utilization core 0
<li>cpu1:
%CPU utilization core 1
<li>cpu2:
%CPU utilization core 2
<li>cpu3:
%CPU utilization core 3
        </ol>

   <p>Slots with a higher number are used for custom measurement promises in CFEngine Nova.

   <p>These values collected and analysed by <code>cf-monitord</code> are
transformed into agent variables in the <code>$(mon.</code><var>name</var><code>)</code>
context.

<p class="noindent"><b>Measurement promise syntax:</b>

<ul class="menu">
<li><a accesskey="1" href="#stream_005ftype-in-measurements">stream_type in measurements</a>
<li><a accesskey="2" href="#data_005ftype-in-measurements">data_type in measurements</a>
<li><a accesskey="3" href="#history_005ftype-in-measurements">history_type in measurements</a>
<li><a accesskey="4" href="#units-in-measurements">units in measurements</a>
<li><a accesskey="5" href="#match_005fvalue-in-measurements">match_value in measurements</a>
</ul>

<div class="node">
<a name="stream_type-in-measurements"></a>
<a name="stream_005ftype-in-measurements"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#data_005ftype-in-measurements">data_type in measurements</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#measurements-in-monitor-promises">measurements in monitor promises</a>

</div>

<h4 class="subsection">10.1.1 <code>stream_type</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>pipe</code>
               <code>file</code>
</pre>
   <p class="noindent"><b>Synopsis</b>: The datatype being collected.

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
stream_type => "pipe";

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>CFEngine treats all input using a stream abstraction. The preferred interface is files, since they
can be read without incurring the cost of a process. However pipes from executed commands may also
be invoked.

<div class="node">
<a name="data_type-in-measurements"></a>
<a name="data_005ftype-in-measurements"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#history_005ftype-in-measurements">history_type in measurements</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#stream_005ftype-in-measurements">stream_type in measurements</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#measurements-in-monitor-promises">measurements in monitor promises</a>

</div>

<h4 class="subsection">10.1.2 <code>data_type</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>counter</code>
               <code>int</code>
               <code>real</code>
               <code>string</code>
               <code>slist</code>
</pre>
   <p class="noindent"><b>Synopsis</b>: The datatype being collected.

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
  "/bin/df"

      handle => "free_disk_watch",
      stream_type => "pipe",

      data_type => "slist",

      history_type => "static",
      units => "device",
      match_value => file_systems,
      action => sample_min(10,15);


</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>When CFEngine (Nova) observes data, such as the attached partitions in
the example above, the datatype determines how that data will be
handled.  Integer and real values, counters etc., are recorded as
time-series if the history type is `weekly', or as single values
otherwise. If multiple items are matched by an observation,
e.g. several lines in a file match the given regular expression,
then these can be made into a list by choosing <code>slist</code>, else
the first matching item will be selected.

<div class="node">
<a name="history_type-in-measurements"></a>
<a name="history_005ftype-in-measurements"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#units-in-measurements">units in measurements</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#data_005ftype-in-measurements">data_type in measurements</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#measurements-in-monitor-promises">measurements in monitor promises</a>

</div>

<h4 class="subsection">10.1.3 <code>history_type</code></h4>

<p class="noindent"><b>Type</b>: (menu option)

<p class="noindent"><b>Allowed input range</b>: <br>
<pre class="example">               <code>weekly</code>
               <code>scalar</code>
               <code>static</code>
               <code>log</code>
</pre>
   <p class="noindent"><b>Synopsis</b>: Whether the data can be seen as a time-series or just an isolated value

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
 "/proc/meminfo"

      handle => "free_memory_watch",
      stream_type => "file",
      data_type => "int",
      history_type => "weekly",
      units => "kB",
      match_value => free_memory;

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

     <dl>
<dt>&lsquo;<samp><span class="samp">scalar</span></samp>&rsquo;<dd>A single value, with compressed statistics is retained.  The value of the
data is not expected to change much for the lifetime of the daemon (and so
will be sampled less often by &lsquo;<samp><span class="samp">cf-monitord</span></samp>&rsquo;).

     <br><dt>&lsquo;<samp><span class="samp">static</span></samp>&rsquo;<dd>A synonym for `scalar'.

     <br><dt>&lsquo;<samp><span class="samp">log</span></samp>&rsquo;<dd>The measured value is logged as an infinite time-series in
&lsquo;<samp><span class="samp">$(sys.workdir)/state</span></samp>&rsquo;.

     <br><dt>&lsquo;<samp><span class="samp">weekly</span></samp>&rsquo;<dd>A standard CFEngine two-dimensional time average (over a weekly period) is retained. 
</dl>

<div class="node">
<a name="units-in-measurements"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#match_005fvalue-in-measurements">match_value in measurements</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#history_005ftype-in-measurements">history_type in measurements</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#measurements-in-monitor-promises">measurements in monitor promises</a>

</div>

<h4 class="subsection">10.1.4 <code>units</code></h4>

<p class="noindent"><b>Type</b>: string

<p class="noindent"><b>Allowed input range</b>: (arbitrary string)

<p class="noindent"><b>Synopsis</b>: The engineering dimensions of this value or a note about its intent used in plots

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
   "/var/cfengine/state/cf_rootprocs"

      handle => "monitor_self_watch",
      stream_type => "file",
      data_type => "int",
      history_type => "weekly",
      units => "kB",
      match_value => proc_value(".*cf-monitord.*",
        
         "root\s+[0-9.]+\s+[0-9.]+\s+[0-9.]+\s+[0-9.]+\s+([0-9]+).*");

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This is an arbitary string used in documentation only.

<div class="node">
<a name="match_value-in-measurements"></a>
<a name="match_005fvalue-in-measurements"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#units-in-measurements">units in measurements</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#measurements-in-monitor-promises">measurements in monitor promises</a>

</div>

<h4 class="subsection">10.1.5 <code>match_value</code> (body template)</h4>

<p class="noindent"><b>Type</b>: (ext body)

     <dl>
<dt>&lsquo;<samp><code>select_line_matching</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: <code>.*</code>

     <p class="noindent"><b>Synopsis</b>: Regular expression for matching line location

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     # Editing
     
     body location example
     {
     select_line_matching => "Expression match.* whole line";
     }
     
     # Measurement promises
     
     body match_value example
     {
     select_line_matching => "Expression match.* whole line";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>The expression must match a whole line, not a fragment within a line
(that is, it is anchored, see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>).

     <p>This attribute is mutually exclusive of <code>select_line_number</code>.

     <br><dt>&lsquo;<samp><code>select_line_number</code></samp>&rsquo;<dd><b>Type</b>: int

     <p class="noindent"><b>Allowed input range</b>: <code>0,99999999999</code>

     <p class="noindent"><b>Synopsis</b>: Read from the n-th line of the output (fixed format)

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body match_value find_line
     {
     select_line_number => "2";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This is mutually exclusive of <code>select_line_matching</code>.

     <br><dt>&lsquo;<samp><code>extraction_regex</code></samp>&rsquo;<dd><b>Type</b>: string

     <p class="noindent"><b>Allowed input range</b>: (arbitrary string)

     <p class="noindent"><b>Synopsis</b>: Regular expression that should contain a single backreference for extracting a value

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body match_value free_memory
     {
     select_line_matching => "MemFree:.*";
     extraction_regex => "MemFree:\s+([0-9]+).*";
     }
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>A single parenthesized backreference should be given to lift the value to be measured out of the text stream. 
The regular expression may match a partial string (that is, it is unanchored
see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>).

     <br><dt>&lsquo;<samp><code>track_growing_file</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>true</code>
                    <code>false</code>
                    <code>yes</code>
                    <code>no</code>
                    <code>on</code>
                    <code>off</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: If true, cfengine remembers the position to which is last read when opening the file, and resets to the start if the file has since been truncated

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     bundle monitor watch
     {
     measurements:
     
        "/home/mark/tmp/file"
     
              handle => "line_counter",
         stream_type => "file",
           data_type => "counter",
         match_value => scan_log("MYLINE.*"),
        history_type => "log",
              action => sample_rate("0");
     
     }
     
     #
     
     body match_value scan_log(x)
     {
     select_line_matching => "^$(x)$";
     track_growing_file => "true";
     }
     
     #
     
     body action sample_rate(x)
     {
     ifelapsed => "$(x)";
     expireafter => "10";
     }
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p>This option applies only to file based input streams. If this is
&lsquo;<samp><span class="samp">true</span></samp>&rsquo;, CFEngine treats the file as if it were a log file,
growing continuously. Thus the monitor reads all new entries since the
last sampling time on each invocation. In this way, the monitor does
not count lines in the log file redundantly.

     <p>This makes a log pattern promise equivalent to something like
&lsquo;<samp><span class="samp">tail -f logfile | grep pattern</span></samp>&rsquo; in Unix parlance.

     <br><dt>&lsquo;<samp><code>select_multiline_policy</code></samp>&rsquo;<dd><b>Type</b>: (menu option)

     <p class="noindent"><b>Allowed input range</b>: <br>
     <pre class="example">                    <code>average</code>
                    <code>sum</code>
                    <code>first</code>
                    <code>last</code>
</pre>
     <p class="noindent"><b>Synopsis</b>: Regular expression for matching line location

     <p><b>Example</b>:<br>
<br>

     <pre class="verbatim">     
     body match_value myvalue(xxx)
     {
      select_line_matching => ".*$(xxx).*";
      extraction_regex => "root\s+\S+\s+\S+\s+\S+\s+\S+\s+\S+\s+\S+\s+\S+\s+(\S+).*";
      select_multiline_policy => "sum";
     } 
     
</pre>

     <p><b>Notes</b>:<br>
<br>

     <p><i>History</i>: Was introduced in 3.4.0 (2012)

     <p>This option governs how CFEngine handels multiple matching lines in the input
stream. We can average or sum values if they are integer or real, or use first or last representative samples. If non-numerical data types are used on the the first match is used.

   </dl>
   <!-- ***************************************************** -->
<!-- * CHAPTER -->
<!-- ***************************************************** -->
<div class="node">
<a name="Special-functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Special-Variables">Special Variables</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Bundles-for-monitor">Bundles for monitor</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">11 Special functions</h2>

<ul class="menu">
<li><a accesskey="1" href="#Introduction-to-functions">Introduction to functions</a>
<li><a accesskey="2" href="#Function-accessedbefore">Function accessedbefore</a>
<li><a accesskey="3" href="#Function-accumulated">Function accumulated</a>
<li><a accesskey="4" href="#Function-ago">Function ago</a>
<li><a accesskey="5" href="#Function-and">Function and</a>
<li><a accesskey="6" href="#Function-canonify">Function canonify</a>
<li><a accesskey="7" href="#Function-concat">Function concat</a>
<li><a accesskey="8" href="#Function-changedbefore">Function changedbefore</a>
<li><a accesskey="9" href="#Function-classify">Function classify</a>
<li><a href="#Function-classmatch">Function classmatch</a>
<li><a href="#Function-countclassesmatching">Function countclassesmatching</a>
<li><a href="#Function-countlinesmatching">Function countlinesmatching</a>
<li><a href="#Function-dirname">Function dirname</a>
<li><a href="#Function-diskfree">Function diskfree</a>
<li><a href="#Function-escape">Function escape</a>
<li><a href="#Function-execresult">Function execresult</a>
<li><a href="#Function-fileexists">Function fileexists</a>
<li><a href="#Function-filesexist">Function filesexist</a>
<li><a href="#Function-filesize">Function filesize</a>
<li><a href="#Function-getenv">Function getenv</a>
<li><a href="#Function-getfields">Function getfields</a>
<li><a href="#Function-getgid">Function getgid</a>
<li><a href="#Function-getindices">Function getindices</a>
<li><a href="#Function-getuid">Function getuid</a>
<li><a href="#Function-getusers">Function getusers</a>
<li><a href="#Function-getvalues">Function getvalues</a>
<li><a href="#Function-grep">Function grep</a>
<li><a href="#Function-groupexists">Function groupexists</a>
<li><a href="#Function-hash">Function hash</a>
<li><a href="#Function-hashmatch">Function hashmatch</a>
<li><a href="#Function-host2ip">Function host2ip</a>
<li><a href="#Function-ip2host">Function ip2host</a>
<li><a href="#Function-hostinnetgroup">Function hostinnetgroup</a>
<li><a href="#Function-hostrange">Function hostrange</a>
<li><a href="#Function-hostsseen">Function hostsseen</a>
<li><a href="#Function-hostswithclass">Function hostswithclass</a>
<li><a href="#Function-hubknowledge">Function hubknowledge</a>
<li><a href="#Function-iprange">Function iprange</a>
<li><a href="#Function-irange">Function irange</a>
<li><a href="#Function-isdir">Function isdir</a>
<li><a href="#Function-isexecutable">Function isexecutable</a>
<li><a href="#Function-isgreaterthan">Function isgreaterthan</a>
<li><a href="#Function-islessthan">Function islessthan</a>
<li><a href="#Function-islink">Function islink</a>
<li><a href="#Function-isnewerthan">Function isnewerthan</a>
<li><a href="#Function-isplain">Function isplain</a>
<li><a href="#Function-isvariable">Function isvariable</a>
<li><a href="#Function-join">Function join</a>
<li><a href="#Function-lastnode">Function lastnode</a>
<li><a href="#Function-laterthan">Function laterthan</a>
<li><a href="#Function-ldaparray">Function ldaparray</a>
<li><a href="#Function-ldaplist">Function ldaplist</a>
<li><a href="#Function-ldapvalue">Function ldapvalue</a>
<li><a href="#Function-lsdir">Function lsdir</a>
<li><a href="#Function-maplist">Function maplist</a>
<li><a href="#Function-not">Function not</a>
<li><a href="#Function-now">Function now</a>
<li><a href="#Function-on">Function on</a>
<li><a href="#Function-or">Function or</a>
<li><a href="#Function-parseintarray">Function parseintarray</a>
<li><a href="#Function-parserealarray">Function parserealarray</a>
<li><a href="#Function-parsestringarray">Function parsestringarray</a>
<li><a href="#Function-parsestringarrayidx">Function parsestringarrayidx</a>
<li><a href="#Function-peers">Function peers</a>
<li><a href="#Function-peerleader">Function peerleader</a>
<li><a href="#Function-peerleaders">Function peerleaders</a>
<li><a href="#Function-product">Function product</a>
<li><a href="#Function-randomint">Function randomint</a>
<li><a href="#Function-readfile">Function readfile</a>
<li><a href="#Function-readintarray">Function readintarray</a>
<li><a href="#Function-readintlist">Function readintlist</a>
<li><a href="#Function-readrealarray">Function readrealarray</a>
<li><a href="#Function-readreallist">Function readreallist</a>
<li><a href="#Function-readstringarray">Function readstringarray</a>
<li><a href="#Function-readstringarrayidx">Function readstringarrayidx</a>
<li><a href="#Function-readstringlist">Function readstringlist</a>
<li><a href="#Function-readtcp">Function readtcp</a>
<li><a href="#Function-regarray">Function regarray</a>
<li><a href="#Function-regcmp">Function regcmp</a>
<li><a href="#Function-regextract">Function regextract</a>
<li><a href="#Function-registryvalue">Function registryvalue</a>
<li><a href="#Function-regline">Function regline</a>
<li><a href="#Function-reglist">Function reglist</a>
<li><a href="#Function-regldap">Function regldap</a>
<li><a href="#Function-remotescalar">Function remotescalar</a>
<li><a href="#Function-remoteclassesmatching">Function remoteclassesmatching</a>
<li><a href="#Function-returnszero">Function returnszero</a>
<li><a href="#Function-rrange">Function rrange</a>
<li><a href="#Function-selectservers">Function selectservers</a>
<li><a href="#Function-splayclass">Function splayclass</a>
<li><a href="#Function-splitstring">Function splitstring</a>
<li><a href="#Function-strcmp">Function strcmp</a>
<li><a href="#Function-sum">Function sum</a>
<li><a href="#Function-translatepath">Function translatepath</a>
<li><a href="#Function-usemodule">Function usemodule</a>
<li><a href="#Function-userexists">Function userexists</a>
</ul>
<div class="node">
<a name="Introduction-to-functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-accessedbefore">Function accessedbefore</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.1 Introduction to functions</h3>

<p><br>
There is a large number of functions built into CFEngine, and finding the
right one to use can be a daunting task.  The following tables are designed
to make it easier for you to find the function you need, based on the value
or type that the function returns or processes as inputs.

<h4 class="subsection">11.1.1 Functions listed by return value</h4>

<h5 class="unnumberedsubsubsec">Functions which return class</h5>

<p><table summary=""><tr align="left"><td valign="top" width="20%"><a href="#Function-accessedbefore">accessedbefore</a>
</td><td valign="top" width="20%"><a href="#Function-and">and</a>
</td><td valign="top" width="20%"><a href="#Function-changedbefore">changedbefore</a>
</td><td valign="top" width="20%"><a href="#Function-classify">classify</a>
</td><td valign="top" width="20%"><a href="#Function-classmatch">classmatch</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-concat">concat</a>
</td><td valign="top" width="20%"><a href="#Function-fileexists">fileexists</a>
</td><td valign="top" width="20%"><a href="#Function-filesexist">filesexist</a>
</td><td valign="top" width="20%"><a href="#Function-groupexists">groupexists</a>
</td><td valign="top" width="20%"><a href="#Function-hashmatch">hashmatch</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-hostinnetgroup">hostinnetgroup</a>
</td><td valign="top" width="20%"><a href="#Function-hostrange">hostrange</a>
</td><td valign="top" width="20%"><a href="#Function-iprange">iprange</a>
</td><td valign="top" width="20%"><a href="#Function-isdir">isdir</a>
</td><td valign="top" width="20%"><a href="#Function-isexecutable">isexecutable</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-isgreaterthan">isgreaterthan</a>
</td><td valign="top" width="20%"><a href="#Function-islessthan">islessthan</a>
</td><td valign="top" width="20%"><a href="#Function-islink">islink</a>
</td><td valign="top" width="20%"><a href="#Function-isnewerthan">isnewerthan</a>
</td><td valign="top" width="20%"><a href="#Function-isplain">isplain</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-isvariable">isvariable</a>
</td><td valign="top" width="20%"><a href="#Function-ldaparray">ldaparray</a>
</td><td valign="top" width="20%"><a href="#Function-or">or</a>
</td><td valign="top" width="20%"><a href="#Function-not">not</a>
</td><td valign="top" width="20%"><a href="#Function-regarray">regarray</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-regcmp">regcmp</a>
</td><td valign="top" width="20%"><a href="#Function-regextract">regextract</a>
</td><td valign="top" width="20%"><a href="#Function-regldap">regldap</a>
</td><td valign="top" width="20%"><a href="#Function-regline">regline</a>
</td><td valign="top" width="20%"><a href="#Function-reglist">reglist</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-remoteclassesmatching">remoteclassesmatching</a>
</td><td valign="top" width="20%"><a href="#Function-returnszero">returnszero</a>
</td><td valign="top" width="20%"><a href="#Function-splayclass">splayclass</a>
</td><td valign="top" width="20%"><a href="#Function-strcmp">strcmp</a>
</td><td valign="top" width="20%"><a href="#Function-usemodule">usemodule</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-userexists">userexists</a>
<br></td></tr></table>

<h5 class="unnumberedsubsubsec">Functions which return (i,r,s)list</h5>

<p><table summary=""><tr align="left"><td valign="top" width="20%"><a href="#Function-getindices">getindices</a>
</td><td valign="top" width="20%"><a href="#Function-getusers">getusers</a>
</td><td valign="top" width="20%"><a href="#Function-grep">grep</a>
</td><td valign="top" width="20%"><a href="#Function-ldaplist">ldaplist</a>
</td><td valign="top" width="20%"><a href="#Function-maplist">maplist</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-peerleaders">peerleaders</a>
</td><td valign="top" width="20%"><a href="#Function-peers">peers</a>
</td><td valign="top" width="20%"><a href="#Function-readintlist">readintlist</a>
</td><td valign="top" width="20%"><a href="#Function-readreallist">readreallist</a>
</td><td valign="top" width="20%"><a href="#Function-readstringlist">readstringlist</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-splitstring">splitstring</a>
<br></td></tr></table>

<h5 class="unnumberedsubsubsec">Functions which return int</h5>

<p><table summary=""><tr align="left"><td valign="top" width="20%"><a href="#Function-accumulated">accumulated</a>
</td><td valign="top" width="20%"><a href="#Function-ago">ago</a>
</td><td valign="top" width="20%"><a href="#Function-countlinesmatching">countlinesmatching</a>
</td><td valign="top" width="20%"><a href="#Function-diskfree">diskfree</a>
</td><td valign="top" width="20%"><a href="#Function-getfields">getfields</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-getgid">getgid</a>
</td><td valign="top" width="20%"><a href="#Function-getuid">getuid</a>
</td><td valign="top" width="20%"><a href="#Function-now">now</a>
</td><td valign="top" width="20%"><a href="#Function-on">on</a>
</td><td valign="top" width="20%"><a href="#Function-randomint">randomint</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-readintarray">readintarray</a>
</td><td valign="top" width="20%"><a href="#Function-readrealarray">readrealarray</a>
</td><td valign="top" width="20%"><a href="#Function-readstringarray">readstringarray</a>
</td><td valign="top" width="20%"><a href="#Function-readstringarrayidx">readstringarrayidx</a>
</td><td valign="top" width="20%"><a href="#Function-selectservers">selectservers</a>
<br></td></tr></table>

<h5 class="unnumberedsubsubsec">Functions which return (i,r)range</h5>

<p><table summary=""><tr align="left"><td valign="top" width="20%"><a href="#Function-irange">irange</a>
</td><td valign="top" width="20%"><a href="#Function-rrange">rrange</a>
<br></td></tr></table>

<h5 class="unnumberedsubsubsec">Functions which return real</h5>

<p><table summary=""><tr align="left"><td valign="top" width="20%"><a href="#Function-product">product</a>
</td><td valign="top" width="20%"><a href="#Function-sum">sum</a>
<br></td></tr></table>

<h5 class="unnumberedsubsubsec">Functions which return string</h5>

<p><table summary=""><tr align="left"><td valign="top" width="20%"><a href="#Function-canonify">canonify</a>
</td><td valign="top" width="20%"><a href="#Function-escape">escape</a>
</td><td valign="top" width="20%"><a href="#Function-execresult">execresult</a>
</td><td valign="top" width="20%"><a href="#Function-getenv">getenv</a>
</td><td valign="top" width="20%"><a href="#Function-hash">hash</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-host2ip">host2ip</a>
</td><td valign="top" width="20%"><a href="#Function-hostsseen">hostsseen</a>
</td><td valign="top" width="20%"><a href="#Function-join">join</a>
</td><td valign="top" width="20%"><a href="#Function-lastnode">lastnode</a>
</td><td valign="top" width="20%"><a href="#Function-ldapvalue">ldapvalue</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-peerleader">peerleader</a>
</td><td valign="top" width="20%"><a href="#Function-readfile">readfile</a>
</td><td valign="top" width="20%"><a href="#Function-readtcp">readtcp</a>
</td><td valign="top" width="20%"><a href="#Function-registryvalue">registryvalue</a>
</td><td valign="top" width="20%"><a href="#Function-remotescalar">remotescalar</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-translatepath">translatepath</a>
<br></td></tr></table>

<h4 class="subsection">11.1.2 Functions which fill arrays</h4>

<p>The following functions all fill arrays, although they return values which
depend on the number of items processed.

   <p><table summary=""><tr align="left"><td valign="top" width="20%"><a href="#Function-getfields">getfields</a>
</td><td valign="top" width="20%"><a href="#Function-readintarray">readintarray</a>
</td><td valign="top" width="20%"><a href="#Function-readrealarray">readrealarray</a>
</td><td valign="top" width="20%"><a href="#Function-readstringarray">readstringarray</a>
</td><td valign="top" width="20%"><a href="#Function-readstringarrayidx">readstringarrayidx</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-regextract">regextract</a>
   <br></td></tr></table>

<h4 class="subsection">11.1.3 Functions which read &ldquo;large&rdquo; data</h4>

<p>The following functions read data from inside CFEngine (from classes, lists,
strings, etc.) and outside of CFEngine (from files, databases, arrays, etc.)

<h5 class="unnumberedsubsubsec">Functions which read arrays</h5>

<p><table summary=""><tr align="left"><td valign="top" width="20%"><a href="#Function-getindices">getindices</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-getvalues">getvalues</a>
</td><td valign="top" width="20%"><a href="#Function-regarray">regarray</a>
<br></td></tr></table>

<h5 class="unnumberedsubsubsec">Functions which read disk data</h5>

<p><table summary=""><tr align="left"><td valign="top" width="20%"><a href="#Function-diskfree">diskfree</a>
<br></td></tr></table>

<h5 class="unnumberedsubsubsec">Functions which read from a remote-CFEngine</h5>

<p><table summary=""><tr align="left"><td valign="top" width="20%"><a href="#Function-remoteclassesmatching">remoteclassesmatching</a>
</td><td valign="top" width="20%"><a href="#Function-remotescalar">remotescalar</a>
<br></td></tr></table>

<h5 class="unnumberedsubsubsec">Functions which read classes</h5>

<p><table summary=""><tr align="left"><td valign="top" width="20%"><a href="#Function-and">and</a>
</td><td valign="top" width="20%"><a href="#Function-classify">classify</a>
</td><td valign="top" width="20%"><a href="#Function-classmatch">classmatch</a>
</td><td valign="top" width="20%"><a href="#Function-concat">concat</a>
</td><td valign="top" width="20%"><a href="#Function-not">not</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-or">or</a>
<br></td></tr></table>

<h5 class="unnumberedsubsubsec">Functions which read command output</h5>

<p><table summary=""><tr align="left"><td valign="top" width="20%"><a href="#Function-execresult">execresult</a>
</td><td valign="top" width="20%"><a href="#Function-returnszero">returnszero</a>
</td><td valign="top" width="20%"><a href="#Function-usemodule">usemodule</a>
<br></td></tr></table>

<h5 class="unnumberedsubsubsec">Functions which read the environment</h5>

<p><table summary=""><tr align="left"><td valign="top" width="20%"><a href="#Function-getenv">getenv</a>
<br></td></tr></table>

<h5 class="unnumberedsubsubsec">Functions which read files</h5>

<p><table summary=""><tr align="left"><td valign="top" width="20%"><a href="#Function-countlinesmatching">countlinesmatching</a>
</td><td valign="top" width="20%"><a href="#Function-getfields">getfields</a>
</td><td valign="top" width="20%"><a href="#Function-getusers">getusers</a>
</td><td valign="top" width="20%"><a href="#Function-hashmatch">hashmatch</a>
</td><td valign="top" width="20%"><a href="#Function-peerleader">peerleader</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-peerleaders">peerleaders</a>
</td><td valign="top" width="20%"><a href="#Function-peers">peers</a>
</td><td valign="top" width="20%"><a href="#Function-readfile">readfile</a>
</td><td valign="top" width="20%"><a href="#Function-readintarray">readintarray</a>
</td><td valign="top" width="20%"><a href="#Function-readintlist">readintlist</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-readrealarray">readrealarray</a>
</td><td valign="top" width="20%"><a href="#Function-readreallist">readreallist</a>
</td><td valign="top" width="20%"><a href="#Function-readstringarray">readstringarray</a>
</td><td valign="top" width="20%"><a href="#Function-readstringarrayidx">readstringarrayidx</a>
</td><td valign="top" width="20%"><a href="#Function-readstringlist">readstringlist</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-regline">regline</a>
<br></td></tr></table>

<h5 class="unnumberedsubsubsec">Functions which read LDAP data</h5>

<p><table summary=""><tr align="left"><td valign="top" width="20%"><a href="#Function-ldaparray">ldaparray</a>
</td><td valign="top" width="20%"><a href="#Function-ldaplist">ldaplist</a>
</td><td valign="top" width="20%"><a href="#Function-ldapvalue">ldapvalue</a>
</td><td valign="top" width="20%"><a href="#Function-regldap">regldap</a>
<br></td></tr></table>

<h5 class="unnumberedsubsubsec">Functions which read from the network</h5>

<p><table summary=""><tr align="left"><td valign="top" width="20%"><a href="#Function-readtcp">readtcp</a>
</td><td valign="top" width="20%"><a href="#Function-selectservers">selectservers</a>
<br></td></tr></table>

<h5 class="unnumberedsubsubsec">Functions which read the Windows registry</h5>

<p><table summary=""><tr align="left"><td valign="top" width="20%"><a href="#Function-registryvalue">registryvalue</a>
<br></td></tr></table>

<h5 class="unnumberedsubsubsec">Functions which read (i,r,s)lists</h5>

<p><table summary=""><tr align="left"><td valign="top" width="20%"><a href="#Function-grep">grep</a>
</td><td valign="top" width="20%"><a href="#Function-join">join</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-product">product</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-reglist">reglist</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-sum">sum</a>
<br></td></tr></table>

<h5 class="unnumberedsubsubsec">Functions which read strings</h5>

<p><table summary=""><tr align="left"><td valign="top" width="20%"><a href="#Function-hash">hash</a>
</td><td valign="top" width="20%"><a href="#Function-lastnode">lastnode</a>
</td><td valign="top" width="20%"><a href="#Function-regcmp">regcmp</a>
</td><td valign="top" width="20%"><a href="#Function-regextract">regextract</a>
</td><td valign="top" width="20%"><a href="#Function-splitstring">splitstring</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-strcmp">strcmp</a>
</td><td valign="top" width="20%"><a href="#Function-translatepath">translatepath</a>
<br></td></tr></table>

<h4 class="subsection">11.1.4 Functions which look at file metadata</h4>

<p>The following functions examine file metadata, but don't use the
contents of the file.

   <p><table summary=""><tr align="left"><td valign="top" width="20%"><a href="#Function-accessedbefore">accessedbefore</a>
</td><td valign="top" width="20%"><a href="#Function-changedbefore">changedbefore</a>
</td><td valign="top" width="20%"><a href="#Function-fileexists">fileexists</a>
</td><td valign="top" width="20%"><a href="#Function-filesexist">filesexist</a>
</td><td valign="top" width="20%"><a href="#Function-isdir">isdir</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-islink">islink</a>
</td><td valign="top" width="20%"><a href="#Function-isnewerthan">isnewerthan</a>
</td><td valign="top" width="20%"><a href="#Function-isplain">isplain</a>
   <br></td></tr></table>

<h4 class="subsection">11.1.5 Functions which look at variables</h4>

<p><table summary=""><tr align="left"><td valign="top" width="20%"><a href="#Function-isgreaterthan">isgreaterthan</a>
</td><td valign="top" width="20%"><a href="#Function-islessthan">islessthan</a>
</td><td valign="top" width="20%"><a href="#Function-isvariable">isvariable</a>
<br></td></tr></table>

<h4 class="subsection">11.1.6 Functions involving date or time</h4>

<p>The following functions all do date or time computation

   <p><table summary=""><tr align="left"><td valign="top" width="20%"><a href="#Function-accessedbefore">accessedbefore</a>
</td><td valign="top" width="20%"><a href="#Function-accumulated">accumulated</a>
</td><td valign="top" width="20%"><a href="#Function-ago">ago</a>
</td><td valign="top" width="20%"><a href="#Function-changedbefore">changedbefore</a>
</td><td valign="top" width="20%"><a href="#Function-isnewerthan">isnewerthan</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-now">now</a>
</td><td valign="top" width="20%"><a href="#Function-on">on</a>
</td><td valign="top" width="20%"><a href="#Function-splayclass">splayclass</a>
   <br></td></tr></table>

<h4 class="subsection">11.1.7 Functions which work with or on regular expressions</h4>

<p><table summary=""><tr align="left"><td valign="top" width="20%"><a href="#Function-classmatch">classmatch</a>
</td><td valign="top" width="20%"><a href="#Function-countlinesmatching">countlinesmatching</a>
</td><td valign="top" width="20%"><a href="#Function-escape">escape</a>
</td><td valign="top" width="20%"><a href="#Function-getfields">getfields</a>
</td><td valign="top" width="20%"><a href="#Function-grep">grep</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-readintarray">readintarray</a>
</td><td valign="top" width="20%"><a href="#Function-readintlist">readintlist</a>
</td><td valign="top" width="20%"><a href="#Function-readrealarray">readrealarray</a>
</td><td valign="top" width="20%"><a href="#Function-readreallist">readreallist</a>
</td><td valign="top" width="20%"><a href="#Function-readstringarray">readstringarray</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-readstringarrayidx">readstringarrayidx</a>
</td><td valign="top" width="20%"><a href="#Function-readstringlist">readstringlist</a>
</td><td valign="top" width="20%"><a href="#Function-regarray">regarray</a>
</td><td valign="top" width="20%"><a href="#Function-regcmp">regcmp</a>
</td><td valign="top" width="20%"><a href="#Function-regextract">regextract</a>
<br></td></tr><tr align="left"><td valign="top" width="20%"><a href="#Function-regldap">regldap</a>
</td><td valign="top" width="20%"><a href="#Function-regline">regline</a>
</td><td valign="top" width="20%"><a href="#Function-reglist">reglist</a>
</td><td valign="top" width="20%"><a href="#Function-splitstring">splitstring</a>
<br></td></tr></table>

<div class="node">
<a name="Function-accessedbefore"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-accumulated">Function accumulated</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Introduction-to-functions">Introduction to functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.2 Function accessedbefore</h3>

<p class="noindent"><b>Synopsis</b>: accessedbefore(arg1,arg2) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : Newer filename, <i>in the range</i> "?(/.*)
<br>
   <i>arg2</i> : Older filename, <i>in the range</i> "?(/.*)
<br>

<p class="noindent">True if arg1 was accessed before arg2 (atime)

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{     
classes:

  "do_it" and => { accessedbefore("/tmp/earlier","/tmp/later"), "linux" }; 

reports:

  do_it::

    "The secret changes have been accessed after the reference time";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The function accesses the <code>atime</code> fields of a file and makes a comparison.

<pre class="smallexample">     
      touch /tmp/reference
      touch /tmp/secretfile
     
      /var/cfengine/bin/cf-agent -f ./unit_accessed_before.cf -K
      R: The secret changes have been accessed after the reference time
     
</pre>
   <div class="node">
<a name="Function-accumulated"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-ago">Function ago</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-accessedbefore">Function accessedbefore</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.3 Function accumulated</h3>

<p class="noindent"><b>Synopsis</b>: accumulated(arg1,arg2,arg3,arg4,arg5,arg6) returns type <b>int</b>

   <p><br>
   <i>arg1</i> : Years, <i>in the range</i> 0,1000
<br>
   <i>arg2</i> : Months, <i>in the range</i> 0,1000
<br>
   <i>arg3</i> : Days, <i>in the range</i> 0,1000
<br>
   <i>arg4</i> : Hours, <i>in the range</i> 0,1000
<br>
   <i>arg5</i> : Minutes, <i>in the range</i> 0,1000
<br>
   <i>arg6</i> : Seconds, <i>in the range</i> 0,40000
<br>

<p class="noindent">Convert an accumulated amount of time into a system representation

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle agent testbundle

{
processes:

 ".*"

    process_count   => anyprocs,
    process_select  => proc_finder;

reports:

 any_procs::

   "Found processes in range";
}

########################################################

body process_select proc_finder

{
ttime_range => irange(accumulated(0,0,0,0,2,0),accumulated(0,0,0,0,20,0));
process_result => "ttime";
}

########################################################

body process_count anyprocs

{
match_range => "0,0";
out_of_range_define => { "any_procs" };
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>In the example we look for processes that have accumulated between 2 and 20
minutes of total run time.

<p class="noindent"><b>ARGUMENTS</b>:

   <p>The <code>accumulated</code> function measures total accumulated runtime. 
Arguments are applied additively, so that accumulated(0,0,2,27,90,0)
means "2 days, 27 hours and 90 minutes of runtime" " &ndash; however, you
are strongly encouraged to keep your usage of <code>accumulated</code>
sensible and readable, e.g., accumulated(0,0,0,48,0,0) or
accumulated(0,0,0,0,90,0).

     <dl>
<dt>&lsquo;<samp><span class="samp">Years</span></samp>&rsquo;<dd>Years of run time.  For convenience in conversion, a year of runtime is always
365 days (one year equals 31,536,000 seconds). 
<br><dt>&lsquo;<samp><span class="samp">Month</span></samp>&rsquo;<dd>Months of run time.  For convenience in conversion, a month of runtime is
always equal to 30 days of runtime (one month equals 2,592,000 seconds). 
<br><dt>&lsquo;<samp><span class="samp">Day</span></samp>&rsquo;<dd>Days of runtime (one day equals 86,400 seconds)
<br><dt>&lsquo;<samp><span class="samp">Hours</span></samp>&rsquo;<dd>Hours of runtime
<br><dt>&lsquo;<samp><span class="samp">Minutes</span></samp>&rsquo;<dd>Minutes of runtime
0-59
<br><dt>&lsquo;<samp><span class="samp">Seconds</span></samp>&rsquo;<dd>Seconds of runtime
</dl>

<div class="node">
<a name="Function-ago"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-and">Function and</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-accumulated">Function accumulated</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.4 Function ago</h3>

<p class="noindent"><b>Synopsis</b>: ago(arg1,arg2,arg3,arg4,arg5,arg6) returns type <b>int</b>

   <p><br>
   <i>arg1</i> : Years, <i>in the range</i> 0,1000
<br>
   <i>arg2</i> : Months, <i>in the range</i> 0,1000
<br>
   <i>arg3</i> : Days, <i>in the range</i> 0,1000
<br>
   <i>arg4</i> : Hours, <i>in the range</i> 0,1000
<br>
   <i>arg5</i> : Minutes, <i>in the range</i> 0,1000
<br>
   <i>arg6</i> : Seconds, <i>in the range</i> 0,40000
<br>

<p class="noindent">Convert a time relative to now to an integer system representation

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle agent testbundle

{
processes:

 ".*"

    process_count   => anyprocs,
    process_select  => proc_finder;

reports:

 any_procs::

   "Found processes out of range";
}

########################################################

body process_select proc_finder

{
# Processes started between 5.5 hours and 20 minutes ago
stime_range => irange(ago(0,0,0,5,30,0),ago(0,0,0,0,20,0));
process_result => "stime";
}

########################################################

body process_count anyprocs

{
match_range => "0,0";
out_of_range_define => { "any_procs" };
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The <code>ago</code> function measures time relative to now.  Arguments are applied
in order, so that ago(0,18,55,27,0,0) means "18 months, 55 days, and 27 hours
ago" &ndash; however, you are strongly encouraged to keep your usage of <code>ago</code>
sensible and readable, e.g., ago(0,0,120,0,0,0) or ago(0,0,0,72,0,0).

<p class="noindent"><b>ARGUMENTS</b>:

     <dl>
<dt>&lsquo;<samp><span class="samp">Years</span></samp>&rsquo;<dd>Years ago.  If today is February 29, and  "<b>n</b> years ago" is not within a
leap-year, February 28 will be used. 
<br><dt>&lsquo;<samp><span class="samp">Month</span></samp>&rsquo;<dd>Months ago.  If the current month has more days that "<b>n</b> months ago", the
last day of "<b>n</b> months ago" will be used (e.g., if today is April 31 and
you compute a date 1 month ago, the resulting date will be March 30). 
equal to 30 days of runtime (one month equals 2,592,000 seconds). 
<br><dt>&lsquo;<samp><span class="samp">Day</span></samp>&rsquo;<dd>Days ago (you may, for example, specify 120 days)
<br><dt>&lsquo;<samp><span class="samp">Hours</span></samp>&rsquo;<dd>Hours ago.  Since all computation are done using "Epoch time", 1 hour ago will
alway result in a time 60 minutes in the past, even during the transition
from Da ylight time to Standard time. 
<br><dt>&lsquo;<samp><span class="samp">Minutes</span></samp>&rsquo;<dd>Minutes ago
0-59
<br><dt>&lsquo;<samp><span class="samp">Seconds</span></samp>&rsquo;<dd>Seconds ago
</dl>

<div class="node">
<a name="Function-and"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-canonify">Function canonify</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-ago">Function ago</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.5 Function and</h3>

<p class="noindent"><b>Synopsis</b>: and(...) returns type <b>string</b>

   <p><br>

<p class="noindent">Calculate whether all arguments evaluate to true

<p class="noindent"><b>Example</b>:<br>
<br>
<pre class="verbatim">
commands:
  "/usr/bin/generate_config $(config)"
    ifvarclass => and(not(fileexists("/etc/config/$(config)")), "generating_configs");

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>
<i>History</i>: Was introduced in 3.2.0, Nova 2.1.0 (2011)

<div class="node">
<a name="Function-canonify"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-concat">Function concat</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-and">Function and</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.6 Function canonify</h3>

<p class="noindent"><b>Synopsis</b>: canonify(arg1) returns type <b>string</b>

   <p><br>
   <i>arg1</i> : String containing non-identifier characters, <i>in the range</i> .*
<br>

<p class="noindent">Convert an abitrary string into a legal class name

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
commands:

   "/var/cfengine/bin/$(component)"

       ifvarclass => canonify("start_$(component)");

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This is for use in turning arbitrary text into class data, See <a href="#Function-classify">Function classify</a>.

<div class="node">
<a name="Function-concat"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-changedbefore">Function changedbefore</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-canonify">Function canonify</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.7 Function concat</h3>

<p class="noindent"><b>Synopsis</b>: concat(...) returns type <b>string</b>

   <p><br>

<p class="noindent">Concatenate all arguments into string

<p class="noindent"><b>Example</b>:<br>
<br>
<pre class="verbatim">
commands:
  "/usr/bin/generate_config $(config)"
    ifvarclass => concat("have_config_", canonify("$(config)"));

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>
<i>History</i>: Was introduced in 3.2.0, Nova 2.1.0 (2011)

<div class="node">
<a name="Function-changedbefore"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-classify">Function classify</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-concat">Function concat</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.8 Function changedbefore</h3>

<p class="noindent"><b>Synopsis</b>: changedbefore(arg1,arg2) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : Newer filename, <i>in the range</i> "?(/.*)
<br>
   <i>arg2</i> : Older filename, <i>in the range</i> "?(/.*)
<br>

<p class="noindent">True if arg1 was changed before arg2 (ctime)

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{     
classes:

  "do_it" and => { changedbefore("/tmp/earlier","/tmp/later"), "linux" }; 

reports:

  do_it::

    "The derived file needs updating";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Change times include both file permissions and file contents. Comparisons like this are normally
used for updating files (like the `make' command).

<div class="node">
<a name="Function-classify"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-classmatch">Function classmatch</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-changedbefore">Function changedbefore</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.9 Function classify</h3>

<p class="noindent"><b>Synopsis</b>: classify(arg1) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : Input string, <i>in the range</i> .*
<br>

<p class="noindent">True if the canonicalization of the argument is a currently defined class

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
classes:

 "i_am_the_policy_host" expression => classify("master.example.org");

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This function returns true if the canonical form of
the argument is already a defined class. This is useful, for example,
transforming variables into classes, See <a href="#Function-canonify">Function canonify</a>.

<div class="node">
<a name="Function-classmatch"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-countclassesmatching">Function countclassesmatching</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-classify">Function classify</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.10 Function classmatch</h3>

<p class="noindent"><b>Synopsis</b>: classmatch(arg1) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : Regular expression, <i>in the range</i> .*
<br>

<p class="noindent">True if the regular expression matches any currently defined class

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{     
classes:

  "do_it" and => { classmatch(".*_cfengine_com"), "linux" }; 

reports:

  do_it::

    "Host matches pattern";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The regular expression is matched against the current list of defined classes. 
The regular expression must match a complete class for the expression to
be true, that is, the regex is anchored,
See <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>.

<div class="node">
<a name="Function-countclassesmatching"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-countlinesmatching">Function countlinesmatching</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-classmatch">Function classmatch</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.11 Function countclassesmatching</h3>

<p class="noindent"><b>Synopsis</b>: countclassesmatching(arg1) returns type <b>int</b>

   <p><br>
   <i>arg1</i> : Regular expression, <i>in the range</i> .*
<br>

<p class="noindent">Count the number of defined classes matching regex arg1

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle agent example
{
vars:

  "num" int => countclassesmatching("entropy.*low");

reports:

  cfengine_3::

    "Found $(num) classes matching";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This function matches classes, using a regular expression
that should match the whole line.

     <dl>
<dt>&lsquo;<samp><span class="samp">regex</span></samp>&rsquo;<dd>A regular expression matching zero or more classes in the current list
of defined classes.  The regular
expression must match a complete class, that is, it is anchored,
See <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>. 
</dl>

   <p>The function returns the number of classes matched.

<div class="node">
<a name="Function-countlinesmatching"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-dirname">Function dirname</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-countclassesmatching">Function countclassesmatching</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.12 Function countlinesmatching</h3>

<p class="noindent"><b>Synopsis</b>: countlinesmatching(arg1,arg2) returns type <b>int</b>

   <p><br>
   <i>arg1</i> : Regular expression, <i>in the range</i> .*
<br>
   <i>arg2</i> : Filename, <i>in the range</i> "?(/.*)
<br>

<p class="noindent">Count the number of lines matching regex arg1 in file arg2

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle agent example
{     
vars:

  "no" int => countlinesmatching("m.*","/etc/passwd");

reports:

  cfengine_3::

    "Found $(no) lines matching";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This function matches lines in the named file, using a regular expression
that should match the whole line.

     <dl>
<dt>&lsquo;<samp><span class="samp">regex</span></samp>&rsquo;<dd>A regular expression matching zero or more lines.  The regular
expression must match a complete line (that is, it is anchored,
see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>).

     <br><dt>&lsquo;<samp><span class="samp">filename</span></samp>&rsquo;<dd>The name of the file to be examined. 
</dl>

   <p>The function returns the number of lines matched.

<div class="node">
<a name="Function-dirname"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-diskfree">Function diskfree</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-countlinesmatching">Function countlinesmatching</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.13 Function dirname</h3>

<p class="noindent"><b>Synopsis</b>: dirname(arg1) returns type <b>string</b>

   <p><br>
   <i>arg1</i> : File path, <i>in the range</i> .*
<br>

<p class="noindent">Return the parent directory name for given path

<p class="noindent"><b>Example</b>:<br>
<br>
<pre class="verbatim">vars:
  "apache_dir" string => dirname("/etc/apache2/httpd.conf");
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>
<i>History</i>: Was introduced in 3.3.0, Nova 2.2.0 (2011)

   <p>This function returns directory name for the argument. If directory
name is provided, name of parent directory is returned.

<div class="node">
<a name="Function-diskfree"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-escape">Function escape</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-dirname">Function dirname</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.14 Function diskfree</h3>

<p class="noindent"><b>Synopsis</b>: diskfree(arg1) returns type <b>int</b>

   <p><br>
   <i>arg1</i> : File system directory, <i>in the range</i> "?(/.*)
<br>

<p class="noindent">Return the free space (in KB) available on the directory's current partition (0 if not found)

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle agent example
{     
vars:

  "free" int => diskfree("/tmp"); 

reports:

  cfengine_3::

    "Freedisk $(free)";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Values returned in kilobytes.

<div class="node">
<a name="Function-escape"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-execresult">Function execresult</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-diskfree">Function diskfree</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.15 Function escape</h3>

<p class="noindent"><b>Synopsis</b>: escape(arg1) returns type <b>string</b>

   <p><br>
   <i>arg1</i> : IP address or string to escape, <i>in the range</i> .*
<br>

<p class="noindent">Escape regular expression characters in a string

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle server control
{
allowconnects         => { "127\.0\.0\.1", escape("192.168.2.1") };
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This function is useful for making inputs readable when a regular expression
is required, but the literal string contains special characters.  The
function simply 'escapes' all the regular expression characters, so that you
don't have to.

   <p>This in the example above, the string "192.168.2.1" is "escaped" to be
equivalent to "192\.168\.2\.1" (because without the backslashes, the regular
expression "192.168.2.1" will also match the IP ranges "192.168.201",
"192.168.231", etc - since the dot character means "match any character" when
used in a regular expression).

   <p><b>History</b>: This function was introduced in CFEngine version 3.0.4 (2010)

<div class="node">
<a name="Function-execresult"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-fileexists">Function fileexists</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-escape">Function escape</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.16 Function execresult</h3>

<p class="noindent"><b>Synopsis</b>: execresult(arg1,arg2) returns type <b>string</b>

   <p><br>
   <i>arg1</i> : Fully qualified command path, <i>in the range</i> "?(/.*)
<br>
   <i>arg2</i> : Shell encapsulation option, <i>in the range</i> useshell,noshell
<br>

<p class="noindent">Execute named command and assign output to variable

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{     
vars:

  "my_result" string => execresult("/bin/ls /tmp","noshell");

reports:

  linux::

    "Variable is $(my_result)";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The second argument (&lsquo;<samp><span class="samp">useshell</span></samp>&rsquo;/&lsquo;<samp><span class="samp">noshell</span></samp>&rsquo;) decides whether a
shell will be used to encapsulate the command.  This is necessary in
order to combine commands with pipes etc, but remember that each
command requires a new process that reads in files beyond CFEngine's
control. Thus using a shell is both a performance hog and a potential
security issue.

   <p>Note: you should never use this function to execute comands that make
changes to the system, or perform lengthy computations. Such an
operation is beyond CFEngine's ability to guarantee convergence, and
on multiple passes and during syntax verification, these function
calls are executed resulting in system changes that are
`covert'. Calls to <code>execresult</code> should be for discovery and
information extraction only.

   <p>Note: if the command is not found, the result will be the empty string!

<p class="noindent"><b>Change:</b> policy change in CFEngine 3.0.5. Previously newlines
were changed for spaces, now newlines are preserved.

<div class="node">
<a name="Function-fileexists"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-filesexist">Function filesexist</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-execresult">Function execresult</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.17 Function fileexists</h3>

<p class="noindent"><b>Synopsis</b>: fileexists(arg1) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : File object name, <i>in the range</i> "?(/.*)
<br>

<p class="noindent">True if the named file can be accessed

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{     
classes:

  "exists" expression => fileexists("/etc/passwd");

reports:

  exists::

    "File exists";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The user must have access permissions to the file for this to work
faithfully.

<div class="node">
<a name="Function-filesexist"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-filesize">Function filesize</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-fileexists">Function fileexists</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.18 Function filesexist</h3>

<p class="noindent"><b>Synopsis</b>: filesexist(arg1) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : Array identifier containing list, <i>in the range</i> @[(][a-zA-Z0-9]+[)]
<br>

<p class="noindent">True if the named list of files can ALL be accessed

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{     
vars:

  "mylist" slist => { "/tmp/a", "/tmp/b", "/tmp/c" };

classes:

  "exists" expression => filesexist("@(mylist)");

reports:

  exists::

    "Files exist";

  !exists::

    "Do not exist";

}



</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The user must have access permissions to the file for this to work
faithfully.

<div class="node">
<a name="Function-filesize"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-getenv">Function getenv</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-filesexist">Function filesexist</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.19 Function filesize</h3>

<p class="noindent"><b>Synopsis</b>: filesize(arg1) returns type <b>int</b>

   <p><br>
   <i>arg1</i> : File object name, <i>in the range</i> "?(/.*)
<br>

<p class="noindent">Returns the size in bytes of the file

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle agent example
{     
vars:

  "exists" int => filesize("/etc/passwd");
  "nexists" int => filesize("/etc/passwdx");

reports:

  !xyz::

    "File size $(exists)";
    "Does not exist $(nexists)";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.1.3,Nova 2.0.2 (2010)

   <p>If the file object does not exist, the function call fails and the variable
does not expand.

<div class="node">
<a name="Function-getenv"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-getfields">Function getfields</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-filesize">Function filesize</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.20 Function getenv</h3>

<p class="noindent"><b>Synopsis</b>: getenv(arg1,arg2) returns type <b>string</b>

   <p><br>
   <i>arg1</i> : Name of environment variable, <i>in the range</i> [a-zA-Z0-9_$(){}\[\].:]+
<br>
   <i>arg2</i> : Maximum number of characters to read , <i>in the range</i> 0,99999999999
<br>

<p class="noindent">Return the environment variable named arg1, truncated at arg2 characters

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle agent example
{
vars:

   "myvar" string => getenv("PATH","20");

classes:

  "isdefined" not => strcmp("$(myvar)","");

reports:

  isdefined::

   "The path is $(myvar)";

  !isdefined::

   "The named variable PATH does not exist";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Returns an empty string if the environment variable is not defined. 
Arg2 is used to avoid unexpectedly large return values,
which could lead to security issues. Choose a reasonable
value based on the environment variable you are querying.

   <p><b>History</b>: This function was introduced in CFEngine version 3.0.4 (2010)

<div class="node">
<a name="Function-getfields"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-getgid">Function getgid</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-getenv">Function getenv</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.21 Function getfields</h3>

<p class="noindent"><b>Synopsis</b>: getfields(arg1,arg2,arg3,arg4) returns type <b>int</b>

   <p><br>
   <i>arg1</i> : Regular expression to match line, <i>in the range</i> .*
<br>
   <i>arg2</i> : Filename to read, <i>in the range</i> "?(/.*)
<br>
   <i>arg3</i> : Regular expression to split fields, <i>in the range</i> .*
<br>
   <i>arg4</i> : Return array name, <i>in the range</i> .*
<br>

<p class="noindent">Get an array of fields in the lines matching regex arg1 in file arg2, split on regex arg3 as array name arg4

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle agent example

{     
vars:

  "no" int => getfields("mark:.*","/etc/passwd",":","userdata");

reports:

  cfengine_3::

    "Found $(no) lines matching";
    "Mark's homedir = $(userdata[6])";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This function matches lines (using a regular expression) in the named file, and
splits the <i>first</i> matched line into fields (using a second) regular expression),
placing these into a named array whose elements are <code>array[1],array[2],..</code>. 
This is useful for examining user data in the Unix password or group files.

     <dl>
<dt>&lsquo;<samp><span class="samp">regex</span></samp>&rsquo;<dd>A regular expression matching one or more lines.  The regular
expression must match the entire line (that is, it is anchored,
see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>).

     <br><dt>&lsquo;<samp><span class="samp">filename</span></samp>&rsquo;<dd>The name of the file to be examined.

     <br><dt>&lsquo;<samp><span class="samp">split</span></samp>&rsquo;<dd>A regex pattern which is used to parse the field separator(s)
to split up the file into items

     <br><dt>&lsquo;<samp><span class="samp">array_lval</span></samp>&rsquo;<dd>The base name of the array that returns the values.

   </dl>

   <p>The function returns the number of lines matched.  This function
is most useful when you want only the first matching line (e.g.,
to mimic the behavior of the <i>getpwnam(3)</i> on the file
<samp><span class="file">/etc/passwd</span></samp>).  If you want to examine <i>all</i> matching lines,
See <a href="#Function-readstringarray">Function readstringarray</a>, instead.

<div class="node">
<a name="Function-getgid"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-getindices">Function getindices</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-getfields">Function getfields</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.22 Function getgid</h3>

<p class="noindent"><b>Synopsis</b>: getgid(arg1) returns type <b>int</b>

   <p><br>
   <i>arg1</i> : Group name in text, <i>in the range</i> .*
<br>

<p class="noindent">Return the integer group id of the named group on this host

<p class="noindent"><b>Example</b>:<br>
<br>
<pre class="verbatim">
body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{     
vars:

  "gid" int => getgid("users");

reports:

  Yr2008::

    "Users gid is $(gid)";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>If the named group does not exist, the variable will not be
defined. On windows, which does not support group ids, the variable
will not be defined.

<div class="node">
<a name="Function-getindices"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-getuid">Function getuid</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-getgid">Function getgid</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.23 Function getindices</h3>

<p class="noindent"><b>Synopsis</b>: getindices(arg1) returns type <b>slist</b>

   <p><br>
   <i>arg1</i> : Cfengine array identifier, <i>in the range</i> [a-zA-Z0-9_$(){}\[\].:]+
<br>

<p class="noindent">Get a list of keys to the array whose id is the argument and assign to variable

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control

{
any::

  bundlesequence  => { "testsetvar" };   
}


#######################################################

bundle agent testsetvar

{
vars:

  "v[index_1]" string => "value_1";
  "v[index_2]" string => "value_2";

  "parameter_name" slist => getindices("v");

reports:

  Yr2008::

   "Found index: $(parameter_name)";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Make sure you specify the correct scope when supplying the name of the variable.

<div class="node">
<a name="Function-getuid"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-getusers">Function getusers</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-getindices">Function getindices</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.24 Function getuid</h3>

<p class="noindent"><b>Synopsis</b>: getuid(arg1) returns type <b>int</b>

   <p><br>
   <i>arg1</i> : User name in text, <i>in the range</i> .*
<br>

<p class="noindent">Return the integer user id of the named user on this host

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{
vars:

  "uid" int => getuid("mark");

reports:

  Yr2008::

    "Users uid is $(uid)";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>If the named user is not registered the variable will not be
defined. On windows, which does not support user ids, the variable
will not be defined.

<div class="node">
<a name="Function-getusers"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-getvalues">Function getvalues</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-getuid">Function getuid</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.25 Function getusers</h3>

<p class="noindent"><b>Synopsis</b>: getusers(arg1,arg2) returns type <b>slist</b>

   <p><br>
   <i>arg1</i> : Comma separated list of User names, <i>in the range</i> .*
<br>
   <i>arg2</i> : Comma separated list of UserID numbers, <i>in the range</i> .*
<br>

<p class="noindent">Get a list of all system users defined, minus those names defined in arg1 and uids in arg2

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">vars:
  "allusers" slist => getusers("zenoss,mysql,at","12,0");

reports:

 linux::

  "Found user $(allusers)";
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><b>History</b>: Was introduced in version 3.1.0b1,Nova 2.0.0b1 (2010)
This function is only available on Unix-like systems in the present version.

   <p>The function has two arguments, both are comma separated lists. The first argument is a list
of user names that should be excluded from the output. The second is a list of integrer UIDs
that should be excluded.

<div class="node">
<a name="Function-getvalues"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-grep">Function grep</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-getusers">Function getusers</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.26 Function getvalues</h3>

<p class="noindent"><b>Synopsis</b>: getvalues(arg1) returns type <b>slist</b>

   <p><br>
   <i>arg1</i> : Cfengine array identifier, <i>in the range</i> [a-zA-Z0-9_$(){}\[\].:]+
<br>

<p class="noindent">Get a list of values corresponding to the right hand sides in an array whose id is the argument and assign to variable

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control

{
any::

  bundlesequence  => { "testsetvar" };   
}


#######################################################

bundle agent testsetvar

{
vars:

  "v[index_1]" string => "value_1";
  "v[index_2]" string => "value_2";

  "parameter_name" slist => getvalues("v");

reports:

  Yr2008::

   "Found index: $(parameter_name)";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Make sure you specify the correct scope when supplying the name of the
variable.  If the array contains list elements on the right hand side
then all of the list elements are flattened into a single list to make the return value a list.

<div class="node">
<a name="Function-grep"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-groupexists">Function groupexists</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-getvalues">Function getvalues</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.27 Function grep</h3>

<p class="noindent"><b>Synopsis</b>: grep(arg1,arg2) returns type <b>slist</b>

   <p><br>
   <i>arg1</i> : Regular expression, <i>in the range</i> .*
<br>
   <i>arg2</i> : CFEngine list identifier, <i>in the range</i> [a-zA-Z0-9_$(){}\[\].:]+
<br>

<p class="noindent">Extract the sub-list if items matching the regular expression in arg1 of the list named in arg2

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle agent test

{
vars:

  "mylist" slist => { "One", "Two", "Three", "Four", "Five" };

  "sublist" slist => grep("T.*","mylist");

  "empty_list" slist => grep("ive","mylist");

reports:

 linux::

  "Item: $(sublist)";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Extracts a sublist of elements matching the regular expression in arg1 from a
list variable specified in arg2.  The regex is anchored. 
See <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>.

<div class="node">
<a name="Function-groupexists"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-hash">Function hash</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-grep">Function grep</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.28 Function groupexists</h3>

<p class="noindent"><b>Synopsis</b>: groupexists(arg1) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : Group name or identifier, <i>in the range</i> .*
<br>

<p class="noindent">True if group or numerical id exists on this host

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{     
classes:

  "gname" expression => groupexists("users");
  "gid"   expression => groupexists("100");

reports:

  gname::

    "Group exists by name";

  gid::

    "Group exists by id";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The group may be specified by name or number.

<div class="node">
<a name="Function-hash"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-hashmatch">Function hashmatch</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-groupexists">Function groupexists</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.29 Function hash</h3>

<p class="noindent"><b>Synopsis</b>: hash(arg1,arg2) returns type <b>string</b>

   <p><br>
   <i>arg1</i> : Input text, <i>in the range</i> .*
<br>
   <i>arg2</i> : Hash or digest algorithm, <i>in the range</i> md5,sha1,sha256,sha512,sha384,crypt
<br>

<p class="noindent">Return the hash of arg1, type arg2 and assign to a variable

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">

body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{     
vars:

  "md5" string => hash("CFEngine is not cryptic","md5");

reports:

  Yr2008::

    "Hashed to: $(md5)";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Hash functions are extremely sensitive to input. You should not expect
to get the same answer from this function as you would from every other
tool, since it depends on how whitespace and end of file characters are
handled.

   <p>Valid hash types (depending on availablity) include:
<code>md5</code>, <code>sha1</code>, <code>sha256</code>, <code>sha512</code> ,<code>sha384</code>,
<code>crypt</code>.

<div class="node">
<a name="Function-hashmatch"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-host2ip">Function host2ip</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-hash">Function hash</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.30 Function hashmatch</h3>

<p class="noindent"><b>Synopsis</b>: hashmatch(arg1,arg2,arg3) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : Filename to hash, <i>in the range</i> "?(/.*)
<br>
   <i>arg2</i> : Hash or digest algorithm, <i>in the range</i> md5,sha1,crypt,cf_sha224,cf_sha256,cf_sha384,cf_sha512
<br>
   <i>arg3</i> : ASCII representation of hash for comparison, <i>in the range</i> [a-zA-Z0-9_$(){}\[\].:]+
<br>

<p class="noindent">Compute the hash of arg1, of type arg2 and test if it matches the value in arg3

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle agent example

{     
classes:

  "matches" expression => hashmatch("/etc/passwd","md5","c5068b7c2b1707f8939b283a2758a691");

reports:

  matches::

    "File has correct version";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="example">     
     (class) hashmatch(<var>file</var>,<var>md5|sha1|crypt</var>,<var>hash-comparison</var>);
     
</pre>
   </td></tr></table>

   <p>This function may be used to determine whether a system has a particular
version of a binary file (e.g. software patch).

<p class="noindent"><b>ARGUMENTS</b>:

     <ul>
<li>The file concerned
<li>The type of hash
<li>A string of the hash to which we expect the file to conform. 
</ul>

<div class="node">
<a name="Function-host2ip"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-ip2host">Function ip2host</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-hashmatch">Function hashmatch</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.31 Function host2ip</h3>

<p class="noindent"><b>Synopsis</b>: host2ip(arg1) returns type <b>string</b>

   <p><br>
   <i>arg1</i> : Host name in ascii, <i>in the range</i> .*
<br>

<p class="noindent">Returns the primary name-service IP address for the named host

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle server control
{
allowconnects         => { escape(host2ip("www.example.com")) };
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Uses whatever configured name service is used by the resolver library
to translate a hostname into an IP address. It will return an IPv6
address by preference if such an address exists. This function uses
the standard lookup procedure for a name, so it mimics internal
processes and can therefore be used not only to cache multiple lookups
in the configuration, but to debug the behaviour of the resolver.

   <p><b>History</b>: This function was introduced in CFEngine version 3.0.4 (2010)

<div class="node">
<a name="Function-ip2host"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-hostinnetgroup">Function hostinnetgroup</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-host2ip">Function host2ip</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.32 Function ip2host</h3>

<p class="noindent"><b>Synopsis</b>: ip2host(arg1) returns type <b>string</b>

   <p><br>
   <i>arg1</i> : IP address (IPv4 or IPv6), <i>in the range</i> .*
<br>

<p class="noindent">Returns the primary name-service host name for the IP address

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">bundle agent reverse_lookup
{
vars:
 "local4" string => ip2host("127.0.0.1");
 "local6" string => ip2host("::1");


reports:
cfengine_3::
  "local4 is $(local4)";
  "local6 is $(local6)";
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Uses whatever configured name service is used by the resolver library
to translate an IP address to a hostname. IPv6 addresses will also
resolve, if supported by the resolver library.

   <p>Note that DNS lookups may take time and thus cause CFEngine agents to
wait for responses, slowing their progress significantly.

   <p><i>History</i>: Was introduced in version 3.1.3, Nova 2.0.2 (2010)

<div class="node">
<a name="Function-hostinnetgroup"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-hostrange">Function hostrange</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-ip2host">Function ip2host</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.33 Function hostinnetgroup</h3>

<p class="noindent"><b>Synopsis</b>: hostinnetgroup(arg1) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : Netgroup name, <i>in the range</i> .*
<br>

<p class="noindent">True if the current host is in the named netgroup

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
classes:

  "ingroup" expression => hostinnetgroup("my_net_group");

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

<div class="node">
<a name="Function-hostrange"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-hostsseen">Function hostsseen</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-hostinnetgroup">Function hostinnetgroup</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.34 Function hostrange</h3>

<p class="noindent"><b>Synopsis</b>: hostrange(arg1,arg2) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : Hostname prefix, <i>in the range</i> .*
<br>
   <i>arg2</i> : Enumerated range, <i>in the range</i> .*
<br>

<p class="noindent">True if the current host lies in the range of enumerated hostnames specified

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">

body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{     
classes:

  "compute_nodes" expression => hostrange("cpu-","01-32");

reports:

  compute_nodes::

    "No computer is a cluster";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This is a pattern matching function for non-regular (enumerated) expressions.

<div class="node">
<a name="Function-hostsseen"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-hostswithclass">Function hostswithclass</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-hostrange">Function hostrange</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.35 Function hostsseen</h3>

<p class="noindent"><b>Synopsis</b>: hostsseen(arg1,arg2,arg3) returns type <b>slist</b>

   <p><br>
   <i>arg1</i> : Horizon since last seen in hours, <i>in the range</i> 0,99999999999
<br>
   <i>arg2</i> : Complements for selection policy, <i>in the range</i> lastseen,notseen
<br>
   <i>arg3</i> : Type of return value desired, <i>in the range</i> name,address
<br>

<p class="noindent">Extract the list of hosts last seen/not seen within the last arg1 hours

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">bundle agent test

{
vars:

  "myhosts" slist => { hostsseen("inf","lastseen","address") };

reports:

  cfengine_3::

    "Found client/peer: $(myhosts)";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Finds a list of hosts seen by a CFEngine remote connection on the
current host within the number of hours specified by argument
1. Argument 2 may be &lsquo;<samp><span class="samp">lastseen</span></samp>&rsquo; or &lsquo;<samp><span class="samp">notseen</span></samp>&rsquo;, the latter
being all hosts not observed to have connected within the specified
time.  Argument 3 may be &lsquo;<samp><span class="samp">address</span></samp>&rsquo; or &lsquo;<samp><span class="samp">name</span></samp>&rsquo;, to return ip
address or hostname form.

<div class="node">
<a name="Function-hostswithclass"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-hubknowledge">Function hubknowledge</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-hostsseen">Function hostsseen</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.36 Function hostswithclass</h3>

<p class="noindent"><b>Synopsis</b>: hostswithclass(arg1,arg2) returns type <b>slist</b>

   <p><br>
   <i>arg1</i> : Class name to look for, <i>in the range</i> [a-zA-Z0-9_]+
<br>
   <i>arg2</i> : Type of return value desired, <i>in the range</i> name,address
<br>

<p class="noindent">Extract the list of hosts with the given class set from the hub database (commercial extension)

<p class="noindent"><b>Example</b>:<br>
<br>
<pre class="verbatim">body common control
{
bundlesequence => { "test" };
inputs => { "cfengine_stdlib.cf" };
}


bundle agent test
{
vars:

am_policy_hub::
 "host_list" slist => hostswithclass( "debian", "name" );

files:
am_policy_hub::
  "/tmp/master_config.cfg"
         edit_line => insert_lines("host=$(host_list)"),
            create => "true";
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>On CFEngine Nova hubs, this function can be used to return a list of
hostnames or ip-addresses of hosts that has the class given as
argument 1.  Argument 2 may be &lsquo;<samp><span class="samp">address</span></samp>&rsquo; or &lsquo;<samp><span class="samp">name</span></samp>&rsquo;, to
return ip address or hostname form.

   <p>Note that this function only works locally on the hub, but allows the
hub to construct custom configuration files for (classes of) hosts.

   <p><i>History</i>: Was introduced in 3.3.0, Nova 2.2.0 (2012)

   <p>Availability: Enterprise editions of CFEngine only.

<pre class="verbatim">
</pre>

<div class="node">
<a name="Function-hubknowledge"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-iprange">Function iprange</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-hostswithclass">Function hostswithclass</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.37 Function hubknowledge</h3>

<p class="noindent"><b>Synopsis</b>: hubknowledge(arg1) returns type <b>string</b>

   <p><br>
   <i>arg1</i> : Variable identifier, <i>in the range</i> [a-zA-Z0-9_$(){}\[\].:]+
<br>

<p class="noindent">Read global knowledge from the hub host by id (commercial extension)

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
vars:

  guard::

   "global_number" string => hubknowledge("number_variable");

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This function is only available in commercial releases of CFEngine. 
It is intended for use in distributed orchestration. It is recommended
that you use this function sparingly with <i>guards</i>, as it
contributes to network traffic and depends on the network for its function. 
Unlike <code>remotescalar()</code>, the value of hub-knowledge is not cached.

   <p>This function behaves is essentially similar to the
<code>remotescalar</code> function, except that it always gets its
information from the policy server hub by an encrypted connection. It
is designed for spreading globally calibrated information about a
CFEngine swarm back to the client machines. The data available through
this channel are generated automatically by discovery, unlike
<code>remotescalar</code> which accesses user defined data.

   <p>This function asks for an identifier; it is up to the server to interpret
what this means and to return a value of its choosing. If the identifier matches
a persistent scalar variable (such as is used to count distributed processes in CFEngine
Enterprise) then this will be returned preferentially. If no such variable is found,
then the server will look for a literal string in a server bundle with a handle that
matches the requested object.

<div class="node">
<a name="Function-iprange"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-irange">Function irange</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-hubknowledge">Function hubknowledge</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.38 Function iprange</h3>

<p class="noindent"><b>Synopsis</b>: iprange(arg1) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : IP address range syntax, <i>in the range</i> .*
<br>

<p class="noindent">True if the current host lies in the range of IP addresses specified

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{     
classes:

  "adhoc_group_1" expression => iprange("128.39.89.10-15");
  "adhoc_group_2" expression => iprange("128.39.74.1/23");

reports:

  adhoc_group_1::

    "Some numerology";

  adhoc_group_2::

    "The masked warriors";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Pattern matching based on IP addresses.

<div class="node">
<a name="Function-irange"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-isdir">Function isdir</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-iprange">Function iprange</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.39 Function irange</h3>

<p class="noindent"><b>Synopsis</b>: irange(arg1,arg2) returns type <b>irange [int,int]</b>

   <p><br>
   <i>arg1</i> : Integer, <i>in the range</i> -99999999999,9999999999
<br>
   <i>arg2</i> : Integer, <i>in the range</i> -99999999999,9999999999
<br>

<p class="noindent">Define a range of integer values for cfengine internal use

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
irange("1","100");

irange(ago(0,0,0,1,30,0), "0");

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Used for any scalar attribute which requires an integer range.  You can
generally interchangeably say &lsquo;<samp><span class="samp">"1,10"</span></samp>&rsquo; or &lsquo;<samp><span class="samp">irange("1","10")</span></samp>&rsquo;
(however, if you want to create a range of dates or times, you must use
irange if you also use the functions &lsquo;<samp><span class="samp">ago</span></samp>&rsquo;, &lsquo;<samp><span class="samp">now</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">accumulated</span></samp>&rsquo;, etc).

<div class="node">
<a name="Function-isdir"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-isexecutable">Function isexecutable</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-irange">Function irange</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.40 Function isdir</h3>

<p class="noindent"><b>Synopsis</b>: isdir(arg1) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : File object name, <i>in the range</i> "?(/.*)
<br>

<p class="noindent">True if the named object is a directory

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">

body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{     
classes:

  "isdir" expression => isdir("/etc");

reports:

  isdir::

    "Directory exists..";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The CFEngine process must have access to the object concerned in order for
this to work.

<div class="node">
<a name="Function-isexecutable"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-isgreaterthan">Function isgreaterthan</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-isdir">Function isdir</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.41 Function isexecutable</h3>

<p class="noindent"><b>Synopsis</b>: isexecutable(arg1) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : File object name, <i>in the range</i> "?(/.*)
<br>

<p class="noindent">True if the named object has execution rights for the current user

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">classes:

  "yes" expression => isexecutable("/bin/ls");

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.1.0b1,Nova 2.0.0b1 (2010)

<div class="node">
<a name="Function-isgreaterthan"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-islessthan">Function islessthan</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-isexecutable">Function isexecutable</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.42 Function isgreaterthan</h3>

<p class="noindent"><b>Synopsis</b>: isgreaterthan(arg1,arg2) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : Larger string or value, <i>in the range</i> .*
<br>
   <i>arg2</i> : Smaller string or value, <i>in the range</i> .*
<br>

<p class="noindent">True if arg1 is numerically greater than arg2, else compare strings like strcmp

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control

{
bundlesequence  => { "test"  };
}

###########################################################

bundle agent test

{
classes:

  "ok" expression => isgreaterthan("1","0");

reports:

  ok::

    "Assertion is true";

 !ok::

  "Assertion is false";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The comparison is made numerically if possible. If the values are
strings, the result is identical to that of comparing with &lsquo;<samp><span class="samp">strcmp()</span></samp>&rsquo;.

<div class="node">
<a name="Function-islessthan"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-islink">Function islink</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-isgreaterthan">Function isgreaterthan</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.43 Function islessthan</h3>

<p class="noindent"><b>Synopsis</b>: islessthan(arg1,arg2) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : Smaller string or value, <i>in the range</i> .*
<br>
   <i>arg2</i> : Larger string or value, <i>in the range</i> .*
<br>

<p class="noindent">True if arg1 is numerically less than arg2, else compare strings like NOT strcmp

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control

{
bundlesequence  => { "test"  };
}

###########################################################

bundle agent test

{
classes:

  "ok" expression => islessthan("0","1");

reports:

  ok::

    "Assertion is true";

 !ok::

  "Assertion is false";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The complement of <code>isgreaterthan</code>. 
The comparison is made numerically if possible. If the values are
strings, the result is identical to that of comparing with &lsquo;<samp><span class="samp">strcmp()</span></samp>&rsquo;.

<div class="node">
<a name="Function-islink"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-isnewerthan">Function isnewerthan</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-islessthan">Function islessthan</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.44 Function islink</h3>

<p class="noindent"><b>Synopsis</b>: islink(arg1) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : File object name, <i>in the range</i> "?(/.*)
<br>

<p class="noindent">True if the named object is a symbolic link

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{     
classes:

  "isdir" expression => islink("/tmp/link");

reports:

  isdir::

    "Directory exists..";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The link node must both exist and be a symbolic link. Hard links cannot be
detected using this function. A hard link is a regular file or directory.

<div class="node">
<a name="Function-isnewerthan"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-isplain">Function isplain</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-islink">Function islink</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.45 Function isnewerthan</h3>

<p class="noindent"><b>Synopsis</b>: isnewerthan(arg1,arg2) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : Newer file name, <i>in the range</i> "?(/.*)
<br>
   <i>arg2</i> : Older file name, <i>in the range</i> "?(/.*)
<br>

<p class="noindent">True if arg1 is newer (modified later) than arg2 (mtime)

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{     
classes:

  "do_it" and => { isnewerthan("/tmp/later","/tmp/earlier"), "linux" }; 

reports:

  do_it::

    "The derived file needs updating";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This function compares the modification time of the file, referring to changes
of content only.

<div class="node">
<a name="Function-isplain"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-isvariable">Function isvariable</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-isnewerthan">Function isnewerthan</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.46 Function isplain</h3>

<p class="noindent"><b>Synopsis</b>: isplain(arg1) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : File object name, <i>in the range</i> "?(/.*)
<br>

<p class="noindent">True if the named object is a plain/regular file

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{     
classes:

  "isplain" expression => isplain("/etc/passwd");

reports:

  isplain::

    "File exists..";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

<div class="node">
<a name="Function-isvariable"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-join">Function join</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-isplain">Function isplain</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.47 Function isvariable</h3>

<p class="noindent"><b>Synopsis</b>: isvariable(arg1) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : Variable identifier, <i>in the range</i> [a-zA-Z0-9_$(){}\[\].:]+
<br>

<p class="noindent">True if the named variable is defined

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{     
vars:

  "bla" string => "xyz..";

classes:

  "exists" expression => isvariable("bla");

reports:

  exists::

    "Variable exists: \"$(bla)\"..";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The variable need only exist. This says nothing about its value. Use <code>regcmp</code>
to check variable values.

<div class="node">
<a name="Function-join"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-lastnode">Function lastnode</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-isvariable">Function isvariable</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.48 Function join</h3>

<p class="noindent"><b>Synopsis</b>: join(arg1,arg2) returns type <b>string</b>

   <p><br>
   <i>arg1</i> : Join glue-string, <i>in the range</i> .*
<br>
   <i>arg2</i> : CFEngine list identifier, <i>in the range</i> [a-zA-Z0-9_$(){}\[\].:]+
<br>

<p class="noindent">Join the items of arg2 into a string, using the conjunction in arg1

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle agent test

{
vars:

  "mylist" slist => { "one", "two", "three", "four", "five" };

  "scalar" string => join("&lt;->","mylist");

reports:

 linux::

  "Concatenated $(scalar)";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Converts a string of type list into a scalar variable using the join string in first
argument.

<div class="node">
<a name="Function-lastnode"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-laterthan">Function laterthan</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-join">Function join</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.49 Function lastnode</h3>

<p class="noindent"><b>Synopsis</b>: lastnode(arg1,arg2) returns type <b>string</b>

   <p><br>
   <i>arg1</i> : Input string, <i>in the range</i> .*
<br>
   <i>arg2</i> : Link separator, e.g. /,:, <i>in the range</i> .*
<br>

<p class="noindent">Extract the last of a separated string, e.g. filename from a path

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle agent yes
{
vars:

  "path1" string => "/one/two/last1";
  "path2" string => "one:two:last2";

  "last1" string => lastnode("$(path1)","/");
  "last2" string => lastnode("$(path2)",":");

  "last3" string => lastnode("$(path2)","/");

reports:

  Yr2009::

    "Last = $(last1),$(last2),$(last3)";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This function returns the final node in a chain, given a regular expression to split on. 
This is mainly useful for finding leaf-names of files, from a fully qualified path name.

<div class="node">
<a name="Function-laterthan"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-ldaparray">Function ldaparray</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-lastnode">Function lastnode</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.50 Function laterthan</h3>

<p class="noindent"><b>Synopsis</b>: laterthan(arg1,arg2,arg3,arg4,arg5,arg6) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : Years, <i>in the range</i> 0,1000
<br>
   <i>arg2</i> : Months, <i>in the range</i> 0,1000
<br>
   <i>arg3</i> : Days, <i>in the range</i> 0,1000
<br>
   <i>arg4</i> : Hours, <i>in the range</i> 0,1000
<br>
   <i>arg5</i> : Minutes, <i>in the range</i> 0,1000
<br>
   <i>arg6</i> : Seconds, <i>in the range</i> 0,40000
<br>

<p class="noindent">True if the current time is later than the given date

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
classes:

  "after_deadline" expression => laterthan(2000,1,1,0,0,0);

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The arguments are standard time, See <a href="#Function-on">Function on</a>.

<div class="node">
<a name="Function-ldaparray"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-ldaplist">Function ldaplist</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-laterthan">Function laterthan</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.51 Function ldaparray</h3>

<p class="noindent"><b>Synopsis</b>: ldaparray(arg1,arg2,arg3,arg4,arg5,arg6) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : Array name, <i>in the range</i> .*
<br>
   <i>arg2</i> : URI, <i>in the range</i> .*
<br>
   <i>arg3</i> : Distinguished name, <i>in the range</i> .*
<br>
   <i>arg4</i> : Filter, <i>in the range</i> .*
<br>
   <i>arg5</i> : Search scope policy, <i>in the range</i> subtree,onelevel,base
<br>
   <i>arg6</i> : Security level, <i>in the range</i> none,ssl,sasl
<br>

<p class="noindent">Extract all values from an ldap record

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
classes:

   "gotdata" expression => ldaparray(
                                    "myarray",
                                    "ldap://ldap.example.org",
                                    "dc=cfengine,dc=com",
                                    "(uid=mark)",
                                    "subtree",
                                    "none");

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="example">     
     (class) ldaparray (<var>array</var>,<var>uri</var>,<var>dn</var>,<var>filter</var>,<var>scope</var>,<var>security</var>)
     
</pre>
   </td></tr></table>

   <p>This function retrieves an entire record with all elements and
populates an associative array with the entries. It returns a class
which is true if there was a match for the search and false if nothing
was retrieved.

<p class="noindent"><b>ARGUMENTS</b>:

     <dl>
<dt>&lsquo;<samp><span class="samp">array</span></samp>&rsquo;<dd>String name of the array to populate with the result of the search
<br><dt>&lsquo;<samp><span class="samp">uri</span></samp>&rsquo;<dd>String value of the ldap server. e.g. <code>"ldap://ldap.cfengine.com.no"</code>
<br><dt>&lsquo;<samp><span class="samp">dn</span></samp>&rsquo;<dd>Distinguished name, an ldap formatted name built from components, e.g. "dc=cfengine,dc=com". 
<br><dt>&lsquo;<samp><span class="samp">filter</span></samp>&rsquo;<dd>String filter criterion, in ldap search, e.g. "(sn=User)". 
<br><dt>&lsquo;<samp><span class="samp">scope</span></samp>&rsquo;<dd>Menu option, the type of ldap search, from
     <pre class="smallexample">              subtree
              onelevel
              base
</pre>
     <br><dt>&lsquo;<samp><span class="samp">security</span></samp>&rsquo;<dd>Menu option indicating the encryption and authentication settings
for communication with the LDAP server. These features might be subject
to machine and server capabilites.
     <pre class="smallexample">               none
               ssl
               sasl
</pre>
     </dl>

<div class="node">
<a name="Function-ldaplist"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-ldapvalue">Function ldapvalue</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-ldaparray">Function ldaparray</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.52 Function ldaplist</h3>

<p class="noindent"><b>Synopsis</b>: ldaplist(arg1,arg2,arg3,arg4,arg5,arg6) returns type <b>slist</b>

   <p><br>
   <i>arg1</i> : URI, <i>in the range</i> .*
<br>
   <i>arg2</i> : Distinguished name, <i>in the range</i> .*
<br>
   <i>arg3</i> : Filter, <i>in the range</i> .*
<br>
   <i>arg4</i> : Record name, <i>in the range</i> .*
<br>
   <i>arg5</i> : Search scope policy, <i>in the range</i> subtree,onelevel,base
<br>
   <i>arg6</i> : Security level, <i>in the range</i> none,ssl,sasl
<br>

<p class="noindent">Extract all named values from multiple ldap records

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">vars:

   # Get all matching values for "uid" - should be a single record match

  "list" slist =>  ldaplist(
                           "ldap://ldap.example.org",
                           "dc=cfengine,dc=com",
                           "(sn=User)",
                           "uid",
                           "subtree",
                           "none"
                           );

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="example">     
     (slist) ldaplist(<var>uri</var>,<var>dn</var>,<var>filter</var>,<var>name</var>,<var>scope</var>,<var>security</var>)
     
</pre>
   </td></tr></table>

   <p>This function retrieves a single field from all matching LDAP records identified by the search
parameters.

<p class="noindent"><b>ARGUMENTS</b>:

     <dl>
<dt>&lsquo;<samp><span class="samp">uri</span></samp>&rsquo;<dd>String value of the ldap server. e.g. <code>"ldap://ldap.cfengine.com.no"</code>
<br><dt>&lsquo;<samp><span class="samp">dn</span></samp>&rsquo;<dd>Distinguished name, an ldap formatted name built from components, e.g. "dc=cfengine,dc=com". 
<br><dt>&lsquo;<samp><span class="samp">filter</span></samp>&rsquo;<dd>String filter criterion, in ldap search, e.g. "(sn=User)". 
<br><dt>&lsquo;<samp><span class="samp">name</span></samp>&rsquo;<dd>String value, the name of a single record to be retrieved, e.g. <code>uid</code>. 
<br><dt>&lsquo;<samp><span class="samp">scope</span></samp>&rsquo;<dd>Menu option, the type of ldap search, from the specified root. May take values:
     <pre class="smallexample">              subtree
              onelevel
              base
</pre>
     <br><dt>&lsquo;<samp><span class="samp">security</span></samp>&rsquo;<dd>Menu option indicating the encryption and authentication settings
for communication with the LDAP server. These features might be subject
to machine and server capabilites.
     <pre class="smallexample">               none
               ssl
               sasl
</pre>
     </dl>

<div class="node">
<a name="Function-ldapvalue"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-lsdir">Function lsdir</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-ldaplist">Function ldaplist</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.53 Function ldapvalue</h3>

<p class="noindent"><b>Synopsis</b>: ldapvalue(arg1,arg2,arg3,arg4,arg5,arg6) returns type <b>string</b>

   <p><br>
   <i>arg1</i> : URI, <i>in the range</i> .*
<br>
   <i>arg2</i> : Distinguished name, <i>in the range</i> .*
<br>
   <i>arg3</i> : Filter, <i>in the range</i> .*
<br>
   <i>arg4</i> : Record name, <i>in the range</i> .*
<br>
   <i>arg5</i> : Search scope policy, <i>in the range</i> subtree,onelevel,base
<br>
   <i>arg6</i> : Security level, <i>in the range</i> none,ssl,sasl
<br>

<p class="noindent">Extract the first matching named value from ldap

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
vars:

   # Get the first matching value for "uid" in schema

  "value" string => ldapvalue(
                             "ldap://ldap.example.org", 
                             "dc=cfengine,dc=com",
                             "(sn=User)",
                             "uid",
                             "subtree",
                             "none"
                             );

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="example">     
     (string) ldapvalue(<var>uri</var>,<var>dn</var>,<var>filter</var>,<var>name</var>,<var>scope</var>,<var>security</var>)
     
</pre>
   </td></tr></table>

   <p>This function retrieves a single field from a single LDAP record identified by the search
parameters. The first matching value it taken.

<p class="noindent"><b>ARGUMENTS</b>:

     <dl>
<dt>&lsquo;<samp><span class="samp">uri</span></samp>&rsquo;<dd>String value of the ldap server. e.g. <code>"ldap://ldap.cfengine.com.no"</code>
<br><dt>&lsquo;<samp><span class="samp">dn</span></samp>&rsquo;<dd>Distinguished name, an ldap formatted name built from components, e.g. "dc=cfengine,dc=com". 
<br><dt>&lsquo;<samp><span class="samp">filter</span></samp>&rsquo;<dd>String filter criterion, in ldap search, e.g. "(sn=User)". 
<br><dt>&lsquo;<samp><span class="samp">name</span></samp>&rsquo;<dd>String value, the name of a single record to be retrieved, e.g. <code>uid</code>. 
<br><dt>&lsquo;<samp><span class="samp">scope</span></samp>&rsquo;<dd>Menu option, the type of ldap search, from the specified root. May take values:
     <pre class="smallexample">              subtree
              onelevel
              base
</pre>
     </dl>

<div class="node">
<a name="Function-lsdir"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-maplist">Function maplist</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-ldapvalue">Function ldapvalue</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.54 Function lsdir</h3>

<p class="noindent"><b>Synopsis</b>: lsdir(arg1,arg2,arg3) returns type <b>slist</b>

   <p><br>
   <i>arg1</i> : Path to base directory, <i>in the range</i> .+
<br>
   <i>arg2</i> : Regular expression to match files or blank, <i>in the range</i> .*
<br>
   <i>arg3</i> : Include the base path in the list, <i>in the range</i> true,false,yes,no,on,off
<br>

<p class="noindent">Return a list of files in a directory matching a regular expression

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">vars:
  "listfiles" slist => lsdir("/etc", "(passwd|shadow).*", "true");
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>
<i>History</i>: Was introduced in 3.3.0, Nova 2.2.0 (2011)

   <p>This function returns list of files in directory specified in arg1,
matched with regular expression in arg2. In case arg3 is true, full
paths are returned, otherwise only names relative to the the directory
are returned.

<div class="node">
<a name="Function-maplist"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-not">Function not</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-lsdir">Function lsdir</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.55 Function maplist</h3>

<p class="noindent"><b>Synopsis</b>: maplist(arg1,arg2) returns type <b>slist</b>

   <p><br>
   <i>arg1</i> : Pattern based on $(this) as original text, <i>in the range</i> .*
<br>
   <i>arg2</i> : The name of the list variable to map, <i>in the range</i> [a-zA-Z0-9_$(){}\[\].:]+
<br>

<p class="noindent">Return a list with each element modified by a pattern based $(this)

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle agent test
{
vars:

  "oldlist" slist => { "a", "b", "c" };
  "newlist" slist => maplist("Element ($(this))","oldlist");

reports:
 linux::
  "Transform: $(newlist)";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in 3.3.0, Nova 2.2.0 (2011)

   <p>This is essentially like the map() function in Perl, and applies to lists.

<div class="node">
<a name="Function-not"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-now">Function now</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-maplist">Function maplist</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.56 Function not</h3>

<p class="noindent"><b>Synopsis</b>: not(arg1) returns type <b>string</b>

   <p><br>
   <i>arg1</i> : Class value, <i>in the range</i> .*
<br>

<p class="noindent">Calculate whether argument is false

<p class="noindent"><b>Example</b>:<br>
<br>
<pre class="verbatim">
commands:
  "/usr/bin/generate_config $(config)"
    ifvarclass => not(fileexists("/etc/config/$(config)"));

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>
<i>History</i>: Was introduced in 3.2.0, Nova 2.1.0 (2011)

<div class="node">
<a name="Function-now"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-on">Function on</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-not">Function not</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.57 Function now</h3>

<p class="noindent"><b>Synopsis</b>: now() returns type <b>int</b>

   <p><br>

<p class="noindent">Convert the current time into system representation

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body file_select zero_age
{
mtime       => irange(ago(1,0,0,0,0,0),now);
file_result => "mtime";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

<div class="node">
<a name="Function-on"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-or">Function or</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-now">Function now</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.58 Function on</h3>

<p class="noindent"><b>Synopsis</b>: on(arg1,arg2,arg3,arg4,arg5,arg6) returns type <b>int</b>

   <p><br>
   <i>arg1</i> : Year, <i>in the range</i> 1970,3000
<br>
   <i>arg2</i> : Month, <i>in the range</i> 1,12
<br>
   <i>arg3</i> : Day, <i>in the range</i> 1,31
<br>
   <i>arg4</i> : Hour, <i>in the range</i> 0,23
<br>
   <i>arg5</i> : Minute, <i>in the range</i> 0,59
<br>
   <i>arg6</i> : Second, <i>in the range</i> 0,59
<br>

<p class="noindent">Convert an exact date/time to an integer system representation

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body file_select zero_age
{
mtime       => irange(on(2000,1,1,0,0,0),now);
file_result => "mtime";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>An absolute date in the local timezone. 
Note that in process matching dates could be wrong by an hour
depending on Daylight Savings Time / Summer Time. This is a known bug to be fixed.

<p class="noindent"><b>ARGUMENTS</b>:

     <dl>
<dt>&lsquo;<samp><span class="samp">Years</span></samp>&rsquo;<dd>The year, e.g. 2009
<br><dt>&lsquo;<samp><span class="samp">Month</span></samp>&rsquo;<dd>The Month, 1-12
<br><dt>&lsquo;<samp><span class="samp">Day</span></samp>&rsquo;<dd>The day 1-31
<br><dt>&lsquo;<samp><span class="samp">Hours</span></samp>&rsquo;<dd>The hour 0-23
<br><dt>&lsquo;<samp><span class="samp">Minutes</span></samp>&rsquo;<dd>The minutes
0-59
<br><dt>&lsquo;<samp><span class="samp">Seconds</span></samp>&rsquo;<dd>The number of seconds 0-59
</dl>

<div class="node">
<a name="Function-or"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-parseintarray">Function parseintarray</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-on">Function on</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.59 Function or</h3>

<p class="noindent"><b>Synopsis</b>: or(...) returns type <b>string</b>

   <p><br>

<p class="noindent">Calculate whether any argument evaluates to true

<p class="noindent"><b>Example</b>:<br>
<br>
<pre class="verbatim">
commands:
  "/usr/bin/generate_config $(config)"
    ifvarclass => or(not(fileexists("/etc/config/$(config)")), "force_configs");

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>
<i>History</i>: Was introduced in 3.2.0, Nova 2.1.0 (2011)

<div class="node">
<a name="Function-parseintarray"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-parserealarray">Function parserealarray</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-or">Function or</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.60 Function parseintarray</h3>

<p class="noindent"><b>Synopsis</b>: parseintarray(arg1,arg2,arg3,arg4,arg5,arg6) returns type <b>int</b>

   <p><br>
   <i>arg1</i> : Array identifier to populate, <i>in the range</i> [a-zA-Z0-9_$(){}\[\].:]+
<br>
   <i>arg2</i> : A string to parse for input data, <i>in the range</i> "?(/.*)
<br>
   <i>arg3</i> : Regex matching comments, <i>in the range</i> .*
<br>
   <i>arg4</i> : Regex to split data, <i>in the range</i> .*
<br>
   <i>arg5</i> : Maximum number of entries to read, <i>in the range</i> 0,99999999999
<br>
   <i>arg6</i> : Maximum bytes to read, <i>in the range</i> 0,99999999999
<br>

<p class="noindent">Read an array of integers from a file and assign the dimension to a variable

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle agent test(f) 
{
vars:

 #######################################
 # Define data inline for convenience
 #######################################

  "table"   string => 

"1:2
3:4
5:6";

#######################################

 "dim" int => parseintarray(
	                      "items",
			      "$(table)",
			      "\s*#[^\n]*",
			      ":",
			      "1000",
			      "200000"
			      );

 "keys" slist => getindices("items");

reports:
  cfengine_3::
	"$(keys)";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.1.5a1, Nova 2.1.0 (2011)

   <p>This function mirrors the exact behaviour of <code>readintarray()</code>,
but reads data from a variable instead of a file see <a href="#Function-readintarray">Function readintarray</a>. 
By making data
readable from a variable, data driven policies can be kept inline. 
This means that they will be visible in the CFEngine Knowledge
Management portal.

<div class="node">
<a name="Function-parserealarray"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-parsestringarray">Function parsestringarray</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-parseintarray">Function parseintarray</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.61 Function parserealarray</h3>

<p class="noindent"><b>Synopsis</b>: parserealarray(arg1,arg2,arg3,arg4,arg5,arg6) returns type <b>int</b>

   <p><br>
   <i>arg1</i> : Array identifier to populate, <i>in the range</i> [a-zA-Z0-9_$(){}\[\].:]+
<br>
   <i>arg2</i> : A string to parse for input data, <i>in the range</i> "?(/.*)
<br>
   <i>arg3</i> : Regex matching comments, <i>in the range</i> .*
<br>
   <i>arg4</i> : Regex to split data, <i>in the range</i> .*
<br>
   <i>arg5</i> : Maximum number of entries to read, <i>in the range</i> 0,99999999999
<br>
   <i>arg6</i> : Maximum bytes to read, <i>in the range</i> 0,99999999999
<br>

<p class="noindent">Read an array of real numbers from a file and assign the dimension to a variable

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle agent test(f) 
{
vars:

 #######################################
 # Define data inline for convenience
 #######################################

  "table"   string => 

"1:1.6
2:2.5
3:3.4";

#######################################

 "dim" int => parserealarray(
	                      "items",
			      "$(table)",
			      "\s*#[^\n]*",
			      ":",
			      "1000",
			      "200000"
			      );

 "keys" slist => getindices("items");

reports:
  cfengine_3::
	"$(keys)";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.1.5, Nova 2.1.0 (2011)

   <p>This function mirrors the exact behaviour of <code>readrealarray()</code>,
but reads data from a variable instead of a file see <a href="#Function-readrealarray">Function readrealarray</a>. 
By making data
readable from a variable, data driven policies can be kept inline. 
This means that they will be visible in the CFEngine Knowledge
Management portal.

<div class="node">
<a name="Function-parsestringarray"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-parsestringarrayidx">Function parsestringarrayidx</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-parserealarray">Function parserealarray</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.62 Function parsestringarray</h3>

<p class="noindent"><b>Synopsis</b>: parsestringarray(arg1,arg2,arg3,arg4,arg5,arg6) returns type <b>int</b>

   <p><br>
   <i>arg1</i> : Array identifier to populate, <i>in the range</i> [a-zA-Z0-9_$(){}\[\].:]+
<br>
   <i>arg2</i> : A string to parse for input data, <i>in the range</i> "?(/.*)
<br>
   <i>arg3</i> : Regex matching comments, <i>in the range</i> .*
<br>
   <i>arg4</i> : Regex to split data, <i>in the range</i> .*
<br>
   <i>arg5</i> : Maximum number of entries to read, <i>in the range</i> 0,99999999999
<br>
   <i>arg6</i> : Maximum bytes to read, <i>in the range</i> 0,99999999999
<br>

<p class="noindent">Read an array of strings from a file and assign the dimension to a variable

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle agent test(f) 
{
vars:

 #######################################
 # Define data inline for convenience
 #######################################

  "table"   string => 

"one: a
two: b
three: c";

#######################################

 "dim" int => parsestringarray(
	                      "items",
			      "$(table)",
			      "\s*#[^\n]*",
			      ":",
			      "1000",
			      "200000"
			      );

 "keys" slist => getindices("items");

reports:
  cfengine_3::
	"$(keys)";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.1.5, Nova 2.1.0 (2011)

   <p>This function mirrors the exact behaviour of <code>readstringarray()</code>,
but reads data from a variable instead of a file
see <a href="#Function-readstringarray">Function readstringarray</a>.  By making data
readable from a variable, data driven policies can be kept inline. 
This means that they will be visible in the CFEngine Knowledge
Management portal.

<div class="node">
<a name="Function-parsestringarrayidx"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-peers">Function peers</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-parsestringarray">Function parsestringarray</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.63 Function parsestringarrayidx</h3>

<p class="noindent"><b>Synopsis</b>: parsestringarrayidx(arg1,arg2,arg3,arg4,arg5,arg6) returns type <b>int</b>

   <p><br>
   <i>arg1</i> : Array identifier to populate, <i>in the range</i> [a-zA-Z0-9_$(){}\[\].:]+
<br>
   <i>arg2</i> : A string to parse for input data, <i>in the range</i> "?(/.*)
<br>
   <i>arg3</i> : Regex matching comments, <i>in the range</i> .*
<br>
   <i>arg4</i> : Regex to split data, <i>in the range</i> .*
<br>
   <i>arg5</i> : Maximum number of entries to read, <i>in the range</i> 0,99999999999
<br>
   <i>arg6</i> : Maximum bytes to read, <i>in the range</i> 0,99999999999
<br>

<p class="noindent">Read an array of strings from a file and assign the dimension to a variable with integer indeces

<p class="noindent"><b>Example</b>:<br>
<br>
<pre class="verbatim">
bundle agent test(f) 
{
vars:

 #######################################
 # Define data inline for convenience
 #######################################

  "table"   string => 

"one: a
two: b
three: c";

#######################################

 "dim" int => parsestringarrayidx(
	                      "items",
			      "$(table)",
			      "\s*#[^\n]*",
			      ":",
			      "1000",
			      "200000"
			      );

 "keys" slist => getindices("items");

reports:
  cfengine_3::
	"$(keys)";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><i>History</i>: Was introduced in version 3.1.5, Nova 2.1.0 (2011)

   <p>This function mirrors the exact behaviour of <code>readstringarrayidx()</code>,
but reads data from a variable instead of a file
see <a href="#Function-readstringarrayidx">Function readstringarrayidx</a>.  By making data
readable from a variable, data driven policies can be kept inline. 
This means that they will be visible in the CFEngine Knowledge
Management portal.

<div class="node">
<a name="Function-peers"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-peerleader">Function peerleader</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-parsestringarrayidx">Function parsestringarrayidx</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.64 Function peers</h3>

<p class="noindent"><b>Synopsis</b>: peers(arg1,arg2,arg3) returns type <b>slist</b>

   <p><br>
   <i>arg1</i> : File name of host list, <i>in the range</i> "?(/.*)
<br>
   <i>arg2</i> : Comment regex pattern, <i>in the range</i> .*
<br>
   <i>arg3</i> : Peer group size, <i>in the range</i> 0,99999999999
<br>

<p class="noindent">Get a list of peers (not including ourself) from the partition to which we belong

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle agent peers
{
vars:

  "mygroup" slist => peers("/tmp/hostlist","#.*",4);

  "myleader" string => peerleader("/tmp/hostlist","#.*",4);

  "all_leaders" slist => peerleaders("/tmp/hostlist","#.*",4);

reports:

 linux::

   "mypeer $(mygroup)";
   "myleader $(myleader)";
   "another leader $(all_leaders)";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="example">     
     (slist) peers(<var>file of hosts</var>,<var>comment pattern</var>,<var>group size</var>);
     
</pre>
   </td></tr></table>

   <p>This function returns a list of hostnames that may be considered peers
of the current host. Peers are defined according to a list of hosts,
provided as a file in the first argument. This file should contain a
list (one per line), possible with comments, of fully qualified host
names. CFEngine breaks up this list into non-overlapping groups of up to
<var>groupsize</var>, each of which has a leader which is the first host
in the group.

   <p>The current host should belong to this file if it is expected to interact
with the others. The function returns nothing if the host does not belong
to the list.

<p class="noindent"><b>ARGUMENTS</b>:

     <dl>
<dt>&lsquo;<samp><span class="samp">File of hosts</span></samp>&rsquo;<dd>A path to a list of hosts.

     <br><dt>&lsquo;<samp><span class="samp">Comment pattern</span></samp>&rsquo;<dd>A pattern that matches a legal comment in the file.  The regex may
match a partial line (that is, it is unanchored,
see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>). 
Comments are stripped as the file is read.

     <br><dt>&lsquo;<samp><span class="samp">Group size</span></samp>&rsquo;<dd>A number between 2 and 64 which represents the number of peers in a peer-group. 
An arbitary limit of 64 is set on groups to avoid nonsensical promises. 
</dl>

   <p>Example file:

<pre class="smallexample">     one
     two
     three # this is a comment
     four
     five
     six
     seven
     eight
     nine
     ten
     eleven
     twelve
     etc
     
</pre>
   <div class="node">
<a name="Function-peerleader"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-peerleaders">Function peerleaders</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-peers">Function peers</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.65 Function peerleader</h3>

<p class="noindent"><b>Synopsis</b>: peerleader(arg1,arg2,arg3) returns type <b>string</b>

   <p><br>
   <i>arg1</i> : File name of host list, <i>in the range</i> "?(/.*)
<br>
   <i>arg2</i> : Comment regex pattern, <i>in the range</i> .*
<br>
   <i>arg3</i> : Peer group size, <i>in the range</i> 0,99999999999
<br>

<p class="noindent">Get the assigned peer-leader of the partition to which we belong

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">bundle agent peers
{
vars:

  "mygroup" slist => peers("/tmp/hostlist","#.*",4);

  "myleader" string => peerleader("/tmp/hostlist","#.*",4);

  "all_leaders" slist => peerleaders("/tmp/hostlist","#.*",4);

reports:

 linux::

   "mypeer $(mygroup)";
   "myleader $(myleader)";
   "another leader $(all_leaders)";

}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="example">     
     (string) peerleader(<var>file of hosts</var>,<var>comment pattern</var>,<var>group size</var>);
     
</pre>
   </td></tr></table>

   <p>This function returns the name of a ost that may be considered the
leader of a group of peers of the current host. Peers are defined
according to a list of hosts, provided as a file in the first
argument. This file should contain a list (one per line), possibly
with comments, of fully qualified host names. CFEngine breaks up this
list into non-overlapping groups of up to <var>groupsize</var>, each of
which has a leader which is the first host in the group.

   <p>The current host should belong to this file if it is expected to interact
with the others. The function returns nothing if the host does not belong
to the list.

<p class="noindent"><b>ARGUMENTS</b>:

     <dl>
<dt>&lsquo;<samp><span class="samp">File of hosts</span></samp>&rsquo;<dd>A path to a list of hosts.

     <br><dt>&lsquo;<samp><span class="samp">Comment pattern</span></samp>&rsquo;<dd>A pattern that matches a legal comment in the file. The regex may
match a partial line (that is, it is unanchored, see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>). 
Comments are stripped as the file is read.

     <br><dt>&lsquo;<samp><span class="samp">Group size</span></samp>&rsquo;<dd>A number between 2 and 64 which represents the number of peers in a peer-group. 
An arbitary limit of 64 is set on groups to avoid nonsensical promises.

   </dl>

   <p>Example file:

<pre class="smallexample">     one
     two
     three # this is a comment
     four
     five
     six
     seven
     eight
     nine
     ten
     eleven
     twelve
     etc
     
</pre>
   <div class="node">
<a name="Function-peerleaders"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-product">Function product</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-peerleader">Function peerleader</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.66 Function peerleaders</h3>

<p class="noindent"><b>Synopsis</b>: peerleaders(arg1,arg2,arg3) returns type <b>slist</b>

   <p><br>
   <i>arg1</i> : File name of host list, <i>in the range</i> "?(/.*)
<br>
   <i>arg2</i> : Comment regex pattern, <i>in the range</i> .*
<br>
   <i>arg3</i> : Peer group size, <i>in the range</i> 0,99999999999
<br>

<p class="noindent">Get a list of peer leaders from the named partitioning

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">bundle agent peers
{
vars:

  "mygroup" slist => peers("/tmp/hostlist","#.*",4);

  "myleader" string => peerleader("/tmp/hostlist","#.*",4);

  "all_leaders" slist => peerleaders("/tmp/hostlist","#.*",4);

reports:

 linux::

   "mypeer $(mygroup)";
   "myleader $(myleader)";
   "another leader $(all_leaders)";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="example">     
     (slist) peers(<var>file of hosts</var>,<var>comment pattern</var>,<var>group size</var>);
     
</pre>
   </td></tr></table>

   <p>This function returns a list of hostnames that may be considered peer
leaders in the partitioning scheme described in the file of
hosts. Peers are defined according to a list of hosts, provided as a
file in the first argument. This file should contain a list (one per
line), possible with comments, of fully qualified host names. CFEngine
breaks up this list into non-overlapping groups of up to
<var>groupsize</var>, each of which has a leader which is the first host in
the group.

   <p>The current host need not belong to this file.

<p class="noindent"><b>ARGUMENTS</b>:

     <dl>
<dt>&lsquo;<samp><span class="samp">File of hosts</span></samp>&rsquo;<dd>A path to a list of hosts.

     <br><dt>&lsquo;<samp><span class="samp">Comment pattern</span></samp>&rsquo;<dd>A pattern that matches a legal comment in the file. The regex may
match a partial line (that is, it is unanchored,
see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>). 
Comments are stripped as the file is read.

     <br><dt>&lsquo;<samp><span class="samp">Group size</span></samp>&rsquo;<dd>A number between 2 and 64 which represents the number of peers in a peer-group. 
An arbitary limit of 64 is set on groups to avoid nonsensical promises.

   </dl>

   <p>Example file:

<pre class="smallexample">     one
     two
     three # this is a comment
     four
     five
     six
     seven
     eight
     nine
     ten
     eleven
     twelve
     etc
     
</pre>
   <div class="node">
<a name="Function-product"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-randomint">Function randomint</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-peerleaders">Function peerleaders</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.67 Function product</h3>

<p class="noindent"><b>Synopsis</b>: product(arg1) returns type <b>real</b>

   <p><br>
   <i>arg1</i> : A list of arbitrary real values, <i>in the range</i> [a-zA-Z0-9_$(){}\[\].:]+
<br>

<p class="noindent">Return the product of a list of reals

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">bundle agent test
{
vars:

  "series" rlist => { "1.1", "2.2", "3.3", "5.5", "7.7" };

  "prod" real => product("series");
  "sum"  real => sum("series");

reports:

  cfengine_3::

    "Product result: $(prod) > $(sum)";
}
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>
Of course, you could easily combine <code>product</code> with <code>readstringarray</code>
or <code>readreallist</code>, etc. to collect summary information from a source
external to CFEngine.

   <p><b>History</b>: Was introduced in version 3.1.0b1,Nova 2.0.0b1 (2010)

   <p>This function might be used for simple ring computation.

<div class="node">
<a name="Function-randomint"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-readfile">Function readfile</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-product">Function product</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.68 Function randomint</h3>

<p class="noindent"><b>Synopsis</b>: randomint(arg1,arg2) returns type <b>int</b>

   <p><br>
   <i>arg1</i> : Lower inclusive bound, <i>in the range</i> -99999999999,9999999999
<br>
   <i>arg2</i> : Upper inclusive bound, <i>in the range</i> -99999999999,9999999999
<br>

<p class="noindent">Generate a random integer between the given limits

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
vars:

 "ran"    int => randomint(4,88);

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The limits must be integer values and the resulting numbers are based
on the entropy of the md5 algorithm.

<div class="node">
<a name="Function-readfile"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-readintarray">Function readintarray</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-randomint">Function randomint</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.69 Function readfile</h3>

<p class="noindent"><b>Synopsis</b>: readfile(arg1,arg2) returns type <b>string</b>

   <p><br>
   <i>arg1</i> : File name, <i>in the range</i> "?(/.*)
<br>
   <i>arg2</i> : Maximum number of bytes to read, <i>in the range</i> 0,99999999999
<br>

<p class="noindent">Read max number of bytes from named file and assign to variable

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
vars:

 "xxx"   

    string => readfile( "/home/mark/tmp/testfile" , "33" );

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The file (fragment) is read into a single scalar variable.

<div class="node">
<a name="Function-readintarray"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-readintlist">Function readintlist</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-readfile">Function readfile</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.70 Function readintarray</h3>

<p class="noindent"><b>Synopsis</b>: readintarray(arg1,arg2,arg3,arg4,arg5,arg6) returns type <b>int</b>

   <p><br>
   <i>arg1</i> : Array identifier to populate, <i>in the range</i> [a-zA-Z0-9_$(){}\[\].:]+
<br>
   <i>arg2</i> : File name to read, <i>in the range</i> "?(/.*)
<br>
   <i>arg3</i> : Regex matching comments, <i>in the range</i> .*
<br>
   <i>arg4</i> : Regex to split data, <i>in the range</i> .*
<br>
   <i>arg5</i> : Maximum number of entries to read, <i>in the range</i> 0,99999999999
<br>
   <i>arg6</i> : Maximum bytes to read, <i>in the range</i> 0,99999999999
<br>

<p class="noindent">Read an array of integers from a file and assign the dimension to a variable

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">vars:

  "dim_array" 

     int =>  readintarray("array_name","/tmp/array","#[^\n]*",":",10,4000);

</pre>

<p class="noindent"><b>ARGUMENTS</b>:

     <dl>
<dt>&lsquo;<samp><span class="samp">array_name</span></samp>&rsquo;<dd>The name to be used for the container array (the array is filled by this routine).

     <br><dt>&lsquo;<samp><span class="samp">filename</span></samp>&rsquo;<dd>The name of a text file containing the text to be split up as a list.

     <br><dt>&lsquo;<samp><span class="samp">comment</span></samp>&rsquo;<dd>A regex pattern which specifies comments to be ignored in the file. 
The <code>comment</code> field will strip out unwanted patterns from the
file being read, leaving unstripped characters to be split into
fields. Using the empty string (<code>""</code>) indicates no commments. The
regex is unanchored, See <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>.

     <br><dt>&lsquo;<samp><span class="samp">split</span></samp>&rsquo;<dd>A regex pattern which is used to parse the field separator(s)
to split up the file into items.  The <code>split</code> regex is also unanchored.

     <br><dt>&lsquo;<samp><span class="samp">maxent</span></samp>&rsquo;<dd>The maximum number of list items to read from the file

     <br><dt>&lsquo;<samp><span class="samp">maxsize</span></samp>&rsquo;<dd>The maximum number of bytes to read from the file
</dl>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Reads a two dimensional array from a file. One dimension is separated by
the character specified in the argument, the other by the the lines in the file. 
The first field of the lines names the first array argument.

<pre class="smallexample">     
     1: 5:7:21:13
     2:19:8:14:14
     3:45:1:78:22
     4:64:2:98:99
</pre>
   <p class="noindent">Results in

<pre class="smallexample">     array_name[1][0]   1
     array_name[1][1]   5
     array_name[1][2]   7
     array_name[1][3]   21
     array_name[1][4]   13
     array_name[2][0]   2
     array_name[2][1]   19
     array_name[2][2]   8
     array_name[2][3]   14
     array_name[2][4]   14
     array_name[3][0]   3
     array_name[3][1]   45
     array_name[3][2]   1
     array_name[3][3]   78
     array_name[3][4]   22
     array_name[4][0]   4
     array_name[4][1]   64
     array_name[4][2]   2
     array_name[4][3]   98
     array_name[4][4]   99
</pre>
   <div class="node">
<a name="Function-readintlist"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-readrealarray">Function readrealarray</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-readintarray">Function readintarray</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.71 Function readintlist</h3>

<p class="noindent"><b>Synopsis</b>: readintlist(arg1,arg2,arg3,arg4,arg5) returns type <b>ilist</b>

   <p><br>
   <i>arg1</i> : File name to read, <i>in the range</i> "?(/.*)
<br>
   <i>arg2</i> : Regex matching comments, <i>in the range</i> .*
<br>
   <i>arg3</i> : Regex to split data, <i>in the range</i> .*
<br>
   <i>arg4</i> : Maximum number of entries to read, <i>in the range</i> 0,99999999999
<br>
   <i>arg5</i> : Maximum bytes to read, <i>in the range</i> 0,99999999999
<br>

<p class="noindent">Read and assign a list variable from a file of separated ints

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">

body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{     
vars:

  "mylist" ilist => { readintlist("/tmp/listofint","#.*","[\n]",10,400) };

reports:

  Yr2008::

    "List entry: $(mylist)";

}

</pre>

<p class="noindent"><b>ARGUMENTS</b>:

     <dl>
<dt>&lsquo;<samp><span class="samp">filename</span></samp>&rsquo;<dd>The name of a text file containing text to be split up as a list.

     <br><dt>&lsquo;<samp><span class="samp">comment</span></samp>&rsquo;<dd>A regex pattern which specifies comments to be ignored in the file. 
The <code>comment</code> field will strip out unwanted patterns from the
file being read, leaving unstripped characters to be split into
fields. Using the empty string (<code>""</code>) indicates no commments. The
regex is unanchored, See <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>.

     <br><dt>&lsquo;<samp><span class="samp">split</span></samp>&rsquo;<dd>A regex pattern which is used to parse the field separator(s)
to split up the file into items.  The <code>split</code> regex is also unanchored.

     <br><dt>&lsquo;<samp><span class="samp">maxent</span></samp>&rsquo;<dd>The maximum number of list items to read from the file

     <br><dt>&lsquo;<samp><span class="samp">maxsize</span></samp>&rsquo;<dd>The maximum number of bytes to read from the file
</dl>

<p class="noindent"><b>Notes</b>:<br>
<br>

<div class="node">
<a name="Function-readrealarray"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-readreallist">Function readreallist</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-readintlist">Function readintlist</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.72 Function readrealarray</h3>

<p class="noindent"><b>Synopsis</b>: readrealarray(arg1,arg2,arg3,arg4,arg5,arg6) returns type <b>int</b>

   <p><br>
   <i>arg1</i> : Array identifier to populate, <i>in the range</i> [a-zA-Z0-9_$(){}\[\].:]+
<br>
   <i>arg2</i> : File name to read, <i>in the range</i> "?(/.*)
<br>
   <i>arg3</i> : Regex matching comments, <i>in the range</i> .*
<br>
   <i>arg4</i> : Regex to split data, <i>in the range</i> .*
<br>
   <i>arg5</i> : Maximum number of entries to read, <i>in the range</i> 0,99999999999
<br>
   <i>arg6</i> : Maximum bytes to read, <i>in the range</i> 0,99999999999
<br>

<p class="noindent">Read an array of real numbers from a file and assign the dimension to a variable

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">vars:

  "dim_array" 

     int =>  readrealarray("array_name","/tmp/array","#[^\n]*",":",10,4000);

</pre>

<p class="noindent"><b>ARGUMENTS</b>:

     <dl>
<dt>&lsquo;<samp><span class="samp">array_name</span></samp>&rsquo;<dd>The name to be used for the container array (the array is filled by this routine).

     <br><dt>&lsquo;<samp><span class="samp">filename</span></samp>&rsquo;<dd>The name of a text file containing the text to be split up as a list.

     <br><dt>&lsquo;<samp><span class="samp">comment</span></samp>&rsquo;<dd>A regex pattern which specifies comments to be ignored in the file. 
The <code>comment</code> field will strip out unwanted patterns from the
file being read, leaving unstripped characters to be split into
fields. Using the empty string (<code>""</code>) indicates no commments. The
regex is unanchored, See <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>.

     <br><dt>&lsquo;<samp><span class="samp">split</span></samp>&rsquo;<dd>A regex pattern which is used to parse the field separator(s)
to split up the file into items.  The <code>split</code> regex is also unanchored.

     <br><dt>&lsquo;<samp><span class="samp">maxent</span></samp>&rsquo;<dd>The maximum number of list items to read from the file

     <br><dt>&lsquo;<samp><span class="samp">maxsize</span></samp>&rsquo;<dd>The maximum number of bytes to read from the file
</dl>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>For detailed notes, See <a href="#Function-readintarray">Function readintarray</a>.

<div class="node">
<a name="Function-readreallist"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-readstringarray">Function readstringarray</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-readrealarray">Function readrealarray</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.73 Function readreallist</h3>

<p class="noindent"><b>Synopsis</b>: readreallist(arg1,arg2,arg3,arg4,arg5) returns type <b>rlist</b>

   <p><br>
   <i>arg1</i> : File name to read, <i>in the range</i> "?(/.*)
<br>
   <i>arg2</i> : Regex matching comments, <i>in the range</i> .*
<br>
   <i>arg3</i> : Regex to split data, <i>in the range</i> .*
<br>
   <i>arg4</i> : Maximum number of entries to read, <i>in the range</i> 0,99999999999
<br>
   <i>arg5</i> : Maximum bytes to read, <i>in the range</i> 0,99999999999
<br>

<p class="noindent">Read and assign a list variable from a file of separated real numbers

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">

body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{     
vars:

  "mylist" rlist => { readreallist("/tmp/listofreal","#.*","[\n]",10,400) };

reports:

  Yr2008::

    "List entry: $(mylist)";

}

</pre>

<p class="noindent"><b>ARGUMENTS</b>:

     <dl>
<dt>&lsquo;<samp><span class="samp">filename</span></samp>&rsquo;<dd>The name of a text file containing text to be split up as a list.

     <br><dt>&lsquo;<samp><span class="samp">comment</span></samp>&rsquo;<dd>A regex pattern which specifies comments to be ignored in the file. 
The <code>comment</code> field will strip out unwanted patterns from the
file being read, leaving unstripped characters to be split into
fields. Using the empty string (<code>""</code>) indicates no commments. The
regex is unanchored, See <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>.

     <br><dt>&lsquo;<samp><span class="samp">split</span></samp>&rsquo;<dd>A regex pattern which is used to parse the field separator(s)
to split up the file into items.  The <code>split</code> regex is also unanchored.

     <br><dt>&lsquo;<samp><span class="samp">maxent</span></samp>&rsquo;<dd>The maximum number of list items to read from the file

     <br><dt>&lsquo;<samp><span class="samp">maxsize</span></samp>&rsquo;<dd>The maximum number of bytes to read from the file
</dl>

<p class="noindent"><b>Notes</b>:<br>
<br>

<div class="node">
<a name="Function-readstringarray"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-readstringarrayidx">Function readstringarrayidx</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-readreallist">Function readreallist</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.74 Function readstringarray</h3>

<p class="noindent"><b>Synopsis</b>: readstringarray(arg1,arg2,arg3,arg4,arg5,arg6) returns type <b>int</b>

   <p><br>
   <i>arg1</i> : Array identifier to populate, <i>in the range</i> [a-zA-Z0-9_$(){}\[\].:]+
<br>
   <i>arg2</i> : File name to read, <i>in the range</i> "?(/.*)
<br>
   <i>arg3</i> : Regex matching comments, <i>in the range</i> .*
<br>
   <i>arg4</i> : Regex to split data, <i>in the range</i> .*
<br>
   <i>arg5</i> : Maximum number of entries to read, <i>in the range</i> 0,99999999999
<br>
   <i>arg6</i> : Maximum bytes to read, <i>in the range</i> 0,99999999999
<br>

<p class="noindent">Read an array of strings from a file and assign the dimension to a variable

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">vars:

  "dim_array" 

     int =>  readstringarray("array_name","/tmp/array","\s*#[^\n]*",":",10,4000);

</pre>

<p class="noindent">Returns an integer number of keys in the array (i.e., the
number of lines matched).  If you only want the fields in the first
matching line (e.g., to mimic the behavior of the <i>getpwnam(3)</i>
on the file <samp><span class="file">/etc/passwd</span></samp>), See <a href="#Function-getfields">Function getfields</a>, instead.

<p class="noindent"><b>ARGUMENTS</b>:

     <dl>
<dt>&lsquo;<samp><span class="samp">array_name</span></samp>&rsquo;<dd>The name to be used for the container array (the array is filled by this routine).

     <br><dt>&lsquo;<samp><span class="samp">filename</span></samp>&rsquo;<dd>The name of a text file containing the text to be split up as a list.

     <br><dt>&lsquo;<samp><span class="samp">comment</span></samp>&rsquo;<dd>A regex pattern which specifies comments to be ignored in the file. 
The <code>comment</code> field will strip out unwanted patterns from the
file being read, leaving unstripped characters to be split into
fields. Using the empty string (<code>""</code>) indicates no commments. The
regex is unanchored, See <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>.

     <br><dt>&lsquo;<samp><span class="samp">split</span></samp>&rsquo;<dd>A regex pattern which is used to parse the field separator(s)
to split up the file into items.  The <code>split</code> regex is also unanchored.

     <br><dt>&lsquo;<samp><span class="samp">maxent</span></samp>&rsquo;<dd>The maximum number of list items to read from the file

     <br><dt>&lsquo;<samp><span class="samp">maxsize</span></samp>&rsquo;<dd>The maximum number of bytes to read from the file
</dl>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Reads a two dimensional array from a file. One dimension is separated by
the character specified in the argument, the other by the the lines in the file. 
The first field of the lines names the first array argument.

<pre class="smallexample">     
     at:x:25:25:Batch jobs daemon:/var/spool/atjobs:/bin/bash
     avahi:x:103:105:User for Avahi:/var/run/avahi-daemon:/bin/false	# Disallow login
     beagleindex:x:104:106:User for Beagle indexing:/var/cache/beagle:/bin/bash
     bin:x:1:1:bin:/bin:/bin/bash
     # Daemon has the default shell
     daemon:x:2:2:Daemon:/sbin:
     
</pre>
   <p class="noindent">Results in a systematically indexed map of the file. Some samples
are show below to illustrate the pattern.

<pre class="smallexample">     ...
     array_name[daemon][0]   daemon
     array_name[daemon][1]   x
     array_name[daemon][2]   2
     array_name[daemon][3]   2
     array_name[daemon][4]   Daemon
     array_name[daemon][5]   /sbin
     array_name[daemon][6]   /bin/bash
     ...
     array_name[at][3]       25
     array_name[at][4]       Batch jobs daemon
     array_name[at][5]       /var/spool/atjobs
     array_name[at][6]       /bin/bash
     ...
     array_name[games][3]    100
     array_name[games][4]    Games account
     array_name[games][5]    /var/games
     array_name[games][6]    /bin/bash
     ...
     
</pre>
   <div class="node">
<a name="Function-readstringarrayidx"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-readstringlist">Function readstringlist</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-readstringarray">Function readstringarray</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.75 Function readstringarrayidx</h3>

<p class="noindent"><b>Synopsis</b>: readstringarrayidx(arg1,arg2,arg3,arg4,arg5,arg6) returns type <b>int</b>

   <p><br>
   <i>arg1</i> : Array identifier to populate, <i>in the range</i> [a-zA-Z0-9_$(){}\[\].:]+
<br>
   <i>arg2</i> : A string to parse for input data, <i>in the range</i> "?(/.*)
<br>
   <i>arg3</i> : Regex matching comments, <i>in the range</i> .*
<br>
   <i>arg4</i> : Regex to split data, <i>in the range</i> .*
<br>
   <i>arg5</i> : Maximum number of entries to read, <i>in the range</i> 0,99999999999
<br>
   <i>arg6</i> : Maximum bytes to read, <i>in the range</i> 0,99999999999
<br>

<p class="noindent">Read an array of strings from a file and assign the dimension to a variable with integer indeces

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">vars:

  "dim_array" 

     int =>  readstringarrayidx("array_name","/tmp/array","\s*#[^\n]*",":",10,4000);

</pre>

<p class="noindent">Returns an integer number of keys in the array (i.e., the
number of lines matched).  If you only want the fields in the first
matching line (e.g., to mimic the behavior of the <i>getpwnam(3)</i>
on the file <samp><span class="file">/etc/passwd</span></samp>), See <a href="#Function-getfields">Function getfields</a>, instead.

<p class="noindent"><b>ARGUMENTS</b>:

     <dl>
<dt>&lsquo;<samp><span class="samp">array_name</span></samp>&rsquo;<dd>The name to be used for the container array (the array is filled by this routine).

     <br><dt>&lsquo;<samp><span class="samp">filename</span></samp>&rsquo;<dd>The name of a text file containing the text to be split up as a list.

     <br><dt>&lsquo;<samp><span class="samp">comment</span></samp>&rsquo;<dd>A regex pattern which specifies comments to be ignored in the file. 
The <code>comment</code> field will strip out unwanted patterns from the
file being read, leaving unstripped characters to be split into
fields. Using the empty string (<code>""</code>) indicates no commments. The
regex is unanchored. See <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>.

     <br><dt>&lsquo;<samp><span class="samp">split</span></samp>&rsquo;<dd>A regex pattern which is used to parse the field separator(s)
to split up the file into items.  The <code>split</code> regex is also unanchored.

     <br><dt>&lsquo;<samp><span class="samp">maxent</span></samp>&rsquo;<dd>The maximum number of list items to read from the file

     <br><dt>&lsquo;<samp><span class="samp">maxsize</span></samp>&rsquo;<dd>The maximum number of bytes to read from the file
</dl>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Reads a two dimensional array from a file. One dimension is separated by
the character specified in the argument, the other by the the lines in the file. 
The array arguments are both integer indeces, allowing for
non-identifiers at first field (e.g. duplicates or names with spaces),
unlike <code>readstringarray</code>.

<pre class="smallexample">     
     at spaced:x:25:25:Batch jobs daemon:/var/spool/atjobs:/bin/bash
     duplicate:x:103:105:User for Avahi:/var/run/avahi-daemon:/bin/false	# Disallow login
     beagleindex:x:104:106:User for Beagle indexing:/var/cache/beagle:/bin/bash
     duplicate:x:1:1:bin:/bin:/bin/bash
     # Daemon has the default shell
     daemon:x:2:2:Daemon:/sbin:
     
</pre>
   <p class="noindent">Results in a systematically indexed map of the file. Some samples
are show below to illustrate the pattern.

<pre class="smallexample">     array_name[0][0]       at spaced
     array_name[0][1]       x
     array_name[0][2]       25
     array_name[0][3]       25
     array_name[0][4]       Batch jobs daemon
     array_name[0][5]       /var/spool/atjobs
     array_name[0][6]       /bin/bash
     array_name[1][0]       duplicate
     array_name[1][1]       x
     array_name[1][2]       103
     array_name[1][3]       105
     array_name[1][4]       User for Avahi
     array_name[1][5]       /var/run/avahi-daemon
     array_name[1][6]       /bin/false
     ...
     
</pre>
   <div class="node">
<a name="Function-readstringlist"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-readtcp">Function readtcp</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-readstringarrayidx">Function readstringarrayidx</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.76 Function readstringlist</h3>

<p class="noindent"><b>Synopsis</b>: readstringlist(arg1,arg2,arg3,arg4,arg5) returns type <b>slist</b>

   <p><br>
   <i>arg1</i> : File name to read, <i>in the range</i> "?(/.*)
<br>
   <i>arg2</i> : Regex matching comments, <i>in the range</i> .*
<br>
   <i>arg3</i> : Regex to split data, <i>in the range</i> .*
<br>
   <i>arg4</i> : Maximum number of entries to read, <i>in the range</i> 0,99999999999
<br>
   <i>arg5</i> : Maximum bytes to read, <i>in the range</i> 0,99999999999
<br>

<p class="noindent">Read and assign a list variable from a file of separated strings

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{     
vars:

  "mylist" slist => readstringlist("/tmp/listofstring", "#.*", "\s", 10, 400);

reports:

  Yr2008::

    "List entry: $(mylist)";

}

</pre>

<p class="noindent"><b>ARGUMENTS</b>:

     <dl>
<dt>&lsquo;<samp><span class="samp">filename</span></samp>&rsquo;<dd>The name of a text file containing text to be split up as a list.

     <br><dt>&lsquo;<samp><span class="samp">comment</span></samp>&rsquo;<dd>A regex pattern which specifies comments to be ignored in the file.  The
<code>comment</code> field will strip out unwanted patterns from the file being
read, leaving unstripped characters to be split into fields.  The
regex is unanchored, See <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>. 
<b>Note</b> that the text is not treated as a collection of lines, but is read
as a single block of <code>maxsize</code> characters, and the regex is applied to
that as a single string.

     <br><dt>&lsquo;<samp><span class="samp">split</span></samp>&rsquo;<dd>A regex pattern which is used to parse the field separator(s)
to split up the file into items.  The <code>split</code> regex is also unanchored.

     <br><dt>&lsquo;<samp><span class="samp">maxent</span></samp>&rsquo;<dd>The maximum number of list items to read from the file

     <br><dt>&lsquo;<samp><span class="samp">maxsize</span></samp>&rsquo;<dd>The maximum number of bytes to read from the file
</dl>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The following example file would be split into a list of the
first ten Greek letters - alpha through kappa.

<pre class="smallexample">     
     alpha beta
     gamma # This is a comment
     delta epsilon zeta
            eta
                   theta
     iota
     kappa          lambda
     mu
     nu
     etc
     
     
</pre>
   <div class="node">
<a name="Function-readtcp"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-regarray">Function regarray</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-readstringlist">Function readstringlist</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.77 Function readtcp</h3>

<p class="noindent"><b>Synopsis</b>: readtcp(arg1,arg2,arg3,arg4) returns type <b>string</b>

   <p><br>
   <i>arg1</i> : Host name or IP address of server socket, <i>in the range</i> .*
<br>
   <i>arg2</i> : Port number, <i>in the range</i> 0,99999999999
<br>
   <i>arg3</i> : Protocol query string, <i>in the range</i> .*
<br>
   <i>arg4</i> : Maximum number of bytes to read, <i>in the range</i> 0,99999999999
<br>

<p class="noindent">Connect to tcp port, send string and assign result to variable

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle agent example

{     
vars:

  "my80" string => readtcp("research.iu.hio.no","80","GET /index.php HTTP/1.1$(const.r)$(const.n)Host: research.iu.hio.no$(const.r)$(const.n)$(const.r)$(const.n)",20);

classes:

  "server_ok" expression => regcmp("[^\n]*200 OK.*\n.*","$(my80)");

reports:

  server_ok::

    "Server is alive";

  !server_ok::

    "Server is not responding - got $(my80)";
}

</pre>

     <dl>
<dt>&lsquo;<samp><span class="samp">hostnameip</span></samp>&rsquo;<dd>The host name or IP address of a tcp socket. 
<br><dt>&lsquo;<samp><span class="samp">port</span></samp>&rsquo;<dd>The port number to connect to. 
<br><dt>&lsquo;<samp><span class="samp">sendstring</span></samp>&rsquo;<dd>A string to send to the TCP port to elicit a response
<br><dt>&lsquo;<samp><span class="samp">maxbytes</span></samp>&rsquo;<dd>The maximum number of bytes to read in response. 
</dl>

   <p>Important note: not all Unix TCP read operations respond to signals for interruption so
poorly formed requests can hang. Always test TCP connections fully before deploying.

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>If the send string is empty, no data are sent or received from the socket. Then the
function only tests whether the TCP port is alive and returns an empty variable.

   <p>Note that on some systems the timeout mechanism does not seem to successfully interrupt
the waiting system calls so this might hang if you send a query string that is incorrect. 
This should not happen, but the cause has yet to be diagnosed.

<div class="node">
<a name="Function-regarray"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-regcmp">Function regcmp</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-readtcp">Function readtcp</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.78 Function regarray</h3>

<p class="noindent"><b>Synopsis</b>: regarray(arg1,arg2) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : Cfengine array identifier, <i>in the range</i> [a-zA-Z0-9_$(){}\[\].:]+
<br>
   <i>arg2</i> : Regular expression, <i>in the range</i> .*
<br>

<p class="noindent">True if arg1 matches any item in the associative array with id=arg2

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control

{
bundlesequence  => { "testbundle"  };
}

###########################################

bundle agent testbundle
{
vars:

  "myarray[0]" string => "bla1";
  "myarray[1]" string => "bla2";
  "myarray[3]" string => "bla";
  "myarray"    string => "345";  
  "not"        string => "345";  

classes:

  "ok" expression => regarray("myarray","b.*2");

reports:

 ok::

    "Found in list";

 !ok::

    "Not found in list";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Tests whether an associative array contains elements matching a certain regular expression. 
The result is a class.

<p class="noindent"><b>ARGUMENTS</b>:

     <dl>
<dt>&lsquo;<samp><span class="samp">array_name</span></samp>&rsquo;<dd>The name of the array, with no &lsquo;<samp><span class="samp">$()</span></samp>&rsquo; surrounding it, etc. 
<br><dt>&lsquo;<samp><span class="samp">regex</span></samp>&rsquo;<dd>A regular expression to match the content.  The regular expression
must match the complete array element (that is, it is anchored,
see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>). 
</dl>

<div class="node">
<a name="Function-regcmp"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-regextract">Function regextract</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-regarray">Function regarray</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.79 Function regcmp</h3>

<p class="noindent"><b>Synopsis</b>: regcmp(arg1,arg2) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : Regular expression, <i>in the range</i> .*
<br>
   <i>arg2</i> : Match string, <i>in the range</i> .*
<br>

<p class="noindent">True if arg1 is a regular expression matching that matches string arg2

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle agent subtest(user)

{
classes:

  "invalid" not => regcmp("[a-z]{4}","$(user)");

reports:

 !invalid::

  "User name $(user) is valid at exactly 4 letters";

 invalid::

  "User name $(user) is invalid";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Compares a string to a regular expression.

<p class="noindent"><b>ARGUMENTS</b>:

     <dl>
<dt>&lsquo;<samp><span class="samp">regex</span></samp>&rsquo;<dd>A regular expression to match the content.  The regular expression
must match the complete content (that is, it is anchored,
see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>).

     <br><dt>&lsquo;<samp><span class="samp">string</span></samp>&rsquo;<dd>Test data for the regular expression. 
</dl>

   <p>If there are multiple-lines in the data, it is necessary to code these
explicitly, as regular expressions do not normally match the end of line
as a regular character (they only match end of string).  You can do this using either standard regular
expression syntax or using the additional features of PCRE (where
<code>(?ms)</code> changes the way that &lsquo;<samp><span class="samp">.</span></samp>&rsquo;, &lsquo;<samp><span class="samp">^</span></samp>&rsquo; and &lsquo;<samp><span class="samp">$</span></samp>&rsquo; behave), e.g.

<pre class="smallexample">     
     body common control
     {
     bundlesequence =&gt; { "example" };
     }
     
     bundle agent example
     {
     vars:
     
       "x" string =&gt; "
     NAME: apache2 - Apache 2.2 web server
     CATEGORY: application
     ARCH: all
     VERSION: 2.2.3,REV=2006.09.01
     BASEDIR: /
     VENDOR: http://httpd.apache.org/ packaged for CSW by Cory Omand
     PSTAMP: comand@thor-20060901022929
     INSTDATE: Dec 14 2006 16:05
     HOTLINE: http://www.blastwave.org/bugtrack/
     EMAIL: comand@blastwave.org
     STATUS: completely installed
     ";
     
     classes:
     
       "pkg_installed" expression =&gt; regcmp("(.*\n)*STATUS:\s+completely installed\n(.*\n)*",$(x));
     
       "base_is_root" expression =&gt; regcmp("(?ms).*^BASEDIR:\s+/$.*", $(x));
     
     reports:
     
       pkg_installed::
     
         "installed";
     
       base_is_root::
     
         "in root";
     }
     
     
</pre>
   <div class="node">
<a name="Function-regextract"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-registryvalue">Function registryvalue</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-regcmp">Function regcmp</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.80 Function regextract</h3>

<p class="noindent"><b>Synopsis</b>: regextract(arg1,arg2,arg3) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : Regular expression, <i>in the range</i> .*
<br>
   <i>arg2</i> : Match string, <i>in the range</i> .*
<br>
   <i>arg3</i> : Identifier for back-references, <i>in the range</i> [a-zA-Z0-9_$(){}\[\].:]+
<br>

<p class="noindent">True if the regular expression in arg 1 matches the string in arg2 and sets a non-empty array of backreferences named arg3

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">bundle agent testbundle
{
classes:

    # Extract regex backreferences and put them in an array

    "ok" expression => regextract(
                                 "xx ([^\s]+) ([^\s]+).* xx",
                                 "xx one two three four xx",
                                 "myarray"
                                 );
reports:

 ok::

   "ok - \"$(myarray[0])\" = xx + \"$(myarray[1])\" + \"$(myarray[2])\" + .. + xx";
}


</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

<p class="noindent"><b>Arguments:</b>

     <dl>
<dt><i>regex</i><dd>A regular expression containing one or more parenthesized back
references.  The regular expression must match the entire string
(that is, it is anchored, see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>). 
<br><dt><i>data</i><dd>A string to be matched to the regular expression. 
<br><dt><i>identifier</i><dd>The name of an array which (if there are any back reference matches
from the regular expression) will be populated with the values, in
the manner
     <pre class="example">          $(identifier[0]) = entire string
          $(identifier[1]) = back reference 1, etc
</pre>
     </dl>

   <p><b>History</b>: This function was introduced in CFEngine version 3.0.4 (2010)

<div class="node">
<a name="Function-registryvalue"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-regline">Function regline</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-regextract">Function regextract</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.81 Function registryvalue</h3>

<p class="noindent"><b>Synopsis</b>: registryvalue(arg1,arg2) returns type <b>string</b>

   <p><br>
   <i>arg1</i> : Windows registry key, <i>in the range</i> .*
<br>
   <i>arg2</i> : Windows registry value-id, <i>in the range</i> .*
<br>

<p class="noindent">Returns a value for an MS-Win registry key,value pair

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle agent reg
{
vars:

  "value" string => registryvalue("HKEY_LOCAL_MACHINE\SOFTWARE\CFEngine AS\CFEngine","value3");

reports:

  windows::

   "Value extracted: $(value)";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This function applies only to Windows-based systems. It reads a data field for the value named
in the second argument, which lies within the registry key given by the first argument.

   <p>The value is parsed as a string. Currently values of type <code>REG_SZ</code> (string),
<code>REG_EXPAND_SZ</code> (expandable string) and <code>REG_DWORD</code> (double word) are supported.

<div class="node">
<a name="Function-regline"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-reglist">Function reglist</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-registryvalue">Function registryvalue</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.82 Function regline</h3>

<p class="noindent"><b>Synopsis</b>: regline(arg1,arg2) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : Regular expression, <i>in the range</i> .*
<br>
   <i>arg2</i> : Filename to search, <i>in the range</i> .*
<br>

<p class="noindent">True if the regular expression in arg1 matches a line in file arg2

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle agent testbundle

{
files:

  "/tmp/testfile" edit_line => test;
}

########################################################

bundle edit_line test
{
classes:

    "ok" expression => regline(".*XYZ.*","$(edit.filename)");

reports:

 ok::

   "File $(edit.filename) has a line with \"XYZ\" in it";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Note that the regular expression must match an entire line of the
file in order to give a true result. This function is useful for
<code>edit_line</code> applications, where one might want to set a class for
detecting the presence of a string which does not exactly match
one being inserted. e.g.

<pre class="verbatim">
bundle edit_line upgrade_cfexecd
  {
  classes:

    # Check there is not already a crontab line, not identical to
    # the one proposed below...

    "exec_fix" not => regline(".*cf-execd.*","$(edit.filename)");

  insert_lines:

    exec_fix::

     "0,5,10,15,20,25,30,35,40,45,50,55 * * * * /var/cfengine/bin/cf-execd -F";

  reports:

    exec_fix::

     "Added a 5 minute schedule to crontabs";
  }

</pre>

<div class="node">
<a name="Function-reglist"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-regldap">Function regldap</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-regline">Function regline</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.83 Function reglist</h3>

<p class="noindent"><b>Synopsis</b>: reglist(arg1,arg2) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : Cfengine list identifier, <i>in the range</i> @[(][a-zA-Z0-9]+[)]
<br>
   <i>arg2</i> : Regular expression, <i>in the range</i> .*
<br>

<p class="noindent">True if the regular expression in arg2 matches any item in the list whose id is arg1

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
vars:

 "nameservers" slist => {
                        "128.39.89.10",
                        "128.39.74.16",
                        "192.168.1.103"
                        };
classes:

  "am_name_server" expression => reglist("@(nameservers)",escape("$(sys.ipv4[eth0])"));

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Matches a list of test strings to a regular expression.  In the
example above, the IP address in <code>$(sys.ipv4[eth0])</code> must be
<code>escape</code>d, because if not, the dot (&lsquo;<samp><span class="samp">.</span></samp>&rsquo;) characters in the
IP address would be interpreted as regular expression "match any"
characters.

<p class="noindent"><b>ARGUMENTS</b>:

     <dl>
<dt>&lsquo;<samp><span class="samp">list</span></samp>&rsquo;<dd>The list of strings to test with the regular expression. 
<br><dt>&lsquo;<samp><span class="samp">regex</span></samp>&rsquo;<dd>The scalar regular expression string.  The regular expression must
match the entire string (that is, it is anchored, see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>). 
</dl>

<div class="node">
<a name="Function-regldap"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-remotescalar">Function remotescalar</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-reglist">Function reglist</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.84 Function regldap</h3>

<p class="noindent"><b>Synopsis</b>: regldap(arg1,arg2,arg3,arg4,arg5,arg6,arg7) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : URI, <i>in the range</i> .*
<br>
   <i>arg2</i> : Distinguished name, <i>in the range</i> .*
<br>
   <i>arg3</i> : Filter, <i>in the range</i> .*
<br>
   <i>arg4</i> : Record name, <i>in the range</i> .*
<br>
   <i>arg5</i> : Search scope policy, <i>in the range</i> subtree,onelevel,base
<br>
   <i>arg6</i> : Regex to match results, <i>in the range</i> .*
<br>
   <i>arg7</i> : Security level, <i>in the range</i> none,ssl,sasl
<br>

<p class="noindent">True if the regular expression in arg6 matches a value item in an ldap search

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
classes:

   "found" expression => regldap(
                                "ldap://ldap.example.org",
                                "dc=cfengine,dc=com",
                                "(sn=User)",
                                "uid",
                                "subtree",
                                "jon.*",
                                "none"
                                );

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="example">     
     (class) regldap(<var>uri</var>,<var>dn</var>,<var>filter</var>,<var>name</var>,<var>scope</var>,<var>regex</var>,<var>security</var>)
     
</pre>
   </td></tr></table>

   <p>This function retrieves a single field from all matching LDAP records identified by the search
parameters and compares it to a regular expression. If there is a match, true is returned
else false.

<p class="noindent"><b>ARGUMENTS</b>:

     <dl>
<dt>&lsquo;<samp><span class="samp">uri</span></samp>&rsquo;<dd>String value of the ldap server. e.g. <code>"ldap://ldap.cfengine.com.no"</code>
<br><dt>&lsquo;<samp><span class="samp">dn</span></samp>&rsquo;<dd>Distinguished name, an ldap formatted name built from components, e.g. "dc=cfengine,dc=com". 
<br><dt>&lsquo;<samp><span class="samp">filter</span></samp>&rsquo;<dd>String filter criterion, in ldap search, e.g. "(sn=User)". 
<br><dt>&lsquo;<samp><span class="samp">name</span></samp>&rsquo;<dd>String value, the name of a single record to be retrieved, e.g. <code>uid</code>. 
<br><dt>&lsquo;<samp><span class="samp">scope</span></samp>&rsquo;<dd>Menu option, the type of ldap search, from the specified root. May take values:
     <pre class="smallexample">              subtree
              onelevel
              base
</pre>
     <br><dt>&lsquo;<samp><span class="samp">regex</span></samp>&rsquo;<dd>A regular expression string to match to the results of an LDAP
search. The regular expression must match the entire named field
(that is, it is anchored, see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>). 
If any item matches the regex, the result will be true.

     <br><dt>&lsquo;<samp><span class="samp">security</span></samp>&rsquo;<dd>Menu option indicating the encryption and authentication settings
for communication with the LDAP server. These features might be subject
to machine and server capabilites.
     <pre class="smallexample">               none
               ssl
               sasl
</pre>
     </dl>

<div class="node">
<a name="Function-remotescalar"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-remoteclassesmatching">Function remoteclassesmatching</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-regldap">Function regldap</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.85 Function remotescalar</h3>

<p class="noindent"><b>Synopsis</b>: remotescalar(arg1,arg2,arg3) returns type <b>string</b>

   <p><br>
   <i>arg1</i> : Variable identifier, <i>in the range</i> [a-zA-Z0-9_$(){}\[\].:]+
<br>
   <i>arg2</i> : Hostname or IP address of server, <i>in the range</i> .*
<br>
   <i>arg3</i> : Use enryption, <i>in the range</i> true,false,yes,no,on,off
<br>

<p class="noindent">Read a scalar value from a remote cfengine server

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
vars:

 "remote" string => remotescalar("test_scalar","127.0.0.1","yes");

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>
The remote system's cf-serverd must accept the query for the requested variable from
the host that is requesting it. 
An example of this configuration follows.

   <p>This function asks for an identifier; it is up to the server to interpret
what this means and to return a value of its choosing. If the identifier matches
a persistent scalar variable (such as is used to count distributed processes in CFEngine
Enterprise) then this will be returned preferentially. If no such variable is found,
then the server will look for a literal string in a server bundle with a handle that
matches the requested object.

<pre class="verbatim">bundle server access
{
access:
  "value of my test_scalar, can expand variables here - $(sys.host)"
    handle => "test_scalar",
    comment => "Grant access to contents of test_scalar VAR",
    resource_type => "literal",
    admit => { "127.0.0.1" };
}
</pre>

   <p>CFEngine caches the value of this variable, so that, if the network is
unavailable, the last known value will be used. Hence use of this function
is fault tolerant. Care should be taken in attempting to access remote variables
that are not available, as the repeated connections needed to resolve the
absence of a value can lead to undesirable behaviour. As a general rule,
users are recommended to refrain from relying on the availability of network resources.

   <p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="example">     
     (string) remotescalar(<var>resource handle</var>,<var>host/IP address</var>,<var>encrypt</var>);
     
</pre>
   </td></tr></table>

   <p>This function downloads a string from a remote server, using the promise handle
as a variable identifier. Availability: Enterprise editions of CFEngine only.

<p class="noindent"><b>ARGUMENTS</b>:

     <dl>
<dt>&lsquo;<samp><span class="samp">resource handle</span></samp>&rsquo;<dd>The name of the promise on the server side
<br><dt>&lsquo;<samp><span class="samp">host or IP address</span></samp>&rsquo;<dd>The location of the server on which the resource resides. 
<br><dt>&lsquo;<samp><span class="samp">encrypt</span></samp>&rsquo;<dd>Whether to encrypt the connection to the server.
     <pre class="smallexample">               true
               yes
               false
               no
</pre>
     </dl>

   <p>Note that this function assumes that you have already performed a
successful key exchange between systems, (e.g. using either a remote
copy or <code>cf-runagent</code> connection). It contains no mechanism for
trust establishment and will fail if there is no trust relationship
pre-established.

<div class="node">
<a name="Function-remoteclassesmatching"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-returnszero">Function returnszero</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-remotescalar">Function remotescalar</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.86 Function remoteclassesmatching</h3>

<p class="noindent"><b>Synopsis</b>: remoteclassesmatching(arg1,arg2,arg3,arg4) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : Regular expression, <i>in the range</i> .*
<br>
   <i>arg2</i> : Server name or address, <i>in the range</i> .*
<br>
   <i>arg3</i> : Use encryption, <i>in the range</i> true,false,yes,no,on,off
<br>
   <i>arg4</i> : Return class prefix, <i>in the range</i> [a-zA-Z0-9_$(){}\[\].:]+
<br>

<p class="noindent">Read persistent classes matching a regular expression from a remote cfengine server and add them into local context with prefix

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
 "succeeded" expression => remoteclassesmatching("regex","server","yes","myprefix");

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>
This function is only available in Enterprise versions of CFEngine (Nova, Enterprise, etc).

   <p>This function contacts a remote <code>cf-serverd</code> and requests access to defined
<i>persistent classes</i> on that system. These must be granted access to by making an
<code>access</code> promise with <code>resource_type</code> set to <code>context</code>.

   <p>The return value is true (sets the class) if communication with the server was
successful and classes are populated in the current bundle with a prefix of your choosing. 
The arguments are:

     <dl>
<dt><i>Regular expression</i><dd>This should match a list of <i>persistent</i> classes of be returned from the server,
if the server is willing, i.e. has granted access to them.

     <br><dt><i>Server</i><dd>The name or IP address of the remote server.

     <br><dt><i>Encryption</i><dd>Boolean value, whether or not to encrypt communication.

     <br><dt><i>Prefix</i><dd>A string to be added to the returned classes, e.g. if the server defines
a persistent class &lsquo;<samp><span class="samp">alpha</span></samp>&rsquo;, then this would generate a private class in the
current bundle called &lsquo;<samp><span class="samp">myprefix_alpha</span></samp>&rsquo;. 
</dl>

   <p>Note that this function assumes that you have already performed a successful key exchange between
systems, (e.g. using either a remote copy or <code>cf-runagent</code> connection). It contains no mechanism
for trust establishment and will fail if there is no trust relationship  pre-established.

<div class="node">
<a name="Function-returnszero"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-rrange">Function rrange</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-remoteclassesmatching">Function remoteclassesmatching</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.87 Function returnszero</h3>

<p class="noindent"><b>Synopsis</b>: returnszero(arg1,arg2) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : Fully qualified command path, <i>in the range</i> "?(/.*)
<br>
   <i>arg2</i> : Shell encapsulation option, <i>in the range</i> useshell,noshell
<br>

<p class="noindent">True if named shell command has exit status zero

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{     
classes:

  "my_result" expression => returnszero("/usr/local/bin/mycommand","noshell");

reports:

  !my_result::

    "Command failed";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This is the complement of <code>execresult</code>, but it returns a class
result rather than the output of the command.

<div class="node">
<a name="Function-rrange"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-selectservers">Function selectservers</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-returnszero">Function returnszero</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.88 Function rrange</h3>

<p class="noindent"><b>Synopsis</b>: rrange(arg1,arg2) returns type <b>rrange [real,real]</b>

   <p><br>
   <i>arg1</i> : Real number, <i>in the range</i> -9.99999E100,9.99999E100
<br>
   <i>arg2</i> : Real number, <i>in the range</i> -9.99999E100,9.99999E100
<br>

<p class="noindent">Define a range of real numbers for cfengine internal use

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
?

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This is not yet used.

<div class="node">
<a name="Function-selectservers"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-splayclass">Function splayclass</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-rrange">Function rrange</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.89 Function selectservers</h3>

<p class="noindent"><b>Synopsis</b>: selectservers(arg1,arg2,arg3,arg4,arg5,arg6) returns type <b>int</b>

   <p><br>
   <i>arg1</i> : The identifier of a cfengine list of hosts or addresses to contact, <i>in the range</i> @[(][a-zA-Z0-9]+[)]
<br>
   <i>arg2</i> : The port number, <i>in the range</i> 0,99999999999
<br>
   <i>arg3</i> : A query string, <i>in the range</i> .*
<br>
   <i>arg4</i> : A regular expression to match success, <i>in the range</i> .*
<br>
   <i>arg5</i> : Maximum number of bytes to read from server, <i>in the range</i> 0,99999999999
<br>
   <i>arg6</i> : Name for array of results, <i>in the range</i> [a-zA-Z0-9_$(){}\[\].:]+
<br>

<p class="noindent">Select tcp servers which respond correctly to a query and return their number, set array of names

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control

{
bundlesequence  => { "test"  };
}

###########################################################

bundle agent test

{     
vars:

 "hosts" slist => { "slogans.iu.hio.no", "eternity.iu.hio.no", "nexus.iu.hio.no" };
 "fhosts" slist => { "www.cfengine.com", "www.cfengine.org" };
 
 "up_servers" int =>  selectservers("@(hosts)","80","","","100","alive_servers");
 "has_favicon" int =>
	    selectservers(
	        "@(hosts)", "80",
		"GET /favicon.ico HTTP/1.0$(const.n)Host: www.cfengine.com$(const.n)$(const.n)",
		"(?s).*OK.*",
		"200", "favicon_servers");

classes:

  "someone_alive" expression => isgreaterthan("$(up_servers)","0");

  "has_favicon" expression => isgreaterthan("$(has_favicon)","0");

reports:

  cfengine_3::
    "Number of active servers $(up_servers)";

  someone_alive::
    "First server $(alive_servers[0]) fails over to $(alive_servers[1])";

  has_favicon::
    "At least $(favicon_servers[0]) has a favicon.ico";

}


</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>This function selects all the TCP ports that are active and
functioning from an ordered list and builds an array of their names. 
This allows us to select a current list of failover alternatives
that are pretested.

     <dl>
<dt>&lsquo;<samp><span class="samp">hostlist</span></samp>&rsquo;<dd>A list of host names or IP addresses to attempt to connect to.

     <br><dt>&lsquo;<samp><span class="samp">port</span></samp>&rsquo;<dd>The port number for the service.

     <br><dt>&lsquo;<samp><span class="samp">sendstr</span></samp>&rsquo;<dd>An optional string to send to the server to elicit a response.  If
<code>sendstr</code> is empty, then no query is sent to the server.

     <br><dt>&lsquo;<samp><span class="samp">regex_on_reply</span></samp>&rsquo;<dd>If a string is sent, this regex must match the entire resulting
reply (that is, the regex is anchored,
see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>).  If there
is a multi-line response from the server, special care must be taken
to ensure that you match the newlines, too (note the use of <code>(?s)</code>
in the example above, which allows &lsquo;<samp><span class="samp">.</span></samp>&rsquo; to also match newlines
in the multi-line HTTP response).  If <code>regex_on_reply</code> is
empty, then no reply-checking is performed (and any server reply
is deemed to be satisfactory).

     <br><dt>&lsquo;<samp><span class="samp">maxbytesread_reply</span></samp>&rsquo;<dd>The maximum number of bytes to read as the server's reply.

     <br><dt>&lsquo;<samp><span class="samp">array_name</span></samp>&rsquo;<dd>The name of the array to build containing the names of hosts
that pass the above tests. The array is ordered <code>array_name[0],..</code> etc. 
</dl>

<div class="node">
<a name="Function-splayclass"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-splitstring">Function splitstring</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-selectservers">Function selectservers</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.90 Function splayclass</h3>

<p class="noindent"><b>Synopsis</b>: splayclass(arg1,arg2) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : Input string for classification, <i>in the range</i> .*
<br>
   <i>arg2</i> : Splay time policy, <i>in the range</i> daily,hourly
<br>

<p class="noindent">True if the first argument's time-slot has arrived, according to a policy in arg2

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{     
classes:

  "my_result" expression => splayclass("$(sys.host)$(sys.ipv4)","daily");

reports:

  my_result::

    "Load balanced class activated";

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>The lvalue class evaluates to true if the system clock lies within a scheduled
time-interval that maps to a hash of the first argument (which may be any
arbitrary string). Different strings will hash to different time intervals,
and thus one can map different tasks to time-intervals.

   <p>This function may be used to distribute a task, typically in multiple hosts,
in time over a day or
an hourly period, depending on the policy in the second argument (which must
be one of <code>"daily"</code> or <code>"hourly"</code>). 
This is useful for copying resources to multiple hosts from a single server,
(e.g.  large software updates), when simultaneous scheduling would lead to a
bottleneck and/or server overload.

   <p>The function is similar to the <code>splaytime</code> feature in <code>cf-execd</code>,
except
that it allows you to base the decision on any string-criterion on a
given host.  The entropy (or string-variation) in the first argument
determines how effectively CFEngine will be able to distribute tasks. 
CFEngine instances with the same first argument will yield a true
result at the same time (and different first argument will yield a true
result at a different time). Thus tasks could be scheduled according to
group names for predictability, or according to IP addresses for
distribution across the policy interval.

   <p>The times at which the splayclass will be defined depends on the second
argument.  If the first argument is <code>"hourly"</code> then the class will be
defined for a 5-minute interval every hour (and if the first argument is
<code>"daily"</code>, then the class will be defined for one 5-minute interval
every day.  This means that <code>splayclass</code> assumes that you are running
CFEngine with the default schedule of "every 5 minutes".  If you change the
executor <code>schedule</code> control variable, you may prevent the splayclass
from ever being defined (that is, if the hashed 5-minute interval that is
selected by the splayclass is a time when you have told CFEngine <i>not</i> to
run).

<div class="node">
<a name="Function-splitstring"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-strcmp">Function strcmp</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-splayclass">Function splayclass</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.91 Function splitstring</h3>

<p class="noindent"><b>Synopsis</b>: splitstring(arg1,arg2,arg3) returns type <b>slist</b>

   <p><br>
   <i>arg1</i> : A data string, <i>in the range</i> .*
<br>
   <i>arg2</i> : Regex to split on, <i>in the range</i> .*
<br>
   <i>arg3</i> : Maximum number of pieces, <i>in the range</i> 0,99999999999
<br>

<p class="noindent">Convert a string in arg1 into a list of max arg3 strings by splitting on a regular expression in arg2

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
bundle agent test

{
vars:

  "split1" slist => splitstring("one:two:three",":","10");
  "split2" slist => splitstring("one:two:three",":","1");
  "split3" slist => splitstring("alpha:xyz:beta","xyz","10");

reports:

 linux::

  "split1: $(split1)";	# will list "one", "two", and "three"
  "split2: $(split2)";	# will list "one" and "two:three"
  "split3: $(split3)";	# will list "alpha:" and ":beta"

}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

<p class="noindent">Returns a list of strings from a string.

<p class="noindent"><b>ARGUMENTS</b>:

     <dl>
<dt>&lsquo;<samp><span class="samp">string</span></samp>&rsquo;<dd>The string to be split.

     <br><dt>&lsquo;<samp><span class="samp">regex</span></samp>&rsquo;<dd>A regex pattern which is used to parse the field separator(s)
to split up the file into items.  The regex is unanchored,
see <a href="#Anchored-vs_002e-unanchored-regular-expressions">Anchored vs. unanchored regular expressions</a>).

     <br><dt>&lsquo;<samp><span class="samp">maxent</span></samp>&rsquo;<dd>The maximum number of splits to perform. 
</dl>

   <p>If the maximum number of splits is insufficient to accomodate all entries, the
final entry in the slist that is generated will contain the rest of the unsplit string.

<div class="node">
<a name="Function-strcmp"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-sum">Function sum</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-splitstring">Function splitstring</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.92 Function strcmp</h3>

<p class="noindent"><b>Synopsis</b>: strcmp(arg1,arg2) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : String, <i>in the range</i> .*
<br>
   <i>arg2</i> : String, <i>in the range</i> .*
<br>

<p class="noindent">True if the two strings match exactly

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{     
classes:

  "same" expression => strcmp("test","test");

reports:

  same::

    "Strings are equal";

 !same::

    "Strings are not equal";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

<div class="node">
<a name="Function-sum"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-translatepath">Function translatepath</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-strcmp">Function strcmp</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.93 Function sum</h3>

<p class="noindent"><b>Synopsis</b>: sum(arg1) returns type <b>real</b>

   <p><br>
   <i>arg1</i> : A list of arbitrary real values, <i>in the range</i> [a-zA-Z0-9_$(){}\[\].:]+
<br>

<p class="noindent">Return the sum of a list of reals

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control
{
bundlesequence => { "test" };
}

##############################

bundle agent test
{
vars:
  "adds_to_six" ilist => { "1", "2", "3" };
  "six" real => sum("adds_to_six");
  "adds_to_zero" rlist => { "1.0", "2", "-3e0" };
  "zero" real => sum("adds_to_zero");

reports:
  cfengine_3::
    "six is $(six), zero is $(zero)";
}
</pre>

   <p>Because <code>$(six)</code> and <code>$(zero)</code> are both real numbers, the report
that is generated will be:

<pre class="verbatim">six is 6.000000, zero is 0.000000
</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>
Of course, you could easily combine <code>sum</code> with <code>readstringarray</code> or
<code>readreallist</code>, etc. to collect summary information from a source
external to CFEngine.

   <p><b>History</b>: Was introduced in version 3.1.0b1,Nova 2.0.0b1 (2010)

   <p>This function might be used for simple ring computation.

<div class="node">
<a name="Function-translatepath"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-usemodule">Function usemodule</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-sum">Function sum</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.94 Function translatepath</h3>

<p class="noindent"><b>Synopsis</b>: translatepath(arg1) returns type <b>string</b>

   <p><br>
   <i>arg1</i> : Unix style path, <i>in the range</i> "?(/.*)
<br>

<p class="noindent">Translate path separators from Unix style to the host's native

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control
{
bundlesequence => { "test" };
}

##############################

bundle agent test
{
vars:
  "inputs_dir" string => translatepath("$(sys.workdir)/inputs");

reports:

  windows::
    "The path has backslashes: $(inputs_dir)";

  !windows::
    "The path has slashes: $(inputs_dir)";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Takes a string argument with slashes as path separators and translate
these to the native format for path separators on the host. For
example translatepath("a/b/c") would yield "a/b/c" on Unix platforms,
but "a\b\c" on Windows.

   <p>Be careful when using this function in combination with regular
expressions, since backslash is also used as escape character in
regex's. For example, in the regex &lsquo;<samp><span class="samp">dir/.abc</span></samp>&rsquo;, the dot represents the
regular expression "any character", while in the regex &lsquo;<samp><span class="samp">dir\.abc</span></samp>&rsquo;, the
backslash-dot represents a literal dot character.

<div class="node">
<a name="Function-usemodule"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-userexists">Function userexists</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-translatepath">Function translatepath</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.95 Function usemodule</h3>

<p class="noindent"><b>Synopsis</b>: usemodule(arg1,arg2) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : Name of module command, <i>in the range</i> .*
<br>
   <i>arg2</i> : Argument string for the module, <i>in the range</i> .*
<br>

<p class="noindent">Execute cfengine module script and set class if successful

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">
body common control
   {
   any::

      bundlesequence  => {
                         test
                         };
   }

###################################################################

bundle agent test

{
classes:

  # returns $(user)

  "done" expression => usemodule("getusers","");

commands:

  "/bin/echo" args => "test $(user)";
}

</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Modules must reside in <samp><span class="file">WORKDIR/modules</span></samp> but no longer require
a special naming convention.

<p class="noindent"><b>ARGUMENTS</b>:

     <dl>
<dt>&lsquo;<samp><span class="samp">Module name</span></samp>&rsquo;<dd>The name of the module without its leading path, since it is assuemed
to be in the registered modules directory.

     <br><dt>&lsquo;<samp><span class="samp">Argument string</span></samp>&rsquo;<dd>Any command link arguments to pass to the module.

   </dl>

<div class="node">
<a name="Function-userexists"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-usemodule">Function usemodule</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-functions">Special functions</a>

</div>

<h3 class="section">11.96 Function userexists</h3>

<p class="noindent"><b>Synopsis</b>: userexists(arg1) returns type <b>class</b>

   <p><br>
   <i>arg1</i> : User name or identifier, <i>in the range</i> .*
<br>

<p class="noindent">True if user name or numerical id exists on this host

<p class="noindent"><b>Example</b>:<br>
<br>

<pre class="verbatim">

body common control

{
bundlesequence  => { "example" };
}

###########################################################

bundle agent example

{     
classes:

  "ok" expression => userexists("root");

reports:

  ok::

    "Root exists";

 !ok::

    "Root does not exist";
}


</pre>

<p class="noindent"><b>Notes</b>:<br>
<br>

   <p>Checks whether the user is in the password database for the current host. 
The argument must be a user name or user id.

<!-- ***************************************************** -->
<!-- * CHAPTER -->
<!-- ***************************************************** -->
<div class="node">
<a name="Special-Variables"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Logs-and-records">Logs and records</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Special-functions">Special functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">12 Special Variables</h2>

<ul class="menu">
<li><a accesskey="1" href="#Variable-context-const">Variable context const</a>
<li><a accesskey="2" href="#Variable-context-edit">Variable context edit</a>
<li><a accesskey="3" href="#Variable-context-match">Variable context match</a>
<li><a accesskey="4" href="#Variable-context-mon">Variable context mon</a>
<li><a accesskey="5" href="#Variable-context-sys">Variable context sys</a>
<li><a accesskey="6" href="#Variable-context-this">Variable context this</a>
</ul>

<div class="node">
<a name="Variable-context-const"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-context-edit">Variable context edit</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-Variables">Special Variables</a>

</div>

<h3 class="section">12.1 Variable context <code>const</code></h3>

<p><br>

   <p>CFEngine defines a number of variables for embedding unprintable values
or values with special meanings in strings.

<ul class="menu">
<li><a accesskey="1" href="#Variable-const_002edollar">Variable const.dollar</a>
<li><a accesskey="2" href="#Variable-const_002eendl">Variable const.endl</a>
<li><a accesskey="3" href="#Variable-const_002en">Variable const.n</a>
<li><a accesskey="4" href="#Variable-const_002er">Variable const.r</a>
<li><a accesskey="5" href="#Variable-const_002et">Variable const.t</a>
</ul>
<div class="node">
<a name="Variable-const.dollar"></a>
<a name="Variable-const_002edollar"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-const_002eendl">Variable const.endl</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-const">Variable context const</a>

</div>

<h4 class="subsection">12.1.1 Variable const.dollar</h4>

<p><br>

<pre class="verbatim">
reports:

  some::

   # This will report: The value of $(const.dollar) is $
   "The value of $(const.dollar)(const.dollar) is $(const.dollar)";

   # This will report: But the value of \$(dollar) is \$(dollar)
   "But the value of \$(dollar) is \$(dollar)";

</pre>

<div class="node">
<a name="Variable-const.endl"></a>
<a name="Variable-const_002eendl"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-const_002en">Variable const.n</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-const_002edollar">Variable const.dollar</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-const">Variable context const</a>

</div>

<h4 class="subsection">12.1.2 Variable const.endl</h4>

<p><br>

<pre class="verbatim">
reports:

 cfengine_3::

  "A newline with either $(const.n) or with $(const.endl) is ok";
  "But a string with \n in it does not have a newline!";

</pre>

<div class="node">
<a name="Variable-const.n"></a>
<a name="Variable-const_002en"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-const_002er">Variable const.r</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-const_002eendl">Variable const.endl</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-const">Variable context const</a>

</div>

<h4 class="subsection">12.1.3 Variable const.n</h4>

<p><br>

<pre class="verbatim">
reports:

 cfengine_3::

  "A newline with either $(const.n) or with $(const.endl) is ok";
  "But a string with \n in it does not have a newline!";

</pre>

<div class="node">
<a name="Variable-const.r"></a>
<a name="Variable-const_002er"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-const_002et">Variable const.t</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-const_002en">Variable const.n</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-const">Variable context const</a>

</div>

<h4 class="subsection">12.1.4 Variable const.r</h4>

<p><br>

<pre class="verbatim">
reports:

 cfengine_3::

  "A carriage return character is $(const.r)";

</pre>

<div class="node">
<a name="Variable-const.t"></a>
<a name="Variable-const_002et"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-const_002er">Variable const.r</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-const">Variable context const</a>

</div>

<h4 class="subsection">12.1.5 Variable const.t</h4>

<p><br>

<pre class="verbatim">
reports:

 cfengine_3::

  "A report with a$(const.t)tab in it";

</pre>

<div class="node">
<a name="Variable-context-edit"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-context-match">Variable context match</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-context-const">Variable context const</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-Variables">Special Variables</a>

</div>

<h3 class="section">12.2 Variable context <code>edit</code></h3>

<p><br>

   <p>This context &lsquo;<samp><span class="samp">edit</span></samp>&rsquo; is used to access information about editing promises
during their execution. It is context dependent and not universally
meaningful or available. For example:

<pre class="verbatim">bundle agent testbundle
{
files:

  "/tmp/testfile"
     edit_line => test;
}

#

bundle edit_line test
{
classes:
    "ok" expression => regline(".*mark.*","$(edit.filename)");

reports:

  ok::
   "File matched $(edit.filename)";
}

</pre>

<p class="noindent"><b>$(edit.filename)</b>

   <p>This variable points to the filename of the file currently making an edit
promise. If the file has been arrived at through a search, this could be
different from the <samp><span class="file">files</span></samp> promiser.

<ul class="menu">
<li><a accesskey="1" href="#Variable-edit_002efilename">Variable edit.filename</a>
</ul>
<div class="node">
<a name="Variable-edit.filename"></a>
<a name="Variable-edit_002efilename"></a>
<p><hr>
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-edit">Variable context edit</a>

</div>

<h4 class="subsection">12.2.1 Variable edit.filename</h4>

<p><br>

   <p>This variable points to the filename of the file currently making an edit
promise. If the file has been arrived at through a search, this could be
different from the <samp><span class="file">files</span></samp> promiser.

<div class="node">
<a name="Variable-context-match"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-context-mon">Variable context mon</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-context-edit">Variable context edit</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-Variables">Special Variables</a>

</div>

<h3 class="section">12.3 Variable context <code>match</code></h3>

<p><br>

   <p>Each time CFEngine matches a string, these values are
assigned to a special variable context <code>$(match.</code><var>n</var><code>)</code>. 
The fragments can be referred to in the remainder of the promise. 
There are two places where this makes sense. One is in pattern replacement
during file editing, and the other is in searching for files.

   <p>Consider the examples below:
<pre class="verbatim">
bundle agent testbundle

{
files:

  "/home/mark/tmp/(cf[23])_(.*)"
       create    => "true",
       edit_line => myedit("second $(match.2)");


  # but more specifically...

  "/home/mark/tmp/cf3_(test)"
       create    => "true",
       edit_line => myedit("second $(match.1)");


}

</pre>

<ul class="menu">
<li><a accesskey="1" href="#Variable-match_002e0">Variable match.0</a>
</ul>
<div class="node">
<a name="Variable-match.0"></a>
<a name="Variable-match_002e0"></a>
<p><hr>
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-match">Variable context match</a>

</div>

<h4 class="subsection">12.3.1 Variable match.0</h4>

<p><br>

   <p>A string matching the complete regular expression whether or not
back-references were used in the pattern.

<div class="node">
<a name="Variable-context-mon"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-context-sys">Variable context sys</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-context-match">Variable context match</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-Variables">Special Variables</a>

</div>

<h3 class="section">12.4 Variable context <code>mon</code></h3>

<p><br>

   <p>The variables discovered by <code>cf-monitord</code> are placed in this
monitoring context. Monitoring variables are expected to be ephemeral
properties, rapidly changing.

   <p>In enterprise versions of CFEngine, custom defined monitoring targets
also become variables in this context, named by the handle of the
promise that defined them.

<ul class="menu">
<li><a accesskey="1" href="#Variable-mon_002elistening_005fudp4_005fports">Variable mon.listening_udp4_ports</a>
<li><a accesskey="2" href="#Variable-mon_002elistening_005ftcp4_005fports">Variable mon.listening_tcp4_ports</a>
<li><a accesskey="3" href="#Variable-mon_002elistening_005fudp6_005fports">Variable mon.listening_udp6_ports</a>
<li><a accesskey="4" href="#Variable-mon_002elistening_005ftcp6_005fports">Variable mon.listening_tcp6_ports</a>
<li><a accesskey="5" href="#Variable-mon_002evalue_005fusers">Variable mon.value_users</a>
<li><a accesskey="6" href="#Variable-mon_002eav_005fusers">Variable mon.av_users</a>
<li><a accesskey="7" href="#Variable-mon_002edev_005fusers">Variable mon.dev_users</a>
<li><a accesskey="8" href="#Variable-mon_002evalue_005frootprocs">Variable mon.value_rootprocs</a>
<li><a accesskey="9" href="#Variable-mon_002eav_005frootprocs">Variable mon.av_rootprocs</a>
<li><a href="#Variable-mon_002edev_005frootprocs">Variable mon.dev_rootprocs</a>
<li><a href="#Variable-mon_002evalue_005fotherprocs">Variable mon.value_otherprocs</a>
<li><a href="#Variable-mon_002eav_005fotherprocs">Variable mon.av_otherprocs</a>
<li><a href="#Variable-mon_002edev_005fotherprocs">Variable mon.dev_otherprocs</a>
<li><a href="#Variable-mon_002evalue_005fdiskfree">Variable mon.value_diskfree</a>
<li><a href="#Variable-mon_002eav_005fdiskfree">Variable mon.av_diskfree</a>
<li><a href="#Variable-mon_002edev_005fdiskfree">Variable mon.dev_diskfree</a>
<li><a href="#Variable-mon_002evalue_005floadavg">Variable mon.value_loadavg</a>
<li><a href="#Variable-mon_002eav_005floadavg">Variable mon.av_loadavg</a>
<li><a href="#Variable-mon_002edev_005floadavg">Variable mon.dev_loadavg</a>
<li><a href="#Variable-mon_002evalue_005fnetbiosns_005fin">Variable mon.value_netbiosns_in</a>
<li><a href="#Variable-mon_002eav_005fnetbiosns_005fin">Variable mon.av_netbiosns_in</a>
<li><a href="#Variable-mon_002edev_005fnetbiosns_005fin">Variable mon.dev_netbiosns_in</a>
<li><a href="#Variable-mon_002evalue_005fnetbiosns_005fout">Variable mon.value_netbiosns_out</a>
<li><a href="#Variable-mon_002eav_005fnetbiosns_005fout">Variable mon.av_netbiosns_out</a>
<li><a href="#Variable-mon_002edev_005fnetbiosns_005fout">Variable mon.dev_netbiosns_out</a>
<li><a href="#Variable-mon_002evalue_005fnetbiosdgm_005fin">Variable mon.value_netbiosdgm_in</a>
<li><a href="#Variable-mon_002eav_005fnetbiosdgm_005fin">Variable mon.av_netbiosdgm_in</a>
<li><a href="#Variable-mon_002edev_005fnetbiosdgm_005fin">Variable mon.dev_netbiosdgm_in</a>
<li><a href="#Variable-mon_002evalue_005fnetbiosdgm_005fout">Variable mon.value_netbiosdgm_out</a>
<li><a href="#Variable-mon_002eav_005fnetbiosdgm_005fout">Variable mon.av_netbiosdgm_out</a>
<li><a href="#Variable-mon_002edev_005fnetbiosdgm_005fout">Variable mon.dev_netbiosdgm_out</a>
<li><a href="#Variable-mon_002evalue_005fnetbiosssn_005fin">Variable mon.value_netbiosssn_in</a>
<li><a href="#Variable-mon_002eav_005fnetbiosssn_005fin">Variable mon.av_netbiosssn_in</a>
<li><a href="#Variable-mon_002edev_005fnetbiosssn_005fin">Variable mon.dev_netbiosssn_in</a>
<li><a href="#Variable-mon_002evalue_005fnetbiosssn_005fout">Variable mon.value_netbiosssn_out</a>
<li><a href="#Variable-mon_002eav_005fnetbiosssn_005fout">Variable mon.av_netbiosssn_out</a>
<li><a href="#Variable-mon_002edev_005fnetbiosssn_005fout">Variable mon.dev_netbiosssn_out</a>
<li><a href="#Variable-mon_002evalue_005fimap_005fin">Variable mon.value_imap_in</a>
<li><a href="#Variable-mon_002eav_005fimap_005fin">Variable mon.av_imap_in</a>
<li><a href="#Variable-mon_002edev_005fimap_005fin">Variable mon.dev_imap_in</a>
<li><a href="#Variable-mon_002evalue_005fimap_005fout">Variable mon.value_imap_out</a>
<li><a href="#Variable-mon_002eav_005fimap_005fout">Variable mon.av_imap_out</a>
<li><a href="#Variable-mon_002edev_005fimap_005fout">Variable mon.dev_imap_out</a>
<li><a href="#Variable-mon_002evalue_005fcfengine_005fin">Variable mon.value_cfengine_in</a>
<li><a href="#Variable-mon_002eav_005fcfengine_005fin">Variable mon.av_cfengine_in</a>
<li><a href="#Variable-mon_002edev_005fcfengine_005fin">Variable mon.dev_cfengine_in</a>
<li><a href="#Variable-mon_002evalue_005fcfengine_005fout">Variable mon.value_cfengine_out</a>
<li><a href="#Variable-mon_002eav_005fcfengine_005fout">Variable mon.av_cfengine_out</a>
<li><a href="#Variable-mon_002edev_005fcfengine_005fout">Variable mon.dev_cfengine_out</a>
<li><a href="#Variable-mon_002evalue_005fnfsd_005fin">Variable mon.value_nfsd_in</a>
<li><a href="#Variable-mon_002eav_005fnfsd_005fin">Variable mon.av_nfsd_in</a>
<li><a href="#Variable-mon_002edev_005fnfsd_005fin">Variable mon.dev_nfsd_in</a>
<li><a href="#Variable-mon_002evalue_005fnfsd_005fout">Variable mon.value_nfsd_out</a>
<li><a href="#Variable-mon_002eav_005fnfsd_005fout">Variable mon.av_nfsd_out</a>
<li><a href="#Variable-mon_002edev_005fnfsd_005fout">Variable mon.dev_nfsd_out</a>
<li><a href="#Variable-mon_002evalue_005fsmtp_005fin">Variable mon.value_smtp_in</a>
<li><a href="#Variable-mon_002eav_005fsmtp_005fin">Variable mon.av_smtp_in</a>
<li><a href="#Variable-mon_002edev_005fsmtp_005fin">Variable mon.dev_smtp_in</a>
<li><a href="#Variable-mon_002evalue_005fsmtp_005fout">Variable mon.value_smtp_out</a>
<li><a href="#Variable-mon_002eav_005fsmtp_005fout">Variable mon.av_smtp_out</a>
<li><a href="#Variable-mon_002edev_005fsmtp_005fout">Variable mon.dev_smtp_out</a>
<li><a href="#Variable-mon_002evalue_005fwww_005fin">Variable mon.value_www_in</a>
<li><a href="#Variable-mon_002eav_005fwww_005fin">Variable mon.av_www_in</a>
<li><a href="#Variable-mon_002edev_005fwww_005fin">Variable mon.dev_www_in</a>
<li><a href="#Variable-mon_002evalue_005fwww_005fout">Variable mon.value_www_out</a>
<li><a href="#Variable-mon_002eav_005fwww_005fout">Variable mon.av_www_out</a>
<li><a href="#Variable-mon_002edev_005fwww_005fout">Variable mon.dev_www_out</a>
<li><a href="#Variable-mon_002evalue_005fftp_005fin">Variable mon.value_ftp_in</a>
<li><a href="#Variable-mon_002eav_005fftp_005fin">Variable mon.av_ftp_in</a>
<li><a href="#Variable-mon_002edev_005fftp_005fin">Variable mon.dev_ftp_in</a>
<li><a href="#Variable-mon_002evalue_005fftp_005fout">Variable mon.value_ftp_out</a>
<li><a href="#Variable-mon_002eav_005fftp_005fout">Variable mon.av_ftp_out</a>
<li><a href="#Variable-mon_002edev_005fftp_005fout">Variable mon.dev_ftp_out</a>
<li><a href="#Variable-mon_002evalue_005fssh_005fin">Variable mon.value_ssh_in</a>
<li><a href="#Variable-mon_002eav_005fssh_005fin">Variable mon.av_ssh_in</a>
<li><a href="#Variable-mon_002edev_005fssh_005fin">Variable mon.dev_ssh_in</a>
<li><a href="#Variable-mon_002evalue_005fssh_005fout">Variable mon.value_ssh_out</a>
<li><a href="#Variable-mon_002eav_005fssh_005fout">Variable mon.av_ssh_out</a>
<li><a href="#Variable-mon_002edev_005fssh_005fout">Variable mon.dev_ssh_out</a>
<li><a href="#Variable-mon_002evalue_005fwwws_005fin">Variable mon.value_wwws_in</a>
<li><a href="#Variable-mon_002eav_005fwwws_005fin">Variable mon.av_wwws_in</a>
<li><a href="#Variable-mon_002edev_005fwwws_005fin">Variable mon.dev_wwws_in</a>
<li><a href="#Variable-mon_002evalue_005fwwws_005fout">Variable mon.value_wwws_out</a>
<li><a href="#Variable-mon_002eav_005fwwws_005fout">Variable mon.av_wwws_out</a>
<li><a href="#Variable-mon_002edev_005fwwws_005fout">Variable mon.dev_wwws_out</a>
<li><a href="#Variable-mon_002evalue_005ficmp_005fin">Variable mon.value_icmp_in</a>
<li><a href="#Variable-mon_002eav_005ficmp_005fin">Variable mon.av_icmp_in</a>
<li><a href="#Variable-mon_002edev_005ficmp_005fin">Variable mon.dev_icmp_in</a>
<li><a href="#Variable-mon_002evalue_005ficmp_005fout">Variable mon.value_icmp_out</a>
<li><a href="#Variable-mon_002eav_005ficmp_005fout">Variable mon.av_icmp_out</a>
<li><a href="#Variable-mon_002edev_005ficmp_005fout">Variable mon.dev_icmp_out</a>
<li><a href="#Variable-mon_002evalue_005fudp_005fin">Variable mon.value_udp_in</a>
<li><a href="#Variable-mon_002eav_005fudp_005fin">Variable mon.av_udp_in</a>
<li><a href="#Variable-mon_002edev_005fudp_005fin">Variable mon.dev_udp_in</a>
<li><a href="#Variable-mon_002evalue_005fudp_005fout">Variable mon.value_udp_out</a>
<li><a href="#Variable-mon_002eav_005fudp_005fout">Variable mon.av_udp_out</a>
<li><a href="#Variable-mon_002edev_005fudp_005fout">Variable mon.dev_udp_out</a>
<li><a href="#Variable-mon_002evalue_005fdns_005fin">Variable mon.value_dns_in</a>
<li><a href="#Variable-mon_002eav_005fdns_005fin">Variable mon.av_dns_in</a>
<li><a href="#Variable-mon_002edev_005fdns_005fin">Variable mon.dev_dns_in</a>
<li><a href="#Variable-mon_002evalue_005fdns_005fout">Variable mon.value_dns_out</a>
<li><a href="#Variable-mon_002eav_005fdns_005fout">Variable mon.av_dns_out</a>
<li><a href="#Variable-mon_002edev_005fdns_005fout">Variable mon.dev_dns_out</a>
<li><a href="#Variable-mon_002evalue_005ftcpsyn_005fin">Variable mon.value_tcpsyn_in</a>
<li><a href="#Variable-mon_002eav_005ftcpsyn_005fin">Variable mon.av_tcpsyn_in</a>
<li><a href="#Variable-mon_002edev_005ftcpsyn_005fin">Variable mon.dev_tcpsyn_in</a>
<li><a href="#Variable-mon_002evalue_005ftcpsyn_005fout">Variable mon.value_tcpsyn_out</a>
<li><a href="#Variable-mon_002eav_005ftcpsyn_005fout">Variable mon.av_tcpsyn_out</a>
<li><a href="#Variable-mon_002edev_005ftcpsyn_005fout">Variable mon.dev_tcpsyn_out</a>
<li><a href="#Variable-mon_002evalue_005ftcpack_005fin">Variable mon.value_tcpack_in</a>
<li><a href="#Variable-mon_002eav_005ftcpack_005fin">Variable mon.av_tcpack_in</a>
<li><a href="#Variable-mon_002edev_005ftcpack_005fin">Variable mon.dev_tcpack_in</a>
<li><a href="#Variable-mon_002evalue_005ftcpack_005fout">Variable mon.value_tcpack_out</a>
<li><a href="#Variable-mon_002eav_005ftcpack_005fout">Variable mon.av_tcpack_out</a>
<li><a href="#Variable-mon_002edev_005ftcpack_005fout">Variable mon.dev_tcpack_out</a>
<li><a href="#Variable-mon_002evalue_005ftcpfin_005fin">Variable mon.value_tcpfin_in</a>
<li><a href="#Variable-mon_002eav_005ftcpfin_005fin">Variable mon.av_tcpfin_in</a>
<li><a href="#Variable-mon_002edev_005ftcpfin_005fin">Variable mon.dev_tcpfin_in</a>
<li><a href="#Variable-mon_002evalue_005ftcpfin_005fout">Variable mon.value_tcpfin_out</a>
<li><a href="#Variable-mon_002eav_005ftcpfin_005fout">Variable mon.av_tcpfin_out</a>
<li><a href="#Variable-mon_002edev_005ftcpfin_005fout">Variable mon.dev_tcpfin_out</a>
<li><a href="#Variable-mon_002evalue_005ftcpmisc_005fin">Variable mon.value_tcpmisc_in</a>
<li><a href="#Variable-mon_002eav_005ftcpmisc_005fin">Variable mon.av_tcpmisc_in</a>
<li><a href="#Variable-mon_002edev_005ftcpmisc_005fin">Variable mon.dev_tcpmisc_in</a>
<li><a href="#Variable-mon_002evalue_005ftcpmisc_005fout">Variable mon.value_tcpmisc_out</a>
<li><a href="#Variable-mon_002eav_005ftcpmisc_005fout">Variable mon.av_tcpmisc_out</a>
<li><a href="#Variable-mon_002edev_005ftcpmisc_005fout">Variable mon.dev_tcpmisc_out</a>
<li><a href="#Variable-mon_002evalue_005fwebaccess">Variable mon.value_webaccess</a>
<li><a href="#Variable-mon_002eav_005fwebaccess">Variable mon.av_webaccess</a>
<li><a href="#Variable-mon_002edev_005fwebaccess">Variable mon.dev_webaccess</a>
<li><a href="#Variable-mon_002evalue_005fweberrors">Variable mon.value_weberrors</a>
<li><a href="#Variable-mon_002eav_005fweberrors">Variable mon.av_weberrors</a>
<li><a href="#Variable-mon_002edev_005fweberrors">Variable mon.dev_weberrors</a>
<li><a href="#Variable-mon_002evalue_005fsyslog">Variable mon.value_syslog</a>
<li><a href="#Variable-mon_002eav_005fsyslog">Variable mon.av_syslog</a>
<li><a href="#Variable-mon_002edev_005fsyslog">Variable mon.dev_syslog</a>
<li><a href="#Variable-mon_002evalue_005fmessages">Variable mon.value_messages</a>
<li><a href="#Variable-mon_002eav_005fmessages">Variable mon.av_messages</a>
<li><a href="#Variable-mon_002edev_005fmessages">Variable mon.dev_messages</a>
<li><a href="#Variable-mon_002evalue_005ftemp0">Variable mon.value_temp0</a>
<li><a href="#Variable-mon_002eav_005ftemp0">Variable mon.av_temp0</a>
<li><a href="#Variable-mon_002edev_005ftemp0">Variable mon.dev_temp0</a>
<li><a href="#Variable-mon_002evalue_005ftemp1">Variable mon.value_temp1</a>
<li><a href="#Variable-mon_002eav_005ftemp1">Variable mon.av_temp1</a>
<li><a href="#Variable-mon_002edev_005ftemp1">Variable mon.dev_temp1</a>
<li><a href="#Variable-mon_002evalue_005ftemp2">Variable mon.value_temp2</a>
<li><a href="#Variable-mon_002eav_005ftemp2">Variable mon.av_temp2</a>
<li><a href="#Variable-mon_002edev_005ftemp2">Variable mon.dev_temp2</a>
<li><a href="#Variable-mon_002evalue_005ftemp3">Variable mon.value_temp3</a>
<li><a href="#Variable-mon_002eav_005ftemp3">Variable mon.av_temp3</a>
<li><a href="#Variable-mon_002edev_005ftemp3">Variable mon.dev_temp3</a>
<li><a href="#Variable-mon_002evalue_005fcpu">Variable mon.value_cpu</a>
<li><a href="#Variable-mon_002eav_005fcpu">Variable mon.av_cpu</a>
<li><a href="#Variable-mon_002edev_005fcpu">Variable mon.dev_cpu</a>
<li><a href="#Variable-mon_002evalue_005fcpu0">Variable mon.value_cpu0</a>
<li><a href="#Variable-mon_002eav_005fcpu0">Variable mon.av_cpu0</a>
<li><a href="#Variable-mon_002edev_005fcpu0">Variable mon.dev_cpu0</a>
<li><a href="#Variable-mon_002evalue_005fcpu1">Variable mon.value_cpu1</a>
<li><a href="#Variable-mon_002eav_005fcpu1">Variable mon.av_cpu1</a>
<li><a href="#Variable-mon_002edev_005fcpu1">Variable mon.dev_cpu1</a>
<li><a href="#Variable-mon_002evalue_005fcpu2">Variable mon.value_cpu2</a>
<li><a href="#Variable-mon_002eav_005fcpu2">Variable mon.av_cpu2</a>
<li><a href="#Variable-mon_002edev_005fcpu2">Variable mon.dev_cpu2</a>
<li><a href="#Variable-mon_002evalue_005fcpu3">Variable mon.value_cpu3</a>
<li><a href="#Variable-mon_002eav_005fcpu3">Variable mon.av_cpu3</a>
<li><a href="#Variable-mon_002edev_005fcpu3">Variable mon.dev_cpu3</a>
<li><a href="#Variable-mon_002evalue_005fmicrosoft_005fds_005fin">Variable mon.value_microsoft_ds_in</a>
<li><a href="#Variable-mon_002eav_005fmicrosoft_005fds_005fin">Variable mon.av_microsoft_ds_in</a>
<li><a href="#Variable-mon_002edev_005fmicrosoft_005fds_005fin">Variable mon.dev_microsoft_ds_in</a>
<li><a href="#Variable-mon_002evalue_005fmicrosoft_005fds_005fout">Variable mon.value_microsoft_ds_out</a>
<li><a href="#Variable-mon_002eav_005fmicrosoft_005fds_005fout">Variable mon.av_microsoft_ds_out</a>
<li><a href="#Variable-mon_002edev_005fmicrosoft_005fds_005fout">Variable mon.dev_microsoft_ds_out</a>
<li><a href="#Variable-mon_002evalue_005fwww_005falt_005fin">Variable mon.value_www_alt_in</a>
<li><a href="#Variable-mon_002eav_005fwww_005falt_005fin">Variable mon.av_www_alt_in</a>
<li><a href="#Variable-mon_002edev_005fwww_005falt_005fin">Variable mon.dev_www_alt_in</a>
<li><a href="#Variable-mon_002evalue_005fwww_005falt_005fout">Variable mon.value_www_alt_out</a>
<li><a href="#Variable-mon_002eav_005fwww_005falt_005fout">Variable mon.av_www_alt_out</a>
<li><a href="#Variable-mon_002edev_005fwww_005falt_005fout">Variable mon.dev_www_alt_out</a>
<li><a href="#Variable-mon_002evalue_005fimaps_005fin">Variable mon.value_imaps_in</a>
<li><a href="#Variable-mon_002eav_005fimaps_005fin">Variable mon.av_imaps_in</a>
<li><a href="#Variable-mon_002edev_005fimaps_005fin">Variable mon.dev_imaps_in</a>
<li><a href="#Variable-mon_002evalue_005fimaps_005fout">Variable mon.value_imaps_out</a>
<li><a href="#Variable-mon_002eav_005fimaps_005fout">Variable mon.av_imaps_out</a>
<li><a href="#Variable-mon_002edev_005fimaps_005fout">Variable mon.dev_imaps_out</a>
<li><a href="#Variable-mon_002evalue_005fldap_005fin">Variable mon.value_ldap_in</a>
<li><a href="#Variable-mon_002eav_005fldap_005fin">Variable mon.av_ldap_in</a>
<li><a href="#Variable-mon_002edev_005fldap_005fin">Variable mon.dev_ldap_in</a>
<li><a href="#Variable-mon_002evalue_005fldap_005fout">Variable mon.value_ldap_out</a>
<li><a href="#Variable-mon_002eav_005fldap_005fout">Variable mon.av_ldap_out</a>
<li><a href="#Variable-mon_002edev_005fldap_005fout">Variable mon.dev_ldap_out</a>
<li><a href="#Variable-mon_002evalue_005fldaps_005fin">Variable mon.value_ldaps_in</a>
<li><a href="#Variable-mon_002eav_005fldaps_005fin">Variable mon.av_ldaps_in</a>
<li><a href="#Variable-mon_002edev_005fldaps_005fin">Variable mon.dev_ldaps_in</a>
<li><a href="#Variable-mon_002evalue_005fldaps_005fout">Variable mon.value_ldaps_out</a>
<li><a href="#Variable-mon_002eav_005fldaps_005fout">Variable mon.av_ldaps_out</a>
<li><a href="#Variable-mon_002edev_005fldaps_005fout">Variable mon.dev_ldaps_out</a>
<li><a href="#Variable-mon_002evalue_005fmongo_005fin">Variable mon.value_mongo_in</a>
<li><a href="#Variable-mon_002eav_005fmongo_005fin">Variable mon.av_mongo_in</a>
<li><a href="#Variable-mon_002edev_005fmongo_005fin">Variable mon.dev_mongo_in</a>
<li><a href="#Variable-mon_002evalue_005fmongo_005fout">Variable mon.value_mongo_out</a>
<li><a href="#Variable-mon_002eav_005fmongo_005fout">Variable mon.av_mongo_out</a>
<li><a href="#Variable-mon_002edev_005fmongo_005fout">Variable mon.dev_mongo_out</a>
<li><a href="#Variable-mon_002evalue_005fmysql_005fin">Variable mon.value_mysql_in</a>
<li><a href="#Variable-mon_002eav_005fmysql_005fin">Variable mon.av_mysql_in</a>
<li><a href="#Variable-mon_002edev_005fmysql_005fin">Variable mon.dev_mysql_in</a>
<li><a href="#Variable-mon_002evalue_005fmysql_005fout">Variable mon.value_mysql_out</a>
<li><a href="#Variable-mon_002eav_005fmysql_005fout">Variable mon.av_mysql_out</a>
<li><a href="#Variable-mon_002edev_005fmysql_005fout">Variable mon.dev_mysql_out</a>
<li><a href="#Variable-mon_002evalue_005fpostgres_005fin">Variable mon.value_postgres_in</a>
<li><a href="#Variable-mon_002eav_005fpostgres_005fin">Variable mon.av_postgres_in</a>
<li><a href="#Variable-mon_002edev_005fpostgres_005fin">Variable mon.dev_postgres_in</a>
<li><a href="#Variable-mon_002evalue_005fpostgres_005fout">Variable mon.value_postgres_out</a>
<li><a href="#Variable-mon_002eav_005fpostgres_005fout">Variable mon.av_postgres_out</a>
<li><a href="#Variable-mon_002edev_005fpostgres_005fout">Variable mon.dev_postgres_out</a>
<li><a href="#Variable-mon_002evalue_005fipp_005fin">Variable mon.value_ipp_in</a>
<li><a href="#Variable-mon_002eav_005fipp_005fin">Variable mon.av_ipp_in</a>
<li><a href="#Variable-mon_002edev_005fipp_005fin">Variable mon.dev_ipp_in</a>
<li><a href="#Variable-mon_002evalue_005fipp_005fout">Variable mon.value_ipp_out</a>
<li><a href="#Variable-mon_002eav_005fipp_005fout">Variable mon.av_ipp_out</a>
<li><a href="#Variable-mon_002edev_005fipp_005fout">Variable mon.dev_ipp_out</a>
</ul>

<div class="node">
<a name="Variable-mon.listening_udp4_ports"></a>
<a name="Variable-mon_002elistening_005fudp4_005fports"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002elistening_005ftcp4_005fports">Variable mon.listening_tcp4_ports</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.1 Variable mon.listening_udp4_ports</h4>

<p>List variable containing an observational measure collected every 2.5 minutes from cf-monitord, description: port numbers that were observed to be set up to receive connections on the host concerned
<div class="node">
<a name="Variable-mon.listening_tcp4_ports"></a>
<a name="Variable-mon_002elistening_005ftcp4_005fports"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002elistening_005fudp6_005fports">Variable mon.listening_udp6_ports</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002elistening_005fudp4_005fports">Variable mon.listening_udp4_ports</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.2 Variable mon.listening_tcp4_ports</h4>

<p>List variable containing an observational measure collected every 2.5 minutes from cf-monitord, description: port numbers that were observed to be set up to receive connections on the host concerned
<div class="node">
<a name="Variable-mon.listening_udp6_ports"></a>
<a name="Variable-mon_002elistening_005fudp6_005fports"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002elistening_005ftcp6_005fports">Variable mon.listening_tcp6_ports</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002elistening_005ftcp4_005fports">Variable mon.listening_tcp4_ports</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.3 Variable mon.listening_udp6_ports</h4>

<p>List variable containing an observational measure collected every 2.5 minutes from cf-monitord, description: port numbers that were observed to be set up to receive connections on the host concerned
<div class="node">
<a name="Variable-mon.listening_tcp6_ports"></a>
<a name="Variable-mon_002elistening_005ftcp6_005fports"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fusers">Variable mon.value_users</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002elistening_005fudp6_005fports">Variable mon.listening_udp6_ports</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.4 Variable mon.listening_tcp6_ports</h4>

<p>List variable containing an observational measure collected every 2.5 minutes from cf-monitord, description: port numbers that were observed to be set up to receive connections on the host concerned
<div class="node">
<a name="Variable-mon.value_users"></a>
<a name="Variable-mon_002evalue_005fusers"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fusers">Variable mon.av_users</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002elistening_005ftcp6_005fports">Variable mon.listening_tcp6_ports</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.5 Variable mon.value_users</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Users with active processes - including system users</var>. 
<div class="node">
<a name="Variable-mon.av_users"></a>
<a name="Variable-mon_002eav_005fusers"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fusers">Variable mon.dev_users</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fusers">Variable mon.value_users</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.6 Variable mon.av_users</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Users with active processes - including system users</var>. 
<div class="node">
<a name="Variable-mon.dev_users"></a>
<a name="Variable-mon_002edev_005fusers"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005frootprocs">Variable mon.value_rootprocs</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fusers">Variable mon.av_users</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.7 Variable mon.dev_users</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Users with active processes - including system users</var>. 
<div class="node">
<a name="Variable-mon.value_rootprocs"></a>
<a name="Variable-mon_002evalue_005frootprocs"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005frootprocs">Variable mon.av_rootprocs</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fusers">Variable mon.dev_users</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.8 Variable mon.value_rootprocs</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Sum privileged system processes</var>. 
<div class="node">
<a name="Variable-mon.av_rootprocs"></a>
<a name="Variable-mon_002eav_005frootprocs"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005frootprocs">Variable mon.dev_rootprocs</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005frootprocs">Variable mon.value_rootprocs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.9 Variable mon.av_rootprocs</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Sum privileged system processes</var>. 
<div class="node">
<a name="Variable-mon.dev_rootprocs"></a>
<a name="Variable-mon_002edev_005frootprocs"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fotherprocs">Variable mon.value_otherprocs</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005frootprocs">Variable mon.av_rootprocs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.10 Variable mon.dev_rootprocs</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Sum privileged system processes</var>. 
<div class="node">
<a name="Variable-mon.value_otherprocs"></a>
<a name="Variable-mon_002evalue_005fotherprocs"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fotherprocs">Variable mon.av_otherprocs</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005frootprocs">Variable mon.dev_rootprocs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.11 Variable mon.value_otherprocs</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Sum non-privileged process</var>. 
<div class="node">
<a name="Variable-mon.av_otherprocs"></a>
<a name="Variable-mon_002eav_005fotherprocs"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fotherprocs">Variable mon.dev_otherprocs</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fotherprocs">Variable mon.value_otherprocs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.12 Variable mon.av_otherprocs</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Sum non-privileged process</var>. 
<div class="node">
<a name="Variable-mon.dev_otherprocs"></a>
<a name="Variable-mon_002edev_005fotherprocs"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fdiskfree">Variable mon.value_diskfree</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fotherprocs">Variable mon.av_otherprocs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.13 Variable mon.dev_otherprocs</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Sum non-privileged process</var>. 
<div class="node">
<a name="Variable-mon.value_diskfree"></a>
<a name="Variable-mon_002evalue_005fdiskfree"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fdiskfree">Variable mon.av_diskfree</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fotherprocs">Variable mon.dev_otherprocs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.14 Variable mon.value_diskfree</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Free disk on / partition</var>. 
<div class="node">
<a name="Variable-mon.av_diskfree"></a>
<a name="Variable-mon_002eav_005fdiskfree"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fdiskfree">Variable mon.dev_diskfree</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fdiskfree">Variable mon.value_diskfree</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.15 Variable mon.av_diskfree</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Free disk on / partition</var>. 
<div class="node">
<a name="Variable-mon.dev_diskfree"></a>
<a name="Variable-mon_002edev_005fdiskfree"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005floadavg">Variable mon.value_loadavg</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fdiskfree">Variable mon.av_diskfree</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.16 Variable mon.dev_diskfree</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Free disk on / partition</var>. 
<div class="node">
<a name="Variable-mon.value_loadavg"></a>
<a name="Variable-mon_002evalue_005floadavg"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005floadavg">Variable mon.av_loadavg</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fdiskfree">Variable mon.dev_diskfree</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.17 Variable mon.value_loadavg</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Kernel load average utilization (sum over cores)</var>. 
<div class="node">
<a name="Variable-mon.av_loadavg"></a>
<a name="Variable-mon_002eav_005floadavg"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005floadavg">Variable mon.dev_loadavg</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005floadavg">Variable mon.value_loadavg</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.18 Variable mon.av_loadavg</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Kernel load average utilization (sum over cores)</var>. 
<div class="node">
<a name="Variable-mon.dev_loadavg"></a>
<a name="Variable-mon_002edev_005floadavg"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fnetbiosns_005fin">Variable mon.value_netbiosns_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005floadavg">Variable mon.av_loadavg</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.19 Variable mon.dev_loadavg</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Kernel load average utilization (sum over cores)</var>. 
<div class="node">
<a name="Variable-mon.value_netbiosns_in"></a>
<a name="Variable-mon_002evalue_005fnetbiosns_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fnetbiosns_005fin">Variable mon.av_netbiosns_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005floadavg">Variable mon.dev_loadavg</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.20 Variable mon.value_netbiosns_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>netbios name lookups (in)</var>. 
<div class="node">
<a name="Variable-mon.av_netbiosns_in"></a>
<a name="Variable-mon_002eav_005fnetbiosns_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fnetbiosns_005fin">Variable mon.dev_netbiosns_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fnetbiosns_005fin">Variable mon.value_netbiosns_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.21 Variable mon.av_netbiosns_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>netbios name lookups (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_netbiosns_in"></a>
<a name="Variable-mon_002edev_005fnetbiosns_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fnetbiosns_005fout">Variable mon.value_netbiosns_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fnetbiosns_005fin">Variable mon.av_netbiosns_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.22 Variable mon.dev_netbiosns_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>netbios name lookups (in)</var>. 
<div class="node">
<a name="Variable-mon.value_netbiosns_out"></a>
<a name="Variable-mon_002evalue_005fnetbiosns_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fnetbiosns_005fout">Variable mon.av_netbiosns_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fnetbiosns_005fin">Variable mon.dev_netbiosns_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.23 Variable mon.value_netbiosns_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>netbios name lookups (out)</var>. 
<div class="node">
<a name="Variable-mon.av_netbiosns_out"></a>
<a name="Variable-mon_002eav_005fnetbiosns_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fnetbiosns_005fout">Variable mon.dev_netbiosns_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fnetbiosns_005fout">Variable mon.value_netbiosns_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.24 Variable mon.av_netbiosns_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>netbios name lookups (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_netbiosns_out"></a>
<a name="Variable-mon_002edev_005fnetbiosns_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fnetbiosdgm_005fin">Variable mon.value_netbiosdgm_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fnetbiosns_005fout">Variable mon.av_netbiosns_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.25 Variable mon.dev_netbiosns_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>netbios name lookups (out)</var>. 
<div class="node">
<a name="Variable-mon.value_netbiosdgm_in"></a>
<a name="Variable-mon_002evalue_005fnetbiosdgm_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fnetbiosdgm_005fin">Variable mon.av_netbiosdgm_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fnetbiosns_005fout">Variable mon.dev_netbiosns_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.26 Variable mon.value_netbiosdgm_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>netbios name datagrams (in)</var>. 
<div class="node">
<a name="Variable-mon.av_netbiosdgm_in"></a>
<a name="Variable-mon_002eav_005fnetbiosdgm_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fnetbiosdgm_005fin">Variable mon.dev_netbiosdgm_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fnetbiosdgm_005fin">Variable mon.value_netbiosdgm_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.27 Variable mon.av_netbiosdgm_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>netbios name datagrams (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_netbiosdgm_in"></a>
<a name="Variable-mon_002edev_005fnetbiosdgm_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fnetbiosdgm_005fout">Variable mon.value_netbiosdgm_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fnetbiosdgm_005fin">Variable mon.av_netbiosdgm_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.28 Variable mon.dev_netbiosdgm_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>netbios name datagrams (in)</var>. 
<div class="node">
<a name="Variable-mon.value_netbiosdgm_out"></a>
<a name="Variable-mon_002evalue_005fnetbiosdgm_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fnetbiosdgm_005fout">Variable mon.av_netbiosdgm_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fnetbiosdgm_005fin">Variable mon.dev_netbiosdgm_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.29 Variable mon.value_netbiosdgm_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>netbios name datagrams (out)</var>. 
<div class="node">
<a name="Variable-mon.av_netbiosdgm_out"></a>
<a name="Variable-mon_002eav_005fnetbiosdgm_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fnetbiosdgm_005fout">Variable mon.dev_netbiosdgm_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fnetbiosdgm_005fout">Variable mon.value_netbiosdgm_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.30 Variable mon.av_netbiosdgm_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>netbios name datagrams (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_netbiosdgm_out"></a>
<a name="Variable-mon_002edev_005fnetbiosdgm_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fnetbiosssn_005fin">Variable mon.value_netbiosssn_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fnetbiosdgm_005fout">Variable mon.av_netbiosdgm_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.31 Variable mon.dev_netbiosdgm_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>netbios name datagrams (out)</var>. 
<div class="node">
<a name="Variable-mon.value_netbiosssn_in"></a>
<a name="Variable-mon_002evalue_005fnetbiosssn_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fnetbiosssn_005fin">Variable mon.av_netbiosssn_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fnetbiosdgm_005fout">Variable mon.dev_netbiosdgm_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.32 Variable mon.value_netbiosssn_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Samba/netbios name sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.av_netbiosssn_in"></a>
<a name="Variable-mon_002eav_005fnetbiosssn_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fnetbiosssn_005fin">Variable mon.dev_netbiosssn_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fnetbiosssn_005fin">Variable mon.value_netbiosssn_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.33 Variable mon.av_netbiosssn_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Samba/netbios name sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_netbiosssn_in"></a>
<a name="Variable-mon_002edev_005fnetbiosssn_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fnetbiosssn_005fout">Variable mon.value_netbiosssn_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fnetbiosssn_005fin">Variable mon.av_netbiosssn_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.34 Variable mon.dev_netbiosssn_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Samba/netbios name sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.value_netbiosssn_out"></a>
<a name="Variable-mon_002evalue_005fnetbiosssn_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fnetbiosssn_005fout">Variable mon.av_netbiosssn_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fnetbiosssn_005fin">Variable mon.dev_netbiosssn_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.35 Variable mon.value_netbiosssn_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Samba/netbios name sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.av_netbiosssn_out"></a>
<a name="Variable-mon_002eav_005fnetbiosssn_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fnetbiosssn_005fout">Variable mon.dev_netbiosssn_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fnetbiosssn_005fout">Variable mon.value_netbiosssn_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.36 Variable mon.av_netbiosssn_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Samba/netbios name sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_netbiosssn_out"></a>
<a name="Variable-mon_002edev_005fnetbiosssn_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fimap_005fin">Variable mon.value_imap_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fnetbiosssn_005fout">Variable mon.av_netbiosssn_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.37 Variable mon.dev_netbiosssn_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Samba/netbios name sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.value_imap_in"></a>
<a name="Variable-mon_002evalue_005fimap_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fimap_005fin">Variable mon.av_imap_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fnetbiosssn_005fout">Variable mon.dev_netbiosssn_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.38 Variable mon.value_imap_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>imap mail client sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.av_imap_in"></a>
<a name="Variable-mon_002eav_005fimap_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fimap_005fin">Variable mon.dev_imap_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fimap_005fin">Variable mon.value_imap_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.39 Variable mon.av_imap_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>imap mail client sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_imap_in"></a>
<a name="Variable-mon_002edev_005fimap_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fimap_005fout">Variable mon.value_imap_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fimap_005fin">Variable mon.av_imap_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.40 Variable mon.dev_imap_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>imap mail client sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.value_imap_out"></a>
<a name="Variable-mon_002evalue_005fimap_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fimap_005fout">Variable mon.av_imap_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fimap_005fin">Variable mon.dev_imap_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.41 Variable mon.value_imap_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>imap mail client sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.av_imap_out"></a>
<a name="Variable-mon_002eav_005fimap_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fimap_005fout">Variable mon.dev_imap_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fimap_005fout">Variable mon.value_imap_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.42 Variable mon.av_imap_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>imap mail client sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_imap_out"></a>
<a name="Variable-mon_002edev_005fimap_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fcfengine_005fin">Variable mon.value_cfengine_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fimap_005fout">Variable mon.av_imap_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.43 Variable mon.dev_imap_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>imap mail client sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.value_cfengine_in"></a>
<a name="Variable-mon_002evalue_005fcfengine_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fcfengine_005fin">Variable mon.av_cfengine_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fimap_005fout">Variable mon.dev_imap_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.44 Variable mon.value_cfengine_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>cfengine connections (in)</var>. 
<div class="node">
<a name="Variable-mon.av_cfengine_in"></a>
<a name="Variable-mon_002eav_005fcfengine_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fcfengine_005fin">Variable mon.dev_cfengine_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fcfengine_005fin">Variable mon.value_cfengine_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.45 Variable mon.av_cfengine_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>cfengine connections (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_cfengine_in"></a>
<a name="Variable-mon_002edev_005fcfengine_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fcfengine_005fout">Variable mon.value_cfengine_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fcfengine_005fin">Variable mon.av_cfengine_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.46 Variable mon.dev_cfengine_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>cfengine connections (in)</var>. 
<div class="node">
<a name="Variable-mon.value_cfengine_out"></a>
<a name="Variable-mon_002evalue_005fcfengine_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fcfengine_005fout">Variable mon.av_cfengine_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fcfengine_005fin">Variable mon.dev_cfengine_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.47 Variable mon.value_cfengine_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>cfengine connections (out)</var>. 
<div class="node">
<a name="Variable-mon.av_cfengine_out"></a>
<a name="Variable-mon_002eav_005fcfengine_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fcfengine_005fout">Variable mon.dev_cfengine_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fcfengine_005fout">Variable mon.value_cfengine_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.48 Variable mon.av_cfengine_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>cfengine connections (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_cfengine_out"></a>
<a name="Variable-mon_002edev_005fcfengine_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fnfsd_005fin">Variable mon.value_nfsd_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fcfengine_005fout">Variable mon.av_cfengine_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.49 Variable mon.dev_cfengine_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>cfengine connections (out)</var>. 
<div class="node">
<a name="Variable-mon.value_nfsd_in"></a>
<a name="Variable-mon_002evalue_005fnfsd_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fnfsd_005fin">Variable mon.av_nfsd_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fcfengine_005fout">Variable mon.dev_cfengine_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.50 Variable mon.value_nfsd_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>nfs connections (in)</var>. 
<div class="node">
<a name="Variable-mon.av_nfsd_in"></a>
<a name="Variable-mon_002eav_005fnfsd_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fnfsd_005fin">Variable mon.dev_nfsd_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fnfsd_005fin">Variable mon.value_nfsd_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.51 Variable mon.av_nfsd_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>nfs connections (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_nfsd_in"></a>
<a name="Variable-mon_002edev_005fnfsd_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fnfsd_005fout">Variable mon.value_nfsd_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fnfsd_005fin">Variable mon.av_nfsd_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.52 Variable mon.dev_nfsd_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>nfs connections (in)</var>. 
<div class="node">
<a name="Variable-mon.value_nfsd_out"></a>
<a name="Variable-mon_002evalue_005fnfsd_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fnfsd_005fout">Variable mon.av_nfsd_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fnfsd_005fin">Variable mon.dev_nfsd_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.53 Variable mon.value_nfsd_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>nfs connections (out)</var>. 
<div class="node">
<a name="Variable-mon.av_nfsd_out"></a>
<a name="Variable-mon_002eav_005fnfsd_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fnfsd_005fout">Variable mon.dev_nfsd_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fnfsd_005fout">Variable mon.value_nfsd_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.54 Variable mon.av_nfsd_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>nfs connections (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_nfsd_out"></a>
<a name="Variable-mon_002edev_005fnfsd_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fsmtp_005fin">Variable mon.value_smtp_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fnfsd_005fout">Variable mon.av_nfsd_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.55 Variable mon.dev_nfsd_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>nfs connections (out)</var>. 
<div class="node">
<a name="Variable-mon.value_smtp_in"></a>
<a name="Variable-mon_002evalue_005fsmtp_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fsmtp_005fin">Variable mon.av_smtp_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fnfsd_005fout">Variable mon.dev_nfsd_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.56 Variable mon.value_smtp_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>smtp connections (in)</var>. 
<div class="node">
<a name="Variable-mon.av_smtp_in"></a>
<a name="Variable-mon_002eav_005fsmtp_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fsmtp_005fin">Variable mon.dev_smtp_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fsmtp_005fin">Variable mon.value_smtp_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.57 Variable mon.av_smtp_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>smtp connections (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_smtp_in"></a>
<a name="Variable-mon_002edev_005fsmtp_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fsmtp_005fout">Variable mon.value_smtp_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fsmtp_005fin">Variable mon.av_smtp_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.58 Variable mon.dev_smtp_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>smtp connections (in)</var>. 
<div class="node">
<a name="Variable-mon.value_smtp_out"></a>
<a name="Variable-mon_002evalue_005fsmtp_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fsmtp_005fout">Variable mon.av_smtp_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fsmtp_005fin">Variable mon.dev_smtp_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.59 Variable mon.value_smtp_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>smtp connections (out)</var>. 
<div class="node">
<a name="Variable-mon.av_smtp_out"></a>
<a name="Variable-mon_002eav_005fsmtp_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fsmtp_005fout">Variable mon.dev_smtp_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fsmtp_005fout">Variable mon.value_smtp_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.60 Variable mon.av_smtp_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>smtp connections (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_smtp_out"></a>
<a name="Variable-mon_002edev_005fsmtp_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fwww_005fin">Variable mon.value_www_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fsmtp_005fout">Variable mon.av_smtp_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.61 Variable mon.dev_smtp_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>smtp connections (out)</var>. 
<div class="node">
<a name="Variable-mon.value_www_in"></a>
<a name="Variable-mon_002evalue_005fwww_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fwww_005fin">Variable mon.av_www_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fsmtp_005fout">Variable mon.dev_smtp_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.62 Variable mon.value_www_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>www connections (in)</var>. 
<div class="node">
<a name="Variable-mon.av_www_in"></a>
<a name="Variable-mon_002eav_005fwww_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fwww_005fin">Variable mon.dev_www_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fwww_005fin">Variable mon.value_www_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.63 Variable mon.av_www_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>www connections (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_www_in"></a>
<a name="Variable-mon_002edev_005fwww_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fwww_005fout">Variable mon.value_www_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fwww_005fin">Variable mon.av_www_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.64 Variable mon.dev_www_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>www connections (in)</var>. 
<div class="node">
<a name="Variable-mon.value_www_out"></a>
<a name="Variable-mon_002evalue_005fwww_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fwww_005fout">Variable mon.av_www_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fwww_005fin">Variable mon.dev_www_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.65 Variable mon.value_www_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>www connections (out)</var>. 
<div class="node">
<a name="Variable-mon.av_www_out"></a>
<a name="Variable-mon_002eav_005fwww_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fwww_005fout">Variable mon.dev_www_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fwww_005fout">Variable mon.value_www_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.66 Variable mon.av_www_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>www connections (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_www_out"></a>
<a name="Variable-mon_002edev_005fwww_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fftp_005fin">Variable mon.value_ftp_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fwww_005fout">Variable mon.av_www_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.67 Variable mon.dev_www_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>www connections (out)</var>. 
<div class="node">
<a name="Variable-mon.value_ftp_in"></a>
<a name="Variable-mon_002evalue_005fftp_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fftp_005fin">Variable mon.av_ftp_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fwww_005fout">Variable mon.dev_www_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.68 Variable mon.value_ftp_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>ftp connections (in)</var>. 
<div class="node">
<a name="Variable-mon.av_ftp_in"></a>
<a name="Variable-mon_002eav_005fftp_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fftp_005fin">Variable mon.dev_ftp_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fftp_005fin">Variable mon.value_ftp_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.69 Variable mon.av_ftp_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>ftp connections (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_ftp_in"></a>
<a name="Variable-mon_002edev_005fftp_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fftp_005fout">Variable mon.value_ftp_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fftp_005fin">Variable mon.av_ftp_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.70 Variable mon.dev_ftp_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>ftp connections (in)</var>. 
<div class="node">
<a name="Variable-mon.value_ftp_out"></a>
<a name="Variable-mon_002evalue_005fftp_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fftp_005fout">Variable mon.av_ftp_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fftp_005fin">Variable mon.dev_ftp_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.71 Variable mon.value_ftp_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>ftp connections (out)</var>. 
<div class="node">
<a name="Variable-mon.av_ftp_out"></a>
<a name="Variable-mon_002eav_005fftp_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fftp_005fout">Variable mon.dev_ftp_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fftp_005fout">Variable mon.value_ftp_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.72 Variable mon.av_ftp_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>ftp connections (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_ftp_out"></a>
<a name="Variable-mon_002edev_005fftp_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fssh_005fin">Variable mon.value_ssh_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fftp_005fout">Variable mon.av_ftp_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.73 Variable mon.dev_ftp_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>ftp connections (out)</var>. 
<div class="node">
<a name="Variable-mon.value_ssh_in"></a>
<a name="Variable-mon_002evalue_005fssh_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fssh_005fin">Variable mon.av_ssh_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fftp_005fout">Variable mon.dev_ftp_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.74 Variable mon.value_ssh_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>ssh connections (in)</var>. 
<div class="node">
<a name="Variable-mon.av_ssh_in"></a>
<a name="Variable-mon_002eav_005fssh_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fssh_005fin">Variable mon.dev_ssh_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fssh_005fin">Variable mon.value_ssh_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.75 Variable mon.av_ssh_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>ssh connections (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_ssh_in"></a>
<a name="Variable-mon_002edev_005fssh_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fssh_005fout">Variable mon.value_ssh_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fssh_005fin">Variable mon.av_ssh_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.76 Variable mon.dev_ssh_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>ssh connections (in)</var>. 
<div class="node">
<a name="Variable-mon.value_ssh_out"></a>
<a name="Variable-mon_002evalue_005fssh_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fssh_005fout">Variable mon.av_ssh_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fssh_005fin">Variable mon.dev_ssh_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.77 Variable mon.value_ssh_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>ssh connections (out)</var>. 
<div class="node">
<a name="Variable-mon.av_ssh_out"></a>
<a name="Variable-mon_002eav_005fssh_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fssh_005fout">Variable mon.dev_ssh_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fssh_005fout">Variable mon.value_ssh_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.78 Variable mon.av_ssh_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>ssh connections (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_ssh_out"></a>
<a name="Variable-mon_002edev_005fssh_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fwwws_005fin">Variable mon.value_wwws_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fssh_005fout">Variable mon.av_ssh_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.79 Variable mon.dev_ssh_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>ssh connections (out)</var>. 
<div class="node">
<a name="Variable-mon.value_wwws_in"></a>
<a name="Variable-mon_002evalue_005fwwws_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fwwws_005fin">Variable mon.av_wwws_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fssh_005fout">Variable mon.dev_ssh_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.80 Variable mon.value_wwws_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>wwws connections (in)</var>. 
<div class="node">
<a name="Variable-mon.av_wwws_in"></a>
<a name="Variable-mon_002eav_005fwwws_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fwwws_005fin">Variable mon.dev_wwws_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fwwws_005fin">Variable mon.value_wwws_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.81 Variable mon.av_wwws_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>wwws connections (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_wwws_in"></a>
<a name="Variable-mon_002edev_005fwwws_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fwwws_005fout">Variable mon.value_wwws_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fwwws_005fin">Variable mon.av_wwws_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.82 Variable mon.dev_wwws_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>wwws connections (in)</var>. 
<div class="node">
<a name="Variable-mon.value_wwws_out"></a>
<a name="Variable-mon_002evalue_005fwwws_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fwwws_005fout">Variable mon.av_wwws_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fwwws_005fin">Variable mon.dev_wwws_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.83 Variable mon.value_wwws_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>wwws connections (out)</var>. 
<div class="node">
<a name="Variable-mon.av_wwws_out"></a>
<a name="Variable-mon_002eav_005fwwws_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fwwws_005fout">Variable mon.dev_wwws_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fwwws_005fout">Variable mon.value_wwws_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.84 Variable mon.av_wwws_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>wwws connections (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_wwws_out"></a>
<a name="Variable-mon_002edev_005fwwws_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005ficmp_005fin">Variable mon.value_icmp_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fwwws_005fout">Variable mon.av_wwws_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.85 Variable mon.dev_wwws_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>wwws connections (out)</var>. 
<div class="node">
<a name="Variable-mon.value_icmp_in"></a>
<a name="Variable-mon_002evalue_005ficmp_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005ficmp_005fin">Variable mon.av_icmp_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fwwws_005fout">Variable mon.dev_wwws_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.86 Variable mon.value_icmp_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>ICMP packets (in)</var>. 
<div class="node">
<a name="Variable-mon.av_icmp_in"></a>
<a name="Variable-mon_002eav_005ficmp_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005ficmp_005fin">Variable mon.dev_icmp_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005ficmp_005fin">Variable mon.value_icmp_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.87 Variable mon.av_icmp_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>ICMP packets (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_icmp_in"></a>
<a name="Variable-mon_002edev_005ficmp_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005ficmp_005fout">Variable mon.value_icmp_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005ficmp_005fin">Variable mon.av_icmp_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.88 Variable mon.dev_icmp_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>ICMP packets (in)</var>. 
<div class="node">
<a name="Variable-mon.value_icmp_out"></a>
<a name="Variable-mon_002evalue_005ficmp_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005ficmp_005fout">Variable mon.av_icmp_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005ficmp_005fin">Variable mon.dev_icmp_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.89 Variable mon.value_icmp_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>ICMP packets (out)</var>. 
<div class="node">
<a name="Variable-mon.av_icmp_out"></a>
<a name="Variable-mon_002eav_005ficmp_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005ficmp_005fout">Variable mon.dev_icmp_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005ficmp_005fout">Variable mon.value_icmp_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.90 Variable mon.av_icmp_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>ICMP packets (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_icmp_out"></a>
<a name="Variable-mon_002edev_005ficmp_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fudp_005fin">Variable mon.value_udp_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005ficmp_005fout">Variable mon.av_icmp_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.91 Variable mon.dev_icmp_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>ICMP packets (out)</var>. 
<div class="node">
<a name="Variable-mon.value_udp_in"></a>
<a name="Variable-mon_002evalue_005fudp_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fudp_005fin">Variable mon.av_udp_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005ficmp_005fout">Variable mon.dev_icmp_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.92 Variable mon.value_udp_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>UDP dgrams (in)</var>. 
<div class="node">
<a name="Variable-mon.av_udp_in"></a>
<a name="Variable-mon_002eav_005fudp_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fudp_005fin">Variable mon.dev_udp_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fudp_005fin">Variable mon.value_udp_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.93 Variable mon.av_udp_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>UDP dgrams (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_udp_in"></a>
<a name="Variable-mon_002edev_005fudp_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fudp_005fout">Variable mon.value_udp_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fudp_005fin">Variable mon.av_udp_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.94 Variable mon.dev_udp_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>UDP dgrams (in)</var>. 
<div class="node">
<a name="Variable-mon.value_udp_out"></a>
<a name="Variable-mon_002evalue_005fudp_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fudp_005fout">Variable mon.av_udp_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fudp_005fin">Variable mon.dev_udp_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.95 Variable mon.value_udp_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>UDP dgrams (out)</var>. 
<div class="node">
<a name="Variable-mon.av_udp_out"></a>
<a name="Variable-mon_002eav_005fudp_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fudp_005fout">Variable mon.dev_udp_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fudp_005fout">Variable mon.value_udp_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.96 Variable mon.av_udp_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>UDP dgrams (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_udp_out"></a>
<a name="Variable-mon_002edev_005fudp_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fdns_005fin">Variable mon.value_dns_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fudp_005fout">Variable mon.av_udp_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.97 Variable mon.dev_udp_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>UDP dgrams (out)</var>. 
<div class="node">
<a name="Variable-mon.value_dns_in"></a>
<a name="Variable-mon_002evalue_005fdns_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fdns_005fin">Variable mon.av_dns_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fudp_005fout">Variable mon.dev_udp_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.98 Variable mon.value_dns_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>DNS requests (in)</var>. 
<div class="node">
<a name="Variable-mon.av_dns_in"></a>
<a name="Variable-mon_002eav_005fdns_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fdns_005fin">Variable mon.dev_dns_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fdns_005fin">Variable mon.value_dns_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.99 Variable mon.av_dns_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>DNS requests (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_dns_in"></a>
<a name="Variable-mon_002edev_005fdns_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fdns_005fout">Variable mon.value_dns_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fdns_005fin">Variable mon.av_dns_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.100 Variable mon.dev_dns_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>DNS requests (in)</var>. 
<div class="node">
<a name="Variable-mon.value_dns_out"></a>
<a name="Variable-mon_002evalue_005fdns_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fdns_005fout">Variable mon.av_dns_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fdns_005fin">Variable mon.dev_dns_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.101 Variable mon.value_dns_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>DNS requests (out)</var>. 
<div class="node">
<a name="Variable-mon.av_dns_out"></a>
<a name="Variable-mon_002eav_005fdns_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fdns_005fout">Variable mon.dev_dns_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fdns_005fout">Variable mon.value_dns_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.102 Variable mon.av_dns_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>DNS requests (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_dns_out"></a>
<a name="Variable-mon_002edev_005fdns_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005ftcpsyn_005fin">Variable mon.value_tcpsyn_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fdns_005fout">Variable mon.av_dns_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.103 Variable mon.dev_dns_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>DNS requests (out)</var>. 
<div class="node">
<a name="Variable-mon.value_tcpsyn_in"></a>
<a name="Variable-mon_002evalue_005ftcpsyn_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005ftcpsyn_005fin">Variable mon.av_tcpsyn_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fdns_005fout">Variable mon.dev_dns_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.104 Variable mon.value_tcpsyn_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>TCP sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.av_tcpsyn_in"></a>
<a name="Variable-mon_002eav_005ftcpsyn_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005ftcpsyn_005fin">Variable mon.dev_tcpsyn_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005ftcpsyn_005fin">Variable mon.value_tcpsyn_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.105 Variable mon.av_tcpsyn_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>TCP sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_tcpsyn_in"></a>
<a name="Variable-mon_002edev_005ftcpsyn_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005ftcpsyn_005fout">Variable mon.value_tcpsyn_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005ftcpsyn_005fin">Variable mon.av_tcpsyn_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.106 Variable mon.dev_tcpsyn_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>TCP sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.value_tcpsyn_out"></a>
<a name="Variable-mon_002evalue_005ftcpsyn_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005ftcpsyn_005fout">Variable mon.av_tcpsyn_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005ftcpsyn_005fin">Variable mon.dev_tcpsyn_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.107 Variable mon.value_tcpsyn_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>TCP sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.av_tcpsyn_out"></a>
<a name="Variable-mon_002eav_005ftcpsyn_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005ftcpsyn_005fout">Variable mon.dev_tcpsyn_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005ftcpsyn_005fout">Variable mon.value_tcpsyn_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.108 Variable mon.av_tcpsyn_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>TCP sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_tcpsyn_out"></a>
<a name="Variable-mon_002edev_005ftcpsyn_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005ftcpack_005fin">Variable mon.value_tcpack_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005ftcpsyn_005fout">Variable mon.av_tcpsyn_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.109 Variable mon.dev_tcpsyn_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>TCP sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.value_tcpack_in"></a>
<a name="Variable-mon_002evalue_005ftcpack_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005ftcpack_005fin">Variable mon.av_tcpack_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005ftcpsyn_005fout">Variable mon.dev_tcpsyn_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.110 Variable mon.value_tcpack_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>TCP acks (in)</var>. 
<div class="node">
<a name="Variable-mon.av_tcpack_in"></a>
<a name="Variable-mon_002eav_005ftcpack_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005ftcpack_005fin">Variable mon.dev_tcpack_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005ftcpack_005fin">Variable mon.value_tcpack_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.111 Variable mon.av_tcpack_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>TCP acks (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_tcpack_in"></a>
<a name="Variable-mon_002edev_005ftcpack_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005ftcpack_005fout">Variable mon.value_tcpack_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005ftcpack_005fin">Variable mon.av_tcpack_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.112 Variable mon.dev_tcpack_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>TCP acks (in)</var>. 
<div class="node">
<a name="Variable-mon.value_tcpack_out"></a>
<a name="Variable-mon_002evalue_005ftcpack_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005ftcpack_005fout">Variable mon.av_tcpack_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005ftcpack_005fin">Variable mon.dev_tcpack_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.113 Variable mon.value_tcpack_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>TCP acks (out)</var>. 
<div class="node">
<a name="Variable-mon.av_tcpack_out"></a>
<a name="Variable-mon_002eav_005ftcpack_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005ftcpack_005fout">Variable mon.dev_tcpack_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005ftcpack_005fout">Variable mon.value_tcpack_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.114 Variable mon.av_tcpack_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>TCP acks (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_tcpack_out"></a>
<a name="Variable-mon_002edev_005ftcpack_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005ftcpfin_005fin">Variable mon.value_tcpfin_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005ftcpack_005fout">Variable mon.av_tcpack_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.115 Variable mon.dev_tcpack_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>TCP acks (out)</var>. 
<div class="node">
<a name="Variable-mon.value_tcpfin_in"></a>
<a name="Variable-mon_002evalue_005ftcpfin_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005ftcpfin_005fin">Variable mon.av_tcpfin_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005ftcpack_005fout">Variable mon.dev_tcpack_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.116 Variable mon.value_tcpfin_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>TCP finish (in)</var>. 
<div class="node">
<a name="Variable-mon.av_tcpfin_in"></a>
<a name="Variable-mon_002eav_005ftcpfin_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005ftcpfin_005fin">Variable mon.dev_tcpfin_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005ftcpfin_005fin">Variable mon.value_tcpfin_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.117 Variable mon.av_tcpfin_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>TCP finish (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_tcpfin_in"></a>
<a name="Variable-mon_002edev_005ftcpfin_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005ftcpfin_005fout">Variable mon.value_tcpfin_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005ftcpfin_005fin">Variable mon.av_tcpfin_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.118 Variable mon.dev_tcpfin_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>TCP finish (in)</var>. 
<div class="node">
<a name="Variable-mon.value_tcpfin_out"></a>
<a name="Variable-mon_002evalue_005ftcpfin_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005ftcpfin_005fout">Variable mon.av_tcpfin_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005ftcpfin_005fin">Variable mon.dev_tcpfin_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.119 Variable mon.value_tcpfin_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>TCP finish (out)</var>. 
<div class="node">
<a name="Variable-mon.av_tcpfin_out"></a>
<a name="Variable-mon_002eav_005ftcpfin_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005ftcpfin_005fout">Variable mon.dev_tcpfin_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005ftcpfin_005fout">Variable mon.value_tcpfin_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.120 Variable mon.av_tcpfin_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>TCP finish (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_tcpfin_out"></a>
<a name="Variable-mon_002edev_005ftcpfin_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005ftcpmisc_005fin">Variable mon.value_tcpmisc_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005ftcpfin_005fout">Variable mon.av_tcpfin_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.121 Variable mon.dev_tcpfin_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>TCP finish (out)</var>. 
<div class="node">
<a name="Variable-mon.value_tcpmisc_in"></a>
<a name="Variable-mon_002evalue_005ftcpmisc_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005ftcpmisc_005fin">Variable mon.av_tcpmisc_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005ftcpfin_005fout">Variable mon.dev_tcpfin_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.122 Variable mon.value_tcpmisc_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>TCP misc (in)</var>. 
<div class="node">
<a name="Variable-mon.av_tcpmisc_in"></a>
<a name="Variable-mon_002eav_005ftcpmisc_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005ftcpmisc_005fin">Variable mon.dev_tcpmisc_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005ftcpmisc_005fin">Variable mon.value_tcpmisc_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.123 Variable mon.av_tcpmisc_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>TCP misc (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_tcpmisc_in"></a>
<a name="Variable-mon_002edev_005ftcpmisc_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005ftcpmisc_005fout">Variable mon.value_tcpmisc_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005ftcpmisc_005fin">Variable mon.av_tcpmisc_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.124 Variable mon.dev_tcpmisc_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>TCP misc (in)</var>. 
<div class="node">
<a name="Variable-mon.value_tcpmisc_out"></a>
<a name="Variable-mon_002evalue_005ftcpmisc_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005ftcpmisc_005fout">Variable mon.av_tcpmisc_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005ftcpmisc_005fin">Variable mon.dev_tcpmisc_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.125 Variable mon.value_tcpmisc_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>TCP misc (out)</var>. 
<div class="node">
<a name="Variable-mon.av_tcpmisc_out"></a>
<a name="Variable-mon_002eav_005ftcpmisc_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005ftcpmisc_005fout">Variable mon.dev_tcpmisc_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005ftcpmisc_005fout">Variable mon.value_tcpmisc_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.126 Variable mon.av_tcpmisc_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>TCP misc (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_tcpmisc_out"></a>
<a name="Variable-mon_002edev_005ftcpmisc_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fwebaccess">Variable mon.value_webaccess</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005ftcpmisc_005fout">Variable mon.av_tcpmisc_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.127 Variable mon.dev_tcpmisc_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>TCP misc (out)</var>. 
<div class="node">
<a name="Variable-mon.value_webaccess"></a>
<a name="Variable-mon_002evalue_005fwebaccess"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fwebaccess">Variable mon.av_webaccess</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005ftcpmisc_005fout">Variable mon.dev_tcpmisc_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.128 Variable mon.value_webaccess</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Webserver hits</var>. 
<div class="node">
<a name="Variable-mon.av_webaccess"></a>
<a name="Variable-mon_002eav_005fwebaccess"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fwebaccess">Variable mon.dev_webaccess</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fwebaccess">Variable mon.value_webaccess</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.129 Variable mon.av_webaccess</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Webserver hits</var>. 
<div class="node">
<a name="Variable-mon.dev_webaccess"></a>
<a name="Variable-mon_002edev_005fwebaccess"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fweberrors">Variable mon.value_weberrors</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fwebaccess">Variable mon.av_webaccess</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.130 Variable mon.dev_webaccess</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Webserver hits</var>. 
<div class="node">
<a name="Variable-mon.value_weberrors"></a>
<a name="Variable-mon_002evalue_005fweberrors"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fweberrors">Variable mon.av_weberrors</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fwebaccess">Variable mon.dev_webaccess</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.131 Variable mon.value_weberrors</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Webserver errors</var>. 
<div class="node">
<a name="Variable-mon.av_weberrors"></a>
<a name="Variable-mon_002eav_005fweberrors"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fweberrors">Variable mon.dev_weberrors</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fweberrors">Variable mon.value_weberrors</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.132 Variable mon.av_weberrors</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Webserver errors</var>. 
<div class="node">
<a name="Variable-mon.dev_weberrors"></a>
<a name="Variable-mon_002edev_005fweberrors"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fsyslog">Variable mon.value_syslog</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fweberrors">Variable mon.av_weberrors</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.133 Variable mon.dev_weberrors</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Webserver errors</var>. 
<div class="node">
<a name="Variable-mon.value_syslog"></a>
<a name="Variable-mon_002evalue_005fsyslog"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fsyslog">Variable mon.av_syslog</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fweberrors">Variable mon.dev_weberrors</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.134 Variable mon.value_syslog</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>New log entries (Syslog)</var>. 
<div class="node">
<a name="Variable-mon.av_syslog"></a>
<a name="Variable-mon_002eav_005fsyslog"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fsyslog">Variable mon.dev_syslog</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fsyslog">Variable mon.value_syslog</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.135 Variable mon.av_syslog</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>New log entries (Syslog)</var>. 
<div class="node">
<a name="Variable-mon.dev_syslog"></a>
<a name="Variable-mon_002edev_005fsyslog"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fmessages">Variable mon.value_messages</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fsyslog">Variable mon.av_syslog</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.136 Variable mon.dev_syslog</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>New log entries (Syslog)</var>. 
<div class="node">
<a name="Variable-mon.value_messages"></a>
<a name="Variable-mon_002evalue_005fmessages"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fmessages">Variable mon.av_messages</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fsyslog">Variable mon.dev_syslog</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.137 Variable mon.value_messages</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>New log entries (messages)</var>. 
<div class="node">
<a name="Variable-mon.av_messages"></a>
<a name="Variable-mon_002eav_005fmessages"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fmessages">Variable mon.dev_messages</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fmessages">Variable mon.value_messages</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.138 Variable mon.av_messages</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>New log entries (messages)</var>. 
<div class="node">
<a name="Variable-mon.dev_messages"></a>
<a name="Variable-mon_002edev_005fmessages"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005ftemp0">Variable mon.value_temp0</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fmessages">Variable mon.av_messages</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.139 Variable mon.dev_messages</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>New log entries (messages)</var>. 
<div class="node">
<a name="Variable-mon.value_temp0"></a>
<a name="Variable-mon_002evalue_005ftemp0"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005ftemp0">Variable mon.av_temp0</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fmessages">Variable mon.dev_messages</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.140 Variable mon.value_temp0</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>CPU Temperature 0</var>. 
<div class="node">
<a name="Variable-mon.av_temp0"></a>
<a name="Variable-mon_002eav_005ftemp0"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005ftemp0">Variable mon.dev_temp0</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005ftemp0">Variable mon.value_temp0</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.141 Variable mon.av_temp0</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>CPU Temperature 0</var>. 
<div class="node">
<a name="Variable-mon.dev_temp0"></a>
<a name="Variable-mon_002edev_005ftemp0"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005ftemp1">Variable mon.value_temp1</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005ftemp0">Variable mon.av_temp0</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.142 Variable mon.dev_temp0</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>CPU Temperature 0</var>. 
<div class="node">
<a name="Variable-mon.value_temp1"></a>
<a name="Variable-mon_002evalue_005ftemp1"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005ftemp1">Variable mon.av_temp1</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005ftemp0">Variable mon.dev_temp0</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.143 Variable mon.value_temp1</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>CPU Temperature 1</var>. 
<div class="node">
<a name="Variable-mon.av_temp1"></a>
<a name="Variable-mon_002eav_005ftemp1"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005ftemp1">Variable mon.dev_temp1</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005ftemp1">Variable mon.value_temp1</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.144 Variable mon.av_temp1</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>CPU Temperature 1</var>. 
<div class="node">
<a name="Variable-mon.dev_temp1"></a>
<a name="Variable-mon_002edev_005ftemp1"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005ftemp2">Variable mon.value_temp2</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005ftemp1">Variable mon.av_temp1</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.145 Variable mon.dev_temp1</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>CPU Temperature 1</var>. 
<div class="node">
<a name="Variable-mon.value_temp2"></a>
<a name="Variable-mon_002evalue_005ftemp2"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005ftemp2">Variable mon.av_temp2</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005ftemp1">Variable mon.dev_temp1</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.146 Variable mon.value_temp2</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>CPU Temperature 2</var>. 
<div class="node">
<a name="Variable-mon.av_temp2"></a>
<a name="Variable-mon_002eav_005ftemp2"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005ftemp2">Variable mon.dev_temp2</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005ftemp2">Variable mon.value_temp2</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.147 Variable mon.av_temp2</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>CPU Temperature 2</var>. 
<div class="node">
<a name="Variable-mon.dev_temp2"></a>
<a name="Variable-mon_002edev_005ftemp2"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005ftemp3">Variable mon.value_temp3</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005ftemp2">Variable mon.av_temp2</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.148 Variable mon.dev_temp2</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>CPU Temperature 2</var>. 
<div class="node">
<a name="Variable-mon.value_temp3"></a>
<a name="Variable-mon_002evalue_005ftemp3"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005ftemp3">Variable mon.av_temp3</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005ftemp2">Variable mon.dev_temp2</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.149 Variable mon.value_temp3</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>CPU Temperature 3</var>. 
<div class="node">
<a name="Variable-mon.av_temp3"></a>
<a name="Variable-mon_002eav_005ftemp3"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005ftemp3">Variable mon.dev_temp3</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005ftemp3">Variable mon.value_temp3</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.150 Variable mon.av_temp3</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>CPU Temperature 3</var>. 
<div class="node">
<a name="Variable-mon.dev_temp3"></a>
<a name="Variable-mon_002edev_005ftemp3"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fcpu">Variable mon.value_cpu</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005ftemp3">Variable mon.av_temp3</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.151 Variable mon.dev_temp3</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>CPU Temperature 3</var>. 
<div class="node">
<a name="Variable-mon.value_cpu"></a>
<a name="Variable-mon_002evalue_005fcpu"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fcpu">Variable mon.av_cpu</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005ftemp3">Variable mon.dev_temp3</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.152 Variable mon.value_cpu</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>%CPU utilization (all)</var>. 
<div class="node">
<a name="Variable-mon.av_cpu"></a>
<a name="Variable-mon_002eav_005fcpu"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fcpu">Variable mon.dev_cpu</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fcpu">Variable mon.value_cpu</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.153 Variable mon.av_cpu</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>%CPU utilization (all)</var>. 
<div class="node">
<a name="Variable-mon.dev_cpu"></a>
<a name="Variable-mon_002edev_005fcpu"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fcpu0">Variable mon.value_cpu0</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fcpu">Variable mon.av_cpu</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.154 Variable mon.dev_cpu</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>%CPU utilization (all)</var>. 
<div class="node">
<a name="Variable-mon.value_cpu0"></a>
<a name="Variable-mon_002evalue_005fcpu0"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fcpu0">Variable mon.av_cpu0</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fcpu">Variable mon.dev_cpu</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.155 Variable mon.value_cpu0</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>%CPU utilization 0</var>. 
<div class="node">
<a name="Variable-mon.av_cpu0"></a>
<a name="Variable-mon_002eav_005fcpu0"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fcpu0">Variable mon.dev_cpu0</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fcpu0">Variable mon.value_cpu0</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.156 Variable mon.av_cpu0</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>%CPU utilization 0</var>. 
<div class="node">
<a name="Variable-mon.dev_cpu0"></a>
<a name="Variable-mon_002edev_005fcpu0"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fcpu1">Variable mon.value_cpu1</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fcpu0">Variable mon.av_cpu0</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.157 Variable mon.dev_cpu0</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>%CPU utilization 0</var>. 
<div class="node">
<a name="Variable-mon.value_cpu1"></a>
<a name="Variable-mon_002evalue_005fcpu1"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fcpu1">Variable mon.av_cpu1</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fcpu0">Variable mon.dev_cpu0</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.158 Variable mon.value_cpu1</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>%CPU utilization 1</var>. 
<div class="node">
<a name="Variable-mon.av_cpu1"></a>
<a name="Variable-mon_002eav_005fcpu1"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fcpu1">Variable mon.dev_cpu1</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fcpu1">Variable mon.value_cpu1</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.159 Variable mon.av_cpu1</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>%CPU utilization 1</var>. 
<div class="node">
<a name="Variable-mon.dev_cpu1"></a>
<a name="Variable-mon_002edev_005fcpu1"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fcpu2">Variable mon.value_cpu2</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fcpu1">Variable mon.av_cpu1</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.160 Variable mon.dev_cpu1</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>%CPU utilization 1</var>. 
<div class="node">
<a name="Variable-mon.value_cpu2"></a>
<a name="Variable-mon_002evalue_005fcpu2"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fcpu2">Variable mon.av_cpu2</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fcpu1">Variable mon.dev_cpu1</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.161 Variable mon.value_cpu2</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>%CPU utilization 2</var>. 
<div class="node">
<a name="Variable-mon.av_cpu2"></a>
<a name="Variable-mon_002eav_005fcpu2"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fcpu2">Variable mon.dev_cpu2</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fcpu2">Variable mon.value_cpu2</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.162 Variable mon.av_cpu2</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>%CPU utilization 2</var>. 
<div class="node">
<a name="Variable-mon.dev_cpu2"></a>
<a name="Variable-mon_002edev_005fcpu2"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fcpu3">Variable mon.value_cpu3</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fcpu2">Variable mon.av_cpu2</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.163 Variable mon.dev_cpu2</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>%CPU utilization 2</var>. 
<div class="node">
<a name="Variable-mon.value_cpu3"></a>
<a name="Variable-mon_002evalue_005fcpu3"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fcpu3">Variable mon.av_cpu3</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fcpu2">Variable mon.dev_cpu2</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.164 Variable mon.value_cpu3</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>%CPU utilization 3</var>. 
<div class="node">
<a name="Variable-mon.av_cpu3"></a>
<a name="Variable-mon_002eav_005fcpu3"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fcpu3">Variable mon.dev_cpu3</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fcpu3">Variable mon.value_cpu3</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.165 Variable mon.av_cpu3</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>%CPU utilization 3</var>. 
<div class="node">
<a name="Variable-mon.dev_cpu3"></a>
<a name="Variable-mon_002edev_005fcpu3"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fmicrosoft_005fds_005fin">Variable mon.value_microsoft_ds_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fcpu3">Variable mon.av_cpu3</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.166 Variable mon.dev_cpu3</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>%CPU utilization 3</var>. 
<div class="node">
<a name="Variable-mon.value_microsoft_ds_in"></a>
<a name="Variable-mon_002evalue_005fmicrosoft_005fds_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fmicrosoft_005fds_005fin">Variable mon.av_microsoft_ds_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fcpu3">Variable mon.dev_cpu3</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.167 Variable mon.value_microsoft_ds_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Samba/MS_ds name sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.av_microsoft_ds_in"></a>
<a name="Variable-mon_002eav_005fmicrosoft_005fds_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fmicrosoft_005fds_005fin">Variable mon.dev_microsoft_ds_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fmicrosoft_005fds_005fin">Variable mon.value_microsoft_ds_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.168 Variable mon.av_microsoft_ds_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Samba/MS_ds name sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_microsoft_ds_in"></a>
<a name="Variable-mon_002edev_005fmicrosoft_005fds_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fmicrosoft_005fds_005fout">Variable mon.value_microsoft_ds_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fmicrosoft_005fds_005fin">Variable mon.av_microsoft_ds_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.169 Variable mon.dev_microsoft_ds_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Samba/MS_ds name sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.value_microsoft_ds_out"></a>
<a name="Variable-mon_002evalue_005fmicrosoft_005fds_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fmicrosoft_005fds_005fout">Variable mon.av_microsoft_ds_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fmicrosoft_005fds_005fin">Variable mon.dev_microsoft_ds_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.170 Variable mon.value_microsoft_ds_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Samba/MS_ds name sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.av_microsoft_ds_out"></a>
<a name="Variable-mon_002eav_005fmicrosoft_005fds_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fmicrosoft_005fds_005fout">Variable mon.dev_microsoft_ds_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fmicrosoft_005fds_005fout">Variable mon.value_microsoft_ds_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.171 Variable mon.av_microsoft_ds_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Samba/MS_ds name sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_microsoft_ds_out"></a>
<a name="Variable-mon_002edev_005fmicrosoft_005fds_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fwww_005falt_005fin">Variable mon.value_www_alt_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fmicrosoft_005fds_005fout">Variable mon.av_microsoft_ds_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.172 Variable mon.dev_microsoft_ds_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Samba/MS_ds name sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.value_www_alt_in"></a>
<a name="Variable-mon_002evalue_005fwww_005falt_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fwww_005falt_005fin">Variable mon.av_www_alt_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fmicrosoft_005fds_005fout">Variable mon.dev_microsoft_ds_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.173 Variable mon.value_www_alt_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Alternative web service connections (in)</var>. 
<div class="node">
<a name="Variable-mon.av_www_alt_in"></a>
<a name="Variable-mon_002eav_005fwww_005falt_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fwww_005falt_005fin">Variable mon.dev_www_alt_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fwww_005falt_005fin">Variable mon.value_www_alt_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.174 Variable mon.av_www_alt_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Alternative web service connections (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_www_alt_in"></a>
<a name="Variable-mon_002edev_005fwww_005falt_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fwww_005falt_005fout">Variable mon.value_www_alt_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fwww_005falt_005fin">Variable mon.av_www_alt_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.175 Variable mon.dev_www_alt_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Alternative web service connections (in)</var>. 
<div class="node">
<a name="Variable-mon.value_www_alt_out"></a>
<a name="Variable-mon_002evalue_005fwww_005falt_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fwww_005falt_005fout">Variable mon.av_www_alt_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fwww_005falt_005fin">Variable mon.dev_www_alt_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.176 Variable mon.value_www_alt_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Alternative web client connections (out)</var>. 
<div class="node">
<a name="Variable-mon.av_www_alt_out"></a>
<a name="Variable-mon_002eav_005fwww_005falt_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fwww_005falt_005fout">Variable mon.dev_www_alt_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fwww_005falt_005fout">Variable mon.value_www_alt_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.177 Variable mon.av_www_alt_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Alternative web client connections (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_www_alt_out"></a>
<a name="Variable-mon_002edev_005fwww_005falt_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fimaps_005fin">Variable mon.value_imaps_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fwww_005falt_005fout">Variable mon.av_www_alt_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.178 Variable mon.dev_www_alt_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Alternative web client connections (out)</var>. 
<div class="node">
<a name="Variable-mon.value_imaps_in"></a>
<a name="Variable-mon_002evalue_005fimaps_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fimaps_005fin">Variable mon.av_imaps_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fwww_005falt_005fout">Variable mon.dev_www_alt_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.179 Variable mon.value_imaps_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>encrypted imap mail service sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.av_imaps_in"></a>
<a name="Variable-mon_002eav_005fimaps_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fimaps_005fin">Variable mon.dev_imaps_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fimaps_005fin">Variable mon.value_imaps_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.180 Variable mon.av_imaps_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>encrypted imap mail service sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_imaps_in"></a>
<a name="Variable-mon_002edev_005fimaps_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fimaps_005fout">Variable mon.value_imaps_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fimaps_005fin">Variable mon.av_imaps_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.181 Variable mon.dev_imaps_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>encrypted imap mail service sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.value_imaps_out"></a>
<a name="Variable-mon_002evalue_005fimaps_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fimaps_005fout">Variable mon.av_imaps_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fimaps_005fin">Variable mon.dev_imaps_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.182 Variable mon.value_imaps_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>encrypted imap mail client sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.av_imaps_out"></a>
<a name="Variable-mon_002eav_005fimaps_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fimaps_005fout">Variable mon.dev_imaps_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fimaps_005fout">Variable mon.value_imaps_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.183 Variable mon.av_imaps_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>encrypted imap mail client sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_imaps_out"></a>
<a name="Variable-mon_002edev_005fimaps_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fldap_005fin">Variable mon.value_ldap_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fimaps_005fout">Variable mon.av_imaps_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.184 Variable mon.dev_imaps_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>encrypted imap mail client sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.value_ldap_in"></a>
<a name="Variable-mon_002evalue_005fldap_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fldap_005fin">Variable mon.av_ldap_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fimaps_005fout">Variable mon.dev_imaps_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.185 Variable mon.value_ldap_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>LDAP directory service service sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.av_ldap_in"></a>
<a name="Variable-mon_002eav_005fldap_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fldap_005fin">Variable mon.dev_ldap_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fldap_005fin">Variable mon.value_ldap_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.186 Variable mon.av_ldap_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>LDAP directory service service sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_ldap_in"></a>
<a name="Variable-mon_002edev_005fldap_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fldap_005fout">Variable mon.value_ldap_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fldap_005fin">Variable mon.av_ldap_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.187 Variable mon.dev_ldap_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>LDAP directory service service sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.value_ldap_out"></a>
<a name="Variable-mon_002evalue_005fldap_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fldap_005fout">Variable mon.av_ldap_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fldap_005fin">Variable mon.dev_ldap_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.188 Variable mon.value_ldap_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>LDAP directory service client sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.av_ldap_out"></a>
<a name="Variable-mon_002eav_005fldap_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fldap_005fout">Variable mon.dev_ldap_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fldap_005fout">Variable mon.value_ldap_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.189 Variable mon.av_ldap_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>LDAP directory service client sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_ldap_out"></a>
<a name="Variable-mon_002edev_005fldap_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fldaps_005fin">Variable mon.value_ldaps_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fldap_005fout">Variable mon.av_ldap_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.190 Variable mon.dev_ldap_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>LDAP directory service client sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.value_ldaps_in"></a>
<a name="Variable-mon_002evalue_005fldaps_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fldaps_005fin">Variable mon.av_ldaps_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fldap_005fout">Variable mon.dev_ldap_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.191 Variable mon.value_ldaps_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>LDAP directory service service sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.av_ldaps_in"></a>
<a name="Variable-mon_002eav_005fldaps_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fldaps_005fin">Variable mon.dev_ldaps_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fldaps_005fin">Variable mon.value_ldaps_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.192 Variable mon.av_ldaps_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>LDAP directory service service sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_ldaps_in"></a>
<a name="Variable-mon_002edev_005fldaps_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fldaps_005fout">Variable mon.value_ldaps_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fldaps_005fin">Variable mon.av_ldaps_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.193 Variable mon.dev_ldaps_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>LDAP directory service service sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.value_ldaps_out"></a>
<a name="Variable-mon_002evalue_005fldaps_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fldaps_005fout">Variable mon.av_ldaps_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fldaps_005fin">Variable mon.dev_ldaps_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.194 Variable mon.value_ldaps_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>LDAP directory service client sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.av_ldaps_out"></a>
<a name="Variable-mon_002eav_005fldaps_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fldaps_005fout">Variable mon.dev_ldaps_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fldaps_005fout">Variable mon.value_ldaps_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.195 Variable mon.av_ldaps_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>LDAP directory service client sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_ldaps_out"></a>
<a name="Variable-mon_002edev_005fldaps_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fmongo_005fin">Variable mon.value_mongo_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fldaps_005fout">Variable mon.av_ldaps_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.196 Variable mon.dev_ldaps_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>LDAP directory service client sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.value_mongo_in"></a>
<a name="Variable-mon_002evalue_005fmongo_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fmongo_005fin">Variable mon.av_mongo_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fldaps_005fout">Variable mon.dev_ldaps_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.197 Variable mon.value_mongo_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Mongo database service sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.av_mongo_in"></a>
<a name="Variable-mon_002eav_005fmongo_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fmongo_005fin">Variable mon.dev_mongo_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fmongo_005fin">Variable mon.value_mongo_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.198 Variable mon.av_mongo_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Mongo database service sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_mongo_in"></a>
<a name="Variable-mon_002edev_005fmongo_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fmongo_005fout">Variable mon.value_mongo_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fmongo_005fin">Variable mon.av_mongo_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.199 Variable mon.dev_mongo_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Mongo database service sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.value_mongo_out"></a>
<a name="Variable-mon_002evalue_005fmongo_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fmongo_005fout">Variable mon.av_mongo_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fmongo_005fin">Variable mon.dev_mongo_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.200 Variable mon.value_mongo_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Mongo database client sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.av_mongo_out"></a>
<a name="Variable-mon_002eav_005fmongo_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fmongo_005fout">Variable mon.dev_mongo_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fmongo_005fout">Variable mon.value_mongo_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.201 Variable mon.av_mongo_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Mongo database client sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_mongo_out"></a>
<a name="Variable-mon_002edev_005fmongo_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fmysql_005fin">Variable mon.value_mysql_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fmongo_005fout">Variable mon.av_mongo_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.202 Variable mon.dev_mongo_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Mongo database client sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.value_mysql_in"></a>
<a name="Variable-mon_002evalue_005fmysql_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fmysql_005fin">Variable mon.av_mysql_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fmongo_005fout">Variable mon.dev_mongo_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.203 Variable mon.value_mysql_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>MySQL database service sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.av_mysql_in"></a>
<a name="Variable-mon_002eav_005fmysql_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fmysql_005fin">Variable mon.dev_mysql_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fmysql_005fin">Variable mon.value_mysql_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.204 Variable mon.av_mysql_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>MySQL database service sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_mysql_in"></a>
<a name="Variable-mon_002edev_005fmysql_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fmysql_005fout">Variable mon.value_mysql_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fmysql_005fin">Variable mon.av_mysql_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.205 Variable mon.dev_mysql_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>MySQL database service sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.value_mysql_out"></a>
<a name="Variable-mon_002evalue_005fmysql_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fmysql_005fout">Variable mon.av_mysql_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fmysql_005fin">Variable mon.dev_mysql_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.206 Variable mon.value_mysql_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>MySQL database client sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.av_mysql_out"></a>
<a name="Variable-mon_002eav_005fmysql_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fmysql_005fout">Variable mon.dev_mysql_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fmysql_005fout">Variable mon.value_mysql_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.207 Variable mon.av_mysql_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>MySQL database client sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_mysql_out"></a>
<a name="Variable-mon_002edev_005fmysql_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fpostgres_005fin">Variable mon.value_postgres_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fmysql_005fout">Variable mon.av_mysql_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.208 Variable mon.dev_mysql_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>MySQL database client sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.value_postgres_in"></a>
<a name="Variable-mon_002evalue_005fpostgres_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fpostgres_005fin">Variable mon.av_postgres_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fmysql_005fout">Variable mon.dev_mysql_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.209 Variable mon.value_postgres_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>PostgreSQL database service sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.av_postgres_in"></a>
<a name="Variable-mon_002eav_005fpostgres_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fpostgres_005fin">Variable mon.dev_postgres_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fpostgres_005fin">Variable mon.value_postgres_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.210 Variable mon.av_postgres_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>PostgreSQL database service sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_postgres_in"></a>
<a name="Variable-mon_002edev_005fpostgres_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fpostgres_005fout">Variable mon.value_postgres_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fpostgres_005fin">Variable mon.av_postgres_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.211 Variable mon.dev_postgres_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>PostgreSQL database service sessions (in)</var>. 
<div class="node">
<a name="Variable-mon.value_postgres_out"></a>
<a name="Variable-mon_002evalue_005fpostgres_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fpostgres_005fout">Variable mon.av_postgres_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fpostgres_005fin">Variable mon.dev_postgres_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.212 Variable mon.value_postgres_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>PostgreSQL database client sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.av_postgres_out"></a>
<a name="Variable-mon_002eav_005fpostgres_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fpostgres_005fout">Variable mon.dev_postgres_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fpostgres_005fout">Variable mon.value_postgres_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.213 Variable mon.av_postgres_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>PostgreSQL database client sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_postgres_out"></a>
<a name="Variable-mon_002edev_005fpostgres_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fipp_005fin">Variable mon.value_ipp_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fpostgres_005fout">Variable mon.av_postgres_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.214 Variable mon.dev_postgres_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>PostgreSQL database client sessions (out)</var>. 
<div class="node">
<a name="Variable-mon.value_ipp_in"></a>
<a name="Variable-mon_002evalue_005fipp_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fipp_005fin">Variable mon.av_ipp_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fpostgres_005fout">Variable mon.dev_postgres_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.215 Variable mon.value_ipp_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Internet Printer Protocol (in)</var>. 
<div class="node">
<a name="Variable-mon.av_ipp_in"></a>
<a name="Variable-mon_002eav_005fipp_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fipp_005fin">Variable mon.dev_ipp_in</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fipp_005fin">Variable mon.value_ipp_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.216 Variable mon.av_ipp_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Internet Printer Protocol (in)</var>. 
<div class="node">
<a name="Variable-mon.dev_ipp_in"></a>
<a name="Variable-mon_002edev_005fipp_005fin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002evalue_005fipp_005fout">Variable mon.value_ipp_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fipp_005fin">Variable mon.av_ipp_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.217 Variable mon.dev_ipp_in</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Internet Printer Protocol (in)</var>. 
<div class="node">
<a name="Variable-mon.value_ipp_out"></a>
<a name="Variable-mon_002evalue_005fipp_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002eav_005fipp_005fout">Variable mon.av_ipp_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002edev_005fipp_005fin">Variable mon.dev_ipp_in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.218 Variable mon.value_ipp_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Internet Printer Protocol (out)</var>. 
<div class="node">
<a name="Variable-mon.av_ipp_out"></a>
<a name="Variable-mon_002eav_005fipp_005fout"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-mon_002edev_005fipp_005fout">Variable mon.dev_ipp_out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002evalue_005fipp_005fout">Variable mon.value_ipp_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.219 Variable mon.av_ipp_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Internet Printer Protocol (out)</var>. 
<div class="node">
<a name="Variable-mon.dev_ipp_out"></a>
<a name="Variable-mon_002edev_005fipp_005fout"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-mon_002eav_005fipp_005fout">Variable mon.av_ipp_out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-mon">Variable context mon</a>

</div>

<h4 class="subsection">12.4.220 Variable mon.dev_ipp_out</h4>

<p>Observational measure collected every 2.5 minutes from cf-monitord, description: <var>Internet Printer Protocol (out)</var>.

<div class="node">
<a name="Variable-context-sys"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-context-this">Variable context this</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-context-mon">Variable context mon</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-Variables">Special Variables</a>

</div>

<h3 class="section">12.5 Variable context <code>sys</code></h3>

<p><br>

   <p>System variables are derived from CFEngine's automated discovery of system values. 
They are provided as variables in order to make automatically adaptive rules for
configuration, e.g.

<pre class="verbatim">
files:

 any::

  "$(sys.resolv)"

      create        => "true",
      edit_line     => doresolv("@(this.list1)","@(this.list2)"),
      edit_defaults => reconstruct;

</pre>

<p class="noindent">The above rule requires no class specification because the
variable itself is class-specific.

<ul class="menu">
<li><a accesskey="1" href="#Variable-sys_002earch">Variable sys.arch</a>
<li><a accesskey="2" href="#Variable-sys_002ecdate">Variable sys.cdate</a>
<li><a accesskey="3" href="#Variable-sys_002ecf_005fversion">Variable sys.cf_version</a>
<li><a accesskey="4" href="#Variable-sys_002eclass">Variable sys.class</a>
<li><a accesskey="5" href="#Variable-sys_002ecpus">Variable sys.cpus</a>
<li><a accesskey="6" href="#Variable-sys_002ecrontab">Variable sys.crontab</a>
<li><a accesskey="7" href="#Variable-sys_002edate">Variable sys.date</a>
<li><a accesskey="8" href="#Variable-sys_002edoc_005froot">Variable sys.doc_root</a>
<li><a accesskey="9" href="#Variable-sys_002edomain">Variable sys.domain</a>
<li><a href="#Variable-sys_002eenterprise_005fversion">Variable sys.enterprise_version</a>
<li><a href="#Variable-sys_002eexpires">Variable sys.expires</a>
<li><a href="#Variable-sys_002eexports">Variable sys.exports</a>
<li><a href="#Variable-sys_002eflavor">Variable sys.flavor</a>
<li><a href="#Variable-sys_002eflavour">Variable sys.flavour</a>
<li><a href="#Variable-sys_002efqhost">Variable sys.fqhost</a>
<li><a href="#Variable-sys_002efstab">Variable sys.fstab</a>
<li><a href="#Variable-sys_002ehardware_005faddresses">Variable sys.hardware_addresses</a>
<li><a href="#Variable-sys_002ehardware_005fmac_005binterface_005fname_005d">Variable sys.hardware_mac[interface_name]</a>
<li><a href="#Variable-sys_002ehost">Variable sys.host</a>
<li><a href="#Variable-sys_002einterface">Variable sys.interface</a>
<li><a href="#Variable-sys_002einterfaces">Variable sys.interfaces</a>
<li><a href="#Variable-sys_002eip_005faddresses">Variable sys.ip_addresses</a>
<li><a href="#Variable-sys_002eipv4">Variable sys.ipv4</a>
<li><a href="#Variable-sys_002eipv4_005binterface_005fname_005d">Variable sys.ipv4[interface_name]</a>
<li><a href="#Variable-sys_002eipv4_005f1_005binterface_005fname_005d">Variable sys.ipv4_1[interface_name]</a>
<li><a href="#Variable-sys_002eipv4_005f2_005binterface_005fname_005d">Variable sys.ipv4_2[interface_name]</a>
<li><a href="#Variable-sys_002eipv4_005f3_005binterface_005fname_005d">Variable sys.ipv4_3[interface_name]</a>
<li><a href="#Variable-sys_002elicense_005fowner">Variable sys.license_owner</a>
<li><a href="#Variable-sys_002elicenses_005fgranted">Variable sys.licenses_granted</a>
<li><a href="#Variable-sys_002elicenses_005finstalltime">Variable sys.licenses_installtime</a>
<li><a href="#Variable-sys_002elong_005farch">Variable sys.long_arch</a>
<li><a href="#Variable-sys_002emaildir">Variable sys.maildir</a>
<li><a href="#Variable-sys_002enova_005fversion">Variable sys.nova_version</a>
<li><a href="#Variable-sys_002eos">Variable sys.os</a>
<li><a href="#Variable-sys_002eostype">Variable sys.ostype</a>
<li><a href="#Variable-sys_002epolicy_005fhub">Variable sys.policy_hub</a>
<li><a href="#Variable-sys_002erelease">Variable sys.release</a>
<li><a href="#Variable-sys_002eresolv">Variable sys.resolv</a>
<li><a href="#Variable-sys_002euqhost">Variable sys.uqhost</a>
<li><a href="#Variable-sys_002eversion">Variable sys.version</a>
<li><a href="#Variable-sys_002ewindir">Variable sys.windir</a>
<li><a href="#Variable-sys_002ewinprogdir">Variable sys.winprogdir</a>
<li><a href="#Variable-sys_002ewinprogdir86">Variable sys.winprogdir86</a>
<li><a href="#Variable-sys_002ewinsysdir">Variable sys.winsysdir</a>
<li><a href="#Variable-sys_002eworkdir">Variable sys.workdir</a>
</ul>
<div class="node">
<a name="Variable-sys.arch"></a>
<a name="Variable-sys_002earch"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002ecdate">Variable sys.cdate</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.1 Variable sys.arch</h4>

<p><br>

   <p>The variable gives the kernel's short architecture description.

<pre class="verbatim">
# arch = x86_64

</pre>

<div class="node">
<a name="Variable-sys.cdate"></a>
<a name="Variable-sys_002ecdate"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002ecf_005fversion">Variable sys.cf_version</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002earch">Variable sys.arch</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.2 Variable sys.cdate</h4>

<p><br>

   <p>The date of the system in canonical form, i.e. in the form of a class.

<pre class="verbatim">
# cdate = Sun_Dec__7_10_39_53_2008_

</pre>

<div class="node">
<a name="Variable-sys.cf_version"></a>
<a name="Variable-sys_002ecf_005fversion"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002eclass">Variable sys.class</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002ecdate">Variable sys.cdate</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.3 Variable sys.cf_version</h4>

<p><br>

   <p>The variable gives the version of the running CFEngine Community Edition.

<pre class="verbatim">
# cf_version = 3.0.5 

</pre>

<div class="node">
<a name="Variable-sys.class"></a>
<a name="Variable-sys_002eclass"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002ecpus">Variable sys.cpus</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002ecf_005fversion">Variable sys.cf_version</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.4 Variable sys.class</h4>

<p><br>

   <p>This variable contains the name of the hard-class category for this host, i.e. its
top level operating system type classification.

<pre class="verbatim">
# class = linux

</pre>

<div class="node">
<a name="Variable-sys.cpus"></a>
<a name="Variable-sys_002ecpus"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002ecrontab">Variable sys.crontab</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002eclass">Variable sys.class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.5 Variable sys.cpus</h4>

<p><br>

   <p><i>History</i>: Was introduced in 3.3.0, Nova 2.2.0 (2012)

   <p>A variable containing the number of CPU cores detected on local host, where possible. 
This is currently only guaranteed on Linux 2.6 kernels.
<pre class="verbatim">reports:

 cfengine_3::

   "Number of CPUS = $(sys.cpus)";

</pre>

<div class="node">
<a name="Variable-sys.crontab"></a>
<a name="Variable-sys_002ecrontab"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002edate">Variable sys.date</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002ecpus">Variable sys.cpus</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.6 Variable sys.crontab</h4>

<p><br>

   <p>The variable gives the location of the current users's master crontab directory.

<pre class="verbatim">
# crontab = /var/spool/crontas/root 

</pre>

<div class="node">
<a name="Variable-sys.date"></a>
<a name="Variable-sys_002edate"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002edoc_005froot">Variable sys.doc_root</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002ecrontab">Variable sys.crontab</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.7 Variable sys.date</h4>

<p><br>

   <p>The date of the system as a text string.

<pre class="verbatim">
# date = Sun Dec  7 10:39:53 2008

</pre>

<div class="node">
<a name="Variable-sys.doc_root"></a>
<a name="Variable-sys_002edoc_005froot"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002edomain">Variable sys.domain</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002edate">Variable sys.date</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.8 Variable sys.doc_root</h4>

<p><br>

   <p><i>History</i>: Was introduced in 3.1.0, Nova 2.0.

   <p>A scalar variable containing the default path for the document root of the standard
web server package.

<div class="node">
<a name="Variable-sys.domain"></a>
<a name="Variable-sys_002edomain"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002eenterprise_005fversion">Variable sys.enterprise_version</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002edoc_005froot">Variable sys.doc_root</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.9 Variable sys.domain</h4>

<p><br>

   <p>The domain name as divined by CFEngine. If the DNS is in use, it could
be possible to derive the domain name from its DNS regisration, but in
general there is no way to discover this value automatically. The
<code>common control</code> body permits the ultimate specification of this
value.

<pre class="verbatim">
# domain = example.org
 
</pre>

<div class="node">
<a name="Variable-sys.enterprise_version"></a>
<a name="Variable-sys_002eenterprise_005fversion"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002eexpires">Variable sys.expires</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002edomain">Variable sys.domain</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.10 Variable sys.enterprise_version</h4>

<p><br>

   <p><i>History</i>: Was introduced in 3.5.0, Enterprise 3.0.0

   <p>The variable gives the version of the running CFEngine Enterprise Edition.

<pre class="verbatim">
# enterprise_version = 3.0.0

</pre>

<div class="node">
<a name="Variable-sys.expires"></a>
<a name="Variable-sys_002eexpires"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002eexports">Variable sys.exports</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002eenterprise_005fversion">Variable sys.enterprise_version</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.11 Variable sys.expires</h4>

<p><br>

<pre class="verbatim">reports:

 nova::

  "License expires $(sys.expires)";
</pre>

<div class="node">
<a name="Variable-sys.exports"></a>
<a name="Variable-sys_002eexports"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002eflavor">Variable sys.flavor</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002eexpires">Variable sys.expires</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.12 Variable sys.exports</h4>

<p><br>

   <p>The location of the system NFS exports file.

<pre class="verbatim">
# exports = /etc/exports
# exports = /etc/dfs/dfstab

</pre>

<div class="node">
<a name="Variable-sys.flavor"></a>
<a name="Variable-sys_002eflavor"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002eflavour">Variable sys.flavour</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002eexports">Variable sys.exports</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.13 Variable sys.flavor</h4>

<p><br>

   <p><i>History</i>: Was introduced in 3.2.0, Nova 2.0

   <p>A variable containing an operating system identification string that
is used to determine the current release of the operating system in a
form that can be used as a label in naming.  This is used, for
instance, to detect which package name to choose when updating
software binaries for CFEngine.

   <p>This is a synonym for <code>$(sys.flavour)</code>.

<div class="node">
<a name="Variable-sys.flavour"></a>
<a name="Variable-sys_002eflavour"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002efqhost">Variable sys.fqhost</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002eflavor">Variable sys.flavor</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.14 Variable sys.flavour</h4>

<p><br>

   <p><i>History</i>: Was introduced in 3.2.0, Nova 2.0

   <p>A variable containing an operating system identification string that
is used to determine the current release of the operating system in a
form that can be used as a label in naming.  This is used, for
instance, to detect which package name to choose when updating
software binaries for CFEngine.

   <p>This is a synonym for <code>$(sys.flavor)</code>.

<div class="node">
<a name="Variable-sys.fqhost"></a>
<a name="Variable-sys_002efqhost"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002efstab">Variable sys.fstab</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002eflavour">Variable sys.flavour</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.15 Variable sys.fqhost</h4>

<p><br>

   <p>The fully qualified name of the host. In order to compute this value properly, the domain
name must be defined.

<pre class="verbatim">
# fqhost = host.example.org

</pre>

<div class="node">
<a name="Variable-sys.fstab"></a>
<a name="Variable-sys_002efstab"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002ehardware_005faddresses">Variable sys.hardware_addresses</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002efqhost">Variable sys.fqhost</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.16 Variable sys.fstab</h4>

<p><br>

   <p>The location of the system filesystem (mount) table.

<pre class="verbatim">
# fstab = /etc/fstab

</pre>

<div class="node">
<a name="Variable-sys.hardware_addresses"></a>
<a name="Variable-sys_002ehardware_005faddresses"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002ehardware_005fmac_005binterface_005fname_005d">Variable sys.hardware_mac[interface_name]</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002efstab">Variable sys.fstab</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.17 Variable sys.hardware_addresses</h4>

<p><br>

   <p><i>History</i>: Was introduced in 3.3.0, Nova 2.2.0 (2011)

   <p>This is a list variable containing a list of all known MAC addresses for
system interfaces.

<div class="node">
<a name="Variable-sys.hardware_mac%5binterface_name%5d"></a>
<a name="Variable-sys_002ehardware_005fmac_005binterface_005fname_005d"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002ehost">Variable sys.host</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002ehardware_005faddresses">Variable sys.hardware_addresses</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.18 Variable sys.hardware_mac[interface_name]</h4>

<p><br>

   <p><i>History</i>: Was introduced in 3.3.0, Nova 2.2.0 (2011)

   <p>This contains the MAC address of the named interface. e.g.

<pre class="verbatim">
reports:

  linux::

    "Tell me $(harware_mac[eth0])";
</pre>

<div class="node">
<a name="Variable-sys.host"></a>
<a name="Variable-sys_002ehost"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002einterface">Variable sys.interface</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002ehardware_005fmac_005binterface_005fname_005d">Variable sys.hardware_mac[interface_name]</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.19 Variable sys.host</h4>

<p><br>

   <p>The name of the current host, according to the kernel. It is undefined whether this
is qualified or unqualified with a domain name.

<pre class="verbatim">
# host = myhost

</pre>

<div class="node">
<a name="Variable-sys.interface"></a>
<a name="Variable-sys_002einterface"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002einterfaces">Variable sys.interfaces</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002ehost">Variable sys.host</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.20 Variable sys.interface</h4>

<p><br>

   <p>The assumed (default) name of the main system interface on this host.

<pre class="verbatim">
# interface = eth0

</pre>

<div class="node">
<a name="Variable-sys.interfaces"></a>
<a name="Variable-sys_002einterfaces"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002eip_005faddresses">Variable sys.ip_addresses</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002einterface">Variable sys.interface</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.21 Variable sys.interfaces</h4>

<p><br>

   <p><i>History</i>: Was introduced in 3.3.0, Nova 2.2.0 (2011)

   <p>Displays a system list of configured interfaces currently active
in use by the system. 
This list is detected at runtime and it passed in the variables report
to a Mission Portal in commercial editions of CFEngine.

   <p>To use this list in a policy, you will need a local copy since only local
variables can be iterated.

<pre class="verbatim">
bundle agent test
{
vars:

 # To iterate, we need a local copy

 "i1" slist => { @(sys.ip_addresses)} ;
 "i2" slist => { @(sys.interfaces)} ;

reports:

  cfengine::

    "Addresses: $(i1)";
    "Interfaces: $(i2)";
    "Addresses of the interfaces: $(sys.ipv4[$(i2)])";

}

</pre>

<div class="node">
<a name="Variable-sys.ip_addresses"></a>
<a name="Variable-sys_002eip_005faddresses"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002eipv4">Variable sys.ipv4</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002einterfaces">Variable sys.interfaces</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.22 Variable sys.ip_addresses</h4>

<p><br>

   <p><i>History</i>: Was introduced in 3.3.0, Nova 2.2.0 (2011)

   <p>Displays a system list of IP addresses currently in use by the system. 
This list is detected at runtime and it passed in the variables report
to a Mission Portal in commercial editions of CFEngine.

   <p>To use this list in a policy, you will need a local copy since only local
variables can be iterated.

<pre class="verbatim">
bundle agent test
{
vars:

 # To iterate, we need a local copy

 "i1" slist => { @(sys.ip_addresses)} ;
 "i2" slist => { @(sys.interfaces)} ;

reports:

  cfengine::

    "Addresses: $(i1)";
    "Interfaces: $(i2)";
    "Addresses of the interfaces: $(sys.ipv4[$(i2)])";

}

</pre>

<div class="node">
<a name="Variable-sys.ipv4"></a>
<a name="Variable-sys_002eipv4"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002eipv4_005binterface_005fname_005d">Variable sys.ipv4[interface_name]</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002eip_005faddresses">Variable sys.ip_addresses</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.23 Variable sys.ipv4</h4>

<p><br>

   <p>All four octets of the IPv4 address of the first system interface.

<p class="noindent"><b>Note</b>:<br>

   <p>If your system has a single ethernet interface, &lsquo;<samp><span class="samp">$(sys.ipv4)</span></samp>&rsquo; will
contain your IPv4 address.  However, if your system has multiple interfaces,
then &lsquo;<samp><span class="samp">$(sys.ipv4)</span></samp>&rsquo; will simply be the IPv4 address of the first
interface in the list that has an assigned address, See <a href="#Variable-sys_002eipv4_005binterface_005fname_005d">Variable sys.ipv4[interface_name]</a>, for details on obtaining the IPv4
addresses of all interfaces on a system.

<div class="node">
<a name="Variable-sys.ipv4%5binterface_name%5d"></a>
<a name="Variable-sys_002eipv4_005binterface_005fname_005d"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002eipv4_005f1_005binterface_005fname_005d">Variable sys.ipv4_1[interface_name]</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002eipv4">Variable sys.ipv4</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.24 Variable sys.ipv4[interface_name]</h4>

<p><br>

   <p>The full IPv4 address of the system interface named
as the associative array index, e.g. 
&lsquo;<samp><span class="samp">$(ipv4[le0])</span></samp>&rsquo; or &lsquo;<samp><span class="samp">$(ipv4[xr1])</span></samp>&rsquo;.

<pre class="verbatim">
# If the IPv4 address on the interfaces are
#        le0 = 192.168.1.101
#	 xr1 = 10.12.7.254
#
# Then the octets of all interfaces are accessable as an associative array
# ipv4_1[le0] = 192
# ipv4_2[le0] = 192.168
# ipv4_3[le0] = 192.168.1
#   ipv4[le0] = 192.168.1.101
# ipv4_1[xr1] = 10
# ipv4_2[xr1] = 10.12
# ipv4_3[xr1] = 10.12.7
#   ipv4[xr1] = 10.12.7.254

</pre>

<p class="noindent"><b>Note</b>:<br>

   <p>The list of interfaces may be acquired with &lsquo;<samp><span class="samp">getindices("sys.ipv4")</span></samp>&rsquo; (or
from any of the other associative arrays).  Only those interfaces which are
marked as "up" and have an IP address will be listed.

<div class="node">
<a name="Variable-sys.ipv4_1%5binterface_name%5d"></a>
<a name="Variable-sys_002eipv4_005f1_005binterface_005fname_005d"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002eipv4_005f2_005binterface_005fname_005d">Variable sys.ipv4_2[interface_name]</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002eipv4_005binterface_005fname_005d">Variable sys.ipv4[interface_name]</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.25 Variable sys.ipv4_1[interface_name]</h4>

<p><br>

   <p>The first octet of the IPv4 address of the system interface named
as the associative array index, e.g. 
&lsquo;<samp><span class="samp">$(ipv4_1[le0])</span></samp>&rsquo; or &lsquo;<samp><span class="samp">$(ipv4_1[xr1])</span></samp>&rsquo;, See <a href="#Variable-sys_002eipv4_005binterface_005fname_005d">Variable sys.ipv4[interface_name]</a>.

<div class="node">
<a name="Variable-sys.ipv4_2%5binterface_name%5d"></a>
<a name="Variable-sys_002eipv4_005f2_005binterface_005fname_005d"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002eipv4_005f3_005binterface_005fname_005d">Variable sys.ipv4_3[interface_name]</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002eipv4_005f1_005binterface_005fname_005d">Variable sys.ipv4_1[interface_name]</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.26 Variable sys.ipv4_2[interface_name]</h4>

<p><br>

   <p>The first two octets of the IPv4 address of the system interface named
as the associative array index, e.g. 
&lsquo;<samp><span class="samp">$(ipv4_2[le0])</span></samp>&rsquo; or &lsquo;<samp><span class="samp">$(ipv4_2[xr1])</span></samp>&rsquo;, See <a href="#Variable-sys_002eipv4_005binterface_005fname_005d">Variable sys.ipv4[interface_name]</a>.

<div class="node">
<a name="Variable-sys.ipv4_3%5binterface_name%5d"></a>
<a name="Variable-sys_002eipv4_005f3_005binterface_005fname_005d"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002elicense_005fowner">Variable sys.license_owner</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002eipv4_005f2_005binterface_005fname_005d">Variable sys.ipv4_2[interface_name]</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.27 Variable sys.ipv4_3[interface_name]</h4>

<p><br>

   <p>The first three octets of the IPv4 address of the system interface named
as the associative array index, e.g. 
&lsquo;<samp><span class="samp">$(ipv4_3[le0])</span></samp>&rsquo; or &lsquo;<samp><span class="samp">$(ipv4_3[xr1])</span></samp>&rsquo;, See <a href="#Variable-sys_002eipv4_005binterface_005fname_005d">Variable sys.ipv4[interface_name]</a>.

<div class="node">
<a name="Variable-sys.license_owner"></a>
<a name="Variable-sys_002elicense_005fowner"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002elicenses_005fgranted">Variable sys.licenses_granted</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002eipv4_005f3_005binterface_005fname_005d">Variable sys.ipv4_3[interface_name]</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.28 Variable sys.license_owner</h4>

<p><br>

   <p><i>History</i>: Was introduced in version 3.1.4,Nova 2.0.2 (2011)

<pre class="verbatim">
reports:

 nova::

  "This version of CFEngine is licensed to $(sys.license_owner)";

</pre>

<div class="node">
<a name="Variable-sys.licenses_granted"></a>
<a name="Variable-sys_002elicenses_005fgranted"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002elicenses_005finstalltime">Variable sys.licenses_installtime</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002elicense_005fowner">Variable sys.license_owner</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.29 Variable sys.licenses_granted</h4>

<p><br>

   <p><i>History</i>: Was introduced in version 3.1.4,Nova 2.0.2 (2011)

<pre class="verbatim">
reports:

 nova::

  "There are $(sys.licenses_granted) licenses granted for use";

</pre>

<div class="node">
<a name="Variable-sys.licenses_installtime"></a>
<a name="Variable-sys_002elicenses_005finstalltime"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002elong_005farch">Variable sys.long_arch</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002elicenses_005fgranted">Variable sys.licenses_granted</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.30 Variable sys.licenses_installtime</h4>

<p><br>

   <p><i>History</i>: Was introduced in version 3.1.5, Nova 2.1 (2011)

<pre class="verbatim">
reports:

 nova::

  "The license was installed on $(sys.licenses_installtime)";


</pre>

<div class="node">
<a name="Variable-sys.long_arch"></a>
<a name="Variable-sys_002elong_005farch"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002emaildir">Variable sys.maildir</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002elicenses_005finstalltime">Variable sys.licenses_installtime</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.31 Variable sys.long_arch</h4>

<p><br>

   <p>The long architecture name for this system kernel. This name is sometimes quite unwieldy
but can be useful for logging purposes.

<pre class="verbatim">
# long_arch = linux_x86_64_2_6_22_19_0_1_default__1_SMP_2008_10_14_22_17_43__0200

</pre>

<div class="node">
<a name="Variable-sys.maildir"></a>
<a name="Variable-sys_002emaildir"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002enova_005fversion">Variable sys.nova_version</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002elong_005farch">Variable sys.long_arch</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.32 Variable sys.maildir</h4>

<p><br>

   <p>The name of the system email spool directory.

<pre class="verbatim">
# maildir = /var/spool/mail

</pre>

<div class="node">
<a name="Variable-sys.nova_version"></a>
<a name="Variable-sys_002enova_005fversion"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002eos">Variable sys.os</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002emaildir">Variable sys.maildir</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.33 Variable sys.nova_version</h4>

<p><br>

   <p>The variable gives the version of the running CFEngine Nova Edition.

<pre class="verbatim">
# nova_version = 1.1.3

</pre>

<div class="node">
<a name="Variable-sys.os"></a>
<a name="Variable-sys_002eos"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002eostype">Variable sys.ostype</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002enova_005fversion">Variable sys.nova_version</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.34 Variable sys.os</h4>

<p><br>

   <p>The name of the operating system according to the kernel.

<pre class="verbatim">
# os = linux

</pre>

<div class="node">
<a name="Variable-sys.ostype"></a>
<a name="Variable-sys_002eostype"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002epolicy_005fhub">Variable sys.policy_hub</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002eos">Variable sys.os</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.35 Variable sys.ostype</h4>

<p><br>

   <p>Another name for the operating system.

<pre class="verbatim">
# ostype = linux_x86_64

</pre>

<div class="node">
<a name="Variable-sys.policy_hub"></a>
<a name="Variable-sys_002epolicy_005fhub"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002erelease">Variable sys.release</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002eostype">Variable sys.ostype</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.36 Variable sys.policy_hub</h4>

<p><br>
Hostname of the machine acting as a policy hub. This value is set
during bootstrap. In case bootstrap was not performed, it is set to &ldquo;undefined&rdquo;.

   <p><b>History</b>: Was introduced in version 3.1.0b1,Nova 2.0.0b1 (2010). Available in Community since 3.2.0

<pre class="verbatim">
reports:

 "Policy hub is $(sys.policy_hub)";

</pre>

<div class="node">
<a name="Variable-sys.release"></a>
<a name="Variable-sys_002erelease"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002eresolv">Variable sys.resolv</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002epolicy_005fhub">Variable sys.policy_hub</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.37 Variable sys.release</h4>

<p><br>

   <p>The kernel release of the operating system.

<pre class="verbatim">
# release = 2.6.22.19-0.1-default

</pre>

<div class="node">
<a name="Variable-sys.resolv"></a>
<a name="Variable-sys_002eresolv"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002euqhost">Variable sys.uqhost</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002erelease">Variable sys.release</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.38 Variable sys.resolv</h4>

<p><br>

   <p>The location of the system resolver file.

<pre class="verbatim">
# resolv = /etc/resolv.conf

</pre>

<div class="node">
<a name="Variable-sys.uqhost"></a>
<a name="Variable-sys_002euqhost"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002eversion">Variable sys.version</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002eresolv">Variable sys.resolv</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.39 Variable sys.uqhost</h4>

<p><br>

   <p>The unqualified name of the current host. See also <code>sys.fqhost</code>.

<pre class="verbatim">
# uqhost = myhost

</pre>

<div class="node">
<a name="Variable-sys.version"></a>
<a name="Variable-sys_002eversion"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002ewindir">Variable sys.windir</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002euqhost">Variable sys.uqhost</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.40 Variable sys.version</h4>

<p><br>

   <p>The version of the running kernel. On Linux, this corresponds
to the ouput of <code>uname -v</code>.

<pre class="verbatim">
# version = #55-Ubuntu SMP Mon Jan 10 23:42:43 UTC 2011

</pre>

   <p><i>History</i>: Was introduced in version 3.1.4,Nova 2.0.2 (2011)

<div class="node">
<a name="Variable-sys.windir"></a>
<a name="Variable-sys_002ewindir"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002ewinprogdir">Variable sys.winprogdir</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002eversion">Variable sys.version</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.41 Variable sys.windir</h4>

<p><br>

   <p>On the Windows version of CFEngine Nova, this is the path to the
Windows directory of this system.

<pre class="verbatim">
# windir = C:\WINDOWS

</pre>

<div class="node">
<a name="Variable-sys.winprogdir"></a>
<a name="Variable-sys_002ewinprogdir"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002ewinprogdir86">Variable sys.winprogdir86</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002ewindir">Variable sys.windir</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.42 Variable sys.winprogdir</h4>

<p><br>

   <p>On the Windows version of CFEngine Nova, this is the path to the
program files directory of the system.

<pre class="verbatim">
# winprogdir = C:\Program Files

</pre>

<div class="node">
<a name="Variable-sys.winprogdir86"></a>
<a name="Variable-sys_002ewinprogdir86"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002ewinsysdir">Variable sys.winsysdir</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002ewinprogdir">Variable sys.winprogdir</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.43 Variable sys.winprogdir86</h4>

<p><br>

   <p>On 64 bit Windows versions of CFEngine Nova, this is the path to the
32 bit (x86) program files directory of the system.

<pre class="verbatim">
# winprogdir86 = C:\Program Files (x86)

</pre>

<div class="node">
<a name="Variable-sys.winsysdir"></a>
<a name="Variable-sys_002ewinsysdir"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-sys_002eworkdir">Variable sys.workdir</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002ewinprogdir86">Variable sys.winprogdir86</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.44 Variable sys.winsysdir</h4>

<p><br>

   <p>On the Windows version of CFEngine Nova, this is the path to the
Windows system directory.

<pre class="verbatim">
# winsysdir = C:\WINDOWS\system32

</pre>

<div class="node">
<a name="Variable-sys.workdir"></a>
<a name="Variable-sys_002eworkdir"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-sys_002ewinsysdir">Variable sys.winsysdir</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-sys">Variable context sys</a>

</div>

<h4 class="subsection">12.5.45 Variable sys.workdir</h4>

<p><br>

   <p>The location of the CFEngine work directory and cache. For the
system privileged user this is normally:

<pre class="verbatim">
# workdir = /var/cfengine

</pre>

   <p>For non-privileged users it is in the user's home directory:

<pre class="verbatim">
# workdir = /home/user/.cfagent

</pre>

   <p>On the Windows version of CFEngine Nova, it is normally under program
files (the directory name may change with the language of Windows):

<pre class="verbatim">
# workdir = C:\Program Files\CFEngine

</pre>

<div class="node">
<a name="Variable-context-this"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-context-sys">Variable context sys</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Special-Variables">Special Variables</a>

</div>

<h3 class="section">12.6 Variable context <code>this</code></h3>

<p><br>

   <p>This context &lsquo;<samp><span class="samp">this</span></samp>&rsquo; is used to access information about promises
during their execution. It is context dependent and not universally
meaningful or available, but provides a context for variables where one is
needed (such as when passing the value of a list variable into a parameterized
<code>edit_line</code> promise from a <code>file</code> promise).  For example:

<pre class="verbatim">bundle agent resolver(s,n)
{ 
files:
  "$(sys.resolv)" 

      create        => "true",
      edit_line     => doresolv("@(this.s)","@(this.n)"),
      edit_defaults => reconstruct;
}
</pre>

   <p>Note that every unqualified variable is automatically considered to be in
context &lsquo;<samp><span class="samp">this</span></samp>&rsquo;, so that a reference to the variable <code>$(foo)</code> is
identical to referencing <code>$(this.foo)</code>.  You are strongly encourged to
<b>not</b> take advantage of this behaviour, but simply to be aware that if you
attempt to declare a variable name with one of the following special
reserved names, CFEngine will issue a warning (and you can reference your
variable by qualifying it with the bundle name in which it is declared).

<ul class="menu">
<li><a accesskey="1" href="#Variable-this_002ehandle">Variable this.handle</a>
<li><a accesskey="2" href="#Variable-this_002epromise_005ffilename">Variable this.promise_filename</a>
<li><a accesskey="3" href="#Variable-this_002epromise_005flinenumber">Variable this.promise_linenumber</a>
<li><a accesskey="4" href="#Variable-this_002epromiser">Variable this.promiser</a>
<li><a accesskey="5" href="#Variable-service_005fpolicy">Variable service_policy</a>
<li><a accesskey="6" href="#Variable-this_002ethis">Variable this.this</a>
</ul>

<div class="node">
<a name="Variable-this.handle"></a>
<a name="Variable-this_002ehandle"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-this_002epromise_005ffilename">Variable this.promise_filename</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-this">Variable context this</a>

</div>

<h4 class="subsection">12.6.1 Variable this.handle</h4>

<p>This variable points to the promise handle of the currently handled promise;
 it is useful for referring to the intention in log messages.

<div class="node">
<a name="Variable-this.promise_filename"></a>
<a name="Variable-this_002epromise_005ffilename"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-this_002epromise_005flinenumber">Variable this.promise_linenumber</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-this_002ehandle">Variable this.handle</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-this">Variable context this</a>

</div>

<h4 class="subsection">12.6.2 Variable this.promise_filename</h4>

<p>This variable reveals the name of the file in which the current promise is defined.

<div class="node">
<a name="Variable-this.promise_linenumber"></a>
<a name="Variable-this_002epromise_005flinenumber"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-this_002epromiser">Variable this.promiser</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-this_002epromise_005ffilename">Variable this.promise_filename</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-this">Variable context this</a>

</div>

<h4 class="subsection">12.6.3 Variable this.promise_linenumber</h4>

<p>This variable reveals the line number in the file at which it is used.  It is
useful to differentiate otherwise identical reports promises.

<div class="node">
<a name="Variable-this.promiser"></a>
<a name="Variable-this_002epromiser"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-service_005fpolicy">Variable service_policy</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-this_002epromise_005flinenumber">Variable this.promise_linenumber</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-this">Variable context this</a>

</div>

<h4 class="subsection">12.6.4 Variable this.promiser</h4>

<p>The special variable <code>$(this.promiser)</code> is used to refer to the current
value of the promiser itself, in a number of allowed cases, typically when
searches can take place. Current promise types that define <code>$(this.promiser)</code>
are: <code>files</code>, <code>processes</code>, <code>commands</code>.

   <p>This variable is useful in <code>files</code> promises, for instance when using
pattern matching or <code>depth_search</code> that implicitly match multiple
objects.  In that case, <code>$(this.promiser)</code> refers to the
currently identified file that makes the promise.  For example:

<pre class="verbatim">bundle agent find666
{
files:
  "/home"
    file_select => world_writeable,
    transformer => "/bin/echo DETECTED $(this.promiser)",
    depth_search => recurse("inf");

  "/etc/.*"
    file_select => world_writeable,
    transformer => "/bin/echo DETECTED $(this.promiser)";
}

body file_select world_writeable
{
  search_mode => { "o+w" };
  file_result => "mode";
}
</pre>

<div class="node">
<a name="Variable-service_policy"></a>
<a name="Variable-service_005fpolicy"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-this_002ethis">Variable this.this</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-this_002epromiser">Variable this.promiser</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-this">Variable context this</a>

</div>

<h4 class="subsection">12.6.5 Variable service_policy</h4>

<p>This variable is set to the values of the promise attribute <code>service_policy</code>, e.g.

<pre class="verbatim">services:

  "www"  service_policy => "start";
</pre>
and is typically used in the adaptations for custom services bundles
in the service methods, See <a href="#service_005fmethod-in-services">service_method in services</a>.

<div class="node">
<a name="Variable-this.this"></a>
<a name="Variable-this_002ethis"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-service_005fpolicy">Variable service_policy</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Variable-context-this">Variable context this</a>

</div>

<h4 class="subsection">12.6.6 Variable this.this</h4>

<p>From version core 3.3.0 this variables is reserved. It is used by
functions like <code>maplist()</code> to represent the current object in
a transformation map.

   </ul>
<!-- ***************************************************** -->
<!-- * CHAPTER -->
<!-- ***************************************************** -->
<div class="node">
<a name="Logs-and-records"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Special-Variables">Special Variables</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">13 Logs and records</h2>

<p><br>

   <p>CFEngine writes numerous logs and records to its private workspace,
referred to as <samp><span class="file">WORKDIR</span></samp>. This chapter makes some brief notes
about these files. CFEngine approaches monitoring and reporting from
the viewpoint of scalability so there is no default centralizatio of
reporting information, as this is untenable for more than a few
hundred hosts. Instead, in the classic CFEngine way, every host
is reponsible for its own data. Solutions for centralization and
netwide reporting will be given elsewhere.

   <p>The filenames referred to in this section are all relative to the
CFEngine work directory <samp><span class="file">WORKDIR</span></samp>.

<ul class="menu">
<li><a accesskey="1" href="#Embedded-Databases">Embedded Databases</a>
<li><a accesskey="2" href="#Text-logs">Text logs</a>
<li><a accesskey="3" href="#Reports-in-outputs">Reports in outputs</a>
<li><a accesskey="4" href="#Additional-reports-in-commercical-CFEngine-versions">Additional reports in commercical CFEngine versions</a>
<li><a accesskey="5" href="#State-information">State information</a>
</ul>

<div class="node">
<a name="Embedded-Databases"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Text-logs">Text logs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Logs-and-records">Logs and records</a>

</div>

<h3 class="section">13.1 Embedded Databases</h3>

<p>The embedded databases can be viewed and printed using the reporting
tool <code>cf-report</code>.

   <p>Their file extensions will vary based on which library is used to
implement them; either Tokyo Cabinet (<code>.tcdb</code>), Quick Database
Manager (<code>.qdbm</code>), or Berkeley DB (<code>.db</code>). Converting one
database format to another is not handled by CFEngine, but there exist
external tools meant for that purpose.

     <dl>
<dt><samp><span class="file">cf_Audit.tcdb</span></samp><dd>A compressed database of auditing information. This file grows very large
is auditing is switched on. By default, only minor information about CFEngine runs
are recorded. This file should be archived and deleted regularly to avoid choking
the system. 
<br><dt><samp><span class="file">cf_lastseen.tcdb</span></samp><dd>A database of hosts that last contacted this host, or were contacted by this
host which includes the times at which they were last observed. 
<br><dt><samp><span class="file">cf_classes.tcdb</span></samp><dd>A database of classes that have been defined on the current host, including
their relative frequences, scaled like a probability.

     <br><dt><samp><span class="file">checksum_digests.tcdb</span></samp><dd>The database of hash values used in CFEngine's change management functions. 
<br><dt><samp><span class="file">performance.tcdb</span></samp><dd>A database of last, average and deviation times of jobs recorded by <code>cf-agent</code>. 
Most promises take an immeasurablely short time to check, but longer
tasks such as command execution and file copying are measured by default. 
Other checks can be instrumented by setting a <code>measurement_class</code>
in the <code>action</code> body of a promise.

     <br><dt><samp><span class="file">stats.tcdb</span></samp><dd>A database of external file attributes for change management functionality.

     <br><dt><samp><span class="file">state/cf_lock.tcdb</span></samp><dd>A database of active and inactive locks and their expiry times. Deleting
this database will reset all lock protections in CFEngine.

     <br><dt><samp><span class="file">state/history.tcdb</span></samp><dd>Enterprise level versions of CFEngine maintain this long-term trend database.

     <br><dt><samp><span class="file">state/cf_observations.tcdb</span></samp><dd>This database contains the current state of the observational history
of the host as recorded by <code>cf-monitord</code>.

     <br><dt><samp><span class="file">state/promise_compliance.tcdb</span></samp><dd>Enterprise CFEngine (Nova and above) database of individual promise compliance history. 
The database is approximate because promise references can change as policy is
edited. It quickly approaches accuracy as a policy goes unchanged for more than a day.

     <br><dt><samp><span class="file">state/cf_state.tcdb</span></samp><dd>A database of persistent classes active on this current host.

     <br><dt><samp><span class="file">state/nova_measures.tcdb</span></samp><dd>Enterprise CFEngine (Nova and above) database of custom measurables. 
<br><dt><samp><span class="file">state/nova_static.tcdb</span></samp><dd>Enterprise CFEngine (Nova and above) database of static system discovery data. 
</dl>

<div class="node">
<a name="Text-logs"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Reports-in-outputs">Reports in outputs</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Embedded-Databases">Embedded Databases</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Logs-and-records">Logs and records</a>

</div>

<h3 class="section">13.2 Text logs</h3>

     <dl>
<dt><samp><span class="file">promise_summary.log</span></samp><dd>A time-stamped log of the percentage fraction of promises kept after each run. 
<br><dt><samp><span class="file">cf3.HOSTNAME.runlog</span></samp><dd>A time-stamped log of when each lock was released. This shows the last
time each individual promise was verified. 
<br><dt><samp><span class="file">cfagent.HOSTNAME.log</span></samp><dd>Although ambiguously named (for historical reasons) this log contains the current
list of setuid/setgid programs observed on the system. CFEngine warns about
new additions to this list. This log has been deprecated.

     <br><dt><samp><span class="file">cf_value.log</span></samp><dd>A time stamped log of the business value estimated from the execution of the automation
system.

     <br><dt><samp><span class="file">cf_notkept.log</span></samp><dd>A list of promises, with handles and comments, that were not kept. Nova enterprise versions only.

     <br><dt><samp><span class="file">cf_repaired.log</span></samp><dd>A list of promises, with handles and comments, that were repaired. Nova enterprise versions only.

     <br><dt><samp><span class="file">reports/*</span></samp><dd>Enterprise versions of CFEngine use this directory as a default place for
outputting reports.

     <br><dt><samp><span class="file">reports/class_notes</span></samp><dd>Class data in csv format for export to CMDB.

     <br><dt><samp><span class="file">state/file_change.log</span></samp><dd>A time-stamped log of which files have experienced content changes
since the last observation, as determined by the hashing algorithms in
CFEngine.

     <br><dt><samp><span class="file">state/vars.out</span></samp><dd>Enterprise level versions of CFEngine use this log to communicate variable
data.

     <br><dt><samp><span class="file">state/*_measure.log</span></samp><dd>Enterprise level versions of CFEngine maintain user-defined logs based on
specifically promised observations of the system.

</dl>

<div class="node">
<a name="Reports-in-outputs"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Additional-reports-in-commercical-CFEngine-versions">Additional reports in commercical CFEngine versions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Text-logs">Text logs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Logs-and-records">Logs and records</a>

</div>

<h3 class="section">13.3 Reports in outputs</h3>

<p>The <samp><span class="file">outputs</span></samp> directory contains a time-stamped list of outputs
generated by <code>cf-agent</code>. These are collected by <code>cf-execd</code>
and are often E-mailed as reports. However, not all hosts have an
E-mail capability or are online, so the reports are kept here. Reports
are not tidied automatically, so you should delete these files after a
time to avoid a build up.

<div class="node">
<a name="Additional-reports-in-commercical-CFEngine-versions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#State-information">State information</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Reports-in-outputs">Reports in outputs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Logs-and-records">Logs and records</a>

</div>

<h3 class="section">13.4 Additional reports in commcerical CFEngine versions</h3>

<div class="node">
<a name="State-information"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Additional-reports-in-commercical-CFEngine-versions">Additional reports in commercical CFEngine versions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Logs-and-records">Logs and records</a>

</div>

<h3 class="section">13.5 State information</h3>

<p>The CFEngine components keep their current process identifier number
in `pid files' in the work directory: e.g.

<pre class="verbatim">cf-execd.pid
cf-serverd.pid
</pre>

   <p>Most other state data refer to the running condition of the host and
are generated by <code>cf-monitord</code> (<code>cfenvd</code> in earlier versions
of CFEngine).

     <dl>
<dt><samp><span class="file">state/env_data</span></samp><dd>This file contains a list of currently discovered classes and variable values
that characterize the anomaly alert environment. They are altered by the monitor
daemon. 
<br><dt><samp><span class="file">state/all_classes</span></samp><dd>A list of all the classes that were defined the last time that CFEngine
was run. 
<br><dt><samp><span class="file">state/cf_*</span></samp><dd>All files that begin with this prefix refer to cached data that were observed
by the monitor daemon, and may be used by <code>cf-agent</code> in <code>reports</code> with <code>showstate</code>. 
</dl>

<!-- ========================================================================= -->
<!-- @node Index -->
<!-- @unnumbered Concept Index -->
<!-- @printindex cp -->
<!-- ========================================================================= -->
   <p><a name="Contents">
   <div class="contents">
<h2>Table of Contents</h2>
<ul>
<li><a name="toc_Top" href="#Top">CFEngine-AutoReference</a>
<li><a name="toc_Getting-started" href="#Getting-started">1 CFEngine 3.5.0a1.cd6175a &ndash; Getting started</a>
<ul>
<li><a href="#Software-components">1.1 Software components</a>
<ul>
<li><a href="#cf_002dagent">1.1.1 cf-agent</a>
<li><a href="#cf_002dexecd">1.1.2 cf-execd</a>
<li><a href="#cf_002dknow">1.1.3 cf-know*</a>
<li><a href="#cf_002dmonitord">1.1.4 cf-monitord</a>
<li><a href="#cf_002dpromises">1.1.5 cf-promises</a>
<li><a href="#cf_002drunagent">1.1.6 cf-runagent</a>
<li><a href="#cf_002dserverd">1.1.7 cf-serverd</a>
<li><a href="#cf_002dreport">1.1.8 cf-report</a>
<li><a href="#cf_002dkey">1.1.9 cf-key</a>
<li><a href="#cf_002dhub">1.1.10 cf-hub</a>
</li></ul>
<li><a href="#Core-concepts">1.2 Core concepts</a>
<li><a href="#A-renewed-CFEngine">1.3 A renewed CFEngine</a>
<li><a href="#Installation">1.4 Installation</a>
<li><a href="#Syntax">1.5 Syntax, identifiers and names</a>
<li><a href="#Work-directory">1.6 The work directory</a>
<li><a href="#Decisions">1.7 Decisions</a>
<ul>
<li><a href="#Hard-classes">1.7.1 CFEngine hard classes</a>
<li><a href="#Class-combination-operators-and-precedence">1.7.2 Class combination operators and precedence</a>
<li><a href="#Global-and-local-classes">1.7.3 Global and local classes</a>
</li></ul>
<li><a href="#Filenames-and-paths">1.8 Filenames and paths</a>
<li><a href="#Upgrading-from-CFEngine-2">1.9 Upgrading from CFEngine 2</a>
<li><a href="#Testing-as-a-non_002dprivilieged-user">1.10 Testing as a non-privilieged user</a>
<li><a href="#The-bare-necessities-of-a-CFEngine-3">1.11 The `bare necessities' of a CFEngine 3</a>
<li><a href="#Familiiarizing-yourself">1.12 Familiarizing yourself</a>
<li><a href="#Remote-access-troubleshooting">1.13 Remote access troubleshooting</a>
<ul>
<li><a href="#Server-connection">1.13.1 Server connection</a>
<li><a href="#Key-exchange">1.13.2 Key exchange</a>
<li><a href="#Time-windows">1.13.3 Time windows (races)</a>
<li><a href="#Other-users-than-root">1.13.4 Other users than root</a>
<li><a href="#Encryption">1.13.5 Encryption</a>
</li></ul>
</li></ul>
<li><a name="toc_A-simple-crash-course" href="#A-simple-crash-course">2 A simple crash course in concepts</a>
<ul>
<li><a href="#Rules-are-promises">2.1 Rules are promises</a>
<li><a href="#Best-practice-for-writing-promises">2.2 Best practice for writing promises</a>
<li><a href="#Containers">2.3 Containers</a>
<li><a href="#When-and-where-are-promises-made_003f">2.4 When and where are promises made?</a>
<li><a href="#Types-in-CFEngine-3">2.5 Types in CFEngine 3</a>
<li><a href="#Datatypes-in-CFEngine-3">2.6 Datatypes in CFEngine 3</a>
<li><a href="#Variable-expansion-in-CFEngine-3">2.7 Variable expansion in CFEngine 3</a>
<ul>
<li><a href="#Scalar-variable-expansion">2.7.1 Scalar variable expansion</a>
<li><a href="#List-variable-substitution-and-expansion">2.7.2 List variable substitution and expansion</a>
<li><a href="#Special-list-value-cf_005fnull">2.7.3 Special list value <code>cf_null</code></a>
<li><a href="#Arrays-in-CFEngine-3">2.7.4 Arrays in CFEngine 3</a>
</li></ul>
<li><a href="#Name-spaces">2.8 Name spaces</a>
<li><a href="#Normal-ordering">2.9 Normal ordering</a>
<ul>
<li><a href="#Agent-normal-ordering">2.9.1 Agent normal ordering</a>
<li><a href="#Server-normal-ordering">2.9.2 Server normal ordering</a>
<li><a href="#Monitor-normal-ordering">2.9.3 Monitor normal ordering</a>
<li><a href="#Knowledge-normal-ordering">2.9.4 Knowledge normal ordering</a>
</li></ul>
<li><a href="#Loops-and-lists-in-CFEngine-3">2.10 Loops and lists in CFEngine 3</a>
<li><a href="#Pattern-matching-and-referencing">2.11 Pattern matching and referencing</a>
<ul>
<li><a href="#Runaway-change-warning">2.11.1 Runaway change warning</a>
<li><a href="#Commenting-lines">2.11.2 Commenting lines</a>
<li><a href="#Regular-expressions-in-paths">2.11.3 Regular expressions in paths</a>
<li><a href="#Anchored-vs_002e-unanchored-regular-expressions">2.11.4 Anchored vs. unanchored regular expressions</a>
<li><a href="#Special-topics-on-Regular-Expressions">2.11.5 Special topics on Regular Expressions</a>
</li></ul>
<li><a href="#Distributed-discovery">2.12 Distributed discovery</a>
</li></ul>
<li><a name="toc_How-to-run-CFEngine-3-examples" href="#How-to-run-CFEngine-3-examples">3 How to run CFEngine 3 examples</a>
<li><a name="toc_A-complete-configuration" href="#A-complete-configuration">4 A complete configuration</a>
<ul>
<li><a href="#promises_002ecf">4.1 <samp><span class="file">promises.cf</span></samp></a>
<li><a href="#site_002ecf">4.2 <samp><span class="file">site.cf</span></samp></a>
<li><a href="#update_002ecf">4.3 <samp><span class="file">update.cf</span></samp></a>
<li><a href="#failsafe_002ecf">4.4 <samp><span class="file">failsafe.cf</span></samp></a>
<li><a href="#What-should-a-failsafe-or-update-file-contain">4.5 What should a failsafe and update file contain?</a>
<li><a href="#Recovery-from-errors-in-the-configuration">4.6 Recovery from errors in the configuration</a>
<li><a href="#Recovery-from-errors-in-the-software">4.7 Recovery from errors in the software</a>
</li></ul>
<li><a name="toc_Control-Promises" href="#Control-Promises">5 Control promises</a>
<ul>
<li><a href="#control-common">5.1 <code>common</code> control promises</a>
<ul>
<li><a href="#bundlesequence-in-common">5.1.1 <code>bundlesequence</code></a>
<li><a href="#goal_005fpatterns-in-common">5.1.2 <code>goal_patterns</code></a>
<li><a href="#ignore_005fmissing_005fbundles-in-common">5.1.3 <code>ignore_missing_bundles</code></a>
<li><a href="#ignore_005fmissing_005finputs-in-common">5.1.4 <code>ignore_missing_inputs</code></a>
<li><a href="#inputs-in-common">5.1.5 <code>inputs</code></a>
<li><a href="#version-in-common">5.1.6 <code>version</code></a>
<li><a href="#lastseenexpireafter-in-common">5.1.7 <code>lastseenexpireafter</code></a>
<li><a href="#output_005fprefix-in-common">5.1.8 <code>output_prefix</code></a>
<li><a href="#domain-in-common">5.1.9 <code>domain</code></a>
<li><a href="#require_005fcomments-in-common">5.1.10 <code>require_comments</code></a>
<li><a href="#host_005flicenses_005fpaid-in-common">5.1.11 <code>host_licenses_paid</code></a>
<li><a href="#site_005fclasses-in-common">5.1.12 <code>site_classes</code></a>
<li><a href="#syslog_005fhost-in-common">5.1.13 <code>syslog_host</code></a>
<li><a href="#syslog_005fport-in-common">5.1.14 <code>syslog_port</code></a>
<li><a href="#fips_005fmode-in-common">5.1.15 <code>fips_mode</code></a>
</li></ul>
<li><a href="#control-agent">5.2 <code>agent</code> control promises</a>
<ul>
<li><a href="#abortclasses-in-agent">5.2.1 <code>abortclasses</code></a>
<li><a href="#abortbundleclasses-in-agent">5.2.2 <code>abortbundleclasses</code></a>
<li><a href="#addclasses-in-agent">5.2.3 <code>addclasses</code></a>
<li><a href="#agentaccess-in-agent">5.2.4 <code>agentaccess</code></a>
<li><a href="#agentfacility-in-agent">5.2.5 <code>agentfacility</code></a>
<li><a href="#allclassesreport-in-agent">5.2.6 <code>allclassesreport</code></a>
<li><a href="#alwaysvalidate-in-agent">5.2.7 <code>alwaysvalidate</code></a>
<li><a href="#auditing-in-agent">5.2.8 <code>auditing</code></a>
<li><a href="#binarypaddingchar-in-agent">5.2.9 <code>binarypaddingchar</code></a>
<li><a href="#bindtointerface-in-agent">5.2.10 <code>bindtointerface</code></a>
<li><a href="#hashupdates-in-agent">5.2.11 <code>hashupdates</code></a>
<li><a href="#childlibpath-in-agent">5.2.12 <code>childlibpath</code></a>
<li><a href="#checksum_005falert_005ftime-in-agent">5.2.13 <code>checksum_alert_time</code></a>
<li><a href="#defaultcopytype-in-agent">5.2.14 <code>defaultcopytype</code></a>
<li><a href="#dryrun-in-agent">5.2.15 <code>dryrun</code></a>
<li><a href="#editbinaryfilesize-in-agent">5.2.16 <code>editbinaryfilesize</code></a>
<li><a href="#editfilesize-in-agent">5.2.17 <code>editfilesize</code></a>
<li><a href="#environment-in-agent">5.2.18 <code>environment</code></a>
<li><a href="#exclamation-in-agent">5.2.19 <code>exclamation</code></a>
<li><a href="#expireafter-in-agent">5.2.20 <code>expireafter</code></a>
<li><a href="#files_005fsingle_005fcopy-in-agent">5.2.21 <code>files_single_copy</code></a>
<li><a href="#files_005fauto_005fdefine-in-agent">5.2.22 <code>files_auto_define</code></a>
<li><a href="#hostnamekeys-in-agent">5.2.23 <code>hostnamekeys</code></a>
<li><a href="#ifelapsed-in-agent">5.2.24 <code>ifelapsed</code></a>
<li><a href="#inform-in-agent">5.2.25 <code>inform</code></a>
<li><a href="#intermittency-in-agent">5.2.26 <code>intermittency</code></a>
<li><a href="#max_005fchildren-in-agent">5.2.27 <code>max_children</code></a>
<li><a href="#maxconnections-in-agent">5.2.28 <code>maxconnections</code></a>
<li><a href="#mountfilesystems-in-agent">5.2.29 <code>mountfilesystems</code></a>
<li><a href="#nonalphanumfiles-in-agent">5.2.30 <code>nonalphanumfiles</code></a>
<li><a href="#repchar-in-agent">5.2.31 <code>repchar</code></a>
<li><a href="#refresh_005fprocesses-in-agent">5.2.32 <code>refresh_processes</code></a>
<li><a href="#default_005frepository-in-agent">5.2.33 <code>default_repository</code></a>
<li><a href="#secureinput-in-agent">5.2.34 <code>secureinput</code></a>
<li><a href="#sensiblecount-in-agent">5.2.35 <code>sensiblecount</code></a>
<li><a href="#sensiblesize-in-agent">5.2.36 <code>sensiblesize</code></a>
<li><a href="#skipidentify-in-agent">5.2.37 <code>skipidentify</code></a>
<li><a href="#suspiciousnames-in-agent">5.2.38 <code>suspiciousnames</code></a>
<li><a href="#syslog-in-agent">5.2.39 <code>syslog</code></a>
<li><a href="#track_005fvalue-in-agent">5.2.40 <code>track_value</code></a>
<li><a href="#timezone-in-agent">5.2.41 <code>timezone</code></a>
<li><a href="#default_005ftimeout-in-agent">5.2.42 <code>default_timeout</code></a>
<li><a href="#verbose-in-agent">5.2.43 <code>verbose</code></a>
</li></ul>
<li><a href="#control-server">5.3 <code>server</code> control promises</a>
<ul>
<li><a href="#allowallconnects-in-server">5.3.1 <code>allowallconnects</code></a>
<li><a href="#allowconnects-in-server">5.3.2 <code>allowconnects</code></a>
<li><a href="#allowusers-in-server">5.3.3 <code>allowusers</code></a>
<li><a href="#auditing-in-server">5.3.4 <code>auditing</code></a>
<li><a href="#bindtointerface-in-server">5.3.5 <code>bindtointerface</code></a>
<li><a href="#cfruncommand-in-server">5.3.6 <code>cfruncommand</code></a>
<li><a href="#call_005fcollect_005finterval-in-server">5.3.7 <code>call_collect_interval</code></a>
<li><a href="#collect_005fwindow-in-server">5.3.8 <code>collect_window</code></a>
<li><a href="#denybadclocks-in-server">5.3.9 <code>denybadclocks</code></a>
<li><a href="#denyconnects-in-server">5.3.10 <code>denyconnects</code></a>
<li><a href="#dynamicaddresses-in-server">5.3.11 <code>dynamicaddresses</code></a>
<li><a href="#hostnamekeys-in-server">5.3.12 <code>hostnamekeys</code></a>
<li><a href="#keycacheTTL-in-server">5.3.13 <code>keycacheTTL</code></a>
<li><a href="#logallconnections-in-server">5.3.14 <code>logallconnections</code></a>
<li><a href="#logencryptedtransfers-in-server">5.3.15 <code>logencryptedtransfers</code></a>
<li><a href="#maxconnections-in-server">5.3.16 <code>maxconnections</code></a>
<li><a href="#port-in-server">5.3.17 <code>port</code></a>
<li><a href="#serverfacility-in-server">5.3.18 <code>serverfacility</code></a>
<li><a href="#skipverify-in-server">5.3.19 <code>skipverify</code></a>
<li><a href="#trustkeysfrom-in-server">5.3.20 <code>trustkeysfrom</code></a>
<li><a href="#listen-in-server">5.3.21 <code>listen</code></a>
</li></ul>
<li><a href="#control-monitor">5.4 <code>monitor</code> control promises</a>
<ul>
<li><a href="#forgetrate-in-monitor">5.4.1 <code>forgetrate</code></a>
<li><a href="#monitorfacility-in-monitor">5.4.2 <code>monitorfacility</code></a>
<li><a href="#histograms-in-monitor">5.4.3 <code>histograms</code></a>
<li><a href="#tcpdump-in-monitor">5.4.4 <code>tcpdump</code></a>
<li><a href="#tcpdumpcommand-in-monitor">5.4.5 <code>tcpdumpcommand</code></a>
</li></ul>
<li><a href="#control-runagent">5.5 <code>runagent</code> control promises</a>
<ul>
<li><a href="#hosts-in-runagent">5.5.1 <code>hosts</code></a>
<li><a href="#port-in-runagent">5.5.2 <code>port</code></a>
<li><a href="#force_005fipv4-in-runagent">5.5.3 <code>force_ipv4</code></a>
<li><a href="#trustkey-in-runagent">5.5.4 <code>trustkey</code></a>
<li><a href="#encrypt-in-runagent">5.5.5 <code>encrypt</code></a>
<li><a href="#background_005fchildren-in-runagent">5.5.6 <code>background_children</code></a>
<li><a href="#max_005fchildren-in-runagent">5.5.7 <code>max_children</code></a>
<li><a href="#output_005fto_005ffile-in-runagent">5.5.8 <code>output_to_file</code></a>
<li><a href="#output_005fdirectory-in-runagent">5.5.9 <code>output_directory</code></a>
<li><a href="#timeout-in-runagent">5.5.10 <code>timeout</code></a>
</li></ul>
<li><a href="#control-executor">5.6 <code>executor</code> control promises</a>
<ul>
<li><a href="#splaytime-in-executor">5.6.1 <code>splaytime</code></a>
<li><a href="#mailfrom-in-executor">5.6.2 <code>mailfrom</code></a>
<li><a href="#mailto-in-executor">5.6.3 <code>mailto</code></a>
<li><a href="#smtpserver-in-executor">5.6.4 <code>smtpserver</code></a>
<li><a href="#mailmaxlines-in-executor">5.6.5 <code>mailmaxlines</code></a>
<li><a href="#schedule-in-executor">5.6.6 <code>schedule</code></a>
<li><a href="#executorfacility-in-executor">5.6.7 <code>executorfacility</code></a>
<li><a href="#exec_005fcommand-in-executor">5.6.8 <code>exec_command</code></a>
<li><a href="#agent_005fexpireafter-in-executor">5.6.9 <code>agent_expireafter</code></a>
</li></ul>
<li><a href="#control-knowledge">5.7 <code>knowledge</code> control promises</a>
<ul>
<li><a href="#build_005fdirectory-in-knowledge">5.7.1 <code>build_directory</code></a>
<li><a href="#document_005froot-in-knowledge">5.7.2 <code>document_root</code></a>
<li><a href="#generate_005fmanual-in-knowledge">5.7.3 <code>generate_manual</code></a>
<li><a href="#graph_005fdirectory-in-knowledge">5.7.4 <code>graph_directory</code></a>
<li><a href="#graph_005foutput-in-knowledge">5.7.5 <code>graph_output</code></a>
<li><a href="#html_005fbanner-in-knowledge">5.7.6 <code>html_banner</code></a>
<li><a href="#html_005ffooter-in-knowledge">5.7.7 <code>html_footer</code></a>
<li><a href="#id_005fprefix-in-knowledge">5.7.8 <code>id_prefix</code></a>
<li><a href="#manual_005fsource_005fdirectory-in-knowledge">5.7.9 <code>manual_source_directory</code></a>
<li><a href="#query_005fengine-in-knowledge">5.7.10 <code>query_engine</code></a>
<li><a href="#query_005foutput-in-knowledge">5.7.11 <code>query_output</code></a>
<li><a href="#sql_005ftype-in-knowledge">5.7.12 <code>sql_type</code></a>
<li><a href="#sql_005fdatabase-in-knowledge">5.7.13 <code>sql_database</code></a>
<li><a href="#sql_005fowner-in-knowledge">5.7.14 <code>sql_owner</code></a>
<li><a href="#sql_005fpasswd-in-knowledge">5.7.15 <code>sql_passwd</code></a>
<li><a href="#sql_005fserver-in-knowledge">5.7.16 <code>sql_server</code></a>
<li><a href="#sql_005fconnection_005fdb-in-knowledge">5.7.17 <code>sql_connection_db</code></a>
<li><a href="#style_005fsheet-in-knowledge">5.7.18 <code>style_sheet</code></a>
<li><a href="#view_005fprojections-in-knowledge">5.7.19 <code>view_projections</code></a>
</li></ul>
<li><a href="#control-reporter">5.8 <code>reporter</code> control promises</a>
<ul>
<li><a href="#aggregation_005fpoint-in-reporter">5.8.1 <code>aggregation_point</code></a>
<li><a href="#auto_005fscaling-in-reporter">5.8.2 <code>auto_scaling</code></a>
<li><a href="#build_005fdirectory-in-reporter">5.8.3 <code>build_directory</code></a>
<li><a href="#csv2xml-in-reporter">5.8.4 <code>csv2xml</code></a>
<li><a href="#error_005fbars-in-reporter">5.8.5 <code>error_bars</code></a>
<li><a href="#html_005fbanner-in-reporter">5.8.6 <code>html_banner</code></a>
<li><a href="#html_005fembed-in-reporter">5.8.7 <code>html_embed</code></a>
<li><a href="#html_005ffooter-in-reporter">5.8.8 <code>html_footer</code></a>
<li><a href="#query_005fengine-in-reporter">5.8.9 <code>query_engine</code></a>
<li><a href="#reports-in-reporter">5.8.10 <code>reports</code></a>
<li><a href="#report_005foutput-in-reporter">5.8.11 <code>report_output</code></a>
<li><a href="#style_005fsheet-in-reporter">5.8.12 <code>style_sheet</code></a>
<li><a href="#time_005fstamps-in-reporter">5.8.13 <code>time_stamps</code></a>
</li></ul>
<li><a href="#control-hub">5.9 <code>hub</code> control promises</a>
<ul>
<li><a href="#export_005fzenoss-in-hub">5.9.1 <code>export_zenoss</code></a>
<li><a href="#exclude_005fhosts-in-hub">5.9.2 <code>exclude_hosts</code></a>
<li><a href="#hub_005fschedule-in-hub">5.9.3 <code>hub_schedule</code></a>
<li><a href="#port-in-hub">5.9.4 <code>port</code></a>
</li></ul>
<li><a href="#control-file">5.10 <code>file</code> control promises</a>
<ul>
<li><a href="#namespace-in-file">5.10.1 <code>namespace</code></a>
</li></ul>
</li></ul>
<li><a name="toc_Bundles-for-common" href="#Bundles-for-common">6 Bundles of <code>common</code></a>
<ul>
<li><a href="#classes-in-common-promises">6.1 <code>classes</code> promises in &lsquo;<samp><span class="samp">*</span></samp>&rsquo;</a>
<ul>
<li><a href="#and-in-classes">6.1.1 <code>and</code></a>
<li><a href="#dist-in-classes">6.1.2 <code>dist</code></a>
<li><a href="#expression-in-classes">6.1.3 <code>expression</code></a>
<li><a href="#or-in-classes">6.1.4 <code>or</code></a>
<li><a href="#persistence-in-classes">6.1.5 <code>persistence</code></a>
<li><a href="#not-in-classes">6.1.6 <code>not</code></a>
<li><a href="#select_005fclass-in-classes">6.1.7 <code>select_class</code></a>
<li><a href="#xor-in-classes">6.1.8 <code>xor</code></a>
</li></ul>
<li><a href="#defaults-in-common-promises">6.2 <code>defaults</code> promises in &lsquo;<samp><span class="samp">*</span></samp>&rsquo;</a>
<ul>
<li><a href="#if_005fmatch_005fregex-in-defaults">6.2.1 <code>if_match_regex</code></a>
<li><a href="#string-in-defaults">6.2.2 <code>string</code></a>
<li><a href="#slist-in-defaults">6.2.3 <code>slist</code></a>
</li></ul>
<li><a href="#meta-in-common-promises">6.3 <code>meta</code> promises in &lsquo;<samp><span class="samp">*</span></samp>&rsquo;</a>
<ul>
<li><a href="#string-in-meta">6.3.1 <code>string</code></a>
<li><a href="#slist-in-meta">6.3.2 <code>slist</code></a>
</li></ul>
<li><a href="#reports-in-common-promises">6.4 <code>reports</code> promises in &lsquo;<samp><span class="samp">*</span></samp>&rsquo;</a>
<ul>
<li><a href="#friend_005fpattern-in-reports">6.4.1 <code>friend_pattern</code></a>
<li><a href="#intermittency-in-reports">6.4.2 <code>intermittency</code></a>
<li><a href="#lastseen-in-reports">6.4.3 <code>lastseen</code></a>
<li><a href="#printfile-in-reports">6.4.4 <code>printfile</code> (body template)</a>
<li><a href="#report_005fto_005ffile-in-reports">6.4.5 <code>report_to_file</code></a>
<li><a href="#bundle_005freturn_005fvalue_005findex-in-reports">6.4.6 <code>bundle_return_value_index</code></a>
<li><a href="#showstate-in-reports">6.4.7 <code>showstate</code></a>
</li></ul>
<li><a href="#vars-in-common-promises">6.5 <code>vars</code> promises in &lsquo;<samp><span class="samp">*</span></samp>&rsquo;</a>
<ul>
<li><a href="#string-in-vars">6.5.1 <code>string</code></a>
<li><a href="#int-in-vars">6.5.2 <code>int</code></a>
<li><a href="#real-in-vars">6.5.3 <code>real</code></a>
<li><a href="#slist-in-vars">6.5.4 <code>slist</code></a>
<li><a href="#ilist-in-vars">6.5.5 <code>ilist</code></a>
<li><a href="#rlist-in-vars">6.5.6 <code>rlist</code></a>
<li><a href="#policy-in-vars">6.5.7 <code>policy</code></a>
</li></ul>
<li><a href="#Miscellaneous-in-common-promises">6.6 <code>*</code> promises</a>
<ul>
<li><a href="#action-in-_002a">6.6.1 <code>action</code> (body template)</a>
<li><a href="#classes-in-_002a">6.6.2 <code>classes</code> (body template)</a>
<li><a href="#comment-in-_002a">6.6.3 <code>comment</code></a>
<li><a href="#depends_005fon-in-_002a">6.6.4 <code>depends_on</code></a>
<li><a href="#handle-in-_002a">6.6.5 <code>handle</code></a>
<li><a href="#ifvarclass-in-_002a">6.6.6 <code>ifvarclass</code></a>
<li><a href="#meta-in-_002a">6.6.7 <code>meta</code></a>
</li></ul>
</li></ul>
<li><a name="toc_Bundles-for-agent" href="#Bundles-for-agent">7 Bundles of <code>agent</code></a>
<ul>
<li><a href="#commands-in-agent-promises">7.1 <code>commands</code> promises in &lsquo;<samp><span class="samp">agent</span></samp>&rsquo;</a>
<ul>
<li><a href="#args-in-commands">7.1.1 <code>args</code></a>
<li><a href="#contain-in-commands">7.1.2 <code>contain</code> (body template)</a>
<li><a href="#module-in-commands">7.1.3 <code>module</code></a>
</li></ul>
<li><a href="#databases-in-agent-promises">7.2 <code>databases</code> promises in &lsquo;<samp><span class="samp">agent</span></samp>&rsquo;</a>
<ul>
<li><a href="#database_005fserver-in-databases">7.2.1 <code>database_server</code> (body template)</a>
<li><a href="#database_005ftype-in-databases">7.2.2 <code>database_type</code></a>
<li><a href="#database_005foperation-in-databases">7.2.3 <code>database_operation</code></a>
<li><a href="#database_005fcolumns-in-databases">7.2.4 <code>database_columns</code></a>
<li><a href="#database_005frows-in-databases">7.2.5 <code>database_rows</code></a>
<li><a href="#registry_005fexclude-in-databases">7.2.6 <code>registry_exclude</code></a>
</li></ul>
<li><a href="#guest_005fenvironments-in-agent-promises">7.3 <code>guest_environments</code> promises in &lsquo;<samp><span class="samp">agent</span></samp>&rsquo;</a>
<ul>
<li><a href="#environment_005fhost-in-guest_005fenvironments">7.3.1 <code>environment_host</code></a>
<li><a href="#environment_005finterface-in-guest_005fenvironments">7.3.2 <code>environment_interface</code> (body template)</a>
<li><a href="#environment_005fresources-in-guest_005fenvironments">7.3.3 <code>environment_resources</code> (body template)</a>
<li><a href="#environment_005fstate-in-guest_005fenvironments">7.3.4 <code>environment_state</code></a>
<li><a href="#environment_005ftype-in-guest_005fenvironments">7.3.5 <code>environment_type</code></a>
</li></ul>
<li><a href="#files-in-agent-promises">7.4 <code>files</code> promises in &lsquo;<samp><span class="samp">agent</span></samp>&rsquo;</a>
<ul>
<li><a href="#acl-in-files">7.4.1 <code>acl</code> (body template)</a>
<li><a href="#changes-in-files">7.4.2 <code>changes</code> (body template)</a>
<li><a href="#copy_005ffrom-in-files">7.4.3 <code>copy_from</code> (body template)</a>
<li><a href="#create-in-files">7.4.4 <code>create</code></a>
<li><a href="#delete-in-files">7.4.5 <code>delete</code> (body template)</a>
<li><a href="#depth_005fsearch-in-files">7.4.6 <code>depth_search</code> (body template)</a>
<li><a href="#edit_005fdefaults-in-files">7.4.7 <code>edit_defaults</code> (body template)</a>
<li><a href="#edit_005fline-in-files">7.4.8 <code>edit_line</code></a>
<li><a href="#edit_005ftemplate-in-files">7.4.9 <code>edit_template</code></a>
<li><a href="#edit_005fxml-in-files">7.4.10 <code>edit_xml</code></a>
<li><a href="#file_005fselect-in-files">7.4.11 <code>file_select</code> (body template)</a>
<li><a href="#link_005ffrom-in-files">7.4.12 <code>link_from</code> (body template)</a>
<li><a href="#move_005fobstructions-in-files">7.4.13 <code>move_obstructions</code></a>
<li><a href="#pathtype-in-files">7.4.14 <code>pathtype</code></a>
<li><a href="#perms-in-files">7.4.15 <code>perms</code> (body template)</a>
<li><a href="#rename-in-files">7.4.16 <code>rename</code> (body template)</a>
<li><a href="#repository-in-files">7.4.17 <code>repository</code></a>
<li><a href="#touch-in-files">7.4.18 <code>touch</code></a>
<li><a href="#transformer-in-files">7.4.19 <code>transformer</code></a>
</li></ul>
<li><a href="#Miscellaneous-in-edit_005fline-promises">7.5 Miscelleneous in <code>edit_line</code> promises</a>
<ul>
<li><a href="#select_005fregion-in-_002a">7.5.1 <code>select_region</code> (body template)</a>
</li></ul>
<li><a href="#delete_005flines-in-edit_005fline-promises">7.6 <code>delete_lines</code> promises in &lsquo;<samp><span class="samp">edit_line</span></samp>&rsquo;</a>
<ul>
<li><a href="#delete_005fselect-in-delete_005flines">7.6.1 <code>delete_select</code> (body template)</a>
<li><a href="#not_005fmatching-in-delete_005flines">7.6.2 <code>not_matching</code></a>
</li></ul>
<li><a href="#insert_005flines-in-edit_005fline-promises">7.7 <code>insert_lines</code> promises in &lsquo;<samp><span class="samp">edit_line</span></samp>&rsquo;</a>
<ul>
<li><a href="#expand_005fscalars-in-insert_005flines">7.7.1 <code>expand_scalars</code></a>
<li><a href="#insert_005ftype-in-insert_005flines">7.7.2 <code>insert_type</code></a>
<li><a href="#insert_005fselect-in-insert_005flines">7.7.3 <code>insert_select</code> (body template)</a>
<li><a href="#location-in-insert_005flines">7.7.4 <code>location</code> (body template)</a>
<li><a href="#whitespace_005fpolicy-in-insert_005flines">7.7.5 <code>whitespace_policy</code></a>
</li></ul>
<li><a href="#field_005fedits-in-edit_005fline-promises">7.8 <code>field_edits</code> promises in &lsquo;<samp><span class="samp">edit_line</span></samp>&rsquo;</a>
<ul>
<li><a href="#edit_005ffield-in-field_005fedits">7.8.1 <code>edit_field</code> (body template)</a>
</li></ul>
<li><a href="#replace_005fpatterns-in-edit_005fline-promises">7.9 <code>replace_patterns</code> promises in &lsquo;<samp><span class="samp">edit_line</span></samp>&rsquo;</a>
<ul>
<li><a href="#replace_005fwith-in-replace_005fpatterns">7.9.1 <code>replace_with</code> (body template)</a>
</li></ul>
<li><a href="#Miscellaneous-in-edit_005fxml-promises">7.10 Miscelleneous in <code>edit_xml</code> promises</a>
<ul>
<li><a href="#build_005fxpath-in-_002a">7.10.1 <code>build_xpath</code></a>
<li><a href="#select_005fxpath-in-_002a">7.10.2 <code>select_xpath</code></a>
</li></ul>
<li><a href="#build_005fxpath-in-edit_005fxml-promises">7.11 <code>build_xpath</code> promises in &lsquo;<samp><span class="samp">edit_xml</span></samp>&rsquo;</a>
<li><a href="#delete_005ftree-in-edit_005fxml-promises">7.12 <code>delete_tree</code> promises in &lsquo;<samp><span class="samp">edit_xml</span></samp>&rsquo;</a>
<li><a href="#insert_005ftree-in-edit_005fxml-promises">7.13 <code>insert_tree</code> promises in &lsquo;<samp><span class="samp">edit_xml</span></samp>&rsquo;</a>
<li><a href="#delete_005fattribute-in-edit_005fxml-promises">7.14 <code>delete_attribute</code> promises in &lsquo;<samp><span class="samp">edit_xml</span></samp>&rsquo;</a>
<li><a href="#set_005fattribute-in-edit_005fxml-promises">7.15 <code>set_attribute</code> promises in &lsquo;<samp><span class="samp">edit_xml</span></samp>&rsquo;</a>
<ul>
<li><a href="#attribute_005fvalue-in-set_005fattribute">7.15.1 <code>attribute_value</code></a>
</li></ul>
<li><a href="#delete_005ftext-in-edit_005fxml-promises">7.16 <code>delete_text</code> promises in &lsquo;<samp><span class="samp">edit_xml</span></samp>&rsquo;</a>
<li><a href="#set_005ftext-in-edit_005fxml-promises">7.17 <code>set_text</code> promises in &lsquo;<samp><span class="samp">edit_xml</span></samp>&rsquo;</a>
<li><a href="#insert_005ftext-in-edit_005fxml-promises">7.18 <code>insert_text</code> promises in &lsquo;<samp><span class="samp">edit_xml</span></samp>&rsquo;</a>
<li><a href="#interfaces-in-agent-promises">7.19 <code>interfaces</code> promises in &lsquo;<samp><span class="samp">agent</span></samp>&rsquo;</a>
<ul>
<li><a href="#tcp_005fip-in-interfaces">7.19.1 <code>tcp_ip</code> (body template)</a>
</li></ul>
<li><a href="#methods-in-agent-promises">7.20 <code>methods</code> promises in &lsquo;<samp><span class="samp">agent</span></samp>&rsquo;</a>
<ul>
<li><a href="#inherit-in-methods">7.20.1 <code>inherit</code></a>
<li><a href="#usebundle-in-methods">7.20.2 <code>usebundle</code></a>
<li><a href="#useresult-in-methods">7.20.3 <code>useresult</code></a>
</li></ul>
<li><a href="#outputs-in-agent-promises">7.21 <code>outputs</code> promises in &lsquo;<samp><span class="samp">agent</span></samp>&rsquo;</a>
<ul>
<li><a href="#output_005flevel-in-outputs">7.21.1 <code>output_level</code></a>
<li><a href="#promiser_005ftype-in-outputs">7.21.2 <code>promiser_type</code></a>
</li></ul>
<li><a href="#packages-in-agent-promises">7.22 <code>packages</code> promises in &lsquo;<samp><span class="samp">agent</span></samp>&rsquo;</a>
<ul>
<li><a href="#package_005farchitectures-in-packages">7.22.1 <code>package_architectures</code></a>
<li><a href="#package_005fmethod-in-packages">7.22.2 <code>package_method</code> (body template)</a>
<li><a href="#package_005fpolicy-in-packages">7.22.3 <code>package_policy</code></a>
<li><a href="#package_005fselect-in-packages">7.22.4 <code>package_select</code></a>
<li><a href="#package_005fversion-in-packages">7.22.5 <code>package_version</code></a>
</li></ul>
<li><a href="#processes-in-agent-promises">7.23 <code>processes</code> promises in &lsquo;<samp><span class="samp">agent</span></samp>&rsquo;</a>
<ul>
<li><a href="#process_005fcount-in-processes">7.23.1 <code>process_count</code> (body template)</a>
<li><a href="#process_005fselect-in-processes">7.23.2 <code>process_select</code> (body template)</a>
<li><a href="#process_005fstop-in-processes">7.23.3 <code>process_stop</code></a>
<li><a href="#restart_005fclass-in-processes">7.23.4 <code>restart_class</code></a>
<li><a href="#signals-in-processes">7.23.5 <code>signals</code></a>
</li></ul>
<li><a href="#services-in-agent-promises">7.24 <code>services</code> promises in &lsquo;<samp><span class="samp">agent</span></samp>&rsquo;</a>
<ul>
<li><a href="#service_005fpolicy-in-services">7.24.1 <code>service_policy</code></a>
<li><a href="#service_005fdependencies-in-services">7.24.2 <code>service_dependencies</code></a>
<li><a href="#service_005fmethod-in-services">7.24.3 <code>service_method</code> (body template)</a>
</li></ul>
<li><a href="#storage-in-agent-promises">7.25 <code>storage</code> promises in &lsquo;<samp><span class="samp">agent</span></samp>&rsquo;</a>
<ul>
<li><a href="#mount-in-storage">7.25.1 <code>mount</code> (body template)</a>
<li><a href="#volume-in-storage">7.25.2 <code>volume</code> (body template)</a>
</li></ul>
</li></ul>
<li><a name="toc_Bundles-for-server" href="#Bundles-for-server">8 Bundles of <code>server</code></a>
<ul>
<li><a href="#access-in-server-promises">8.1 <code>access</code> promises in &lsquo;<samp><span class="samp">server</span></samp>&rsquo;</a>
<ul>
<li><a href="#admit-in-access">8.1.1 <code>admit</code></a>
<li><a href="#deny-in-access">8.1.2 <code>deny</code></a>
<li><a href="#maproot-in-access">8.1.3 <code>maproot</code></a>
<li><a href="#ifencrypted-in-access">8.1.4 <code>ifencrypted</code></a>
<li><a href="#resource_005ftype-in-access">8.1.5 <code>resource_type</code></a>
</li></ul>
<li><a href="#roles-in-server-promises">8.2 <code>roles</code> promises in &lsquo;<samp><span class="samp">server</span></samp>&rsquo;</a>
<ul>
<li><a href="#authorize-in-roles">8.2.1 <code>authorize</code></a>
</li></ul>
</li></ul>
<li><a name="toc_Bundles-for-knowledge" href="#Bundles-for-knowledge">9 Bundles of <code>knowledge</code></a>
<ul>
<li><a href="#inferences-in-knowledge-promises">9.1 <code>inferences</code> promises in &lsquo;<samp><span class="samp">knowledge</span></samp>&rsquo;</a>
<ul>
<li><a href="#precedents-in-inferences">9.1.1 <code>precedents</code></a>
<li><a href="#qualifiers-in-inferences">9.1.2 <code>qualifiers</code></a>
</li></ul>
<li><a href="#things-in-knowledge-promises">9.2 <code>things</code> promises in &lsquo;<samp><span class="samp">knowledge</span></samp>&rsquo;</a>
<ul>
<li><a href="#synonyms-in-things">9.2.1 <code>synonyms</code></a>
<li><a href="#affects-in-things">9.2.2 <code>affects</code></a>
<li><a href="#belongs_005fto-in-things">9.2.3 <code>belongs_to</code></a>
<li><a href="#causes-in-things">9.2.4 <code>causes</code></a>
<li><a href="#certainty-in-things">9.2.5 <code>certainty</code></a>
<li><a href="#determines-in-things">9.2.6 <code>determines</code></a>
<li><a href="#generalizations-in-things">9.2.7 <code>generalizations</code></a>
<li><a href="#implements-in-things">9.2.8 <code>implements</code></a>
<li><a href="#involves-in-things">9.2.9 <code>involves</code></a>
<li><a href="#is_005fcaused_005fby-in-things">9.2.10 <code>is_caused_by</code></a>
<li><a href="#is_005fconnected_005fto-in-things">9.2.11 <code>is_connected_to</code></a>
<li><a href="#is_005fdetermined_005fby-in-things">9.2.12 <code>is_determined_by</code></a>
<li><a href="#is_005ffollowed_005fby-in-things">9.2.13 <code>is_followed_by</code></a>
<li><a href="#is_005fimplemented_005fby-in-things">9.2.14 <code>is_implemented_by</code></a>
<li><a href="#is_005flocated_005fin-in-things">9.2.15 <code>is_located_in</code></a>
<li><a href="#is_005fmeasured_005fby-in-things">9.2.16 <code>is_measured_by</code></a>
<li><a href="#is_005fpart_005fof-in-things">9.2.17 <code>is_part_of</code></a>
<li><a href="#is_005fpreceded_005fby-in-things">9.2.18 <code>is_preceded_by</code></a>
<li><a href="#measures-in-things">9.2.19 <code>measures</code></a>
<li><a href="#needs-in-things">9.2.20 <code>needs</code></a>
<li><a href="#provides-in-things">9.2.21 <code>provides</code></a>
<li><a href="#uses-in-things">9.2.22 <code>uses</code></a>
</li></ul>
<li><a href="#topics-in-knowledge-promises">9.3 <code>topics</code> promises in &lsquo;<samp><span class="samp">knowledge</span></samp>&rsquo;</a>
<ul>
<li><a href="#association-in-topics">9.3.1 <code>association</code> (body template)</a>
<li><a href="#synonyms-in-topics">9.3.2 <code>synonyms</code></a>
<li><a href="#generalizations-in-topics">9.3.3 <code>generalizations</code></a>
</li></ul>
<li><a href="#occurrences-in-knowledge-promises">9.4 <code>occurrences</code> promises in &lsquo;<samp><span class="samp">knowledge</span></samp>&rsquo;</a>
<ul>
<li><a href="#about_005ftopics-in-occurrences">9.4.1 <code>about_topics</code></a>
<li><a href="#represents-in-occurrences">9.4.2 <code>represents</code></a>
<li><a href="#representation-in-occurrences">9.4.3 <code>representation</code></a>
</li></ul>
</li></ul>
<li><a name="toc_Bundles-for-monitor" href="#Bundles-for-monitor">10 Bundles of <code>monitor</code></a>
<ul>
<li><a href="#measurements-in-monitor-promises">10.1 <code>measurements</code> promises in &lsquo;<samp><span class="samp">monitor</span></samp>&rsquo;</a>
<ul>
<li><a href="#stream_005ftype-in-measurements">10.1.1 <code>stream_type</code></a>
<li><a href="#data_005ftype-in-measurements">10.1.2 <code>data_type</code></a>
<li><a href="#history_005ftype-in-measurements">10.1.3 <code>history_type</code></a>
<li><a href="#units-in-measurements">10.1.4 <code>units</code></a>
<li><a href="#match_005fvalue-in-measurements">10.1.5 <code>match_value</code> (body template)</a>
</li></ul>
</li></ul>
<li><a name="toc_Special-functions" href="#Special-functions">11 Special functions</a>
<ul>
<li><a href="#Introduction-to-functions">11.1 Introduction to functions</a>
<ul>
<li><a href="#Introduction-to-functions">11.1.1 Functions listed by return value</a>
<ul>
<li><a href="#Introduction-to-functions">Functions which return class</a>
<li><a href="#Introduction-to-functions">Functions which return (i,r,s)list</a>
<li><a href="#Introduction-to-functions">Functions which return int</a>
<li><a href="#Introduction-to-functions">Functions which return (i,r)range</a>
<li><a href="#Introduction-to-functions">Functions which return real</a>
<li><a href="#Introduction-to-functions">Functions which return string</a>
</li></ul>
<li><a href="#Introduction-to-functions">11.1.2 Functions which fill arrays</a>
<li><a href="#Introduction-to-functions">11.1.3 Functions which read &ldquo;large&rdquo; data</a>
<ul>
<li><a href="#Introduction-to-functions">Functions which read arrays</a>
<li><a href="#Introduction-to-functions">Functions which read disk data</a>
<li><a href="#Introduction-to-functions">Functions which read from a remote-CFEngine</a>
<li><a href="#Introduction-to-functions">Functions which read classes</a>
<li><a href="#Introduction-to-functions">Functions which read command output</a>
<li><a href="#Introduction-to-functions">Functions which read the environment</a>
<li><a href="#Introduction-to-functions">Functions which read files</a>
<li><a href="#Introduction-to-functions">Functions which read LDAP data</a>
<li><a href="#Introduction-to-functions">Functions which read from the network</a>
<li><a href="#Introduction-to-functions">Functions which read the Windows registry</a>
<li><a href="#Introduction-to-functions">Functions which read (i,r,s)lists</a>
<li><a href="#Introduction-to-functions">Functions which read strings</a>
</li></ul>
<li><a href="#Introduction-to-functions">11.1.4 Functions which look at file metadata</a>
<li><a href="#Introduction-to-functions">11.1.5 Functions which look at variables</a>
<li><a href="#Introduction-to-functions">11.1.6 Functions involving date or time</a>
<li><a href="#Introduction-to-functions">11.1.7 Functions which work with or on regular expressions</a>
</li></ul>
<li><a href="#Function-accessedbefore">11.2 Function accessedbefore</a>
<li><a href="#Function-accumulated">11.3 Function accumulated</a>
<li><a href="#Function-ago">11.4 Function ago</a>
<li><a href="#Function-and">11.5 Function and</a>
<li><a href="#Function-canonify">11.6 Function canonify</a>
<li><a href="#Function-concat">11.7 Function concat</a>
<li><a href="#Function-changedbefore">11.8 Function changedbefore</a>
<li><a href="#Function-classify">11.9 Function classify</a>
<li><a href="#Function-classmatch">11.10 Function classmatch</a>
<li><a href="#Function-countclassesmatching">11.11 Function countclassesmatching</a>
<li><a href="#Function-countlinesmatching">11.12 Function countlinesmatching</a>
<li><a href="#Function-dirname">11.13 Function dirname</a>
<li><a href="#Function-diskfree">11.14 Function diskfree</a>
<li><a href="#Function-escape">11.15 Function escape</a>
<li><a href="#Function-execresult">11.16 Function execresult</a>
<li><a href="#Function-fileexists">11.17 Function fileexists</a>
<li><a href="#Function-filesexist">11.18 Function filesexist</a>
<li><a href="#Function-filesize">11.19 Function filesize</a>
<li><a href="#Function-getenv">11.20 Function getenv</a>
<li><a href="#Function-getfields">11.21 Function getfields</a>
<li><a href="#Function-getgid">11.22 Function getgid</a>
<li><a href="#Function-getindices">11.23 Function getindices</a>
<li><a href="#Function-getuid">11.24 Function getuid</a>
<li><a href="#Function-getusers">11.25 Function getusers</a>
<li><a href="#Function-getvalues">11.26 Function getvalues</a>
<li><a href="#Function-grep">11.27 Function grep</a>
<li><a href="#Function-groupexists">11.28 Function groupexists</a>
<li><a href="#Function-hash">11.29 Function hash</a>
<li><a href="#Function-hashmatch">11.30 Function hashmatch</a>
<li><a href="#Function-host2ip">11.31 Function host2ip</a>
<li><a href="#Function-ip2host">11.32 Function ip2host</a>
<li><a href="#Function-hostinnetgroup">11.33 Function hostinnetgroup</a>
<li><a href="#Function-hostrange">11.34 Function hostrange</a>
<li><a href="#Function-hostsseen">11.35 Function hostsseen</a>
<li><a href="#Function-hostswithclass">11.36 Function hostswithclass</a>
<li><a href="#Function-hubknowledge">11.37 Function hubknowledge</a>
<li><a href="#Function-iprange">11.38 Function iprange</a>
<li><a href="#Function-irange">11.39 Function irange</a>
<li><a href="#Function-isdir">11.40 Function isdir</a>
<li><a href="#Function-isexecutable">11.41 Function isexecutable</a>
<li><a href="#Function-isgreaterthan">11.42 Function isgreaterthan</a>
<li><a href="#Function-islessthan">11.43 Function islessthan</a>
<li><a href="#Function-islink">11.44 Function islink</a>
<li><a href="#Function-isnewerthan">11.45 Function isnewerthan</a>
<li><a href="#Function-isplain">11.46 Function isplain</a>
<li><a href="#Function-isvariable">11.47 Function isvariable</a>
<li><a href="#Function-join">11.48 Function join</a>
<li><a href="#Function-lastnode">11.49 Function lastnode</a>
<li><a href="#Function-laterthan">11.50 Function laterthan</a>
<li><a href="#Function-ldaparray">11.51 Function ldaparray</a>
<li><a href="#Function-ldaplist">11.52 Function ldaplist</a>
<li><a href="#Function-ldapvalue">11.53 Function ldapvalue</a>
<li><a href="#Function-lsdir">11.54 Function lsdir</a>
<li><a href="#Function-maplist">11.55 Function maplist</a>
<li><a href="#Function-not">11.56 Function not</a>
<li><a href="#Function-now">11.57 Function now</a>
<li><a href="#Function-on">11.58 Function on</a>
<li><a href="#Function-or">11.59 Function or</a>
<li><a href="#Function-parseintarray">11.60 Function parseintarray</a>
<li><a href="#Function-parserealarray">11.61 Function parserealarray</a>
<li><a href="#Function-parsestringarray">11.62 Function parsestringarray</a>
<li><a href="#Function-parsestringarrayidx">11.63 Function parsestringarrayidx</a>
<li><a href="#Function-peers">11.64 Function peers</a>
<li><a href="#Function-peerleader">11.65 Function peerleader</a>
<li><a href="#Function-peerleaders">11.66 Function peerleaders</a>
<li><a href="#Function-product">11.67 Function product</a>
<li><a href="#Function-randomint">11.68 Function randomint</a>
<li><a href="#Function-readfile">11.69 Function readfile</a>
<li><a href="#Function-readintarray">11.70 Function readintarray</a>
<li><a href="#Function-readintlist">11.71 Function readintlist</a>
<li><a href="#Function-readrealarray">11.72 Function readrealarray</a>
<li><a href="#Function-readreallist">11.73 Function readreallist</a>
<li><a href="#Function-readstringarray">11.74 Function readstringarray</a>
<li><a href="#Function-readstringarrayidx">11.75 Function readstringarrayidx</a>
<li><a href="#Function-readstringlist">11.76 Function readstringlist</a>
<li><a href="#Function-readtcp">11.77 Function readtcp</a>
<li><a href="#Function-regarray">11.78 Function regarray</a>
<li><a href="#Function-regcmp">11.79 Function regcmp</a>
<li><a href="#Function-regextract">11.80 Function regextract</a>
<li><a href="#Function-registryvalue">11.81 Function registryvalue</a>
<li><a href="#Function-regline">11.82 Function regline</a>
<li><a href="#Function-reglist">11.83 Function reglist</a>
<li><a href="#Function-regldap">11.84 Function regldap</a>
<li><a href="#Function-remotescalar">11.85 Function remotescalar</a>
<li><a href="#Function-remoteclassesmatching">11.86 Function remoteclassesmatching</a>
<li><a href="#Function-returnszero">11.87 Function returnszero</a>
<li><a href="#Function-rrange">11.88 Function rrange</a>
<li><a href="#Function-selectservers">11.89 Function selectservers</a>
<li><a href="#Function-splayclass">11.90 Function splayclass</a>
<li><a href="#Function-splitstring">11.91 Function splitstring</a>
<li><a href="#Function-strcmp">11.92 Function strcmp</a>
<li><a href="#Function-sum">11.93 Function sum</a>
<li><a href="#Function-translatepath">11.94 Function translatepath</a>
<li><a href="#Function-usemodule">11.95 Function usemodule</a>
<li><a href="#Function-userexists">11.96 Function userexists</a>
</li></ul>
<li><a name="toc_Special-Variables" href="#Special-Variables">12 Special Variables</a>
<ul>
<li><a href="#Variable-context-const">12.1 Variable context <code>const</code></a>
<ul>
<li><a href="#Variable-const_002edollar">12.1.1 Variable const.dollar</a>
<li><a href="#Variable-const_002eendl">12.1.2 Variable const.endl</a>
<li><a href="#Variable-const_002en">12.1.3 Variable const.n</a>
<li><a href="#Variable-const_002er">12.1.4 Variable const.r</a>
<li><a href="#Variable-const_002et">12.1.5 Variable const.t</a>
</li></ul>
<li><a href="#Variable-context-edit">12.2 Variable context <code>edit</code></a>
<ul>
<li><a href="#Variable-edit_002efilename">12.2.1 Variable edit.filename</a>
</li></ul>
<li><a href="#Variable-context-match">12.3 Variable context <code>match</code></a>
<ul>
<li><a href="#Variable-match_002e0">12.3.1 Variable match.0</a>
</li></ul>
<li><a href="#Variable-context-mon">12.4 Variable context <code>mon</code></a>
<ul>
<li><a href="#Variable-mon_002elistening_005fudp4_005fports">12.4.1 Variable mon.listening_udp4_ports</a>
<li><a href="#Variable-mon_002elistening_005ftcp4_005fports">12.4.2 Variable mon.listening_tcp4_ports</a>
<li><a href="#Variable-mon_002elistening_005fudp6_005fports">12.4.3 Variable mon.listening_udp6_ports</a>
<li><a href="#Variable-mon_002elistening_005ftcp6_005fports">12.4.4 Variable mon.listening_tcp6_ports</a>
<li><a href="#Variable-mon_002evalue_005fusers">12.4.5 Variable mon.value_users</a>
<li><a href="#Variable-mon_002eav_005fusers">12.4.6 Variable mon.av_users</a>
<li><a href="#Variable-mon_002edev_005fusers">12.4.7 Variable mon.dev_users</a>
<li><a href="#Variable-mon_002evalue_005frootprocs">12.4.8 Variable mon.value_rootprocs</a>
<li><a href="#Variable-mon_002eav_005frootprocs">12.4.9 Variable mon.av_rootprocs</a>
<li><a href="#Variable-mon_002edev_005frootprocs">12.4.10 Variable mon.dev_rootprocs</a>
<li><a href="#Variable-mon_002evalue_005fotherprocs">12.4.11 Variable mon.value_otherprocs</a>
<li><a href="#Variable-mon_002eav_005fotherprocs">12.4.12 Variable mon.av_otherprocs</a>
<li><a href="#Variable-mon_002edev_005fotherprocs">12.4.13 Variable mon.dev_otherprocs</a>
<li><a href="#Variable-mon_002evalue_005fdiskfree">12.4.14 Variable mon.value_diskfree</a>
<li><a href="#Variable-mon_002eav_005fdiskfree">12.4.15 Variable mon.av_diskfree</a>
<li><a href="#Variable-mon_002edev_005fdiskfree">12.4.16 Variable mon.dev_diskfree</a>
<li><a href="#Variable-mon_002evalue_005floadavg">12.4.17 Variable mon.value_loadavg</a>
<li><a href="#Variable-mon_002eav_005floadavg">12.4.18 Variable mon.av_loadavg</a>
<li><a href="#Variable-mon_002edev_005floadavg">12.4.19 Variable mon.dev_loadavg</a>
<li><a href="#Variable-mon_002evalue_005fnetbiosns_005fin">12.4.20 Variable mon.value_netbiosns_in</a>
<li><a href="#Variable-mon_002eav_005fnetbiosns_005fin">12.4.21 Variable mon.av_netbiosns_in</a>
<li><a href="#Variable-mon_002edev_005fnetbiosns_005fin">12.4.22 Variable mon.dev_netbiosns_in</a>
<li><a href="#Variable-mon_002evalue_005fnetbiosns_005fout">12.4.23 Variable mon.value_netbiosns_out</a>
<li><a href="#Variable-mon_002eav_005fnetbiosns_005fout">12.4.24 Variable mon.av_netbiosns_out</a>
<li><a href="#Variable-mon_002edev_005fnetbiosns_005fout">12.4.25 Variable mon.dev_netbiosns_out</a>
<li><a href="#Variable-mon_002evalue_005fnetbiosdgm_005fin">12.4.26 Variable mon.value_netbiosdgm_in</a>
<li><a href="#Variable-mon_002eav_005fnetbiosdgm_005fin">12.4.27 Variable mon.av_netbiosdgm_in</a>
<li><a href="#Variable-mon_002edev_005fnetbiosdgm_005fin">12.4.28 Variable mon.dev_netbiosdgm_in</a>
<li><a href="#Variable-mon_002evalue_005fnetbiosdgm_005fout">12.4.29 Variable mon.value_netbiosdgm_out</a>
<li><a href="#Variable-mon_002eav_005fnetbiosdgm_005fout">12.4.30 Variable mon.av_netbiosdgm_out</a>
<li><a href="#Variable-mon_002edev_005fnetbiosdgm_005fout">12.4.31 Variable mon.dev_netbiosdgm_out</a>
<li><a href="#Variable-mon_002evalue_005fnetbiosssn_005fin">12.4.32 Variable mon.value_netbiosssn_in</a>
<li><a href="#Variable-mon_002eav_005fnetbiosssn_005fin">12.4.33 Variable mon.av_netbiosssn_in</a>
<li><a href="#Variable-mon_002edev_005fnetbiosssn_005fin">12.4.34 Variable mon.dev_netbiosssn_in</a>
<li><a href="#Variable-mon_002evalue_005fnetbiosssn_005fout">12.4.35 Variable mon.value_netbiosssn_out</a>
<li><a href="#Variable-mon_002eav_005fnetbiosssn_005fout">12.4.36 Variable mon.av_netbiosssn_out</a>
<li><a href="#Variable-mon_002edev_005fnetbiosssn_005fout">12.4.37 Variable mon.dev_netbiosssn_out</a>
<li><a href="#Variable-mon_002evalue_005fimap_005fin">12.4.38 Variable mon.value_imap_in</a>
<li><a href="#Variable-mon_002eav_005fimap_005fin">12.4.39 Variable mon.av_imap_in</a>
<li><a href="#Variable-mon_002edev_005fimap_005fin">12.4.40 Variable mon.dev_imap_in</a>
<li><a href="#Variable-mon_002evalue_005fimap_005fout">12.4.41 Variable mon.value_imap_out</a>
<li><a href="#Variable-mon_002eav_005fimap_005fout">12.4.42 Variable mon.av_imap_out</a>
<li><a href="#Variable-mon_002edev_005fimap_005fout">12.4.43 Variable mon.dev_imap_out</a>
<li><a href="#Variable-mon_002evalue_005fcfengine_005fin">12.4.44 Variable mon.value_cfengine_in</a>
<li><a href="#Variable-mon_002eav_005fcfengine_005fin">12.4.45 Variable mon.av_cfengine_in</a>
<li><a href="#Variable-mon_002edev_005fcfengine_005fin">12.4.46 Variable mon.dev_cfengine_in</a>
<li><a href="#Variable-mon_002evalue_005fcfengine_005fout">12.4.47 Variable mon.value_cfengine_out</a>
<li><a href="#Variable-mon_002eav_005fcfengine_005fout">12.4.48 Variable mon.av_cfengine_out</a>
<li><a href="#Variable-mon_002edev_005fcfengine_005fout">12.4.49 Variable mon.dev_cfengine_out</a>
<li><a href="#Variable-mon_002evalue_005fnfsd_005fin">12.4.50 Variable mon.value_nfsd_in</a>
<li><a href="#Variable-mon_002eav_005fnfsd_005fin">12.4.51 Variable mon.av_nfsd_in</a>
<li><a href="#Variable-mon_002edev_005fnfsd_005fin">12.4.52 Variable mon.dev_nfsd_in</a>
<li><a href="#Variable-mon_002evalue_005fnfsd_005fout">12.4.53 Variable mon.value_nfsd_out</a>
<li><a href="#Variable-mon_002eav_005fnfsd_005fout">12.4.54 Variable mon.av_nfsd_out</a>
<li><a href="#Variable-mon_002edev_005fnfsd_005fout">12.4.55 Variable mon.dev_nfsd_out</a>
<li><a href="#Variable-mon_002evalue_005fsmtp_005fin">12.4.56 Variable mon.value_smtp_in</a>
<li><a href="#Variable-mon_002eav_005fsmtp_005fin">12.4.57 Variable mon.av_smtp_in</a>
<li><a href="#Variable-mon_002edev_005fsmtp_005fin">12.4.58 Variable mon.dev_smtp_in</a>
<li><a href="#Variable-mon_002evalue_005fsmtp_005fout">12.4.59 Variable mon.value_smtp_out</a>
<li><a href="#Variable-mon_002eav_005fsmtp_005fout">12.4.60 Variable mon.av_smtp_out</a>
<li><a href="#Variable-mon_002edev_005fsmtp_005fout">12.4.61 Variable mon.dev_smtp_out</a>
<li><a href="#Variable-mon_002evalue_005fwww_005fin">12.4.62 Variable mon.value_www_in</a>
<li><a href="#Variable-mon_002eav_005fwww_005fin">12.4.63 Variable mon.av_www_in</a>
<li><a href="#Variable-mon_002edev_005fwww_005fin">12.4.64 Variable mon.dev_www_in</a>
<li><a href="#Variable-mon_002evalue_005fwww_005fout">12.4.65 Variable mon.value_www_out</a>
<li><a href="#Variable-mon_002eav_005fwww_005fout">12.4.66 Variable mon.av_www_out</a>
<li><a href="#Variable-mon_002edev_005fwww_005fout">12.4.67 Variable mon.dev_www_out</a>
<li><a href="#Variable-mon_002evalue_005fftp_005fin">12.4.68 Variable mon.value_ftp_in</a>
<li><a href="#Variable-mon_002eav_005fftp_005fin">12.4.69 Variable mon.av_ftp_in</a>
<li><a href="#Variable-mon_002edev_005fftp_005fin">12.4.70 Variable mon.dev_ftp_in</a>
<li><a href="#Variable-mon_002evalue_005fftp_005fout">12.4.71 Variable mon.value_ftp_out</a>
<li><a href="#Variable-mon_002eav_005fftp_005fout">12.4.72 Variable mon.av_ftp_out</a>
<li><a href="#Variable-mon_002edev_005fftp_005fout">12.4.73 Variable mon.dev_ftp_out</a>
<li><a href="#Variable-mon_002evalue_005fssh_005fin">12.4.74 Variable mon.value_ssh_in</a>
<li><a href="#Variable-mon_002eav_005fssh_005fin">12.4.75 Variable mon.av_ssh_in</a>
<li><a href="#Variable-mon_002edev_005fssh_005fin">12.4.76 Variable mon.dev_ssh_in</a>
<li><a href="#Variable-mon_002evalue_005fssh_005fout">12.4.77 Variable mon.value_ssh_out</a>
<li><a href="#Variable-mon_002eav_005fssh_005fout">12.4.78 Variable mon.av_ssh_out</a>
<li><a href="#Variable-mon_002edev_005fssh_005fout">12.4.79 Variable mon.dev_ssh_out</a>
<li><a href="#Variable-mon_002evalue_005fwwws_005fin">12.4.80 Variable mon.value_wwws_in</a>
<li><a href="#Variable-mon_002eav_005fwwws_005fin">12.4.81 Variable mon.av_wwws_in</a>
<li><a href="#Variable-mon_002edev_005fwwws_005fin">12.4.82 Variable mon.dev_wwws_in</a>
<li><a href="#Variable-mon_002evalue_005fwwws_005fout">12.4.83 Variable mon.value_wwws_out</a>
<li><a href="#Variable-mon_002eav_005fwwws_005fout">12.4.84 Variable mon.av_wwws_out</a>
<li><a href="#Variable-mon_002edev_005fwwws_005fout">12.4.85 Variable mon.dev_wwws_out</a>
<li><a href="#Variable-mon_002evalue_005ficmp_005fin">12.4.86 Variable mon.value_icmp_in</a>
<li><a href="#Variable-mon_002eav_005ficmp_005fin">12.4.87 Variable mon.av_icmp_in</a>
<li><a href="#Variable-mon_002edev_005ficmp_005fin">12.4.88 Variable mon.dev_icmp_in</a>
<li><a href="#Variable-mon_002evalue_005ficmp_005fout">12.4.89 Variable mon.value_icmp_out</a>
<li><a href="#Variable-mon_002eav_005ficmp_005fout">12.4.90 Variable mon.av_icmp_out</a>
<li><a href="#Variable-mon_002edev_005ficmp_005fout">12.4.91 Variable mon.dev_icmp_out</a>
<li><a href="#Variable-mon_002evalue_005fudp_005fin">12.4.92 Variable mon.value_udp_in</a>
<li><a href="#Variable-mon_002eav_005fudp_005fin">12.4.93 Variable mon.av_udp_in</a>
<li><a href="#Variable-mon_002edev_005fudp_005fin">12.4.94 Variable mon.dev_udp_in</a>
<li><a href="#Variable-mon_002evalue_005fudp_005fout">12.4.95 Variable mon.value_udp_out</a>
<li><a href="#Variable-mon_002eav_005fudp_005fout">12.4.96 Variable mon.av_udp_out</a>
<li><a href="#Variable-mon_002edev_005fudp_005fout">12.4.97 Variable mon.dev_udp_out</a>
<li><a href="#Variable-mon_002evalue_005fdns_005fin">12.4.98 Variable mon.value_dns_in</a>
<li><a href="#Variable-mon_002eav_005fdns_005fin">12.4.99 Variable mon.av_dns_in</a>
<li><a href="#Variable-mon_002edev_005fdns_005fin">12.4.100 Variable mon.dev_dns_in</a>
<li><a href="#Variable-mon_002evalue_005fdns_005fout">12.4.101 Variable mon.value_dns_out</a>
<li><a href="#Variable-mon_002eav_005fdns_005fout">12.4.102 Variable mon.av_dns_out</a>
<li><a href="#Variable-mon_002edev_005fdns_005fout">12.4.103 Variable mon.dev_dns_out</a>
<li><a href="#Variable-mon_002evalue_005ftcpsyn_005fin">12.4.104 Variable mon.value_tcpsyn_in</a>
<li><a href="#Variable-mon_002eav_005ftcpsyn_005fin">12.4.105 Variable mon.av_tcpsyn_in</a>
<li><a href="#Variable-mon_002edev_005ftcpsyn_005fin">12.4.106 Variable mon.dev_tcpsyn_in</a>
<li><a href="#Variable-mon_002evalue_005ftcpsyn_005fout">12.4.107 Variable mon.value_tcpsyn_out</a>
<li><a href="#Variable-mon_002eav_005ftcpsyn_005fout">12.4.108 Variable mon.av_tcpsyn_out</a>
<li><a href="#Variable-mon_002edev_005ftcpsyn_005fout">12.4.109 Variable mon.dev_tcpsyn_out</a>
<li><a href="#Variable-mon_002evalue_005ftcpack_005fin">12.4.110 Variable mon.value_tcpack_in</a>
<li><a href="#Variable-mon_002eav_005ftcpack_005fin">12.4.111 Variable mon.av_tcpack_in</a>
<li><a href="#Variable-mon_002edev_005ftcpack_005fin">12.4.112 Variable mon.dev_tcpack_in</a>
<li><a href="#Variable-mon_002evalue_005ftcpack_005fout">12.4.113 Variable mon.value_tcpack_out</a>
<li><a href="#Variable-mon_002eav_005ftcpack_005fout">12.4.114 Variable mon.av_tcpack_out</a>
<li><a href="#Variable-mon_002edev_005ftcpack_005fout">12.4.115 Variable mon.dev_tcpack_out</a>
<li><a href="#Variable-mon_002evalue_005ftcpfin_005fin">12.4.116 Variable mon.value_tcpfin_in</a>
<li><a href="#Variable-mon_002eav_005ftcpfin_005fin">12.4.117 Variable mon.av_tcpfin_in</a>
<li><a href="#Variable-mon_002edev_005ftcpfin_005fin">12.4.118 Variable mon.dev_tcpfin_in</a>
<li><a href="#Variable-mon_002evalue_005ftcpfin_005fout">12.4.119 Variable mon.value_tcpfin_out</a>
<li><a href="#Variable-mon_002eav_005ftcpfin_005fout">12.4.120 Variable mon.av_tcpfin_out</a>
<li><a href="#Variable-mon_002edev_005ftcpfin_005fout">12.4.121 Variable mon.dev_tcpfin_out</a>
<li><a href="#Variable-mon_002evalue_005ftcpmisc_005fin">12.4.122 Variable mon.value_tcpmisc_in</a>
<li><a href="#Variable-mon_002eav_005ftcpmisc_005fin">12.4.123 Variable mon.av_tcpmisc_in</a>
<li><a href="#Variable-mon_002edev_005ftcpmisc_005fin">12.4.124 Variable mon.dev_tcpmisc_in</a>
<li><a href="#Variable-mon_002evalue_005ftcpmisc_005fout">12.4.125 Variable mon.value_tcpmisc_out</a>
<li><a href="#Variable-mon_002eav_005ftcpmisc_005fout">12.4.126 Variable mon.av_tcpmisc_out</a>
<li><a href="#Variable-mon_002edev_005ftcpmisc_005fout">12.4.127 Variable mon.dev_tcpmisc_out</a>
<li><a href="#Variable-mon_002evalue_005fwebaccess">12.4.128 Variable mon.value_webaccess</a>
<li><a href="#Variable-mon_002eav_005fwebaccess">12.4.129 Variable mon.av_webaccess</a>
<li><a href="#Variable-mon_002edev_005fwebaccess">12.4.130 Variable mon.dev_webaccess</a>
<li><a href="#Variable-mon_002evalue_005fweberrors">12.4.131 Variable mon.value_weberrors</a>
<li><a href="#Variable-mon_002eav_005fweberrors">12.4.132 Variable mon.av_weberrors</a>
<li><a href="#Variable-mon_002edev_005fweberrors">12.4.133 Variable mon.dev_weberrors</a>
<li><a href="#Variable-mon_002evalue_005fsyslog">12.4.134 Variable mon.value_syslog</a>
<li><a href="#Variable-mon_002eav_005fsyslog">12.4.135 Variable mon.av_syslog</a>
<li><a href="#Variable-mon_002edev_005fsyslog">12.4.136 Variable mon.dev_syslog</a>
<li><a href="#Variable-mon_002evalue_005fmessages">12.4.137 Variable mon.value_messages</a>
<li><a href="#Variable-mon_002eav_005fmessages">12.4.138 Variable mon.av_messages</a>
<li><a href="#Variable-mon_002edev_005fmessages">12.4.139 Variable mon.dev_messages</a>
<li><a href="#Variable-mon_002evalue_005ftemp0">12.4.140 Variable mon.value_temp0</a>
<li><a href="#Variable-mon_002eav_005ftemp0">12.4.141 Variable mon.av_temp0</a>
<li><a href="#Variable-mon_002edev_005ftemp0">12.4.142 Variable mon.dev_temp0</a>
<li><a href="#Variable-mon_002evalue_005ftemp1">12.4.143 Variable mon.value_temp1</a>
<li><a href="#Variable-mon_002eav_005ftemp1">12.4.144 Variable mon.av_temp1</a>
<li><a href="#Variable-mon_002edev_005ftemp1">12.4.145 Variable mon.dev_temp1</a>
<li><a href="#Variable-mon_002evalue_005ftemp2">12.4.146 Variable mon.value_temp2</a>
<li><a href="#Variable-mon_002eav_005ftemp2">12.4.147 Variable mon.av_temp2</a>
<li><a href="#Variable-mon_002edev_005ftemp2">12.4.148 Variable mon.dev_temp2</a>
<li><a href="#Variable-mon_002evalue_005ftemp3">12.4.149 Variable mon.value_temp3</a>
<li><a href="#Variable-mon_002eav_005ftemp3">12.4.150 Variable mon.av_temp3</a>
<li><a href="#Variable-mon_002edev_005ftemp3">12.4.151 Variable mon.dev_temp3</a>
<li><a href="#Variable-mon_002evalue_005fcpu">12.4.152 Variable mon.value_cpu</a>
<li><a href="#Variable-mon_002eav_005fcpu">12.4.153 Variable mon.av_cpu</a>
<li><a href="#Variable-mon_002edev_005fcpu">12.4.154 Variable mon.dev_cpu</a>
<li><a href="#Variable-mon_002evalue_005fcpu0">12.4.155 Variable mon.value_cpu0</a>
<li><a href="#Variable-mon_002eav_005fcpu0">12.4.156 Variable mon.av_cpu0</a>
<li><a href="#Variable-mon_002edev_005fcpu0">12.4.157 Variable mon.dev_cpu0</a>
<li><a href="#Variable-mon_002evalue_005fcpu1">12.4.158 Variable mon.value_cpu1</a>
<li><a href="#Variable-mon_002eav_005fcpu1">12.4.159 Variable mon.av_cpu1</a>
<li><a href="#Variable-mon_002edev_005fcpu1">12.4.160 Variable mon.dev_cpu1</a>
<li><a href="#Variable-mon_002evalue_005fcpu2">12.4.161 Variable mon.value_cpu2</a>
<li><a href="#Variable-mon_002eav_005fcpu2">12.4.162 Variable mon.av_cpu2</a>
<li><a href="#Variable-mon_002edev_005fcpu2">12.4.163 Variable mon.dev_cpu2</a>
<li><a href="#Variable-mon_002evalue_005fcpu3">12.4.164 Variable mon.value_cpu3</a>
<li><a href="#Variable-mon_002eav_005fcpu3">12.4.165 Variable mon.av_cpu3</a>
<li><a href="#Variable-mon_002edev_005fcpu3">12.4.166 Variable mon.dev_cpu3</a>
<li><a href="#Variable-mon_002evalue_005fmicrosoft_005fds_005fin">12.4.167 Variable mon.value_microsoft_ds_in</a>
<li><a href="#Variable-mon_002eav_005fmicrosoft_005fds_005fin">12.4.168 Variable mon.av_microsoft_ds_in</a>
<li><a href="#Variable-mon_002edev_005fmicrosoft_005fds_005fin">12.4.169 Variable mon.dev_microsoft_ds_in</a>
<li><a href="#Variable-mon_002evalue_005fmicrosoft_005fds_005fout">12.4.170 Variable mon.value_microsoft_ds_out</a>
<li><a href="#Variable-mon_002eav_005fmicrosoft_005fds_005fout">12.4.171 Variable mon.av_microsoft_ds_out</a>
<li><a href="#Variable-mon_002edev_005fmicrosoft_005fds_005fout">12.4.172 Variable mon.dev_microsoft_ds_out</a>
<li><a href="#Variable-mon_002evalue_005fwww_005falt_005fin">12.4.173 Variable mon.value_www_alt_in</a>
<li><a href="#Variable-mon_002eav_005fwww_005falt_005fin">12.4.174 Variable mon.av_www_alt_in</a>
<li><a href="#Variable-mon_002edev_005fwww_005falt_005fin">12.4.175 Variable mon.dev_www_alt_in</a>
<li><a href="#Variable-mon_002evalue_005fwww_005falt_005fout">12.4.176 Variable mon.value_www_alt_out</a>
<li><a href="#Variable-mon_002eav_005fwww_005falt_005fout">12.4.177 Variable mon.av_www_alt_out</a>
<li><a href="#Variable-mon_002edev_005fwww_005falt_005fout">12.4.178 Variable mon.dev_www_alt_out</a>
<li><a href="#Variable-mon_002evalue_005fimaps_005fin">12.4.179 Variable mon.value_imaps_in</a>
<li><a href="#Variable-mon_002eav_005fimaps_005fin">12.4.180 Variable mon.av_imaps_in</a>
<li><a href="#Variable-mon_002edev_005fimaps_005fin">12.4.181 Variable mon.dev_imaps_in</a>
<li><a href="#Variable-mon_002evalue_005fimaps_005fout">12.4.182 Variable mon.value_imaps_out</a>
<li><a href="#Variable-mon_002eav_005fimaps_005fout">12.4.183 Variable mon.av_imaps_out</a>
<li><a href="#Variable-mon_002edev_005fimaps_005fout">12.4.184 Variable mon.dev_imaps_out</a>
<li><a href="#Variable-mon_002evalue_005fldap_005fin">12.4.185 Variable mon.value_ldap_in</a>
<li><a href="#Variable-mon_002eav_005fldap_005fin">12.4.186 Variable mon.av_ldap_in</a>
<li><a href="#Variable-mon_002edev_005fldap_005fin">12.4.187 Variable mon.dev_ldap_in</a>
<li><a href="#Variable-mon_002evalue_005fldap_005fout">12.4.188 Variable mon.value_ldap_out</a>
<li><a href="#Variable-mon_002eav_005fldap_005fout">12.4.189 Variable mon.av_ldap_out</a>
<li><a href="#Variable-mon_002edev_005fldap_005fout">12.4.190 Variable mon.dev_ldap_out</a>
<li><a href="#Variable-mon_002evalue_005fldaps_005fin">12.4.191 Variable mon.value_ldaps_in</a>
<li><a href="#Variable-mon_002eav_005fldaps_005fin">12.4.192 Variable mon.av_ldaps_in</a>
<li><a href="#Variable-mon_002edev_005fldaps_005fin">12.4.193 Variable mon.dev_ldaps_in</a>
<li><a href="#Variable-mon_002evalue_005fldaps_005fout">12.4.194 Variable mon.value_ldaps_out</a>
<li><a href="#Variable-mon_002eav_005fldaps_005fout">12.4.195 Variable mon.av_ldaps_out</a>
<li><a href="#Variable-mon_002edev_005fldaps_005fout">12.4.196 Variable mon.dev_ldaps_out</a>
<li><a href="#Variable-mon_002evalue_005fmongo_005fin">12.4.197 Variable mon.value_mongo_in</a>
<li><a href="#Variable-mon_002eav_005fmongo_005fin">12.4.198 Variable mon.av_mongo_in</a>
<li><a href="#Variable-mon_002edev_005fmongo_005fin">12.4.199 Variable mon.dev_mongo_in</a>
<li><a href="#Variable-mon_002evalue_005fmongo_005fout">12.4.200 Variable mon.value_mongo_out</a>
<li><a href="#Variable-mon_002eav_005fmongo_005fout">12.4.201 Variable mon.av_mongo_out</a>
<li><a href="#Variable-mon_002edev_005fmongo_005fout">12.4.202 Variable mon.dev_mongo_out</a>
<li><a href="#Variable-mon_002evalue_005fmysql_005fin">12.4.203 Variable mon.value_mysql_in</a>
<li><a href="#Variable-mon_002eav_005fmysql_005fin">12.4.204 Variable mon.av_mysql_in</a>
<li><a href="#Variable-mon_002edev_005fmysql_005fin">12.4.205 Variable mon.dev_mysql_in</a>
<li><a href="#Variable-mon_002evalue_005fmysql_005fout">12.4.206 Variable mon.value_mysql_out</a>
<li><a href="#Variable-mon_002eav_005fmysql_005fout">12.4.207 Variable mon.av_mysql_out</a>
<li><a href="#Variable-mon_002edev_005fmysql_005fout">12.4.208 Variable mon.dev_mysql_out</a>
<li><a href="#Variable-mon_002evalue_005fpostgres_005fin">12.4.209 Variable mon.value_postgres_in</a>
<li><a href="#Variable-mon_002eav_005fpostgres_005fin">12.4.210 Variable mon.av_postgres_in</a>
<li><a href="#Variable-mon_002edev_005fpostgres_005fin">12.4.211 Variable mon.dev_postgres_in</a>
<li><a href="#Variable-mon_002evalue_005fpostgres_005fout">12.4.212 Variable mon.value_postgres_out</a>
<li><a href="#Variable-mon_002eav_005fpostgres_005fout">12.4.213 Variable mon.av_postgres_out</a>
<li><a href="#Variable-mon_002edev_005fpostgres_005fout">12.4.214 Variable mon.dev_postgres_out</a>
<li><a href="#Variable-mon_002evalue_005fipp_005fin">12.4.215 Variable mon.value_ipp_in</a>
<li><a href="#Variable-mon_002eav_005fipp_005fin">12.4.216 Variable mon.av_ipp_in</a>
<li><a href="#Variable-mon_002edev_005fipp_005fin">12.4.217 Variable mon.dev_ipp_in</a>
<li><a href="#Variable-mon_002evalue_005fipp_005fout">12.4.218 Variable mon.value_ipp_out</a>
<li><a href="#Variable-mon_002eav_005fipp_005fout">12.4.219 Variable mon.av_ipp_out</a>
<li><a href="#Variable-mon_002edev_005fipp_005fout">12.4.220 Variable mon.dev_ipp_out</a>
</li></ul>
<li><a href="#Variable-context-sys">12.5 Variable context <code>sys</code></a>
<ul>
<li><a href="#Variable-sys_002earch">12.5.1 Variable sys.arch</a>
<li><a href="#Variable-sys_002ecdate">12.5.2 Variable sys.cdate</a>
<li><a href="#Variable-sys_002ecf_005fversion">12.5.3 Variable sys.cf_version</a>
<li><a href="#Variable-sys_002eclass">12.5.4 Variable sys.class</a>
<li><a href="#Variable-sys_002ecpus">12.5.5 Variable sys.cpus</a>
<li><a href="#Variable-sys_002ecrontab">12.5.6 Variable sys.crontab</a>
<li><a href="#Variable-sys_002edate">12.5.7 Variable sys.date</a>
<li><a href="#Variable-sys_002edoc_005froot">12.5.8 Variable sys.doc_root</a>
<li><a href="#Variable-sys_002edomain">12.5.9 Variable sys.domain</a>
<li><a href="#Variable-sys_002eenterprise_005fversion">12.5.10 Variable sys.enterprise_version</a>
<li><a href="#Variable-sys_002eexpires">12.5.11 Variable sys.expires</a>
<li><a href="#Variable-sys_002eexports">12.5.12 Variable sys.exports</a>
<li><a href="#Variable-sys_002eflavor">12.5.13 Variable sys.flavor</a>
<li><a href="#Variable-sys_002eflavour">12.5.14 Variable sys.flavour</a>
<li><a href="#Variable-sys_002efqhost">12.5.15 Variable sys.fqhost</a>
<li><a href="#Variable-sys_002efstab">12.5.16 Variable sys.fstab</a>
<li><a href="#Variable-sys_002ehardware_005faddresses">12.5.17 Variable sys.hardware_addresses</a>
<li><a href="#Variable-sys_002ehardware_005fmac_005binterface_005fname_005d">12.5.18 Variable sys.hardware_mac[interface_name]</a>
<li><a href="#Variable-sys_002ehost">12.5.19 Variable sys.host</a>
<li><a href="#Variable-sys_002einterface">12.5.20 Variable sys.interface</a>
<li><a href="#Variable-sys_002einterfaces">12.5.21 Variable sys.interfaces</a>
<li><a href="#Variable-sys_002eip_005faddresses">12.5.22 Variable sys.ip_addresses</a>
<li><a href="#Variable-sys_002eipv4">12.5.23 Variable sys.ipv4</a>
<li><a href="#Variable-sys_002eipv4_005binterface_005fname_005d">12.5.24 Variable sys.ipv4[interface_name]</a>
<li><a href="#Variable-sys_002eipv4_005f1_005binterface_005fname_005d">12.5.25 Variable sys.ipv4_1[interface_name]</a>
<li><a href="#Variable-sys_002eipv4_005f2_005binterface_005fname_005d">12.5.26 Variable sys.ipv4_2[interface_name]</a>
<li><a href="#Variable-sys_002eipv4_005f3_005binterface_005fname_005d">12.5.27 Variable sys.ipv4_3[interface_name]</a>
<li><a href="#Variable-sys_002elicense_005fowner">12.5.28 Variable sys.license_owner</a>
<li><a href="#Variable-sys_002elicenses_005fgranted">12.5.29 Variable sys.licenses_granted</a>
<li><a href="#Variable-sys_002elicenses_005finstalltime">12.5.30 Variable sys.licenses_installtime</a>
<li><a href="#Variable-sys_002elong_005farch">12.5.31 Variable sys.long_arch</a>
<li><a href="#Variable-sys_002emaildir">12.5.32 Variable sys.maildir</a>
<li><a href="#Variable-sys_002enova_005fversion">12.5.33 Variable sys.nova_version</a>
<li><a href="#Variable-sys_002eos">12.5.34 Variable sys.os</a>
<li><a href="#Variable-sys_002eostype">12.5.35 Variable sys.ostype</a>
<li><a href="#Variable-sys_002epolicy_005fhub">12.5.36 Variable sys.policy_hub</a>
<li><a href="#Variable-sys_002erelease">12.5.37 Variable sys.release</a>
<li><a href="#Variable-sys_002eresolv">12.5.38 Variable sys.resolv</a>
<li><a href="#Variable-sys_002euqhost">12.5.39 Variable sys.uqhost</a>
<li><a href="#Variable-sys_002eversion">12.5.40 Variable sys.version</a>
<li><a href="#Variable-sys_002ewindir">12.5.41 Variable sys.windir</a>
<li><a href="#Variable-sys_002ewinprogdir">12.5.42 Variable sys.winprogdir</a>
<li><a href="#Variable-sys_002ewinprogdir86">12.5.43 Variable sys.winprogdir86</a>
<li><a href="#Variable-sys_002ewinsysdir">12.5.44 Variable sys.winsysdir</a>
<li><a href="#Variable-sys_002eworkdir">12.5.45 Variable sys.workdir</a>
</li></ul>
<li><a href="#Variable-context-this">12.6 Variable context <code>this</code></a>
<ul>
<li><a href="#Variable-this_002ehandle">12.6.1 Variable this.handle</a>
<li><a href="#Variable-this_002epromise_005ffilename">12.6.2 Variable this.promise_filename</a>
<li><a href="#Variable-this_002epromise_005flinenumber">12.6.3 Variable this.promise_linenumber</a>
<li><a href="#Variable-this_002epromiser">12.6.4 Variable this.promiser</a>
<li><a href="#Variable-service_005fpolicy">12.6.5 Variable service_policy</a>
<li><a href="#Variable-this_002ethis">12.6.6 Variable this.this</a>
</li></ul>
</li></ul>
<li><a name="toc_Logs-and-records" href="#Logs-and-records">13 Logs and records</a>
<ul>
<li><a href="#Embedded-Databases">13.1 Embedded Databases</a>
<li><a href="#Text-logs">13.2 Text logs</a>
<li><a href="#Reports-in-outputs">13.3 Reports in outputs</a>
<li><a href="#Additional-reports-in-commercical-CFEngine-versions">13.4 Additional reports in commcerical CFEngine versions</a>
<li><a href="#State-information">13.5 State information</a>
</li></ul>
</li></ul>
</div>



<!-- The file is structured like a programming language. Each chapter -->
<!-- starts with a chapter comment. -->
<!-- Menus list the subsections so that an online info-reader can parse -->
<!-- the file hierarchically. -->
   <p><script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-2576171-2");
pageTracker._initData();
pageTracker._trackPageview();
</script>

   <div class="footnote">
<hr>
<a name="texinfo-footnotes-in-document"></a><h4>Footnotes</h4><p class="footnote"><small>[<a name="fn-1" href="#fnd-1">1</a>]</small> There are
no if-then-else statements in CFEngine; all decisions are made with classes.</p>

   <p class="footnote"><small>[<a name="fn-2" href="#fnd-2">2</a>]</small> There is no Da Vinci code in CFEngine</p>

   <hr></div>

</body></html>

